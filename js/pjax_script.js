var getRealPath=(t,e=!1)=>{t||(t=window.location.pathname);let a=t.split("/");if(!1===e)for(let t=a.length-1;t>=0;--t){let e=a[t].trim();if(e.length>0&&"/"!==e&&"index.html"!==e)return e}else for(let t=0;t<a.length;++t){let e=a[t].trim();if(e.length>0&&"/"!==e&&"index.html"!==e)return e}return"/"},scrollIntoViewAndWait=t=>new Promise((e=>{"onscrollend"in window?(document.addEventListener("scrollend",e,{once:!0}),t.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})):(t.scrollIntoView({block:"center",inline:"center"}),e())}));!function(t){t(".article-entry h1>a, .article-entry h2>a, .article-entry h3>a, .article-entry h4>a, .article-entry h5>a, .article-entry h6>a").each((function(){t(this)[0].innerHTML="&#xf292;"})),t(".article-share-link").off("click").on("click",(function(e){e.stopPropagation();const a=t(this),n=a.attr("data-url"),i=encodeURIComponent(n),r="article-share-box-"+a.attr("data-id"),o=a.attr("data-title"),s=a.offset();if(t("#"+r).length){if((c=t("#"+r)).hasClass("on"))return void c.removeClass("on")}else{const e=['<div id="'+r+'" class="article-share-box">','<input class="article-share-input" value="'+n+'">','<div class="article-share-links">','<a href="https://twitter.com/intent/tweet?text='+encodeURIComponent(o)+"&url="+i+'" class="article-share-twitter" target="_blank" title="Twitter"></a>','<a href="https://www.facebook.com/sharer.php?u='+i+'" class="article-share-facebook" target="_blank" title="Facebook"></a>','<a href="http://pinterest.com/pin/create/button/?url='+i+'" class="article-share-pinterest" target="_blank" title="Pinterest"></a>','<a href="https://www.linkedin.com/shareArticle?mini=true&url='+i+'" class="article-share-linkedin" target="_blank" title="LinkedIn"></a>',"</div>","</div>"].join("");var c=t(e);t("body").append(c)}t(".article-share-box.on").hide(),c.css({top:s.top+25,left:s.left}).addClass("on")})),t(".article-share-box").off("click").on("click",(function(t){t.stopPropagation()})),t(".article-share-box-input").off("click").on("click",(function(){t(this).select()})),t(".article-share-box-link").off("click").on("click",(function(t){t.preventDefault(),t.stopPropagation(),window.open(this.href,"article-share-box-window-"+Date.now(),"width=500,height=450")})),t(".article-entry").each((function(e){t(this).find("img").each((function(){if(t(this).parent().hasClass("fancybox")||t(this).parent().is("a"))return;if(t(this).parent().hasClass("friend-icon"))return;const e=this.alt;e&&t(this).after('<span class="caption">'+e+"</span>"),t(this).wrap('<a href="'+this.src+'" data-fancybox="gallery" data-caption="'+e+'"></a>')})),t(this).find(".fancybox").each((function(){t(this).attr("rel","article"+e)}))})),t.fancybox&&(t.fancybox.defaults.hash=!1,t(".fancybox").fancybox());let e=!1;t("#main-nav-toggle").off("click").on("click",(()=>{e||(e=!0,t("body").toggleClass("mobile-nav-on"),setTimeout((function(){e=!1}),200))})),t("#mask").off("click").on("click",(()=>{!e&&t("body").hasClass("mobile-nav-on")&&t("body").removeClass("mobile-nav-on")})),t(".sidebar-toc-btn").off("click").on("click",(function(){t(this).hasClass("current")||(t(".sidebar-toc-btn").addClass("current"),t(".sidebar-common-btn").removeClass("current"),t(".sidebar-toc-sidebar").removeClass("hidden"),t(".sidebar-common-sidebar").addClass("hidden"))})),t(".sidebar-common-btn").off("click").on("click",(function(){t(this).hasClass("current")||(t(".sidebar-common-btn").addClass("current"),t(".sidebar-toc-btn").removeClass("current"),t(".sidebar-common-sidebar").removeClass("hidden"),t(".sidebar-toc-sidebar").addClass("hidden"))}));const a=getRealPath(window.location.pathname,!0);for(let e of t(".sidebar-menu-link-wrap")){let n=t(e).find("a")[0].getAttribute("href");n&&getRealPath(n,!0)===a&&(e.className="sidebar-menu-link-wrap link-active")}function n(){const e="block"===getComputedStyle(document.getElementById("sidebar")).display?t("#sidebar .sidebar-toc-wrapper li"):t("#mobile-nav .sidebar-toc-wrapper li");if(!e.length)return;let a=null;const n=e.map((function(e){const n=t(this).children("a.toc-link"),r=n=>{n.preventDefault();const r=t(decodeURI(t(n.currentTarget).attr("href")));a=e,scrollIntoViewAndWait(r[0]).then((()=>{i(e),a=null}))};n.off("click").on("click",(t=>{r(t)}));const o=t(decodeURI(n.attr("href")));if(!o.length)return null;const s=o.children("a");return s&&s.on("click",(t=>{r(t)})),o})),i=a=>{const i=t(e[a]);if(!i.length)return;if(i.hasClass("current"))return;t(".sidebar-toc-wrapper .active").removeClass("active current"),n.each((function(){t(this)&&t(this).removeClass("active")})),i.addClass("active current"),n[a]&&t(n[a]).addClass("active");let r=e[a].parentNode;for(;!r.matches(".sidebar-toc");){if(r.matches("li")){t(r).addClass("active");const e=t(decodeURI(t(r).children("a.toc-link").attr("href")));e&&e.addClass("active")}r=r.parentNode}t(".sidebar-toc-sidebar").hasClass("hidden")||t(".sidebar-toc-wrapper")[0].scrollTo({top:t(".sidebar-toc-wrapper").scrollTop()+i[0].offsetTop-t(".sidebar-toc-wrapper")[0].offsetHeight/2,behavior:"smooth"})},r=new IntersectionObserver((t=>{const e=(t=>{let e=0,a=t[e];const i=n.toArray().map((t=>t[0]));if(a.boundingClientRect.top>0)return e=i.indexOf(a.target),0===e?0:e-1;for(;e<t.length;e++){if(!(t[e].boundingClientRect.top<=0))return i.indexOf(a.target);a=t[e]}return i.indexOf(a.target)})(t)+(window.diffY>0?1:0);null===a&&i(e)}),{rootMargin:"0px 0px -100% 0px",threshold:0});n.each((function(){t(this).length&&r.observe(t(this)[0])}))}t(".article-entry img").each((function(){const e=t(this).attr("src");t(this).addClass("lazyload"),t(this).removeAttr("src"),t(this).attr("data-src",e),t(this).attr("data-sizes","auto")})),t(".sidebar-top").off("click").on("click",(()=>{t("html")[0].scrollTo({top:0,behavior:"smooth"})})),document.documentElement.scrollTop<10&&t(".sidebar-top").fadeOut(),t(window).off("scroll").on("scroll",(()=>{document.documentElement.scrollTop<10?t(".sidebar-top").fadeOut():t(".sidebar-top").fadeIn()})),t(".toc a").off("click").on("click",(()=>{!e&&t("body").hasClass("mobile-nav-on")&&t("body").removeClass("mobile-nav-on")})),window.addEventListener("hexo-blog-decrypt",n),window.addEventListener("hexo-blog-decrypt",(()=>{const t=document.createElement("script");t.src="/js/insert_highlight.js",t.setAttribute("data-pjax",!0),document.body.appendChild(t)})),n()}(jQuery);