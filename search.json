[{"title":"hexo-theme-reimuå¼€å‘æ—¥å¿—","url":"/20240601/hexo-theme-reimu-log/","content":"\nhexo-theme-reimu çš„å¼€å‘æ—¥å¿—\n\n## v0.2.0(WIP)\n\n### ä¿®å¤\n\n- ä¿®å¤äº†åœ¨ä½¿ç”¨ [hexo-blog-encrypt](https://github.com/D0n9X1n/hexo-blog-encrypt) æ—¶ä»£ç å—æ ·å¼æ˜¾ç¤ºå¼‚å¸¸\n\n### ç‰¹æ€§\n\n- æ–°å¢äº†æ–‡ç« ç‰ˆæƒå±•ç¤ºçš„åŠŸèƒ½ï¼Œé»˜è®¤å…³é—­\n  ```yaml\n  article_copyright:\n  enable: # true | false æ˜¯å¦å±•ç¤ºç‰ˆæƒå¡ç‰‡ï¼Ÿ\n  content:\n    author: # true | false ç‰ˆæƒå¡ç‰‡å±•ç¤ºä½œè€…ï¼Ÿ\n    link: # true | false ç‰ˆæƒå¡ç‰‡å±•ç¤ºé“¾æ¥ï¼Ÿ\n    title: # true | false ç‰ˆæƒå¡ç‰‡å±•ç¤ºæ ‡é¢˜ï¼Ÿ\n    date: # true | false ç‰ˆæƒå¡ç‰‡å±•ç¤ºåˆ›å»ºæ—¥æœŸï¼Ÿ\n    updated: # true | false ç‰ˆæƒå¡ç‰‡å±•ç¤ºæ›´æ–°æ—¥æœŸï¼Ÿ\n    license: # true | false ç‰ˆæƒå¡ç‰‡å±•ç¤ºåè®®ï¼Ÿ\n  ```\n- æ–°å¢äº†å†…é“¾/å¤–é“¾å¡ç‰‡çš„æ ‡ç­¾\n  - postLinkCard\n    ```yaml\n    {% postLinkCard slug [cover]|\"auto\" [escape] %}\n    ```\n    å…¶ä¸­ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ–‡ç« çš„ `slug`ï¼›ç¬¬äºŒä¸ªå‚æ•°ï¼ˆå¯é€‰ï¼‰ä¸ºå¡ç‰‡å±•ç¤ºçš„å°é¢ï¼Œå¦‚æœè®¾ç½®ä¸º `auto` åˆ™è‡ªåŠ¨ä½¿ç”¨åšå®¢çš„ `banner`ï¼›ç¬¬ä¸‰ä¸ªå‚æ•°ï¼ˆå¯é€‰ï¼‰è¡¨ç¤ºæ–‡ç« æ ‡é¢˜æ˜¯å¦è¢«è½¬ä¹‰\n  - externalLinkCard\n    ```yaml\n    {% externalLinkCard title link [cover]|\"auto\" %}\n    ```\n    å…¶ä¸­ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ–‡ç« çš„æ ‡é¢˜ï¼›ç¬¬äºŒä¸ªå‚æ•°ä¸ºæ–‡ç« çš„å¤–éƒ¨é“¾æ¥ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°ï¼ˆå¯é€‰ï¼‰ä¸ºå¡ç‰‡å±•ç¤ºçš„å°é¢ï¼Œå¦‚æœè®¾ç½®ä¸º `auto` åˆ™è‡ªåŠ¨ä½¿ç”¨ç¼ºçœå°é¢\n- å‹é“¾ä¼˜åŒ–ï¼Œç°åœ¨å˜å¾—æ›´å¥½çœ‹äº†ï¼\n- ä»£ç åŒºåŸŸç²˜è´´ä¼˜åŒ–ï¼Œç°åœ¨ç²˜è´´åä¼šæœ‰å›¾æ ‡å˜åŒ–ï¼Œä¸”ä¼šå¼¹å‡ºå¯¹åº”æ¶ˆæ¯\n\n### æ€§èƒ½\n\n- banner å’Œ avatar æ”¹ç”¨ webp æ ¼å¼ï¼Œé™ä½æ–‡ä»¶å¤§å°\n- Google font å­—ä½“ä¼˜åŒ–\n  - `<link rel=\"preconnect\" href=\"https://fonts.gstatic.com/\" crossorigin>`\n  - `<link rel=\"preload\" as=\"style\" href=\"https://fonts.googleapis.com/css\">`\n  - `<link rel=\"stylesheet\" href=\"https://fonts.googleapis.com/css\" media=\"print\" onload=\"this.media='all'\">`\n- mermaid æ”¯æŒæ‡’åŠ è½½ï¼Œä½†ç°åœ¨éœ€è¦åŒæ—¶åœ¨ config å’Œ `front-matter` ä¸­å¯ç”¨ mermaid\n  ```yaml\n  ---\n  mermaid: true\n  ---\n  ```\n\n### âš ï¸ é‡æ„ âš ï¸\n\n- å›¾æ ‡æ”¹ç”¨äº† iconfontï¼Œä½†åŒæ—¶ä¹Ÿä¿ç•™äº† fontawesomeï¼ˆ`icon_font` ä¸º `false` æ—¶é»˜è®¤ä½¿ç”¨ fontawesomeï¼‰\n  ```yaml\n  icon_font: # icon_id | false\n  ```\n\n## v0.1.2\n\n**2024-04-27**\n\n### ä¿®å¤\n\n- ä¿®å¤äº†åœ¨ä½¿ç”¨ [hexo-blog-encrypt](https://github.com/D0n9X1n/hexo-blog-encrypt) æ—¶ TOC æ— æ³•æ˜¾ç¤ºçš„ bug\n\n## v0.1.1\n\n**2024-04-05**\n\n### ç‰¹æ€§\n\n- æ–°å¢äº†å¯çˆ±çµæ¢¦(_â•¹â–½â•¹_)é¼ æ ‡æŒ‡é’ˆï¼Œé»˜è®¤å¼€å¯\n  ```yaml\n  reimu_cursor: # true | false\n  ```\n- æ–°å¢äº† clarity ç»Ÿè®¡\n  ```yaml\n  clarity: # clarity ID\n  ```\n- ç§»é™¤äº†åºŸå¼ƒçš„ gauges ç»Ÿè®¡ï¼Œä»¥ä¸‹é…ç½®ç°åœ¨ä¸å¯ç”¨\n  ```yaml\n  gauges_analytics: # gauges ID\n  ```\n\n### ä¿®å¤\n\n- ä¿®å¤äº† front-matter ä¸­æœªå¡«å†™ `comment` å­—æ®µæ—¶è¯„è®ºä¸æ˜¾ç¤ºçš„ bug\n- ä¿®å¤äº† giscus è¯„è®ºç³»ç»Ÿå®½åº¦æ˜¾ç¤ºå¼‚å¸¸çš„ bug\n\n### æ€§èƒ½\n\n- æå‡äº† lighthouse æ— éšœç¢ç›¸å…³åˆ†æ•°\n- å‡å°‘äº† `banner.jpg` çš„ä½“ç§¯\n\n## v0.1.0\n\n**2024-01-14**\n\nğŸ‰ğŸ‰ğŸ‰ ç»è¿‡äº†è¿‘ä¸€å¹´çš„~~æ‘¸é±¼~~ï¼Œv0.1.0 ç»ˆäºå‘å¸ƒå•¦ ğŸ‰ğŸ‰ğŸ‰\n\n### âš ï¸ é‡æ„ âš ï¸\n\n- [hexo-algolia](https://github.com/thom4parisot/hexo-algolia) æ›¿æ¢ä¸ºäº† [hexo-algoliasearch](https://github.com/LouisBarranqueiro/hexo-algoliasearch)\n- é…ç½®ä¸­çš„ `vendor` è¿›è¡Œäº†å®Œå…¨é‡æ„ï¼Œç°åœ¨æ”¯æŒæ‰‹åŠ¨åˆ‡æ¢ CDNï¼š\n  ```yaml\n  vendor:\n    cdn_jsdelivr_gh: https://cdn.jsdelivr.net/gh/\n    cdn_jsdelivr_npm: https://cdn.jsdelivr.net/npm/\n    fastly_jsdelivr_gh: https://fastly.jsdelivr.net/gh/\n    fastly_jsdelivr_npm: https://fastly.jsdelivr.net/npm/\n    unpkg: https://unpkg.com/\n    webcache: https://npm.webcache.cn/\n    js:\n      jquery: webcache|jquery@3.7.1/dist/jquery.min.js\n  ```\n  ç›®å‰æä¾›äº† `jsdelivr/gh`ã€`jsdelivr/npm`ã€`fastly.jsdelivr/gh`ã€`fastly.jsdelivr/npm`ã€`unpkg` å’Œ `webcache` è¿™å‡ ä¸ª CDN æºã€‚æ‰€æœ‰çš„ä¾èµ–åœ°å€ç°åœ¨çš„ç»“æ„ä¸º `CDNæº|ä¾èµ–è·¯å¾„`ï¼Œåœ¨ç”Ÿæˆåšå®¢çš„è¿‡ç¨‹ä¸­ä¸»é¢˜ä¼šè‡ªåŠ¨å°† CDN æºå’Œåç»­è·¯å¾„æ‹¼æ¥ä»è€Œå½¢æˆå®Œæ•´çš„åœ°å€\n\n### ç‰¹æ€§\n\n- ServiceWorker å¢åŠ å¯¹éƒ¨åˆ†åŸŸåçš„é€‰æ‹©ç¼“å­˜\n- å®Œå–„ TOCï¼Œç›®å‰ TOC å¯ä»¥éšç€é¡µé¢æ»šåŠ¨è€ŒåŠ¨æ€æ›´æ–°ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ç‚¹å‡» TOC è·³è½¬åˆ°å¯¹åº”é”šç‚¹\n- æ”¯æŒäº† waline çš„é˜…è¯»ç»Ÿè®¡åŠŸèƒ½ï¼Œå¯ç”¨æ–¹å¼ï¼š\n  ```yaml\n  waline:\n    pageview: true\n  ```\n\n### ä¿®å¤\n\n- ä¿®å¤äº† pjax æ¨¡å¼ä¸‹ mermaid æ˜¾ç¤ºå¼‚å¸¸çš„é—®é¢˜\n- ä¿®å¤äº† pjax æ¨¡å¼ä¸‹ `insert_highlight` å¤šæ¬¡è°ƒç”¨çš„ bug\n- åŒæ­¥äº†æ‰€æœ‰åŠ¨ç”»çš„æŒç»­æ—¶é—´å’Œç¼“åŠ¨å‡½æ•°\n- ä¿®å¤äº†é…ç½®é¡¹æœªå¡«å†™ `widgets` åç©ºæŒ‡é’ˆçš„ bug\n\n### æ€§èƒ½\n\n- æå‡äº† LCP åˆ†æ•°\n  - google font é‡‡ç”¨ `rel:preload` çš„æ–¹å¼åŠ è½½\n  - banner æ·»åŠ  `fetchpriority=\"high\"`\n  - fontawesome éƒ¨åˆ† css é‡‡ç”¨ `rel:preload` çš„æ–¹å¼åŠ è½½\n\n## v0.0.11\n\n**2024-01-10**\n\n### ç‰¹æ€§\n\n- æ–°å¢äº† ServiceWorker åŠŸèƒ½ï¼Œé»˜è®¤å¼€å¯\n  ```yaml\n  service_worker:\n    enable: # true | false\n  ```\n- æ–°å¢äº† live2d åŠŸèƒ½ï¼Œé»˜è®¤å…³é—­\n  ```yaml\n  live2d:\n    enable: # true | false\n  ```\n- å¯¼èˆªæ ä¼˜åŒ–ï¼Œç°åœ¨æ”¯æŒå¯¼èˆªæ éšç€é¡µé¢æ»šåŠ¨çš„æ–¹å‘è€ŒåŠ¨æ€æ˜¾ç¤ºå’Œéšè—\n- ä»£ç å—ç°åœ¨æ”¯æŒäº†æ—¥å¤œæ¨¡å¼ï¼Œå˜å¾—æ›´å¥½çœ‹äº†ï¼\n- æ—¥å¤œæ¨¡å¼é¢œè‰² token ä¼˜åŒ–ï¼Œå˜å¾—æ›´å¥½çœ‹äº†ï¼\n\n## v0.0.10\n\n**2024-01-07**\n\n### ä¿®å¤\n\n- ä¿®å¤äº† 404 é¡µé¢ä¸èƒ½æ­£å¸¸æœç´¢çš„ bug\n- ä¿®å¤äº† TOC æ ·å¼å¼‚å¸¸\n\n### ç‰¹æ€§\n\n- ç°åœ¨ä¸ä»…ä»…æ”¯æŒ algolia æœç´¢ï¼Œä¹Ÿæ”¯æŒä½¿ç”¨ [hexo-generate-search](https://github.com/wzpan/hexo-generator-search) è¿›è¡Œæœç´¢äº†\n  ```yaml\n  generator_search:\n    enable: # true | false\n  ```\n- æ–°å¢äº†é¼ æ ‡çƒŸç«æ•ˆæœï¼Œé»˜è®¤å¼€å¯ï¼ˆå…·ä½“é…ç½®å¯ä»¥çœ‹ [mouse-firework](https://github.com/D-Sketon/mouse-firework)ï¼Œä¹Ÿæ˜¯æœ¬äººå†™çš„ä¸€ä¸ªåº“ï¼‰\n  ```yaml\n  firework:\n  enable: # true | false\n  options:\n    excludeElements: [\"a\"]\n    particles:\n      - shape: circle\n        move: [\"emit\"]\n        easing: easeOutExpo\n        colors: [\"#ff5252\", \"#ff7c7c\", \"#ffafaf\", \"#ffd0d0\"]\n        number: 20\n        duration: [1200, 1800]\n        shapeOptions:\n          radius: [16, 32]\n          alpha: [0.3, 0.5]\n      - shape: circle\n        move: [\"diffuse\"]\n        easing: easeOutExpo\n        colors: [\"#ff0000\"]\n        number: 1\n        duration: [1200, 1800]\n        shapeOptions:\n          radius: 20\n          alpha: [0.2, 0.5]\n          lineWidth: 6\n  ```\n- æ–°å¢äº† pjax åŠŸèƒ½ï¼Œä½†ç›®å‰ä»ç„¶ä¸ç¨³å®šï¼Œä¼šæœ‰å¾ˆå¤š bugï¼Œé»˜è®¤å…³é—­\n  ```yaml\n  pjax:\n    enable: # true | false\n  ```\n\n## v0.0.9\n\n**2024-01-01**\n\n### ä¿®å¤\n\n- ä¿®å¤äº†ç¼“å­˜è®¾ç½®å¼‚å¸¸é€ æˆçš„ TOC æ˜¾ç¤ºä¸æ­£ç¡®çš„ bug\n- ä¿®å¤äº† valine è¯„è®ºæ•°æ˜¾ç¤ºå¼‚å¸¸çš„ bug\n\n### ç‰¹æ€§\n\n- å›åˆ°é¡¶éƒ¨æŒ‰é’®å˜å¾—æ›´å¥½çœ‹äº†\n- TOC æ–°å¢äº†åˆ‡æ¢åˆ°é¦–é¡µçš„æŒ‰é’®\n- æ”¯æŒäº† valine çš„é˜…è¯»ç»Ÿè®¡åŠŸèƒ½ï¼Œå¯ç”¨æ–¹å¼ï¼š\n  ```yaml\n  valine:\n    visitor: true\n  ```\n\n## v0.0.8\n\n**2023-12-31**\n\n### ç‰¹æ€§\n\n- ä¸‡ä¼—æœŸå¾…çš„ TOC ç»ˆäºå®ç°äº†~~ä¸€éƒ¨åˆ†~~\n- fontawesome å‡çº§åˆ° v6ï¼ŒåŒæ—¶ä¸º `social` æ–°å¢äº†ä¸€å †å›¾æ ‡\n- æ–°å¢äº†å›åˆ°é¡¶éƒ¨æŒ‰é’®\n- æ—¥å¤œæ¨¡å¼é¢œè‰² token ä¼˜åŒ–ï¼Œå˜å¾—æ›´å¥½çœ‹äº†ï¼\n- é€‚é… hexo v7\n\n## v0.0.7\n\n**2023-09-09**\n\n### ä¿®å¤\n\n- ä¿®å¤äº† lazyload å’Œ fancybox å†²çªçš„ bug\n- æ–°å¢äº†æ›´å¤šçš„å°é¢é€‰é¡¹\n\n## v0.0.6\n\n**2023-07-02**\n\n### ä¿®å¤\n\n- ä¿®å¤äº†ç§»åŠ¨ç«¯åˆ†é¡µæ˜¾ç¤ºå¼‚å¸¸\n\n### ç‰¹æ€§\n\n- æ–°å¢äº†è¿‡æ¸¡åŠ¨ç”»åŠŸèƒ½ï¼Œé»˜è®¤å¼€å¯\n  ```yaml\n  animation:\n    enable: # true | false\n  ```\n- æ–°å¢äº†æ—¥å¤œæ¨¡å¼åŠŸèƒ½ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹é…ç½®è®¾ç½®é»˜è®¤æ¨¡å¼\n  ```yaml\n  dark_mode:\n    enable: # true | false\n  ```\n\n## v0.0.5\n\n**2023-06-30**\n\n### ç‰¹æ€§\n\n- æ–°å¢äº†åŠ è½½åŠ¨ç”»åŠŸèƒ½ï¼Œé»˜è®¤å¼€å¯\n  ```yaml\n  preloader:\n    enable: # true | false\n    text: # åŠ è½½æ–‡æœ¬\n  ```\n- æ–°å¢äº†ç‰ˆæœ¬æ£€æŸ¥åŠŸèƒ½ï¼Œå¦‚æœå‘ç°äº†ä¸»é¢˜çš„æ–°ç‰ˆæœ¬ä¼šåœ¨æ§åˆ¶å°ä¸­æç¤º\n\n### é‡æ„\n\n- ç§»é™¤æœ¬åœ° Ubuntu Mono å­—ä½“\n- ç§»é™¤æœ¬åœ° fontawesome å­—ä½“\n\n## v0.0.4\n\n**2023-06-26**\n\n### ç‰¹æ€§\n\n- æ–°å¢äº†ç™¾åº¦ç»Ÿè®¡\n\n  ```yaml\n  baidu_analytics: # baidu ID\n  ```\n\n- æ–°å¢äº† waline è¯„è®ºç³»ç»Ÿ\n  ```yaml\n  waline:\n    enable: # true | false\n    serverURL:\n    lang: zh-CN\n    locale: {} # https://waline.js.org/guide/features/i18n.html#%E8%87%AA%E5%AE%9A%E4%B9%89%E8%AF%AD%E8%A8%80\n    emoji:\n      - https://unpkg.com/@waline/emojis@1.2.0/weibo\n      - https://unpkg.com/@waline/emojis@1.2.0/alus\n      - https://unpkg.com/@waline/emojis@1.2.0/bilibili\n      - https://unpkg.com/@waline/emojis@1.2.0/qq\n      - https://unpkg.com/@waline/emojis@1.2.0/tieba\n      - https://unpkg.com/@waline/emojis@1.2.0/tw-emoji\n    meta:\n      - nick\n      - mail\n      - link\n    requiredMeta:\n      - nick\n      - mail\n    wordLimit: 0\n    pageSize: 10\n  ```\n- æ–°å¢äº† twikoo è¯„è®ºç³»ç»Ÿ\n  ```yaml\n  twikoo:\n    enable: # true | false\n    envId: # è…¾è®¯äº‘ç¯å¢ƒå¡« envIdï¼›Vercel ç¯å¢ƒå¡«åœ°å€ï¼ˆhttps://xxx.vercel.appï¼‰\n    region:\n  ```\n- æ–°å¢äº† gitalk è¯„è®ºç³»ç»Ÿ\n  ```yaml\n  gitalk:\n    enable: # true | false\n    clientID:\n    clientSecret:\n    repo:\n    owner:\n    admin:\n  ```\n- æ–°å¢äº† giscus è¯„è®ºç³»ç»Ÿ\n  ```yaml\n  giscus:\n    enable: # true | false\n    repo:\n    repoId:\n    category:\n    categoryId:\n    mapping:\n    strict:\n    reactionsEnabled:\n    emitMetadata:\n    inputPosition:\n    commentTheme:\n    lang:\n  ```\n","tags":["Hexo"],"categories":["è®¡è½¯æ‚è°ˆ","hexo"]},{"title":"hexo-theme-reimuæ•ˆæœå±•ç¤º","url":"/20240114/hexo-theme-reimu-content/","content":"\n## Markdown åŸºæœ¬å…ƒç´ \n\n### æ ‡é¢˜\n\n# H1\n\n## H2\n\n### H3\n\n#### H4\n\n##### H5\n\n###### H6\n\n### å¼ºè°ƒ\n\nEmphasis, aka italics, with _asterisks_ or _underscores_.\n\nStrong emphasis, aka bold, with **asterisks** or **underscores**.\n\nCombined emphasis with **asterisks and _underscores_**.\n\nStrikethrough uses two tildes. ~~Scratch this.~~\n\n### åˆ—è¡¨\n\n#### Definition List (dl)\n\n<dl><dt>Definition List Title</dt><dd>This is a definition list division.</dd></dl>\n\n#### Ordered List (ol)\n\n1. List Item 1\n2. List Item 2\n3. List Item 3\n\n#### Unordered List (ul)\n\n- List Item 1\n- List Item 2\n- List Item 3\n\n### æ®µè½\n\nLorem ipsum dolor sit amet, [test link]() consectetur adipiscing elit. **Strong text** pellentesque ligula commodo viverra vehicula. _Italic text_ at ullamcorper enim. Morbi a euismod nibh. <u>Underline text</u> non elit nisl. ~~Deleted text~~ tristique, sem id condimentum tempus, metus lectus venenatis mauris, sit amet semper lorem felis a eros. Fusce egestas nibh at sagittis auctor. Sed ultricies ac arcu quis molestie. Donec dapibus nunc in nibh egestas, vitae volutpat sem iaculis. Curabitur sem tellus, elementum nec quam id, fermentum laoreet mi. Ut mollis ullamcorper turpis, vitae facilisis velit ultricies sit amet. Etiam laoreet dui odio, id tempus justo tincidunt id. Phasellus scelerisque nunc sed nunc ultricies accumsan.\n\nInterdum et malesuada fames ac ante ipsum primis in faucibus. `Sed erat diam`, blandit eget felis aliquam, rhoncus varius urna. Donec tellus sapien, sodales eget ante vitae, feugiat ullamcorper urna. Praesent auctor dui vitae dapibus eleifend. Proin viverra mollis neque, ut ullamcorper elit posuere eget.\n\n> This is a very long line that will still be quoted properly when it wraps. Oh boy let's keep writing to make sure this is long enough to actually wrap for everyone. Oh, you can _put_ **Markdown** into a blockquote.\n\nMaecenas ornare arcu at mi suscipit, non molestie tortor ultrices. Aenean convallis, diam et congue ultricies, erat magna tincidunt orci, pulvinar posuere mi sapien ac magna. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Praesent vitae placerat mauris. Nullam laoreet ante posuere tortor blandit auctor. Sed id ligula volutpat leo consequat placerat. Mauris fermentum dolor sed augue malesuada sollicitudin. Vivamus ultrices nunc felis, quis viverra orci eleifend ut. Donec et quam id urna cursus posuere. Donec elementum scelerisque laoreet.\n\n### è¡¨æ ¼\n\n| Table Header 1 | Table Header 2 | Table Header 3 |\n| -------------- | -------------- | -------------- |\n| Division 1     | Division 2     | Division 3     |\n| Division 1     | Division 2     | Division 3     |\n| Division 1     | Division 2     | Division 3     |\n\n| Markdown | Less      | Pretty     |\n| -------- | --------- | ---------- |\n| _Still_  | `renders` | **nicely** |\n| 1        | 2         | 3          |\n\n### å…¶ä»–å…ƒç´  - abbr, acronym, sub, sup, kbd, etc.\n\nLorem <sup>superscript</sup> dolor <sub>subscript</sub> amet, consectetuer adipiscing elit. Nullam dignissim convallis est. Quisque aliquam. <cite>cite</cite>. Nunc iaculis suscipit dui. Nam sit amet sem. Aliquam libero nisi, imperdiet at, tincidunt nec, gravida vehicula, nisl. Praesent mattis, massa quis luctus fermentum, turpis mi volutpat justo, eu volutpat enim diam eget metus. Maecenas ornare tortor. Donec sed tellus eget sapien fringilla nonummy. <acronym title=\"National Basketball Association\">NBA</acronym> Mauris a ante. Suspendisse quam sem, consequat at, commodo vitae, feugiat in, nunc. Morbi imperdiet augue quis tellus. <abbr title=\"Avenue\">AVE</abbr>. Use <kbd>Crtl</kbd> + <kbd>C</kbd> to stop.\n\n### å›¾ç‰‡\n\n![image](https://d-sketon.top/img/backwebp/bg1.webp)\n\n## ä»£ç å—\n\n```plain\nLorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book.\n```\n\n```rust\n#[derive(Debug)]\npub enum State {\n    Start,\n    Transient,\n    Closed,\n}\n\nimpl From<&'a str> for State {\n    fn from(s: &'a str) -> Self {\n        match s {\n            \"start\" => State::Start,\n            \"closed\" => State::Closed,\n            _ => unreachable!(),\n        }\n    }\n}\n```\n\n```json\n[\n  {\n    \"title\": \"apples\",\n    \"count\": [12000, 20000],\n    \"description\": { \"text\": \"...\", \"sensitive\": false }\n  },\n  {\n    \"title\": \"oranges\",\n    \"count\": [17500, null],\n    \"description\": { \"text\": \"...\", \"sensitive\": false }\n  }\n]\n```\n\n```python\n@requires_authorization\ndef somefunc(param1='', param2=0):\n    r'''A docstring'''\n    if param1 > param2: # interesting\n        print 'Gre\\'ater'\n    return (param2 - param1 + 1 + 0b10l) or None\n\nclass SomeClass:\n    pass\n\n>>> message = '''interpreter\n... prompt'''\n```\n\n```html\n<!DOCTYPE html>\n<title>Title</title>\n\n<style>\n  body {\n    width: 500px;\n  }\n</style>\n\n<script type=\"application/javascript\">\n  function $init() {\n    return true;\n  }\n</script>\n\n<body>\n  <p checked class=\"title\" id=\"title\">Title</p>\n  <!-- here goes the rest of the page -->\n</body>\n```\n\n```javascript\nfunction $initHighlight(block, cls) {\n  try {\n    if (cls.search(/\\bno\\-highlight\\b/) != -1)\n      return process(block, true, 0x0F) +\n             ` class=\"${cls}\"`;\n  } catch (e) {\n    /* handle exception */\n  }\n  for (var i = 0 / 2; i < classes.length; i++) {\n    if (checkCondition(classes[i]) === undefined)\n      console.log('undefined');\n  }\n\n  return (\n    <div>\n      <web-component>{block}</web-component>\n    </div>\n  )\n}\n\nexport $initHighlight;\n```\n\n```cpp\n#include <iostream>\n\nint main(int argc, char *argv[]) {\n\n  /* An annoying \"Hello World\" example */\n  for (auto i = 0; i < 0xFFFF; i++)\n    cout << \"Hello, World!\" << endl;\n\n  char c = '\\n';\n  unordered_map <string, vector<string> > m;\n  m[\"key\"] = \"\\\\\\\\\"; // this is an error\n\n  return -2e3 + 12l;\n}\n```\n\n```sql\nCREATE TABLE \"topic\" (\n    \"id\" serial NOT NULL PRIMARY KEY,\n    \"forum_id\" integer NOT NULL,\n    \"subject\" varchar(255) NOT NULL\n);\nALTER TABLE \"topic\"\nADD CONSTRAINT forum_id FOREIGN KEY (\"forum_id\")\nREFERENCES \"forum\" (\"id\");\n\n-- Initials\ninsert into \"topic\" (\"forum_id\", \"subject\")\nvalues (2, 'D''artagnian');\n```\n\n```objectivec\n#import <UIKit/UIKit.h>\n#import \"Dependency.h\"\n\n@protocol WorldDataSource\n@optional\n- (NSString*)worldName;\n@required\n- (BOOL)allowsToLive;\n@end\n\n@property (nonatomic, readonly) NSString *title;\n- (IBAction) show;\n@end\n```\n\n```java\n/**\n * @author John Smith <john.smith@example.com>\n*/\npackage l2f.gameserver.model;\n\npublic abstract class L2Char extends L2Object {\n  public static final Short ERROR = 0x0001;\n\n  public void moveTo(int x, int y, int z) {\n    _ai = null;\n    log(\"Should not be called\");\n    if (1 > 5) { // wtf!?\n      return;\n    }\n  }\n}\n```\n\n```swift\nimport Foundation\n\n@objc class Person: Entity {\n  var name: String!\n  var age:  Int!\n\n  init(name: String, age: Int) {\n    /* /* ... */ */\n  }\n\n  // Return a descriptive string for this person\n  func description(offset: Int = 0) -> String {\n    return \"\\(name) is \\(age + offset) years old\"\n  }\n}\n```\n\n```css\n@font-face {\n  font-family: Chunkfive;\n  src: url(\"Chunkfive.otf\");\n}\n\nbody,\n.usertext {\n  color: #f0f0f0;\n  background: #600;\n  font-family: Chunkfive, sans;\n}\n\n@import url(print.css);\n@media print {\n  a[href^=\"http\"]::after {\n    content: attr(href);\n  }\n}\n```\n\n```ruby\n# The Greeter class\nclass Greeter\n  def initialize(name)\n    @name = name.capitalize\n  end\n\n  def salute\n    puts \"Hello #{@name}!\"\n  end\nend\n\ng = Greeter.new(\"world\")\ng.salute\n```\n\n```makefile\n# Makefile\n\nBUILDDIR      = _build\nEXTRAS       ?= $(BUILDDIR)/extras\n\n.PHONY: main clean\n\nmain:\n\t@echo \"Building main facility...\"\n\tbuild_main $(BUILDDIR)\n\nclean:\n\trm -rf $(BUILDDIR)/*\n```\n\n```go\npackage main\n\nimport \"fmt\"\n\nfunc main() {\n    ch := make(chan float64)\n    ch <- 1.0e10    // magic number\n    x, ok := <- ch\n    defer fmt.Println(`exitting now\\`)\n    go println(len(\"hello world!\"))\n    return\n}\n```\n\n```bash\n#!/bin/bash\n\n###### CONFIG\nACCEPTED_HOSTS=\"/root/.hag_accepted.conf\"\nBE_VERBOSE=false\n\nif [ \"$UID\" -ne 0 ]\nthen\n  echo \"Superuser rights required\"\n  exit 2\nfi\n\ngenApacheConf(){\n  echo -e \"# Host ${HOME_DIR}$1/$2 :\"\n}\n```\n\n```ini\n; boilerplate\n[package]\nname = \"some_name\"\nauthors = [\"Author\"]\ndescription = \"This is \\\na description\"\n\n[[lib]]\nname = ${NAME}\ndefault = True\nauto = no\ncounter = 1_000\n```\n\n## æ ‡ç­¾æ’ä»¶\n\n### å¼•ç”¨å—\n\n{% blockquote David Levithan, Wide Awake %}\nDo not just seek happiness for yourself. Seek happiness for all. Through kindness. Through mercy.\n{% endblockquote %}\n\n{% blockquote Seth Godin http://sethgodin.typepad.com/seths_blog/2009/07/welcome-to-island-marketing.html Welcome to Island Marketing %}\nEvery interaction is both precious and an opportunity to delight.\n{% endblockquote %}\n\n### ä»£ç å—\n\n#### å¸¦æœ‰æ ‡é¢˜å’Œ URL\n\n{% codeblock .compact http://underscorejs.org/#compact Underscore.js %}\n.compact([0, 1, false, 2, â€˜â€™, 3]);\n=> [1, 2, 3]\n{% endcodeblock %}\n\n#### å¸¦æœ‰é€‰ä¸­è¡Œ\n\n{% codeblock lang:js mark:1,7-8,10 %}\nconst http = require('http');\n\nconst hostname = '127.0.0.1';\nconst port = 1337;\n\nhttp.createServer((req, res) => {\n  res.writeHead(200, { 'Content-Type': 'text/plain' });\n  res.end('Hello World\\n');\n}).listen(port, hostname, () => {\n  console.log(`Server running at http://${hostname}:${port}/`);\n});\n{% endcodeblock %}\n\n### Gist\n\n{% gist 996818 %}\n\n### jsFiddle\n\n{% jsfiddle ccWP7 %}\n\n### Pull Quote\n\n{% pullquote left %}\nLorem ipsum dolor sit amet, consectetur adipiscing elit.\n{% endpullquote %}\n\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas tempus molestie arcu, et fringilla mauris placerat ac. Nullam luctus bibendum risus. Ut cursus sed ipsum feugiat egestas. Suspendisse elementum, velit eu consequat consequat, augue lorem dapibus libero, eget pulvinar dolor est sit amet nulla. Suspendisse a porta tortor, et posuere mi. Pellentesque ultricies, mi quis volutpat malesuada, erat felis vulputate nisl, ac congue ante tortor ut ante. Proin aliquam sem vel mauris tincidunt, eget scelerisque tortor euismod. Nulla tincidunt enim nec commodo dictum. Mauris id sapien et orci gravida luctus id ut dui. In vel vulputate odio. Duis vel turpis molestie, scelerisque enim eu, lobortis eros. Cras at ipsum gravida, sagittis ante vel, viverra tellus. Nunc mauris turpis, elementum ullamcorper nisl pretium, ultrices cursus justo. Mauris porttitor commodo eros, ac ornare orci interdum in. Cras fermentum cursus leo sed mattis. In dignissim lorem sem, sit amet elementum mauris venenatis ac.\n\n\n{% pullquote right %}\nLorem ipsum dolor sit amet, consectetur adipiscing elit.\n{% endpullquote %}\n\nLorem ipsum dolor sit amet, consectetur adipiscing elit. Sed ligula justo, lobortis sit amet semper vel, dignissim sit amet libero. Praesent ac tempus ligula. Maecenas at gravida odio. Etiam tristique volutpat lacus eu faucibus. Donec non tempus arcu. Phasellus adipiscing, mauris nec mollis egestas, ipsum nunc auctor velit, et rhoncus lorem ipsum at ante. Praesent et sem in velit volutpat auctor. Duis vel mauris nulla. Maecenas mattis interdum ante, quis sagittis nibh cursus et. Nulla facilisi. Morbi convallis gravida tortor, ut fermentum enim gravida et. Nunc vel dictum nisl, non ultrices libero. Proin vestibulum felis eget orci consectetur lobortis. Vestibulum augue nulla, iaculis vitae augue vehicula, dignissim ultrices libero. Sed imperdiet urna et quam ultrices tincidunt nec ac magna. Etiam vel pharetra elit.\n\n\n## æ•°å­¦å…¬å¼\n\n$f(n) = \\Theta(g(n)) \\land g(n) = \\Theta(h(n)) \\rightarrow f(n) = \\Theta(h(n))$\n\n$\\omega(g(n))=\\{f(n):\\text{å­˜åœ¨æ­£å¸¸é‡}c\\text{å’Œ}n_0\\text{ï¼Œä½¿å¾—å¯¹æ‰€æœ‰}n \\geq n_0\\text{ï¼Œæœ‰}0\\leq cg(n) < f(n)\\}$\n\n$$\nf^{(i)}(n) =\n\\begin{cases}\nn \\qquad & i = 1 \\\\\nf(f^{(i-1)}(n)) \\qquad &  i>1\n\\end{cases}\n$$\n\n$$\nA = \\begin{bmatrix}\nA_{11} & A_{12} \\\\\nA_{21} & A_{22}\n\\end{bmatrix}\n,\nB = \\begin{bmatrix}\nB_{11} & B_{12} \\\\\nB_{21} & B_{22}\n\\end{bmatrix}\n,\nC = \\begin{bmatrix}\nC_{11} & C_{12} \\\\\nC_{21} & C_{22}\n\\end{bmatrix}\n$$\n\n$$\\sum^{\\lfloor lgn \\rfloor}_{h=0} \\lceil \\frac{n}{2^{h+1}} \\rceil O(h) = O(n \\sum^{\\lfloor lgn \\rfloor}_{h=0} \\frac{h}{2^h}) =  O(n \\sum^{\\infty}_{h=0} \\frac{h}{2^h}) =O(n)$$\n\n\n## æµç¨‹å›¾\n\n```mermaid\n  sequenceDiagram\n  participant å®¢æˆ·ç«¯\n  participant ä»£ç†å¯¹è±¡\n  participant ä»£ç†å¤„ç†å™¨\n  participant ç›®æ ‡å¯¹è±¡\n  å®¢æˆ·ç«¯->>ä»£ç†å¯¹è±¡:è°ƒç”¨æ–¹æ³•\n  ä»£ç†å¯¹è±¡->>ä»£ç†å¤„ç†å™¨:è½¬å‘ä»£ç†å¤„ç†å™¨<br>Invoke()æ–¹æ³•\n  ä»£ç†å¤„ç†å™¨->>ç›®æ ‡å¯¹è±¡:åˆ¤æ–­Method<br>è°ƒç”¨ç›®æ ‡å¯¹è±¡çš„æ–¹æ³•\n  ç›®æ ‡å¯¹è±¡->>ä»£ç†å¤„ç†å™¨:è¿”å›ç»“æœ\n  ä»£ç†å¤„ç†å™¨->>ä»£ç†å¯¹è±¡:è¿”å›ç»“æœ\n  ä»£ç†å¯¹è±¡->>å®¢æˆ·ç«¯:è¿”å›ç»“æœ\n```\n\n```mermaid\n  graph LR\n  c1[Client1<br>Socket]--å®¢æˆ·ç«¯å‘å‡ºè¿æ¥-->ss[ServerSocket]\n  c2[Client2<br>Socket]--å®¢æˆ·ç«¯å‘å‡ºè¿æ¥-->ss[ServerSocket]\n  ss--æœåŠ¡å™¨æ¥å—è¯·æ±‚å¹¶åˆ›å»ºæ–°çš„Socket-->s1[ä¸ºClient1åˆ›<br>å»ºçš„Socket]\n  ss--æœåŠ¡å™¨æ¥å—è¯·æ±‚å¹¶åˆ›å»ºæ–°çš„Socket-->s2[ä¸ºClient2åˆ›<br>å»ºçš„Socket]\n  c1--ä¸¤ä¸ªSocketé—´å»ºç«‹ä¸“çº¿è¿æ¥-->s1\n  c2--ä¸¤ä¸ªSocketé—´å»ºç«‹ä¸“çº¿è¿æ¥-->s2\n```\n\n## å¡ç‰‡\n\n{% postLinkCard \"hexo-theme-reimuæ•ˆæœå±•ç¤º\" auto %}\n\n{% externalLinkCard \"Github\" \"https://github.com/D-Sketon/hexo-theme-reimu\" \"https://github.githubassets.com/assets/apple-touch-icon-144x144-b882e354c005.png\" %}","tags":["Hexo"],"categories":["è®¡è½¯æ‚è°ˆ","hexo"]},{"title":"ä¸ºä½ çš„ç½‘ç«™æ·»åŠ é¼ æ ‡çƒŸèŠ±çˆ†ç‚¸æ•ˆæœ","url":"/20240110/mouse-firework-readme/","content":"\n## å‰è¨€\n\næœ€è¿‘åœ¨ä¸º [Hexo](https://github.com/hexojs/hexo) çš„ [ShokaX](https://github.com/theme-shoka-x/hexo-theme-shokaX) ä¸»é¢˜è¿›è¡Œæ¨¡å—åŒ–æ‹†åˆ†çš„è¿‡ç¨‹ä¸­ï¼Œé¡ºä¾¿å°†å…¶ä¸­çš„çƒŸèŠ±çˆ†ç‚¸æ•ˆæœçš„ä»£ç æŠ½ç¦»æˆäº†ä¸€ä¸ªåº“ã€‚\n\n![demo](https://fastly.jsdelivr.net/gh/D-Sketon/blog-img/mouse-firework.gif)\n\n{% externalLinkCard Githubä»“åº“ https://github.com/D-Sketon/mouse-firework \"https://github.githubassets.com/assets/apple-touch-icon-144x144-b882e354c005.png\" %}\n\n{% externalLinkCard Demo https://d-sketon.github.io/mouse-firework \"https://github.githubassets.com/assets/apple-touch-icon-144x144-b882e354c005.png\" %}\n\n## ç‰¹ç‚¹\n- é›¶ä¾èµ–ï¼šç½‘ç»œä¸Šç›¸å…³çš„æ•™ç¨‹å¤§éƒ¨åˆ†éœ€è¦ä¾èµ–anime.js\n- å°ä½“ç§¯ï¼šå‹ç¼©åä½“ç§¯åœ¨ 3KB ä»¥å†…\n- å®šåˆ¶åŒ–ï¼šä»…éœ€ä¸€è¡Œä»£ç ä¾¿èƒ½è½»æ¾è‡ªå®šä¹‰ç²’å­æ•ˆæœ\n\n## ä½¿ç”¨æ–¹å¼\n\nnpm å¼•å…¥\n```bash\nnpm i mouse-firework --save\n```\n\næˆ– html ç›´æ¥å¼•å…¥\n```html\n<script src=\"https://www.unpkg.com/mouse-firework@latest/dist/index.umd.js\"></script>\n```\n\n### é…ç½®\nä»…éœ€ä¸€è¡Œä»£ç \n```js\nfirework(<options>)\n```\nä¾‹å¦‚ï¼š\n```js\nfirework({\n  excludeElements: [\"a\"],\n  particles: [\n    {\n      shape: \"circle\",\n      move: \"emit\",\n      easing: \"easeOutExpo\",\n      colors: [\n        \"rgba(255,182,185,.9)\",\n        \"rgba(250,227,217,.9)\",\n        \"rgba(187,222,214,.9)\",\n        \"rgba(138,198,209,.9)\",\n      ],\n      number: 30,\n      duration: [1200, 1800],\n      shapeOptions: {\n        radius: [16, 32],\n      },\n    },\n  ]\n});\n```\n**å…è®¸é…ç½®ï¼š**\n- ç²’å­çš„å½¢çŠ¶ï¼šåœ†å½¢ã€å¤šè¾¹å½¢ã€æ˜Ÿå½¢\n    - åŠå¾„ã€é€æ˜åº¦ã€æè¾¹ç²—ç»†ç­‰\n- ç²’å­çš„è¿åŠ¨æ–¹å¼ï¼šå‘å››å‘¨å‘å°„ã€ä»ä¸­é—´æ‰©æ•£ã€æ—‹è½¬\n    - è¿åŠ¨åŠå¾„ã€é€æ˜åº¦ã€æ—‹è½¬è§’åº¦ç­‰\n- ç²’å­çš„ç¼“åŠ¨å‡½æ•°ï¼š\n- ç²’å­çš„é¢œè‰²ï¼šæ”¯æŒæ•°ç»„\n- ç²’å­çš„æ•°é‡\n- ç²’å­çš„æŒç»­æ—¶é—´\n\næ•°å­—å‡æ”¯æŒè¾“å…¥åŒºé—´ï¼Œä¼šä»åŒºé—´ä¸­éšæœºé‡‡æ ·å€¼","tags":["Hexo"],"categories":["è®¡è½¯æ‚è°ˆ","hexo"]},{"title":"Hexo 7 è¿ç§»æŒ‡å—","url":"/20231111/hexo-7-migration-guide/","content":"\nHexo 7 å·²æ­£å¼å‘å¸ƒï¼Œå¼ºçƒˆå»ºè®®å¤§å®¶å‘é«˜ç‰ˆæœ¬è¿›è¡Œè¿ç§»ä»¥è·å¾—æ›´å¥½çš„ä½“éªŒã€‚\næœ¬æ–‡é’ˆå¯¹äº v6 å‘ v7 è¿ç§»çš„ç”¨æˆ·ã€‚\n\n## é’ˆå¯¹ä½¿ç”¨è€…\n\n### è¿è¡Œç¯å¢ƒ\n\nHexo 7 éœ€ Node ç‰ˆæœ¬ >=14\n\n### æ ‡ç­¾æ’ä»¶\n\nç›¸å…³ PR: [#5067](https://github.com/hexojs/hexo/pull/5067)ã€[#5064](https://github.com/hexojs/hexo/pull/5064)ã€[#5066](https://github.com/hexojs/hexo/pull/5066)ã€[#5065](https://github.com/hexojs/hexo/pull/5065)\n\nä¸ºäº†ä¿æŒ Hexo çš„é«˜å†…èšæ€§ï¼Œä»¥ä¸‹æ ‡ç­¾æ’ä»¶ä» Hexo æœ¬ä½“ä¸­è¢«ç§»é™¤ï¼š\n\n```text\n{% youtube video_id [type] [cookie] %}\n{% gist gist_id [filename] %}\n{% jsfiddle shorttag [tabs] [skin] [width] [height] %}\n{% vimeo video_id %}\n```\n\nå¦‚æœä½ çš„æ–‡ç« ä¸­ä½¿ç”¨äº†ä»¥ä¸Šæ ‡ç­¾æ’ä»¶ï¼Œè¯·å®‰è£… [hexo-tag-embed](https://github.com/hexojs/hexo-tag-embed)\n\n```bash\n$ npm i hexo-tag-embed\n```\n\n### ä»£ç é«˜äº®\n\nç›¸å…³ PR: [#5095](https://github.com/hexojs/hexo-tag-embed)\n\nä»£ç é«˜äº®ç›¸å…³ä»£ç è¢«é‡æ„ï¼Œä¸”å…¶é…ç½®ä¹Ÿå‘ç”Ÿäº†æ”¹å˜ï¼Œç›®å‰ä»£ç é«˜äº®ç”± `syntax_highlighter` é€‰é¡¹æ§åˆ¶ï¼Œä¸”å…¶å€¼å¯ä»¥ä¸ºï¼š`highlight.js`ã€`prismjs` æˆ– ç©ºå­—ç¬¦ä¸²\n\nåŸï¼š\n\n```yml\nhighlight:\n  enable: true\n```\n\nç°ï¼š\n\n```yml\nsyntax_highlighter: highlight.js\n```\n\nåŸï¼š\n\n```yml\nprismjs:\n  enable: true\n```\n\nç°ï¼š\n\n```yml\nsyntax_highlighter: prismjs\n```\n\nåŸï¼š\n\n```yml\nhighlight:\n  enable: false\nprismjs:\n  enable: false\n```\n\nç°ï¼š\n\n```yml\nsyntax_highlighter:\n```\n\n### external_link\n\nç›¸å…³ PR: [#5063](https://github.com/hexojs/hexo/pull/5063)\n\né…ç½®æ–‡ä»¶ä¸­ï¼Œä»¥ä¸‹å†™æ³•è¢«ç§»é™¤ï¼š\n\n```yml\nexternal_link: true\n```\n\nè¯·ä½¿ç”¨ï¼š\n\n```yml\nexternal_link:\n  enable: true # Open external links in new tab\n  field: site # Apply to the whole site\n  exclude: \"\"\n```\n\n### front-matter\n\nç›¸å…³ PR: [#5253](https://github.com/hexojs/hexo/pull/5253)\n\nfront-matter ä¸­ï¼Œ`link` é€‰é¡¹è¢«ç§»é™¤ã€‚\n\n### updated_option\n\nç›¸å…³ PR: [#5062](https://github.com/hexojs/hexo/pull/5062)\n\né…ç½®æ–‡ä»¶ä¸­ï¼Œ`use_date_for_updated` é€‰é¡¹å·²å»é™¤ã€‚è¯·æ”¹ä¸ºä½¿ç”¨ `updated_option: 'date'`ã€‚\n\n## é’ˆå¯¹å¼€å‘è€…\n\n### è®¿é—®\\_data æ–‡ä»¶å¤¹\n\nç›¸å…³ PR: [#5325](https://github.com/hexojs/hexo/pull/5325)\n\n> è¯¥ç‰¹æ€§åœ¨å®˜æ–¹æ–‡æ¡£ä¸­å¹¶ä¸å­˜åœ¨\n\næºæ–‡ä»¶å¤¹ä¸­çš„ `pages` ç°åœ¨æ— æ³•é€šè¿‡ä»¥ä¸‹æ–¹æ³•è®¿é—®åˆ° `source/_data` ä¸­çš„æ–‡ä»¶ï¼š\n\n```html\n<p>Hello {{site.data.foo.name}}</p>\n```\n\n## å®˜æ–¹é“¾æ¥\n\n- [Hexo Site News: v7.0.0](https://hexo.io/news/2023/11/03/hexo-7-0-0-released/)\n- [GitHub Release Note: v7.0.0](https://github.com/hexojs/hexo/releases/tag/v7.0.0)\n","tags":["Hexo"],"categories":["è®¡è½¯æ‚è°ˆ","hexo"]},{"title":"Hexo 5/6/7 ç”Ÿæˆæ–‡ç« æ€§èƒ½å¯¹æ¯”","url":"/20231111/hexo-generate-benchmark/","content":"\næœ€è¿‘ Hexo 7 æ­£å¼å‘å¸ƒäº†ï¼Œåœ¨è¿™ä¸€ç‰ˆæœ¬ä¸­é’ˆå¯¹ç”Ÿæˆæ€§èƒ½åšäº†ä¸€å®šç¨‹åº¦çš„ä¼˜åŒ–ï¼ˆ[#5119](https://github.com/hexojs/hexo/pull/5119)ã€[#5145](https://github.com/hexojs/hexo/pull/5145)ï¼‰,æœ¬æ–‡ä»¥æ­¤ä¸ºå¥‘æœºé€‰æ‹©å¯¹ä¸åŒç‰ˆæœ¬çš„ Hexo ç”Ÿæˆé€Ÿåº¦è¿›è¡Œæ€§èƒ½æµ‹è¯•ã€‚\n\n## æµ‹è¯•ç¯å¢ƒ\n\n- Node v18.12.1\n- Windows 10 ç‰ˆæœ¬ 21H2\n- Hexo v5.4.2 / v6.3.0 / v7.0.0\n\n### æµ‹è¯•ç‰ˆæœ¬\n\n#### 5.4.2\n\n```text\n+-- hexo-generator-archive@1.0.0\n+-- hexo-generator-category@1.0.0\n+-- hexo-generator-index@2.0.0\n+-- hexo-generator-tag@1.0.0\n+-- hexo-renderer-ejs@1.0.0\n+-- hexo-renderer-marked@4.1.0\n+-- hexo-renderer-stylus@2.1.0\n+-- hexo-server@2.0.0\n+-- hexo-theme-landscape@0.0.3\n`-- hexo@5.4.2\n```\n\n#### 6.3.0\n\n```text\n+-- hexo-generator-archive@2.0.0\n+-- hexo-generator-category@2.0.0\n+-- hexo-generator-index@3.0.0\n+-- hexo-generator-tag@2.0.0\n+-- hexo-renderer-ejs@2.0.0\n+-- hexo-renderer-marked@6.1.1\n+-- hexo-renderer-stylus@3.0.0\n+-- hexo-server@3.0.0\n+-- hexo-theme-landscape@1.0.0\n`-- hexo@6.3.0\n```\n\n#### 7.0.0\n\n```text\n+-- hexo-generator-archive@2.0.0\n+-- hexo-generator-category@2.0.0\n+-- hexo-generator-index@3.0.0\n+-- hexo-generator-tag@2.0.0\n+-- hexo-renderer-ejs@2.0.0\n+-- hexo-renderer-marked@6.1.1\n+-- hexo-renderer-stylus@3.0.0\n+-- hexo-server@3.0.0\n+-- hexo-tag-embed@1.0.0\n+-- hexo-theme-landscape@1.0.0\n`-- hexo@7.0.0\n```\n\n### æµ‹è¯•å‘½ä»¤\n\n```bash\n$ hexo cl && hexo g\n```\n\nå¯¹äº 4000 ç¯‡æ–‡ç« é‡‡ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š\n\n```bash\n$ increase-memory-limit\n$ hexo cl && hexo g -p 20\n```\n\næµ‹è¯•æ–‡ç« æ¥æºäº [hexojs/hexo-many-posts](https://github.com/hexojs/hexo-many-posts)ï¼Œé€šè¿‡å¤åˆ¶æ–‡ä»¶ä»¥æµ‹è¯• 500/1000/2000/4000 ç¯‡æ–‡ç« æ—¶çš„ç”Ÿæˆé€Ÿåº¦ã€‚\n\næµ‹è¯•é…ç½®å‡é‡‡ç”¨é»˜è®¤é…ç½®ï¼Œå¤šæ¬¡æµ‹è¯•ä»¥æ±‚å¹³å‡å€¼ã€‚\n\n## æµ‹è¯•ç»“æœ\n\n{% echarts 95% 500 5.4.3 %}\n{\ntitle: {\ntext: 'Hexo Benchmark',\nsubtext: 'v5 v6 v7'\n},\ntooltip: {\ntrigger: 'axis',\naxisPointer: {\n// Use axis to trigger tooltip\ntype: 'shadow' // 'shadow' as default; can also be 'line' or 'shadow'\n}\n},\nlegend: {},\ngrid: {\nleft: '3%',\nright: '4%',\nbottom: '3%',\ncontainLabel: true\n},\nxAxis: {\ntype: 'value'\n},\nyAxis: {\ntype: 'category',\ndata: ['7.0.0', '6.3.0', '5.4.2']\n},\nseries: [\n{\nname: 'File load',\ntype: 'bar',\nstack: '500',\nlabel: {\n// show: true\n},\nemphasis: {\nfocus: 'series'\n},\ndata: [4.09, 4.77, 4.37]\n},\n{\nname: 'File generate',\ntype: 'bar',\nstack: '500',\nlabel: {\n// show: true\n},\nemphasis: {\nfocus: 'series'\n},\ndata: [3.83, 4.96, 4.79]\n},\n{\nname: 'File load',\ntype: 'bar',\nstack: '1000',\nlabel: {\nshow: true\n},\nemphasis: {\nfocus: 'series'\n},\ndata: [11, 11, 11]\n},\n{\nname: 'File generate',\ntype: 'bar',\nstack: '1000',\nlabel: {\nshow: true\n},\nemphasis: {\nfocus: 'series'\n},\ndata: [7.37, 12, 13]\n},\n{\nname: 'File load',\ntype: 'bar',\nstack: '2000',\nlabel: {\nshow: true\n},\nemphasis: {\nfocus: 'series'\n},\ndata: [27, 32, 32]\n},\n{\nname: 'File generate',\ntype: 'bar',\nstack: '2000',\nlabel: {\nshow: true\n},\nemphasis: {\nfocus: 'series'\n},\ndata: [12, 38, 40]\n},\n{\nname: 'File load',\ntype: 'bar',\nstack: '4000',\nlabel: {\nshow: true\n},\nemphasis: {\nfocus: 'series'\n},\ndata: [134, 140, 152]\n},\n{\nname: 'File generate',\ntype: 'bar',\nstack: '4000',\nlabel: {\nshow: true\n},\nemphasis: {\nfocus: 'series'\n},\ndata: [28, 179, 194]\n}\n]\n};\n{% endecharts %}\n\nå¯ä»¥çœ‹åˆ°ï¼Œåœ¨ç¼“å­˜çš„åŠ æŒä¸‹ï¼ŒFile generate é˜¶æ®µè€—æ—¶å¤§å¤§å‡å°‘ï¼Œæ‰€ä»¥å»ºè®®å¤§å®¶éƒ½å°½å¯èƒ½åœ°å°†è‡ªå·±çš„ Hexo åšå®¢å‘é«˜ç‰ˆæœ¬è¿ç§»ã€‚\n","tags":["Hexo"],"categories":["è®¡è½¯æ‚è°ˆ","hexo"]},{"title":"hexo-theme-reimué£Ÿç”¨æŒ‡å—","url":"/20230707/hexo-theme-reimu-guide/","content":"\nå› ä¸ºæœ¬äººæ˜¯è½¦è½¦äººï¼Œæ‰€ä»¥åˆ¶ä½œäº† `hexo-theme-reimu` è¿™æ ·ä¸€æ¬¾åšä¸½çµæ¢¦é£æ ¼çš„ Hexo ä¸»é¢˜ï¼Œå…¶èåˆäº†[landscape](https://github.com/hexojs/hexo-theme-landscape)ã€[Tangyuxian](https://github.com/tangyuxian/hexo-theme-tangyuxian)å’Œ[Shoka](https://github.com/amehime/hexo-theme-shoka)ä¸‰ä¸ªä¸»é¢˜\n\næ•ˆæœå±•ç¤ºè¯·ç‚¹å‡»ï¼š\n\n{% postLinkCard \"hexo-theme-reimuæ•ˆæœå±•ç¤º\" \"https://d-sketon.top/img/_backwebp/bg28.webp\" %}\n\nå¼€å‘æ—¥å¿—è¯·ç‚¹å‡»ï¼š\n\n{% postLinkCard \"hexo-theme-reimuå¼€å‘æ—¥å¿—\" \"https://d-sketon.top/img/_backwebp/bg27.webp\" %}\n\n> å¦‚æœåœ¨ä½¿ç”¨æœ¬ä¸»é¢˜çš„è¿‡ç¨‹ä¸­é‡åˆ°äº†ä»€ä¹ˆé—®é¢˜ï¼Œè¯·åˆ°[Github issue](https://github.com/D-Sketon/hexo-theme-reimu/issues)ä¸Šæé—®ï¼Œå¹¶æä¾›è¯¦ç»†çš„æŠ¥é”™ä¿¡æ¯/å¤ç°æ­¥éª¤\n\n> æœ¬ä¸»é¢˜ç›®å‰çš„è®¾è®¡è¾ƒä¸ºè½»é‡ï¼Œå¹¶ä¸”åœ¨é¢„è®¡æ¥ä¸ä¼šå¼•å…¥è¯¸å¦‚**éŸ³ä¹æ’­æ”¾å™¨**è¿™ç±»å¤æ‚çš„åŠŸèƒ½ã€‚å¦‚æœ‰éœ€è¦ï¼Œå¯ä»¥å°è¯•é€‰æ‹©[hexo-theme-shokaX](https://github.com/theme-shoka-x/hexo-theme-shokaX)ï¼ˆä¹Ÿæ˜¯æœ¬äººç»´æŠ¤çš„ä¸€æ¬¾ä¸»é¢˜ï¼Œå…·æœ‰æ›´åŠ ä¸°å¯Œçš„åŠŸèƒ½ï¼‰\n\n> å¦‚æœæƒ³è¦è¿½æ±‚æ›´ç°ä»£çš„å»ºç«™æŠ€æœ¯ï¼ˆå¦‚[Astro](https://astro.build)ï¼‰ï¼Œå¯ä»¥å°è¯•é€‰æ‹©æœ¬äººè¿ç§»çš„ [astro-theme-reimu](https://github.com/D-Sketon/astro-theme-reimu)ï¼Œæ•ˆæœå±•ç¤ºè¯·ç‚¹å‡»[æ¼”ç¤ºç½‘ç«™](d-sketon.github.io/astro-theme-reimu/)\n\n## è·¯çº¿å›¾\n\n- å›¾ç‰‡æ‡’åŠ è½½\n- waline è¯„è®ºç³»ç»Ÿ\n- twikoo è¯„è®ºç³»ç»Ÿï¼ˆæœªæµ‹è¯•ï¼‰\n- gitalk è¯„è®ºç³»ç»Ÿï¼ˆæœªæµ‹è¯•ï¼‰\n- giscus è¯„è®ºç³»ç»Ÿ\n- é»‘å¤œæ¨¡å¼\n- æ›´å¤šåŠ¨ç”»æ•ˆæœ\n- google å­—ä½“\n- åŠ è½½åŠ¨ç”»\n- TOC\n- å›åˆ°é¡¶éƒ¨\n- æ–‡ç« é˜…è¯»ç»Ÿè®¡ï¼ˆä»… Valine å’Œ Walineï¼‰\n- é¼ æ ‡åŠ¨ç”»ï¼ˆv0.0.10+ï¼‰\n- pjaxï¼ˆv0.0.10+ï¼Œå®éªŒæ€§ï¼‰\n- pwaï¼ˆv0.0.11+ï¼Œå®éªŒæ€§ï¼‰\n- live2dï¼ˆv0.0.11+ï¼Œå®éªŒæ€§ï¼‰\n\n## ç»“æ„\n\n```txt\n.\nâ”œâ”€â”€ _screenshot æˆªå›¾\nâ”œâ”€â”€ _example    ç¤ºä¾‹sourceæ–‡ä»¶å¤¹å†…ç»“æ„\nâ”œâ”€â”€ _config.yml ä¸»é¢˜é…ç½®\nâ”œâ”€â”€ languages\nâ”œâ”€â”€ layout\nâ”œâ”€â”€ scripts\nâ””â”€â”€ source\n```\n\n## å®‰è£…\n\nä½¿ç”¨ npm\n\n```bash\nnpm install hexo-theme-reimu --save\n```\n\næˆ–ç›´æ¥å…‹éš†[æœ¬ä»“åº“](https://github.com/D-Sketon/hexo-theme-reimu)è‡³`/themes`æ–‡ä»¶å¤¹ä¸‹å¹¶é‡å‘½åä¸º`reimu`\n\n```bash\ngit clone https://github.com/D-Sketon/hexo-theme-reimu.git\n```\n\nå¹¶ä¿®æ”¹ `_config.yml` ä¸­çš„ theme\n\n```yaml\n# Extensions\n## Plugins: https://hexo.io/plugins/\n## Themes: https://hexo.io/themes/\ntheme: reimu\n```\n\n## ä½¿ç”¨\n\n### åŸºæœ¬ç»“æ„\n\nä¸ºäº†ä¿è¯æ˜¾ç¤ºæ­£ç¡®ï¼Œè¯·å‚è€ƒ `_example` åœ¨ `_source` ä¸­åˆ†åˆ«å»ºç«‹ `_data`ã€`about` å’Œ `friend` æ–‡ä»¶å¤¹\n\n#### \\_data\n\n- `avatar` æ–‡ä»¶å¤¹ä¸­å­˜å‚¨ä½œè€…å¤´åƒï¼Œé»˜è®¤å‘½å `avatar.jpg`ï¼Œå¯åœ¨ å†…å±‚ `_config.yml` ä¸­åšå¦‚ä¸‹é…ç½®\n\n```yaml\navatar: \"avatar.jpg\"\n```\n\n- `covers` æ–‡ä»¶å¤¹ä¸­å­˜å‚¨æ–‡ç« å°é¢\n- `covers.yml` ä¸­å­˜å‚¨æ–‡ç« å°é¢ url\n\n#### about\n\n`index.md` ä½œä¸º**å…³äº**é¡µé¢\n\n#### friend\n\n`index.md` ä½œä¸º**å‹é“¾**é¡µé¢ï¼Œåœ¨ `_data.yml` ä¸­å¡«å…¥å‹é“¾ä¿¡æ¯å³å¯åœ¨é¡µé¢ä¸Šæ˜¾ç¤ºå¯¹åº”å¥½å‹å¡ç‰‡\n\n### å°é¢ã€å¤´å›¾å’Œå›¾æ ‡\n\n#### å°é¢\n\nå°é¢æ˜¾ç¤ºé€»è¾‘å¦‚ä¸‹\n\n- å¦‚æœæ–‡ç« çš„ Front matter ä¸­åŒ…å« cover çš„ urlï¼Œåˆ™è¯¥æ–‡ç« å¤´å›¾å’Œé¦–é¡µç¼©ç•¥å›¾å‡æ˜¾ç¤ºè¯¥ url\n\n```yaml\n---\ntitle: Hello World\ncover: https://example.com\n---\n```\n\n- å¦‚æœæ–‡ç« çš„ Front matter ä¸­åŒ…å« cover ä¸º`false`ï¼Œåˆ™è¯¥æ–‡ç« ä¸æ˜¾ç¤ºå¤´å›¾ï¼ˆé¦–é¡µä¸Šä»ç„¶æ˜¯éšæœºå›¾ç‰‡ï¼‰\n\n```yaml\n---\ntitle: Hello World\ncover: false\n---\n```\n\n- å¦‚æœæ–‡ç« çš„ Front matter ä¸­åŒ…å« cover ä¸º`rgb(xxx,xxx,xxx)`ï¼Œåˆ™è¯¥æ–‡ç« å¤´å›¾ä¸ºå¯¹åº”çš„æ¸å˜çº¯è‰²ï¼ˆé¦–é¡µä¸Šä»ç„¶æ˜¯éšæœºå›¾ç‰‡ï¼‰\n\n```yaml\n---\ntitle: Hello World\ncover: rgb(255,117,117)\n---\n```\n\n- å¦åˆ™æŸ¥æ‰¾ `covers` æ–‡ä»¶å¤¹å’Œ `covers.yml`ï¼Œå¹¶ä»ä¸­éšæœºæŒ‘é€‰å›¾ç‰‡\n- è‹¥ä¸Šè¿°æ–‡ä»¶å‡ä¸å­˜åœ¨ï¼Œåˆ™æ˜¾ç¤ºå¤´å›¾\n\n#### å¤´å›¾\n\nå¤´å›¾ä¿å­˜äº `themes/reimu/source/images/banner.webp`ï¼Œå¯åœ¨å†…å±‚ `_config.yml`ä¸­ä¿®æ”¹\n\n```yaml\nbanner: \"/images/banner.webp\"\n```\n\n#### å›¾æ ‡\n\nå›¾æ ‡ä¿å­˜äº `themes/reimu/source/images/favicon.ico`ï¼Œå¯åœ¨å†…å±‚ `_config.yml`ä¸­ä¿®æ”¹\n\n```yaml\nfavicon: \"/images/favicon.ico\"\n```\n\n#### ç½®é¡¶\n\nåœ¨æ–‡ç« çš„ Front-matter ä¸­æ·»åŠ  `sticky: true`\n\n```yaml\n---\ntitle: Hello World\nsticky: true\n---\n```\n\n### ä»£ç é«˜äº®\n\nä¸ºä¿è¯ä»£ç å—çš„æ­£ç¡®æ˜¾ç¤ºï¼Œè¯·ä¿è¯å¤–å±‚ `_config.yml` ä¸­ä¸ºå¦‚ä¸‹é…ç½®\n\n(<7.0.0)\n\n```yaml\nhighlight:\n  enable: true\n  wrap: true\n  hljs: false\nprismjs:\n  enable: false\n```\n\n(>=7.0.0)\n\n```yaml\nsyntax_highlighter: highlight.js\nhighlight:\n  wrap: true\n  hljs: false\n```\n\n### ç«™å†…è¯„è®º\n\n> ç«™å†…è¯„è®ºå¯ä»¥ä½¿ç”¨Front matter ä¸­çš„ `comments` ç‹¬ç«‹æ§åˆ¶æ¯ç¯‡æ–‡ç« æ˜¯å¦æ˜¾ç¤ºè¯„è®ºã€‚  \n> å½“ `comments` ä¸º `false` æ—¶ä¸æ˜¾ç¤ºè¯„è®ºï¼Œ`true` æˆ–ä¸å¡«æ—¶æ ¹æ® `_config_yml` çš„é…ç½®å†³å®šæ˜¯å¦æ˜¾ç¤ºã€‚\n\nè‹¥åŸºäº [Valine](https://valine.js.org/)  \nè¯·å‚è€ƒå…¶å®˜æ–¹æ–‡æ¡£å®Œæˆ `LeanCloud` çš„é…ç½®ï¼Œå¹¶åœ¨å†…å±‚ `_config_yml` ä¸­å°† `valine.enable` æ”¹ä¸º `true`ï¼Œå¹¶å¡«å…¥è‡ªå·±çš„ `appId` å’Œ `appKey`\n\n```yaml\nvaline:\n  enable: true\n  appId: \"your appId\"\n  appKey: \"your appKey\"\n```\n\nè‹¥åŸºäº [Waline](https://waline.js.org/)  \nè¯·å‚è€ƒå…¶[å®˜æ–¹æ–‡æ¡£](https://waline.js.org/guide/get-started/)å®Œæˆ `LeanCloud` çš„é…ç½®ï¼Œå¹¶åœ¨å†…å±‚ `_config_yml` ä¸­å°† `waline.enable` æ”¹ä¸º `true`ï¼Œå¹¶å¡«å…¥è‡ªå·±çš„ `serverURL`\n\n```yaml\nwaline:\n  enable: true\n  serverURL: \"your server url\"\n  lang: zh-CN\n  locale: {} # https://waline.js.org/guide/features/i18n.html#%E8%87%AA%E5%AE%9A%E4%B9%89%E8%AF%AD%E8%A8%80\n  emoji:\n    - https://unpkg.com/@waline/emojis@1.2.0/weibo\n    - https://unpkg.com/@waline/emojis@1.2.0/alus\n    - https://unpkg.com/@waline/emojis@1.2.0/bilibili\n    - https://unpkg.com/@waline/emojis@1.2.0/qq\n    - https://unpkg.com/@waline/emojis@1.2.0/tieba\n    - https://unpkg.com/@waline/emojis@1.2.0/tw-emoji\n  meta:\n    - nick\n    - mail\n    - link\n  requiredMeta:\n    - nick\n    - mail\n  wordLimit: 0\n  pageSize: 10\n  pageview: true\n```\n\nè‹¥åŸºäº [twikoo](https://twikoo.js.org)  \nè¯·å‚è€ƒå…¶[å®˜æ–¹æ–‡æ¡£](https://twikoo.js.org/quick-start.html)å®Œæˆ è…¾è®¯äº‘ æˆ– Vercel éƒ¨ç½²ï¼Œå¹¶åœ¨å†…å±‚ `_config_yml` ä¸­å°† `twikoo.enable` æ”¹ä¸º `true`ï¼Œå¹¶å¡«å…¥è‡ªå·±çš„ `envId`\n\n```yml\ntwikoo:\n  enable: true\n  envId: # è…¾è®¯äº‘ç¯å¢ƒå¡« envIdï¼›Vercel ç¯å¢ƒå¡«åœ°å€ï¼ˆhttps://xxx.vercel.appï¼‰\n  region:\n```\n\nè‹¥åŸºäº [giscus](https://giscus.app/zh-CN)ï¼Œè¯·å‚è€ƒæ–‡æ¡£å®Œæˆä»“åº“çš„é…ç½®ï¼Œå¹¶åœ¨å†…å±‚ `_config_yml` ä¸­å°† `giscus.enable` æ”¹ä¸º `true`ï¼Œå¹¶å¡«å…¥å¯¹åº”çš„æ•°æ®\n\n```yml\ngiscus:\n  enable: true\n  repo: \"your repo\"\n  repoId: \"your repoId\"\n  category: \"your category\"\n  categoryId: \"your categoryId\"\n  mapping: mapping\n  strict: 0\n  reactionsEnabled: 1\n  emitMetadata: 0\n  inputPosition: bottom\n  commentTheme: preferred_color_scheme\n  lang: zh-CN\n```\n\nè‹¥åŸºäº [gitalk](https://gitalk.github.io/)  \nè¯·å‚è€ƒå…¶[å®˜æ–¹æ–‡æ¡£](https://github.com/gitalk/gitalk?tab=readme-ov-file#usage)å®Œæˆä»“åº“çš„é…ç½®ï¼Œå¹¶åœ¨å†…å±‚ `_config_yml` ä¸­å°† `gitalk.enable` æ”¹ä¸º `true`ï¼Œå¹¶å¡«å…¥å¯¹åº”çš„æ•°æ®\n\n```yml\ngitalk:\n  enable: true\n  clientID: \"your application client ID\"\n  clientSecret: \"your application client secret\"\n  repo: \"your repo\"\n  owner: \"repo owner\"\n  admin: \"repo owner and collaborators\"\n```\n\n### ç«™å†…æœç´¢\n\nè‹¥é€‰æ‹© [Algolia](https://www.algolia.com/)ï¼Œè¯·å®‰è£… [hexo-algoliasearch](https://github.com/LouisBarranqueiro/hexo-algoliasearch)\n\n```bash\nnpm install hexo-algoliasearch --save\n```\n\nå¹¶å‚è€ƒå…¶ [README](https://github.com/LouisBarranqueiro/hexo-algoliasearch#readme) å®Œæˆå¯¹ `Algolia` è´¦å·çš„é…ç½®ï¼Œå¹¶åœ¨å¤–å±‚ `_confg.yml` ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®\n\n```yml\nalgolia:\n  appId: \"your applicationID\"\n  apiKey: \"your apiKey\"\n  adminApiKey: \"your adminApiKey\"\n  indexName: \"your indexName\"\n  chunkSize: 5000\n  fields:\n    - content:strip:truncate,0,500\n    - excerpt:strip\n    - gallery\n    - permalink\n    - photos\n    - slug\n    - tags\n    - title\n```\n\nåœ¨å†…å±‚ `_config_yml` ä¸­å°† `algolia_search.enable` æ”¹ä¸º `true`\n\n```yaml\nalgolia_search:\n  enable: true\n```\n\n> æ³¨æ„ï¼šæœç´¢è·³è½¬é“¾æ¥ä¸ºæ°¸ä¹…é“¾æ¥ï¼Œæ‰€ä»¥è¯·ä¿è¯å¤–å±‚ `_config.yml` ä¸­çš„ `url` å¡«å†™æ­£ç¡®\n\n---\n\nè‹¥é€‰æ‹© [hexo-generator-search](https://github.com/wzpan/hexo-generator-search)ï¼Œè¯·å®‰è£…[hexo-generator-search](https://github.com/wzpan/hexo-generator-search)\n\nå¹¶å‚è€ƒå…¶ [README](https://github.com/wzpan/hexo-generator-search#readme)åœ¨å¤–å±‚ `_config.yml` ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®\n\n```yml\nsearch:\n  path: search.json # æ–‡ä»¶åå¿…é¡»ä¸ºsearch.json\n  field: post\n  content: true\n```\n\nåœ¨å†…å±‚ `_config_yml` ä¸­å°† `generator_search.enable` æ”¹ä¸º `true`\n\n```yaml\ngenerator_search:\n  enable: true\n```\n\n### æ•°å­¦å…¬å¼\n\næ•°å­¦å…¬å¼åŸºäº [Katex](https://github.com/KaTeX/KaTeX)ï¼Œè¯·å®‰è£… [hexo-renderer-markdown-it-plus](https://github.com/CHENXCHEN/hexo-renderer-markdown-it-plus)\n\n```bash\nnpm uninstall hexo-renderer-marked --save\nnpm install hexo-renderer-markdown-it-plus --save\n```\n\nåœ¨å†…å±‚ `_config_yml` ä¸­å°† `math.enable` æ”¹ä¸º `true`\n\n```yaml\nmath:\n  enable: true\n```\n\n### Mermaid\n\nè¯·å®‰è£… [hexo-filter-mermaid-diagrams](https://github.com/webappdevelp/hexo-filter-mermaid-diagrams)\n\n```bash\nnpm install hexo-filter-mermaid-diagrams --save\n```\n\nåœ¨å†…å±‚ `_config_yml` ä¸­å°† `mermaid.enable` æ”¹ä¸º `true`\n\n```yaml\nmermaid:\n  enable: true\n```\n\nå¹¶åœ¨éœ€è¦ä½¿ç”¨ mermaid çš„æ–‡ç« çš„ front-matter ä¸­æ·»åŠ  `mermaid: true`\n\n```yaml\n---\ntitle: Hello World\nmermaid: true\n---\n```\n\n### RSS\n\nè¯·å®‰è£… [hexo-generator-feed](https://github.com/hexojs/hexo-generator-feed)\n\n```bash\nnpm install hexo-generator-feed --save\n```\n\nå¹¶å‚è€ƒå…¶ [README](https://github.com/hexojs/hexo-generator-feed#readme) åœ¨å¤–å±‚ `_config.yml` å®Œæˆå¯¹ `feed` çš„é…ç½®  \nåœ¨å†…å±‚ `_config.yml` ä¸­å¡«å…¥ç”Ÿæˆçš„ `xml`\n\n```yaml\nrss: atom.xml\n```\n\n### Icon\n\nIcon é»˜è®¤ä½¿ç”¨æœ¬é¡¹ç›®æä¾›çš„ iconfontï¼ˆv0.1.3+ï¼‰\n\n```yml\nicon_font: 4552607_ikzjpc9jicn\n```\n\nå¦‚æœæƒ³è¦ç»§ç»­ä½¿ç”¨ fontawesome å›¾æ ‡ï¼Œè¯·å°† `icon_font` è®¾ç½®ä¸º `false`ï¼Œæ­¤æ—¶ä¼šä½¿ç”¨ `vendor` ä¸­å¯¹åº”çš„ fontawesome\n\n```yml\nfontawesome:\n  high_priority:\n    - webcache|@fortawesome/fontawesome-free@6.5.1/css/regular.min.css\n    - webcache|@fortawesome/fontawesome-free@6.5.1/css/solid.min.css\n  low_priority:\n    - webcache|@fortawesome/fontawesome-free@6.5.1/css/brands.min.css\n    - webcache|@fortawesome/fontawesome-free@6.5.1/css/v5-font-face.min.css\n    - webcache|@fortawesome/fontawesome-free@6.5.1/css/v4-font-face.min.css\n```\n\n### å®éªŒæ€§åŠŸèƒ½\n\n#### firework\n\né»˜è®¤å¼€å¯\n\n```yaml\nfirework:\n  enable: true\n```\n\nå…·ä½“é…ç½®è¯·æŸ¥çœ‹ [mouse-firework](https://github.com/D-Sketon/mouse-firework)\n\n#### pjax\n\né»˜è®¤å…³é—­\n\n```yaml\npjax:\n  enable: false\n```\n\n> pjax åœ¨ v0.0.10 ä¸­è¢«å¼•å…¥ï¼Œç”¨äºé‚£äº›éœ€è¦æ·»åŠ éŸ³ä¹æ’­æ”¾å™¨ç­‰éœ€è¦ SPA çš„ç”¨æˆ·ã€‚ä½†å…¶ä»ç„¶å±äºå®éªŒæ€§è´¨ï¼Œå¼•å…¥åå¯èƒ½ä¼šå‡ºç°è¯¸å¦‚**è„šæœ¬æ— æ³•æ‰§è¡Œ**ã€**è„šæœ¬é‡å¤æ‰§è¡Œ**ã€**é¡µé¢æ¸²æŸ“æ··ä¹±**ç­‰ BUGã€‚è¯·æ…é‡è€ƒè™‘ï¼\n\n#### PWA\n\né»˜è®¤å¼€å¯\n\n```yaml\nservice_worker:\n  enable: true\n```\n\n#### live-2d\n\né»˜è®¤å…³é—­\n\n```yaml\nlive2d:\n  enable: false\n```\n\n#### reimu é¼ æ ‡æŒ‡é’ˆ\n\né»˜è®¤å¼€å¯\n\n```yml\nreimu_cursor: true\n```\n\n### Vendor\n\nv0.1.0 å¯¹ `vendor` è¿›è¡Œäº†è¾ƒå¤§ç¨‹åº¦çš„é‡æ„ï¼Œç›®å‰ `vendor` è·¯å¾„çš„ç»„æˆæ–¹å¼ä¸ºï¼š`:cdn|:package@:version/:file`ï¼Œ`:cdn`å¯åœ¨ `vendor` ä¸­è‡ªè¡Œé…ç½®ã€‚ç›®å‰è‡ªå¸¦ä»¥ä¸‹ CDN æºï¼š\n\n```yaml\ncdn_jsdelivr_gh: https://cdn.jsdelivr.net/gh/ # ä»…é’ˆå¯¹githubåŠ é€Ÿ\ncdn_jsdelivr_npm: https://cdn.jsdelivr.net/npm/ # ä»…é’ˆå¯¹npmåŠ é€Ÿ\nfastly_jsdelivr_gh: https://fastly.jsdelivr.net/gh/ # ä»…é’ˆå¯¹githubåŠ é€Ÿ\nfastly_jsdelivr_npm: https://fastly.jsdelivr.net/npm/ # ä»…é’ˆå¯¹npmåŠ é€Ÿ\nunpkg: https://unpkg.com/ # ä»…é’ˆå¯¹npmåŠ é€Ÿ\nwebcache: https://npm.webcache.cn/ # ä»…é’ˆå¯¹npmåŠ é€Ÿ\n```\n\nç”¨æˆ·å¯æ ¹æ®ç½‘ç»œçŠ¶å†µè‡ªè¡Œåˆ‡æ¢ CDN æºã€‚\n","tags":["Hexo"],"categories":["è®¡è½¯æ‚è°ˆ","hexo"]},{"title":"è½¯ä»¶æµ‹è¯•ä¸éªŒè¯ å­¦ä¹ ç¬”è®°","url":"/20230217/software-testing-verification/","content":"## è½¯ä»¶æµ‹è¯•åŸºç¡€\n### ä»€ä¹ˆæ˜¯è½¯ä»¶æµ‹è¯•\nè½¯ä»¶æµ‹è¯•æ˜¯è´¯ç©¿æ•´ä¸ªè½¯ä»¶å¼€å‘ç”Ÿå‘½å‘¨æœŸï¼Œå¯¹è½¯ä»¶äº§å“è¿›è¡ŒéªŒè¯å’Œç¡®è®¤çš„æ´»åŠ¨è¿‡ç¨‹ï¼Œä¹Ÿæ˜¯å¯¹è½¯ä»¶äº§å“è´¨é‡æŒç»­çš„è¯„ä¼°è¿‡ç¨‹ï¼Œå…¶ç›®çš„æ˜¯**å°½å¿«å°½æ—©åœ°å‘ç°**è½¯ä»¶äº§å“ä¸­å­˜åœ¨çš„å„ç§ç¼ºé™·ï¼Œå°½æœ€å¤§å¯èƒ½æ­ç¤ºè½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­æ‰€å­˜åœ¨çš„äº§å“è´¨é‡é£é™©ï¼Œå®ç°**ç¼ºé™·é¢„é˜²**\n- **é™æ€æµ‹è¯•**ï¼šä¸æ‰§è¡Œè¢«æµ‹å¯¹è±¡\n- **åŠ¨æ€æµ‹è¯•**ï¼šæ‰§è¡Œè¢«æµ‹å¯¹è±¡\n### å……åˆ†æ€§é—®é¢˜\n- ç”±äºæ— æ³•ç©·ä¸¾è¢«æµ‹è½¯ä»¶å®Œæ•´çš„è¾“å…¥ç©ºé—´ï¼Œå„ç§è½¯ä»¶åŠ¨æ€æµ‹è¯•æ–¹æ³•æœ¬è´¨ä¸Šéƒ½æ˜¯å›´ç»• â€œå¦‚ä½•æ„é€ æµ‹è¯•é›†åˆä»¥ä½¿å…¶å±•ç°çš„éƒ¨åˆ†è¡Œä¸ºèƒ½å¤Ÿé«˜æ•ˆæœ‰æ•ˆåœ°åæ˜ è½¯ä»¶çš„æ•´ä½“è¡Œä¸ºâ€è€Œå±•å¼€ã€‚åˆ¤æ–­æµ‹è¯•é›†åˆåœ¨è½¯ä»¶ä¸Šçš„è¡¨ç°æ˜¯å¦èƒ½å¤Ÿå……åˆ†åæ˜ è¯¥è½¯ä»¶çš„æ€»ä½“è¡¨ç°ï¼Œåœ¨æµ‹è¯•é¢†åŸŸä¸­å«**å……åˆ†æ€§é—®é¢˜**ã€‚\n- ä½œç”¨\n  -  ä¸ºåˆ†æå’Œåº¦é‡è½¯ä»¶æµ‹è¯•è´¨é‡æä¾›äº†ä¸€æ¡å®¢è§‚çš„é€”å¾„\n  -  ç¡®å®šæµ‹è¯•è¿‡ç¨‹ä¸­éœ€è¦è§‚å¯Ÿçš„å†…å®¹\n  -  ä½œä¸ºæµ‹è¯•åœæ­¢æ ‡å‡†ä¹‹ä¸€\n  - å½“æµ‹è¯•é›†åˆæœªèƒ½è¾¾åˆ°æœŸæœ›çš„å……åˆ†æ€§å‡†åˆ™æ—¶ï¼ŒæŒ‡å¯¼æµ‹è¯•æ•°æ®çš„è¡¥å……\n\n### è½¯ä»¶ç¼ºé™·(Software Defect)\n- å­˜åœ¨äºè½¯ä»¶ï¼ˆæ–‡æ¡£ã€æ•°æ®ã€ç¨‹åºï¼‰ä¹‹ä¸­çš„é‚£äº›ä¸å¸Œæœ›æˆ–ä¸å¯æ¥å—çš„åå·®\n- Bugæ˜¯å£è¯­åŒ–çš„ç¼ºé™·\n### è½¯ä»¶å¤±æ•ˆ(Software Failure)\n- è½¯ä»¶è¿è¡Œæ—¶äº§ç”Ÿçš„ä¸€ç§ä¸å¸Œæœ›æˆ–ä¸å¯æ¥å—çš„**å¤–éƒ¨è¡Œä¸ºç»“æœ**\n- ç³»ç»Ÿå´©æºƒï¼Œé—ªé€€ï¼Œç»“æœä¸æ­£ç¡®â€¦â€¦\n  - **å¤–éƒ¨å¯è§çš„è½¯ä»¶å¤±æ•ˆ**æ˜¯æµ‹è¯•ä¸­æ¨æ–­è½¯ä»¶ä¸­å­˜åœ¨ç¼ºé™·çš„åŸºæœ¬æ–¹æ³•\n  - æ²¡æœ‰å¤±æ•ˆå¹¶ä¸ä»£è¡¨è½¯ä»¶ä¸­ä¸å­˜åœ¨ç¼ºé™·\n### è½¯ä»¶æ•…éšœ(Software Fault)\n- è½¯ä»¶è¿è¡Œè¿‡ç¨‹ä¸­å‡ºç°çš„ä¸€ç§ä¸å¸Œæœ›æˆ–ä¸å¯æ¥å—çš„**å†…éƒ¨çŠ¶æ€**\n- **å†…éƒ¨çŠ¶æ€**ï¼šç”±æ‰€æœ‰ç¨‹åºå˜é‡çš„**å½“å‰å€¼**å’Œ**ç¨‹åºæŒ‡é’ˆ**æ„æˆ\n### è½¯ä»¶é”™è¯¯(Software Error)\n- åœ¨è½¯ä»¶ç”Ÿå­˜æœŸå†…çš„ä¸å¸Œæœ›æˆ–è€…ä¸å¯æ¥å—çš„**äººä¸ºé”™è¯¯**\n- è½¯ä»¶ç¼ºé™·æœ¬è´¨ä¸Šæ˜¯**ç ”å‘äººå‘˜**åœ¨è½¯ä»¶ç ”å‘è¿‡ç¨‹ä¸­**æ‰€çŠ¯é”™è¯¯åœ¨è½¯ä»¶ä¸­çš„å¯è§†åŒ–ç»“æœ**\n### ç¼ºé™·å…·æœ‰éšè”½æ€§\n- è½¯ä»¶ä¸­ä¸€å®šå­˜åœ¨ç¼ºé™·\n- æœ‰ç¼ºé™·å¹¶ä¸ä¸€å®šäº§ç”Ÿæ•…éšœ\n- æœ‰æ•…éšœä¹Ÿå¹¶ä¸ä¸€å®šä¼šå¤±æ•ˆ\n- äº§ç”Ÿå¤±æ•ˆä¸€å®šæ„å‘³ç€è½¯ä»¶æœ‰æ•…éšœ\n- äº§ç”Ÿå¤±æ•ˆä¸€å®šæ„å‘³ç€è½¯ä»¶å­˜åœ¨ç¼ºé™·\n- äº§ç”Ÿæ•…éšœä¸€å®šæ„å‘³ç€è½¯ä»¶å­˜åœ¨ç¼ºé™·\n### RIPæ¨¡å‹\n- Reachabilityï¼ˆå¯è¾¾æ€§ï¼‰ï¼šç¨‹åºä¸­åŒ…å«å¿…é¡»è¾¾åˆ°ç¼ºé™·\n- Infectionï¼ˆæ„ŸæŸ“æ€§ï¼‰ï¼šæ‰§è¡Œä½ç½®åï¼Œç¨‹åºçš„çŠ¶æ€å¿…é¡»æ˜¯ä¸æ­£ç¡®çš„\n- Propagationï¼ˆä¼ æ’­æ€§ï¼‰ï¼šå—æ„ŸæŸ“çš„çŠ¶æ€å¿…é¡»ä¼ æ’­æ‰èƒ½å¯¼è‡´æŸäº›è¾“å‡ºç¨‹åºçš„é”™è¯¯\n### æµ‹è¯•ç”¨ä¾‹\n>  A test case is composed of the **test case values**, **expected result**, prefix values, postfix values for a complete execution and evaluation of the software under test\n> â€”â€” Paul Amman\n- Test Case Valuesï¼šä¸ºå®Œæˆè¢«æµ‹è½¯ä»¶çš„æŸäº›æ‰§è¡Œæ‰€å¿…éœ€çš„è¾“å…¥å€¼\n- Expected Resultsï¼šå¦‚æœç¨‹åºæ»¡è¶³å…¶é¢„æœŸè¡Œä¸ºï¼Œåœ¨æ‰§è¡Œæµ‹è¯•æ—¶å°†äº§ç”Ÿçš„ç»“æœ\n- Prefix Valuesï¼šä»»ä½•å¿…è¦çš„è¾“å…¥ï¼Œä½¿è½¯ä»¶è¿›å…¥é€‚å½“çš„çŠ¶æ€ä»¥æ¥æ”¶æµ‹è¯•ç”¨ä¾‹çš„å€¼\n- Postfix Valuesï¼šä»»ä½•éœ€è¦åœ¨æµ‹è¯•ç”¨ä¾‹å€¼ä¹‹åå‘é€è‡³è½¯ä»¶çš„è¾“å…¥ã€‚é€šå¸¸æœ‰ä¸¤ç§ç±»å‹çš„åç¼€å€¼ï¼š\n  - éªŒè¯å€¼ï¼šæŸ¥çœ‹æµ‹è¯•ç”¨ä¾‹å€¼çš„ç»“æœæ‰€éœ€çš„å€¼\n  - é€€å‡ºå‘½ä»¤ï¼šç»ˆæ­¢ç¨‹åºæˆ–ä»¥å…¶ä»–æ–¹å¼ä½¿å…¶å›åˆ°ç¨³å®šçŠ¶æ€æ‰€éœ€çš„å€¼\n- æµ‹è¯•é›†ï¼šä¸ä¸€ç»„æµ‹è¯•ç”¨ä¾‹ç›¸ç»“åˆçš„é›†åˆ\n#### è‡ªåŠ¨æµ‹è¯•ç”¨ä¾‹\n- 4A æ¨¡å¼\n  - Arrange: preparation for the coming test\n  - Action: execute code under test\n  - Assert: compare actual outputs with expected ones\n  - Annihilation: clean up test environment\n#### æµ‹è¯•ç”¨ä¾‹çš„åº¦é‡æ ‡å‡†\n- æœ‰æ•ˆæ€§ï¼šå‘ç°ç¼ºé™·çš„èƒ½åŠ›\n- ä»¿æ•ˆæ€§ï¼šæµ‹è¯•ç”¨ä¾‹ä¸èƒ½å‘ç°çš„ç¼ºé™·ï¼Œå…¶å®ƒè¾“å…¥å‘ç°è¯¥ç¼ºé™·çš„æ¦‚ç‡åº”è¯¥éå¸¸ä½\n- ç»æµæ€§ï¼šå®ç°æ‰§è¡Œæˆæœ¬\n- å¯ç»´æŠ¤æ€§ï¼šæ˜“äºä¿®æ”¹çš„ç¨‹åº¦\n## é¢å‘ä»£ç çš„æµ‹è¯•\n### å•å…ƒæµ‹è¯•ä»‹ç»\n#### åŠ¨æ€è½¯ä»¶æµ‹è¯•\nåœ¨**å¼€å‘ç¯å¢ƒ**ä¸­ï¼Œé€šè¿‡**è¿è¡Œè¢«æµ‹ä»£ç **ä»¥éªŒè¯å…¶**æ˜¯å¦æ»¡è¶³æœŸæœ›ç›®æ ‡**è€Œè¿›è¡Œçš„ä¸€ç§æµ‹è¯•æ´»åŠ¨ä»¥å°½æ—©å°½å¯èƒ½å‘ç°**ä¸ç›®æ ‡ä¸ä¸€è‡´**çš„**ç¼ºé™·**\n#### å•å…ƒ\nå•å…ƒæ˜¯ä¸€ä¸ª**å°ç²’åº¦çš„è¡Œä¸ºç‰¹æ€§**ã€‚ä»è§„æ¨¡ä¸Šè¯´å¯èƒ½æ˜¯ä¸€ä¸ªå‡½æ•°ã€æ–¹æ³•ã€é¡µé¢ï¼Œä¹Ÿå¯èƒ½æ˜¯å‡ ä¸ªã€‚\n#### å•å…ƒæµ‹è¯•\næµ‹è¯•æ‰§è¡Œæ˜¯å¦ç»æµå¿«æ·ç•Œå®šå•å…ƒæµ‹è¯•ï¼Œè¿è¡Œè¦**å¿«**, **ä¸è¶…è¿‡0.1ç§’**\nä¸æ˜¯å•å…ƒæµ‹è¯•ï¼š\n- è·Ÿæ•°æ®åº“äº¤äº’\n- è¿›è¡Œäº†ç½‘ç»œé—´é€šä¿¡\n- è°ƒç”¨äº†æ–‡ä»¶ç³»ç»Ÿ\n- éœ€è¦å¯¹ç¯å¢ƒåšç‰¹å®šçš„å‡†å¤‡ï¼ˆå¦‚ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼‰æ‰èƒ½è¿è¡Œèµ·æ¥\n##### æµ‹è¯•æ›¿èº«ï¼ˆTest Doubleï¼‰\næ›¿ä»£çœŸå®ä»£ç ä¸­ä¾èµ–äºæ•°æ®åº“ã€ç½‘ç»œå’Œæ–‡ä»¶ç³»ç»Ÿçš„ä»£ç \n#### å•å…ƒæµ‹è¯•å¤æ‚åº¦\nè¢«æµ‹ä»£ç è¾“å…¥éœ€è¦è€ƒè™‘çš„\n- è¢«æµ‹ä»£ç çš„è¾“å…¥å‚æ•°\n- è¢«æµ‹ä»£ç å†…éƒ¨éœ€è¦è¯»å–çš„å…¨å±€å˜é‡\n- è¢«æµ‹ä»£ç å†…éƒ¨éœ€è¦è¯»å–çš„æˆå‘˜å˜é‡\n- è¢«æµ‹ä»£ç å†…éƒ¨è°ƒç”¨çš„æ–¹æ³•/å‡½æ•°è·å¾—çš„æ•°æ®\n- è¢«æµ‹ä»£ç å†…éƒ¨è°ƒç”¨çš„æ–¹æ³•æ”¹å†™çš„æ•°æ®\n- â€¦â€¦\nè¢«æµ‹ä»£ç è¾“å‡ºéœ€è¦è€ƒè™‘çš„\n- è¢«æµ‹ä»£ç çš„è¿”å›å€¼\n- è¢«æµ‹ä»£ç çš„è¾“å‡ºå‚æ•°ï¼ˆC/C++ï¼‰\n- è¢«æµ‹ä»£ç å†…éƒ¨æ”¹å†™çš„æˆå‘˜å˜é‡å’Œå…¨å±€å˜é‡\n- è¢«æµ‹ä»£ç è¿›è¡Œçš„æ–‡ä»¶æ›´æ–°ã€æ•°æ®åº“æ›´æ–°ã€æ¶ˆæ¯é˜Ÿåˆ—æ›´æ–°\n- â€¦â€¦\n### ä»£ç ç¼ºé™·åˆ†ç±»\n- åŠŸèƒ½\n  - æœ‰ç‰¹å¾ï¼ˆé™æ€æµ‹è¯•ï¼‰\n    - è¯­æ³•ç‰¹å¾ï¼šåŸºäºç¨‹åºè¯­è¨€è¯­æ³•å°±å¯ä»¥å‘ç°çš„é—®é¢˜\n    - è¾¹ç•Œè¡Œä¸ºç‰¹å¾ï¼šä»£ç åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿå¼‚å¸¸ã€å´©æºƒæˆ–è¶…æ—¶ã€‚é€šå¸¸ï¼Œè¿™äº›è¡Œä¸ºç”±è¾¹ç•Œæ¡ä»¶å¼•èµ·\n    - ç»éªŒç‰¹å¾ï¼šåŸºäºè¿‡å¾€ç»éªŒå¯ä»¥å‘ç°çš„é—®é¢˜\n  - æ— ç‰¹å¾ï¼ˆåŠ¨æ€æµ‹è¯•ï¼‰ \n    - ä»£ç è¡Œä¸ºï¼šä»£ç å®ç°çš„ç®—æ³•/åŠŸèƒ½ä¸æœŸæœ›çš„ä¸ä¸€è‡´\n    - éƒ¨åˆ†ä»£ç è¡Œä¸ºï¼šåœ¨æŸäº›æ¡ä»¶ä¸‹ï¼Œä»£ç ä¸èƒ½å‡†ç¡®åœ°å®Œæˆä¸šåŠ¡è¦æ±‚å®ç°çš„åŠŸèƒ½\n- æ€§èƒ½\n  - æ—¶é—´\n  - ç©ºé—´ \n### å•å…ƒæµ‹è¯•å¯å‘å¼è§„åˆ™\n#### Rightâ€”BICEP\n- Right: Are the results right? \n- B: Are all the boundary conditions correct?\n- I: Can you check inverse relationships? \n- C: Can you cross-check results using other means?\n- E: Can you force error conditions to happen? \n- P: Are performance characteristics within bounds?\n##### Right\n- happy path tests: tests should **first and foremost** validate that the code produces expected results what the users want\n##### B-Boundary conditions\n- è™šå‡æˆ–ä¸ä¸€è‡´çš„è¾“å…¥å€¼\n- æ•°æ®æ ¼å¼é”™è¯¯ï¼Œç”µè¯å·ç é”™è¯¯\n- å¯èƒ½å¯¼è‡´æ•°å­—æº¢å‡ºçš„è®¡ç®—\n- ç©ºå€¼æˆ–ç¼ºå¤±å€¼\n##### I-Checking Inverse Relationship\nç”¨**é€†è¡Œä¸º**æµ‹è¯•è¢«æµ‹è¯•ä»£ç \n- åœ¨æ•°æ®åº“ä¸­æ’å…¥ä¸€æ¡è®°å½•åï¼ŒæŸ¥è¯¢è¯¥è®°å½•\n- å·²ç»ä½¿ç”¨çš„æ¬¾é¡¹æ€»æ•° = æ¬¾é¡¹æ€»æ•° â€“ å‰©ä½™çš„æ¬¾é¡¹æ•°\n##### C-Cross checking\nä½¿ç”¨ä¸åŒæ•°æ®ä¹‹é—´çš„å…³ç³»è¿›è¡Œæµ‹è¯•\n- å·²ç»ä½¿ç”¨çš„æ¬¾é¡¹æ€»æ•° = æ¬¾é¡¹æ€»æ•° â€“ å‰©ä½™çš„æ¬¾é¡¹æ•°\n##### E-Forcing Error Condition\nä½¿ç”¨Mockå¯¹è±¡æ¨¡æ‹Ÿå„ç§å¼‚å¸¸\n##### P-Performance characteristics\né€šå¸¸ç”¨äºE2Eæµ‹è¯•\n- Junit 5 @Timeout\n#### CORRECT\n- **C**onformance: æ•°æ®æ ¼å¼æ˜¯å¦ä¸æœŸæœ›çš„ä¸€è‡´\n- **O**rderingï¼šæ•°æ®ä¹‹é—´çš„é¡ºåºæ˜¯å¦æ»¡è¶³è¦æ±‚\n- **R**angeï¼šæ•°æ®æ˜¯å¦åœ¨åˆç†çš„æœ€å¤§å€¼å’Œæœ€å°å€¼ä¹‹é—´\n- **R**eferenceï¼šè¢«æµ‹ä»£ç æ˜¯å¦ä½¿ç”¨äº†æ— æ³•æ§åˆ¶çš„å¤–éƒ¨å¼•ç”¨\n- **E**xistenceï¼šæ•°æ®æ˜¯å¦è¢«è¦æ±‚å­˜åœ¨ï¼Œä¾‹å¦‚éç©ºã€é0ã€å¿…é¡»åœ¨é›†åˆä¸­\n- **C**ardinalityï¼šæ•°æ®æ•°é‡æ˜¯å¦æ»¡è¶³è¦æ±‚\n- **T**imeï¼šæ¯ä»¶äº‹æƒ…æ˜¯å¦æŒ‰é¡ºå‘ç”Ÿï¼Ÿæ˜¯å¦åœ¨æ­£ç¡®çš„æ—¶é—´å‘ç”Ÿï¼Ÿå‘ç”Ÿæ˜¯å¦åŠæ—¶ï¼Ÿ\n##### C-Conformance\n-å•ä¸€ç»“æ„çš„æ•°æ®\n  - E-mailï¼Œphone numberâ€¦..\n- å¤åˆç»“æ„çš„æ•°æ®\n  - ï¼ˆå§“åï¼Œåœºåœ°ï¼Œæ—¶é—´ï¼‰ï¼šåªæ²¡æœ‰å§“å/åœºåœ°/æ—¶é—´ï¼Œåªæœ‰å§“å/åœºåœ°/æ—¶é—´â€¦â€¦.\n##### O-Ordering\n- ä¸€æ®µæ•°æ®åœ¨è¾ƒå¤§é›†åˆä¸­çš„ä½ç½®\n##### R-Range\n- JavaåŸå§‹ç±»å‹èŒƒå›´\n- è‡ªå®šä¹‰èŒƒå›´\n- ä¸å˜é‡æ–­è¨€\n##### R-Reference\n- è¢«æµ‹æ–¹æ³•ï¼ˆMUTï¼‰åœ¨å…¶èŒƒå›´ä¹‹å¤–å¼•ç”¨äº†ä»€ä¹ˆ\n- MUTæœ‰ä»€ä¹ˆå¤–éƒ¨ä¾èµ–æ€§\n- MUTæ˜¯å¦å–å†³äºå¯¹è±¡å¤„äºç‰¹å®šçŠ¶æ€\n- å¿…é¡»å­˜åœ¨çš„ä»»ä½•å…¶ä»–æ¡ä»¶\n  - å‰ç½®æ¡ä»¶\n  - åç½®æ¡ä»¶\n##### E-Existence\n- å€¼ä¸ºnullã€é›¶æˆ–å…¶ä»–ä¸ºç©º\n##### C-Cardinality\n- åªæœ‰åœ¨è¿™ä¸‰ç§æƒ…å†µä¸‹ï¼ˆ0-1-nè§„åˆ™ï¼‰ï¼ŒæŸç»„å€¼çš„è®¡æ•°æ‰æœ‰æ„ä¹‰\n  - 0\n  - 1\n  - nï¼ˆå¤šä¸ªï¼‰\n##### T-Time\n- ç›¸å¯¹æ—¶é—´ï¼šå¦‚æœæ–¹æ³•æŒ‰é¡ºåºè°ƒç”¨\n- ç»å¯¹æ—¶é—´ï¼šåœ¨è¾¹ç•Œæ—¥æµ‹è¯•ä»»ä½•æ—¶é—´æ•æ„Ÿä»£ç \n- å¹¶å‘é—®é¢˜\n  - å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®åŒä¸€å¯¹è±¡\n  - éœ€è¦åŒæ­¥ä»»ä½•å…¨å±€æˆ–å®ä¾‹çº§æ•°æ®æˆ–æ–¹æ³•\n  - å¤–éƒ¨è®¿é—®æ–‡ä»¶æˆ–ç¡¬ä»¶\n### å•å…ƒæµ‹è¯•å®ç°\n#### æµ‹è¯•ç”Ÿå‘½å‘¨æœŸ\n- Setup (optional): åˆå§‹åŒ–TestFixture\n- Exercise: æµ‹è¯•ä¸SUTäº¤äº’ï¼Œè·å¾—ç»“æœ\n- Verify: ä½¿ç”¨ä¸€ä¸ªæˆ–å¤šä¸ªæ–­è¨€ï¼ˆä¹Ÿç§°ä¸ºè°“è¯ï¼‰å°†è¢«æµ‹ç³»ç»Ÿçš„ç»“æœä¸é¢„æœŸå€¼è¿›è¡Œæ¯”è¾ƒï¼Œåˆ›å»ºæµ‹è¯•ç»“æœ\n- Teardown (optional): é‡Šæ”¾TestFixtureï¼ŒSUTå›åˆ°åˆå§‹çŠ¶æ€\n#### æµ‹è¯•æ›¿èº«\n##### Dummy\n- åœ¨æµ‹è¯•æ–¹æ³•ä¸­**ä¸ä½¿ç”¨å…¶ä»»ä½•æ–¹æ³•**çš„æµ‹è¯•æ›¿èº«\n- ä¸€èˆ¬å‡ºç°åœ¨æ–¹æ³•çš„å‚æ•°å¤„\n- é€šå¸¸ä¸ºäº†é˜²æ­¢NullPointerExceptionçš„å‡ºç°ï¼Œä¿è¯æµ‹è¯•æ–¹æ³•å¯ä»¥é¡ºåˆ©æ‰§è¡Œ\n##### Fake\n- ä¸€ç§**ç®€åŒ–çœŸå®ä»£ç **çš„æµ‹è¯•æ›¿èº«ï¼Œé€šå¸¸é‡‡ç”¨ç»§æ‰¿è¢«Fakeå¯¹è±¡ï¼ˆçœŸå®ä»£ç ï¼‰ï¼Œæˆä¸ºå…¶å­ç±»çš„æ–¹æ³•å®ç°\n- ä¸èƒ½ä½œä¸ºäº§å“ä»£ç ï¼Œå•çº¯ä¸ºäº†æµ‹è¯•å¿«ï¼Œä¸åœ¨æµ‹è¯•ä¸­å‡ºç°è€—æ—¶è¡Œä¸º\n##### Stub\n- Provide canned answerï¼šä¸ºå…¶è°ƒç”¨è€…æä¾›æµ‹è¯•è¿‡ç¨‹ä¸­éœ€è¦ä½¿ç”¨çš„ä¿¡æ¯\n- é€šå¸¸åº”ç”¨å“åº”å¾…æµ‹ç³»ç»Ÿçš„è¯·æ±‚ï¼Œç„¶å**è¿”å›ç‰¹å®šçš„å€¼**\n##### Spy\n- ä½¿ç”¨çœŸå®ä»£ç çš„æµ‹è¯•æ›¿èº«ï¼Œ**è¿”å›å…¶çœŸå®å€¼**\n- å¯ä»¥æ‰“æ¡©\n- å¯ä»¥è®°å½•ä½¿ç”¨è½¨è¿¹ï¼Œä¾¿äºåœ¨åç»­çš„æµ‹è¯•æ´»åŠ¨ä¸­éªŒè¯æ˜¯ä¸æ˜¯å®‰æ’çš„äº‹æƒ…æŒ‰ç…§æœŸæœ›å‘ç”Ÿ\n##### Mock\n- æŒ‰ç…§æœŸæœ›å®ç°çš„ç”¨äºæµ‹è¯•æ–¹æ³•ä¸­çš„è¡Œä¸ºä»£ç \n  - æ­£å¸¸è·¯å¾„ï¼šè¿”å›æ­£å¸¸å€¼\n  - å¼‚å¸¸è·¯å¾„ï¼šè¿”å›æœŸæœ›çš„é”™è¯¯/å¼‚å¸¸\n### ä»£ç æµ‹è¯•å……åˆ†æ€§å‡†åˆ™\n#### åŸºäºæ§åˆ¶æµ \n##### æ§åˆ¶æµå›¾ï¼ˆCFGï¼‰\n- ç»“ç‚¹ï¼šè¯­å¥æˆ–ä»£ç å—\n- è¾¹ï¼šæ§åˆ¶è½¬ç§»\n###### è·¯å¾„\nèŠ‚ç‚¹$(n_1,n_2,...n_m)$çš„åºåˆ—ï¼Œå…¶ä¸­$(n_i,n_{i+1})\\in E,1 \\leq i < m$ \n- é•¿åº¦ï¼šè·¯å¾„ä¸­è¾¹çš„æ•°é‡\n- **è·¯å¾„çš„é•¿åº¦å¯ä»¥ä¸º0**\n- è·¯å¾„çš„**å­è·¯å¾„**æ˜¯pçš„å­åºåˆ—\n###### å®Œæ•´è·¯å¾„\nä»åˆå§‹èŠ‚ç‚¹å¼€å§‹åˆ°æœ€ç»ˆèŠ‚ç‚¹ç»“æŸçš„è·¯å¾„\n##### è¯­å¥è¦†ç›–ï¼ˆStatement Coverageï¼‰\n- è¡¡é‡è¢«æµ‹ä»£ç ä¸­çš„è¯­å¥å¾—åˆ°æ‰§è¡Œçš„ç¨‹åº¦\n- åŸºäºCFGå—ä¸è¯­å¥çš„å¯¹åº”å…³ç³»ï¼Œè¡¡é‡è¯­å¥è¦†ç›–æƒ…å†µ\n- è¯­å¥è¦†ç›–çš„æ­£å¼å®šä¹‰ä¸ºï¼šæµ‹è¯•é›†åˆTç§°ä¸ºè¯­å¥è¦†ç›–å……åˆ†çš„ï¼Œå½“ä¸”ä»…å½“æ‰§è¡ŒTäº§ç”Ÿçš„å®Œæ•´è·¯å¾„é›†åˆLè¦†ç›–äº†æ§åˆ¶æµå›¾ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹ã€‚å¦‚æœä½¿ç”¨ç¬¦å·Node(G)è¡¨ç¤ºæ§åˆ¶æµå›¾çš„èŠ‚ç‚¹é›†åˆï¼ŒNodeï¼ˆLï¼‰è¡¨ç¤ºLåŒ…\nå«çš„èŠ‚ç‚¹é›†åˆï¼Œåˆ™æµ‹è¯•é›†åˆTçš„è¯­å¥è¦†ç›–ç‡ä¸ºï¼š\n$\\frac{||Node(L)||}{||Node(G)||}*100\\%$\n- è¯­å¥è¦†ç›–æ˜¯æœ€å¼±çš„æ ‡å‡†\n##### åˆ†æ”¯è¦†ç›–ï¼ˆBranch Coverageï¼‰\n- è¡¡é‡è¢«ä»£ç ä¸­çš„æ‰€æœ‰æ§åˆ¶è½¬ç§»è¢«æ‰§è¡Œçš„ç¨‹åº¦\n- æ§åˆ¶è½¬ç§»è¡¨ç°ä¸ºCFGçš„è¾¹ï¼Œæ§åˆ¶è½¬ç§»å¾—åˆ°æµ‹è¯•æ„å‘³ç€ç›¸åº”çš„è¾¹åœ¨æµ‹è¯•é›†åˆå¯¹åº”çš„å®Œæ•´è·¯å¾„ä¸­å‡ºç°\n- åˆ†æ”¯è¦†ç›–å‡†åˆ™çš„å®šä¹‰ï¼šæµ‹è¯•é›†åˆTç§°ä¸ºåˆ†æ”¯è¦†ç›–å……åˆ†çš„ï¼Œå½“ä¸”ä»…å½“æ‰§è¡ŒTäº§ç”Ÿçš„å®Œæ•´è·¯å¾„é›†åˆLè¦†ç›–äº†æ§åˆ¶æµå›¾ä¸­çš„æ‰€æœ‰è¾¹ã€‚å¦‚æœä½¿ç”¨ç¬¦å·Edge(G)è¡¨ç¤ºæ§åˆ¶æµå›¾çš„è¾¹é›†åˆï¼ŒEdgeï¼ˆLï¼‰è¡¨ç¤ºLåŒ…å«çš„æ§åˆ¶æµå›¾ä¸­çš„è¾¹é›†åˆï¼Œåˆ™æµ‹è¯•é›†åˆTçš„åˆ†æ”¯è¦†ç›–ç‡ä¸ºï¼š\n$\\frac{||Edge(L)||}{||Edge(G)||}*100\\%$\n##### è·¯å¾„è¦†ç›–ï¼ˆPath Coverageï¼‰\n- è¡¡é‡è¢«ä»£ç ä¸­çš„**å®Œæ•´è·¯å¾„**è¢«æ‰§è¡Œçš„ç¨‹åº¦\n- è¢«ä»£ç ä¸­çš„å®Œæ•´è·¯å¾„å¯¹åº”äºCFGä¸­çš„å®Œæ•´è·¯å¾„\n- æµ‹è¯•é›†åˆTç§°ä¸ºè·¯å¾„è¦†ç›–å……åˆ†çš„ï¼Œå½“ä¸”ä»…å½“æ‰§è¡ŒTäº§ç”Ÿçš„å®Œæ•´è·¯å¾„é›†åˆLè¦†ç›–äº†æ§åˆ¶æµå›¾ä¸­çš„æ‰€æœ‰å®Œæ•´è·¯å¾„ã€‚å¦‚æœä½¿ç”¨ç¬¦å·Path(G)è¡¨ç¤ºæ§åˆ¶æµå›¾çš„æ‰€æœ‰å®Œæ•´è·¯å¾„é›†åˆï¼Œåˆ™æµ‹è¯•é›†åˆTçš„è·¯å¾„è¦†ç›–ç‡ä¸ºï¼š\n$\\frac{||L||}{||Path(G)||}*100\\%$\n##### åŸºè·¯å¾„è¦†ç›–ï¼ˆPrime Path Coverageï¼‰\n- ç®€å•è·¯å¾„\n  - é™¤äº†ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œå…¶ä½™èŠ‚ç‚¹åªå‡ºç°ä¸€æ¬¡ï¼ˆæ— å†…éƒ¨å›è·¯ï¼‰\n- åŸºè·¯å¾„\n  - ä¸å±äºå…¶ä»–ç®€å•è·¯å¾„å­è·¯å¾„çš„ç®€å•è·¯å¾„\n###### è®¡ç®—åŸºè·¯å¾„\n- ç©·ä¸¾æ³•\n- èŠ‚ç‚¹æ ‘\n  - ä»¥Gä¸­çš„èŠ‚ç‚¹ä¸ºæ ¹èŠ‚ç‚¹å»ºç«‹çš„æ ‘ï¼Œä¸”æ»¡è¶³æ ‘ä¸­é™¤æ ¹èŠ‚ç‚¹å’Œå¶èŠ‚ç‚¹å¯ä»¥ç›¸åŒå¤–ï¼Œä»æ ¹èŠ‚ç‚¹åˆ°æ¯ä¸ªæ ‘ä¸­èŠ‚ç‚¹çš„è·¯å¾„ä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„å‡ºç°æ¬¡æ•°æœ‰ä¸”ä»…æœ‰ 1 æ¬¡\n  - åœ¨èŠ‚ç‚¹æ ‘ä¸­ï¼Œæ¯æ¡ä»æ ¹èŠ‚ç‚¹åˆ°å¶èŠ‚ç‚¹çš„è·¯å¾„å³ä¸ºä¸€æ¡ç®€å•è·¯å¾„\n- ç®€å•èŠ‚ç‚¹æ ‘\n  - è‹¥èŠ‚ç‚¹æ ‘Tä¸æ˜¯ä»»ä½•å…¶å®ƒèŠ‚ç‚¹æ ‘çš„å­æ ‘ï¼Œåˆ™ç§°èŠ‚ç‚¹æ ‘Tä¸ºç®€å•èŠ‚ç‚¹æ ‘\n  - æ‰€æœ‰ç®€å•èŠ‚ç‚¹æ ‘çš„ä»æ ¹èŠ‚ç‚¹åˆ°å¶èŠ‚ç‚¹çš„è·¯å¾„é›†åˆä¸ºå¤‡é€‰çš„åŸºè·¯å¾„é›†åˆ\n\n- è¡¡é‡è¢«ä»£ç æ‰€æœ‰åŸºè·¯å¾„è¢«æ‰§è¡Œçš„ç¨‹åº¦\n- åŸºè·¯å¾„è¦†ç›–è¦æ±‚æ¯æ¡åŸºè·¯å¾„è‡³å°‘è¢«æ‰§è¡Œä¸€æ¬¡ï¼Œå…¶å®šä¹‰å¦‚ä¸‹ï¼šæµ‹è¯•é›†åˆTç§°ä¸ºåŸºè·¯å¾„è¦†ç›–å……åˆ†çš„ï¼Œå½“ä¸”ä»…å½“æ‰§è¡ŒTäº§ç”Ÿçš„å®Œæ•´è·¯å¾„é›†åˆLè®¿é—®äº†æ§åˆ¶æµå›¾ä¸­çš„æ‰€æœ‰åŸºè·¯å¾„ã€‚å¦‚æœä½¿ç”¨ç¬¦å·PP(G)è¡¨ç¤ºæ§åˆ¶æµå›¾çš„æ‰€æœ‰åŸºè·¯å¾„é›†åˆï¼ŒPP(L)è¡¨ç¤ºLè®¿é—®çš„åŸºè·¯å¾„é›†åˆï¼Œåˆ™æµ‹è¯•é›†åˆTçš„åŸºè·¯å¾„è¦†ç›–ç‡ä¸ºï¼š\n$\\frac{||PP(L)||}{||PP(G)||}*100\\%$\n\n##### åˆ¤å®šè¦†ç›–ï¼ˆDecision Coverageï¼‰\n- è¡¡é‡ä»£ç ä¸­çš„åˆ¤å®šå¾—åˆ°æ‰§è¡Œçš„ç¨‹åº¦ï¼ŒæœŸæœ›å‘ç°é€»è¾‘è¿ç®—ç¬¦ç›¸å…³ç¼ºé™·\n- å¦‚æœæµ‹è¯•é›†åˆèƒ½å¤Ÿä½¿å¾—è¢«æµ‹ä»£ç ä¸­çš„æ¯ä¸ªåˆ¤å®šè‡³å°‘è¢«æ‰§è¡Œä¸€æ¬¡,é‚£ä¹ˆåˆ™è¯´è¯¥æµ‹è¯•é›†åˆæ»¡è¶³äº†åˆ¤å®šè¦†ç›–\n- æ³¨æ„ï¼Œæ¯ä¸ªåˆ¤å®šè¢«æ‰§è¡Œä¸€æ¬¡çš„å«ä¹‰æ˜¯æŒ‡æ¯ä¸ªåˆ¤å®šçš„æ‰€æœ‰å¯èƒ½ç»“æœéƒ½**è‡³å°‘å‡ºç°ä¸€æ¬¡**\n- ä¾‹ if((num1 >1ï¼‰&& (num2==0))çš„çœŸå‡ç»“æœéƒ½å¾—åˆ°æ‰§è¡Œï¼Œæ‰è®¤ä¸ºè¯¥åˆ¤å®šè¢«æ‰§è¡Œ\n- åˆ¤å®šè¦†ç›–åº¦ï¼š\n$åˆ¤å®šè¦†ç›–åº¦ =\\frac{å¾—åˆ°æ‰§è¡Œçš„åˆ¤å®šæ•°}{åˆ¤å®šæ€»æ•°}âˆ— 100\\%$\n##### æ¡ä»¶è¦†ç›–ï¼ˆCondition Coverageï¼‰\n- è¡¡é‡ä»£ç ä¸­æ„æˆåˆ¤å®šçš„å„ä¸ªæ¡ä»¶å¾—åˆ°æ‰§è¡Œçš„ç¨‹åº¦ï¼ŒæœŸæœ›å‘ç°ç®—æœ¯è¿ç®—ç¬¦ç›¸å…³ç¼ºé™·\n- å¦‚æœæµ‹è¯•é›†åˆèƒ½å¤Ÿä½¿å¾—è¢«æµ‹ä»£ç ä¸­çš„æ¯ä¸ªæ¡ä»¶è‡³å°‘è¢«æ‰§è¡Œä¸€æ¬¡, é‚£ä¹ˆåˆ™è¯´è¯¥æµ‹è¯•é›†åˆæ»¡è¶³äº†æ¡ä»¶è¦†ç›–\n- æ¯ä¸ªæ¡ä»¶è¢«æ‰§è¡Œä¸€æ¬¡çš„å«ä¹‰ï¼šæ¯ä¸ªæ¡ä»¶çš„**æ‰€æœ‰å¯èƒ½ç»“æœéƒ½è‡³å°‘å‡ºç°ä¸€æ¬¡**\n- åˆ¤å®šè¦†ç›–åº¦ï¼š\n$åˆ¤å®šè¦†ç›–åº¦ =\\frac{å¾—åˆ°æ‰§è¡Œçš„æ¡ä»¶æ•°}{æ¡ä»¶æ€»æ•°}âˆ— 100\\%$\n- **æ»¡è¶³åˆ¤å®šä¸ä¸€å®šæ»¡è¶³æ¡ä»¶ï¼Œæ»¡è¶³æ¡ä»¶ä¸ä¸€å®šæ»¡è¶³åˆ¤å®š**\n##### åˆ¤å®š-æ¡ä»¶è¦†ç›–ï¼ˆDecision-Condition Coverageï¼‰\n- è¡¡é‡ä»£ç ä¸­æ¯ä¸ªåˆ¤å®šä»¥åŠæ„æˆåˆ¤å®šçš„æ¯ä¸ªæ¡ä»¶å¾—åˆ°æ‰§è¡Œçš„ç¨‹åº¦\n- å¦‚æœæµ‹è¯•é›†åˆèƒ½å¤Ÿä½¿å¾—è¢«æµ‹ä»£ç ä¸­çš„æ¯ä¸ªåˆ¤å®šè‡³å°‘è¢«æ‰§è¡Œä¸€æ¬¡å¹¶ä¸”æ„æˆåˆ¤å®šçš„æ¯ä¸ªæ¡ä»¶è‡³å°‘è¢«æ‰§è¡Œä¸€æ¬¡, é‚£ä¹ˆåˆ™è¯´è¯¥æµ‹è¯•é›†åˆæ»¡è¶³äº†åˆ¤å®š-æ¡ä»¶è¦†ç›–\n- æ‰§è¡Œçš„å«ä¹‰åŒæ ·æŒ‡**æ‰€æœ‰å¯èƒ½ç»“æœéƒ½è‡³å°‘å‡ºç°ä¸€æ¬¡**\n##### ä¿®æ­£çš„åˆ¤å®š-æ¡ä»¶è¦†ç›–ï¼ˆModified Condition/Decision Coverageï¼ŒMC/DCï¼‰\n- æœŸæœ›æ„æˆæ¯ä¸ªåˆ¤å®šçš„æ¯ä¸ªæ¡ä»¶èƒ½ç‹¬ç«‹åœ°å½±å“æ•´ä¸ªåˆ¤å®šçš„ç»“æœ\n- åœ¨è¿™é‡Œç‹¬ç«‹åœ°å½±å“æ•´ä¸ªåˆ¤å®šçš„ç»“æœæ˜¯æŒ‡åœ¨å…¶å®ƒæ¡ä»¶å–å€¼ä¸å˜çš„æƒ…å†µä¸‹ï¼Œåªæ”¹å˜å½“å‰æ¡ä»¶çš„å–å€¼å°±èƒ½ä½¿å¾—æ•´ä¸ªåˆ¤å®šçš„ç»“æœå‘ç”Ÿå˜åŒ–\n\n#### åŸºäºæ•°æ®æµ\n##### å®šä¹‰å’Œä½¿ç”¨\n- å®šä¹‰ï¼šå°†ä¸€ä¸ªå€¼**å‚¨å­˜åœ¨å†…å­˜ä¸­**\n  - xå‡ºç°åœ¨ä¸€ä¸ªèµ‹å€¼çš„å·¦è¾¹ï¼ˆx = 44ï¼‰\n  - xæ˜¯ä¸€ä¸ªç¨‹åºçš„è¾“å…¥\n  - åœ¨ä¸‹åˆ—æƒ…å†µä¸‹åº”ä»”ç»†è€ƒè™‘\n    - xæ˜¯è°ƒç”¨ä¸­çš„ä¸€ä¸ªå®å‚ï¼Œæ–¹æ³•æ”¹å˜äº†å®ƒçš„å€¼ \n    - xæ˜¯ä¸€ä¸ªæ–¹æ³•çš„å½¢å‚ï¼ˆå½“æ–¹æ³•å¼€å§‹æ—¶éšå«çš„defï¼‰ \n- ä½¿ç”¨ï¼šå˜é‡**è¢«è®¿é—®**\n  - xå‡ºç°åœ¨èµ‹å€¼çš„å³è¾¹\n  - xå‡ºç°åœ¨ä¸€ä¸ªæ¡ä»¶æµ‹è¯•ä¸­\n  - xæ˜¯ä¸€ä¸ªæ–¹æ³•çš„å®å‚\n  - xæ˜¯ç¨‹åºçš„ä¸€ä¸ªè¾“å‡º\n  - xæ˜¯ä¸€ä¸ªæ–¹æ³•åœ¨è¿”å›è¯­å¥ä¸­çš„è¾“å‡º\n##### c-use (computation-use)\n- ä½¿ç”¨èŠ‚ç‚¹ `USE(v, n)` æ˜¯ä¸€ä¸ªè®¡ç®—ä½¿ç”¨ï¼ˆè®°åšc-useï¼‰ï¼Œå½“ä¸”ä»…å½“è¯­å¥næ˜¯è®¡ç®—è¯­å¥ï¼ˆå¯¹äºè®¡ç®—ä½¿ç”¨çš„èŠ‚ç‚¹æ°¸è¿œæœ‰å¤–åº¦=1ï¼‰\n##### p-use (predicate-use)\n- ä½¿ç”¨èŠ‚ç‚¹æ˜¯ä¸€ä¸ªè°“è¯ä½¿ç”¨ï¼ˆè®°åšp-useï¼‰ï¼Œå½“ä¸”ä»…å½“è¯­å¥næ˜¯è°“è¯è¯­å¥ï¼ˆå¯¹äºè°“è¯ä½¿ç”¨çš„èŠ‚ç‚¹æ°¸è¿œæœ‰å¤–åº¦â‰¥2ï¼‰\n##### Data Flow Graph\nç»™å®šä¸€ä¸ªCFGï¼š `(N, N0, Nf, E)` \n- `def(n)` æˆ– `def(e)` è¡¨ç¤ºç”±èŠ‚ç‚¹næˆ–è¾¹eå®šä¹‰çš„å˜é‡é›†\n- `use(n)` æˆ– `use(e)` è¡¨ç¤ºç”±èŠ‚ç‚¹næˆ–è¾¹eä½¿ç”¨çš„å˜é‡é›†\n- æ•°æ®æµå›¾ï¼ˆDFGï¼‰å¯ä»¥è¢«å®šä¹‰ä¸ºä¸€ä¸ªå…ƒç»„ï¼š`(ND, N0, Nf, ED)`, å…¶ä¸­ï¼š\n  - $N_D = \\{ (n, def(n) \\cup use(n)) | n \\in N \\}$\n  - $E_D = \\{ (e, def(e) \\cup use(e)) | e \\in E \\}$\n##### DU Pairs å’Œ DU Paths\n- du pair\n  - ä½ç½®å¯¹ `(li,lj)` ï¼Œå˜é‡ `v` åœ¨ `li` å¤„è¢«å®šä¹‰ï¼Œåœ¨ `lj` å¤„è¢«ä½¿ç”¨\n- def clear\n  - ä»`li` åˆ° `lj` çš„è·¯å¾„ï¼Œåœ¨è¯¥è·¯å¾„ä¸Šå˜é‡ `v` æ²¡æœ‰åœ¨ä»»ä½•èŠ‚ç‚¹æˆ–è¾¹ä¸Šè¢«é‡æ–°èµ‹å€¼\n- du path\n  - ä¸€ä¸ªä»å˜é‡ `v` çš„å®šä¹‰èŠ‚ç‚¹åˆ°ä½¿ç”¨èŠ‚ç‚¹çš„**ç®€å•å­è·¯å¾„**ï¼Œæ»¡è¶³def clear\n  - `du(li, lj, v)` å˜é‡ `v` çš„du-pathé›†åˆï¼Œä» `li` å¼€å§‹ï¼Œåˆ° `lj` ç»“æŸ\n  - `du(li, v)` å˜é‡ `v` çš„du-pathé›†åˆï¼Œä» `li` å¼€å§‹\n  - `du(v)` å˜é‡ `v` çš„du-pathé›†åˆ\n##### å…¨å®šä¹‰è¦†ç›–ï¼ˆAll Defs Coverageï¼‰\n- è¡¡é‡è¢«æµ‹ä»£ç ä¸­å˜é‡çš„æ¯ä¸ªå®šä¹‰å¾—åˆ°ä½¿ç”¨çš„ç¨‹åº¦\n- å…¨å®šä¹‰è¦†ç›–çš„æ­£å¼å®šä¹‰ä¸ºï¼šæµ‹è¯•é›†åˆTæ»¡è¶³å…¨å®šä¹‰è¦†ç›–ï¼Œå½“ä¸”ä»…å½“å¯¹äºæ•°æ®æµå›¾ä¸­æ¯ä¸ªå˜é‡$v_i$çš„æ¯ä¸ªå®šä¹‰å¤„$d_j$ï¼Œæ‰§è¡ŒTäº§ç”Ÿçš„å®Œæ•´è·¯å¾„é›†åˆLä¸­å­˜åœ¨ä¸€æ¡è·¯å¾„$l \\in L$çš„æŸä¸ªå­è·¯å¾„$\\pi$ï¼Œæ»¡è¶³$\\pi \\in du(d_j, v_i)$ã€‚è‹¥$def(v_i)$æ˜¯å˜é‡$v_i$åœ¨æ•°æ®æµå›¾ä¸­å®šä¹‰å¤„çš„é›†åˆï¼Œ$\\Pi^D_L (v_i) = \\{\\pi | \\pi \\in du(d_j,v_i), \\pi æ˜¯l \\in Lçš„å­è·¯å¾„\\}$ï¼Œä¸”æ»¡è¶³$\\Pi^D_L (v_i)$çš„ä»»æ„ä¸¤ä¸ªå…ƒç´ æ˜¯$v_i$çš„ä¸åŒå®šä¹‰å¤„å¼€å§‹çš„å®šä¹‰ä½¿ç”¨è·¯å¾„ï¼Œåˆ™æµ‹è¯•é›†åˆTçš„å…¨å®šä¹‰è¦†ç›–ç‡åˆ¤å®šè¦†ç›–åº¦ï¼š\n$\\frac{\\Sigma^m_{i=1} ||\\Pi^D_L (v_i)||}{\\Sigma^m_{i=1} ||def(v_i)||}âˆ— 100\\%ï¼Œmä¸ºç¨‹åºä¸­å˜é‡çš„ä¸ªæ•°$\n##### å…¨ä½¿ç”¨è¦†ç›–ï¼ˆAll Uses Coverageï¼‰\n- è¡¡é‡è¢«æµ‹ä»£ç ä¸­å˜é‡çš„æ¯ä¸ªä½¿ç”¨å¾—åˆ°æ‰§è¡Œçš„ç¨‹åº¦\n- å…¨ä½¿ç”¨è¦†ç›–çš„æ­£å¼å®šä¹‰ä¸ºï¼šæµ‹è¯•é›†åˆTæ»¡è¶³å…¨ä½¿ç”¨è¦†ç›–ï¼Œå½“ä¸”ä»…å½“å¯¹äºæ•°æ®æµå›¾ä¸­æ¯ä¸ªå˜é‡$v_i$çš„æ¯ä¸ªå®šä¹‰$d_j$çš„æ¯ä¸ªä½¿ç”¨$u_k$ï¼Œæ‰§è¡ŒTäº§ç”Ÿçš„å®Œæ•´è·¯å¾„é›†åˆLä¸­å­˜åœ¨ä¸€æ¡è·¯å¾„$l \\in L$çš„æŸä¸ªå­è·¯å¾„$\\pi$ï¼Œæ»¡è¶³$\\pi \\in du(d_j,u_k, v_i)$ã€‚è‹¥$use(v_i)$æ˜¯å˜é‡$v_i$åœ¨æ•°æ®æµå›¾ä¸­å®šä¹‰ä½¿ç”¨å¯¹çš„é›†åˆï¼Œ$\\Pi^U_L (v_i) = \\{\\pi | \\pi \\in du(d_j,u_k,v_i), \\pi æ˜¯l \\in Lçš„å­è·¯å¾„\\}$ï¼Œä¸”æ»¡è¶³$\\Pi^U_L (v_i)$çš„ä»»æ„ä¸¤ä¸ªå…ƒç´ æ˜¯$v_i$çš„ä¸åŒå®šä¹‰å¤„å¼€å§‹å’Œä½¿ç”¨å¤„ç»“æŸçš„å®šä¹‰ä½¿ç”¨è·¯å¾„ï¼Œåˆ™æµ‹è¯•é›†åˆTçš„å…¨ä½¿ç”¨è¦†ç›–ç‡ä¸ºï¼š\n$\\frac{\\Sigma^m_{i=1} ||\\Pi^U_L (v_i)||}{\\Sigma^m_{i=1} ||use(v_i)||}âˆ— 100\\%ï¼Œmä¸ºç¨‹åºä¸­å˜é‡çš„ä¸ªæ•°$\n##### å…¨å®šä¹‰ä½¿ç”¨è¦†ç›–ï¼ˆAll du path Coverageï¼‰\n- è¡¡é‡è¢«æµ‹ä»£ç ä¸­å˜é‡çš„æ¯æ¡å®šä¹‰ä½¿ç”¨è·¯å¾„å¾—åˆ°æ‰§è¡Œçš„ç¨‹åº¦ã€‚\n- å…¨å®šä¹‰ä½¿ç”¨è·¯å¾„è¦†ç›–çš„æ­£å¼å®šä¹‰ä¸ºï¼šæµ‹è¯•é›†åˆTæ»¡è¶³å…¨å®šä¹‰ä½¿ç”¨è·¯å¾„è¦†ç›–ï¼Œå½“ä¸”ä»…å½“å¯¹äºæ•°æ®æµå›¾ä¸­æ¯ä¸ªå˜é‡$v_i$çš„æ¯æ¡å®šä¹‰ä½¿ç”¨è·¯å¾„ï¼Œæ‰§è¡ŒTäº§ç”Ÿçš„å®Œæ•´è·¯å¾„é›†åˆLä¸­å­˜åœ¨ä¸€æ¡è·¯å¾„$l \\in L$çš„æŸä¸ªå­è·¯\nå¾„$\\pi$ï¼Œæ»¡è¶³$\\pi \\in du(v_i)$ã€‚è‹¥$du(v_i)$æ˜¯å˜é‡ğ‘£ğ‘–åœ¨æ•°æ®æµå›¾ä¸­å®šä¹‰ä½¿ç”¨è·¯å¾„é›†åˆï¼Œ$\\Pi_L (v_i) = \\{\\pi | \\pi \\in du(v_i), \\pi æ˜¯l \\in Lçš„å­è·¯å¾„\\}$ï¼Œåˆ™æµ‹è¯•\né›†åˆTçš„å…¨å®šä¹‰ä½¿ç”¨è·¯å¾„è¦†ç›–ç‡ä¸ºï¼š\n$\\frac{\\Sigma^m_{i=1} ||\\Pi_L (v_i)||}{\\Sigma^m_{i=1} ||du(v_i)||}âˆ— 100\\%ï¼Œmä¸ºç¨‹åºä¸­å˜é‡çš„ä¸ªæ•°$\n\n#### åŸºäºå˜å¼‚\nå˜å¼‚æµ‹è¯•æ˜¯é€šè¿‡åœ¨è¢«æµ‹å¯¹è±¡ä¸­å¼•å…¥é”™è¯¯å¹¶è®¡ç®—å‡ºå‘ç°çš„é”™è¯¯æ•°é‡æ¥**è¯„ä¼°æµ‹è¯•é›†çš„ç¼ºé™·æ£€æµ‹èƒ½åŠ›**ã€‚\n- **åº”è¯¥åœ¨ä»£ç ä¸­å¼•å…¥å“ªäº›ç±»å‹çš„bugï¼Ÿ**\n- å¦‚ä½•åœ¨ä»£ç ä¸­å¼•å…¥é”™è¯¯ï¼Ÿ\n- **å½“æˆ‘ä»¬è¯´å‘ç°ä¸€ä¸ªbugæ—¶ï¼Œæˆ‘ä»¬åº”è¯¥å‚è€ƒä»€ä¹ˆæ ‡å‡†ï¼Ÿ**\n- å¦‚ä½•è¡¨è¾¾ä¸€ä¸ªæµ‹è¯•é›†çš„ç¼ºé™·æ£€æµ‹èƒ½åŠ›ï¼Ÿ\n##### å¼ºæ€æ­»å˜å¼‚\nç»™å®šä¸€ä¸ªç¨‹åºPçš„å˜å¼‚ä½“$m \\in M$å’Œä¸€ä¸ªæµ‹è¯•tï¼Œå½“ä¸”ä»…å½“tåœ¨Pä¸Šçš„è¾“å‡ºä¸tåœ¨mçš„è¾“å‡ºä¸åŒæ—¶ï¼Œå°±è¯´tå¼ºæ€æ­»å˜å¼‚m\n###### å¼ºå˜å¼‚è¦†ç›–ï¼ˆSMCï¼‰\nå¯¹äºæ¯ä¸€ä¸ª$m \\in M$ï¼Œå¦‚æœä¸€ä¸ªæµ‹è¯•é›†èƒ½å¤Ÿå¼ºæ€æ­»mï¼Œé‚£ä¹ˆå…¶æ»¡è¶³SMC\n\nå¼ºæ€æ­»å˜å¼‚ä½“æ„å‘³ç€åœ¨æµ‹è¯•é›†ä¸­æœ‰ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹æ»¡è¶³å˜å¼‚ä½“çš„å¯è¾¾æ€§ã€æ„ŸæŸ“æ€§å’Œ**ä¼ æ’­æ€§**\n##### å¼±æ€æ­»å˜å¼‚\nç»™å®šä¸€ä¸ªç¨‹åºPçš„å˜å¼‚ä½“$m \\in M$å’Œä¸€ä¸ªæµ‹è¯•tï¼Œå½“ä¸”ä»…å½“tåœ¨Pä¸Šçš„æ‰§è¡ŒçŠ¶æ€ä¸tåœ¨mä¸Šçš„æ‰§è¡ŒçŠ¶æ€ä¸åŒæ—¶ï¼Œæˆ‘ä»¬ç§°tå¼±æ€æ­»å˜å¼‚m\n###### å¼±å˜å¼‚è¦†ç›–ï¼ˆWMCï¼‰\nå¯¹äºæ¯ä¸€ä¸ª$m \\in M$ï¼Œå¦‚æœä¸€ä¸ªæµ‹è¯•é›†èƒ½å¤Ÿå¼±æ€æ­»mï¼Œé‚£ä¹ˆå…¶æ»¡è¶³WMC\n\nå¼±æ€æ­»å˜å¼‚ä½“æ„å‘³ç€åœ¨æµ‹è¯•é›†ä¸­æœ‰ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹æ»¡è¶³å˜å¼‚ä½“çš„å¯è¾¾æ€§å’Œæ„ŸæŸ“æ€§ï¼Œä½†ä¸æ»¡è¶³**ä¼ æ’­æ€§**\n##### å˜å¼‚å¾—åˆ†\nMS(T) = |D|/(|L|+|D|)\n- |D|ï¼šè¢«æ€æ­»çš„å˜å¼‚ä½“çš„æ•°é‡\n- |L|ï¼šå­˜æ´»çš„å˜å¼‚ä½“çš„æ•°é‡\n## é¢å‘æ¥å£çš„åŠŸèƒ½æµ‹è¯•\n### æ¥å£æµ‹è¯•ä»‹ç»\n- å°†é€šè¿‡å•å…ƒæµ‹è¯•çš„ä»£ç å•å…ƒé€æ¸é›†æˆåœ¨ä¸€èµ·ç›´è‡³æ•´ä¸ªè½¯ä»¶ç³»ç»Ÿï¼Œä»¥éªŒè¯**å•å…ƒä¹‹é—´çš„æ¥å£äº¤äº’**æ˜¯å¦æ»¡è¶³éœ€æ±‚\n- æ¥å£ï¼šä¸åŒçš„ç³»ç»Ÿæˆ–è€…ä¸€ä¸ªç³»ç»Ÿä¸­ä¸åŒçš„ç»„ä»¶ä¹‹é—´ç›¸äº’äº¤äº’çš„éƒ¨åˆ†\n#### HTTPæ–¹æ³•\n|-|GET|POST|PUT|HEAD|DELETE|OPTIONS|CONNECT|PATCH|TRACE|\n|-|-|-|-|-|-|-|-|-|-|\n|è¯·æ±‚ä¿¡æ¯æ˜¯å¦æœ‰Bodyéƒ¨åˆ†|å¦|æ˜¯|æ˜¯|å¦|å¯ä»¥æœ‰|å¦|å¦|æ˜¯|å¦|\n|æˆåŠŸçš„å“åº”æ˜¯å¦å«æœ‰Body|æ˜¯|æ˜¯|å¦|å¦|å¯ä»¥æœ‰|å¦|å¦|å¦|å¦|\n|å®‰å…¨|æ˜¯|å¦|å¦|æ˜¯|å¦|æ˜¯|æ˜¯|å¦|å¦|\n|å¹‚ç­‰|æ˜¯|å¦|æ˜¯|æ˜¯|æ˜¯|æ˜¯|æ˜¯|å¦|æ˜¯|\n|ç¼“å­˜|æ˜¯|å¯èƒ½|å¦|æ˜¯|å¦|å¦|å¦|å¦|å¦|\n|æ˜¯å¦æ”¯æŒHTMLè¡¨å•|æ˜¯|æ˜¯|å¦|å¦|å¦|å¦|å¦|å¦|å¦|\n\n- å®‰å…¨ï¼šè¯·æ±‚ä¼šä¿®æ”¹æœåŠ¡å™¨èµ„æº\n- å¹‚ç­‰ï¼šå¯¹ä¸€ä¸ªè¯·æ±‚è€Œè¨€ï¼Œæ‰§è¡Œä¸€æ¬¡å’Œå¤šæ¬¡æ•ˆæœç›¸åŒ\n- ç¼“å­˜ï¼šç”¨ä»¥å‡å°‘è¯·æ±‚çš„å¤„ç†å’Œå“åº”æ—¶é—´(å¤§å“åº”); è¯·æ±‚åŒ…æ¶ˆæ¯å¤´çš„æ ‡å¤´ä¸€èˆ¬ä½¿ç”¨\né»˜è®¤å€¼ï¼Œå“åº”åŒ…æ¶ˆæ¯å¤´æ¶‰åŠ3ä¸ªæ ‡å¤´ï¼šCache-Controlï¼ŒEtagï¼ŒLast-Modified\n### æ¥å£æµ‹è¯•è®¾è®¡\n#### ç­‰ä»·åˆ’åˆ†\n- ç­‰ä»·åˆ’åˆ†æ˜¯ä¸€ç§ç»å…¸çš„åˆ†è€Œæ²»ä¹‹çš„æµ‹è¯•è®¾è®¡æ–¹æ³•\n-  å¯¹åˆ†æå¾—åˆ°çš„æ¯ä¸ªè¢«æµ‹å› ç´ çš„è¾“å…¥åŸŸä»¥é¢„æœŸç»“æœç›¸åŒä¸ºç­‰ä»·åˆ’åˆ†åŸåˆ™ï¼Œåˆ’åˆ†ä¸ºä¸åŒçš„ç­‰ä»·ç±»é›†åˆï¼Œåˆ’åˆ†éœ€æ»¡è¶³ï¼š\n   - åˆ’åˆ†è¦†ç›–æ•´ä¸ªå¾…æµ‹è¯•åŸŸ\n   - å„ä¸ªåˆ’åˆ†éƒ¨åˆ†ä¹‹é—´æ²¡æœ‰äº¤é›†\n   - ä»¥è¢«æµ‹å› ç´ çš„çº¦æŸä¸ºæ ‡å‡†ï¼Œåˆ’åˆ†éœ€åŒ…æ‹¬\n     - æœ‰æ•ˆç­‰ä»·ç±»ï¼šç¬¦åˆçº¦æŸçš„ç­‰ä»·ç±»\n     - æ— æ•ˆç­‰ä»·ç±»ï¼šä¸ç¬¦åˆçº¦æŸçš„æ‰€æœ‰å…¶å®ƒå¯èƒ½å­˜åœ¨çš„æƒ…å†µ\n\n##### ç­‰ä»·åˆ’åˆ†å¯å‘å¼è§„åˆ™\n- å¦‚æœæŸä¸ªè¾“å…¥æ¡ä»¶è§„å®šå€¼çš„èŒƒå›´ï¼Œå¯ä»¥ç¡®å®šä¸€ä¸ªæœ‰æ•ˆç­‰ä»·ç±»å’Œä¸¤ä¸ªæ— æ•ˆç­‰ä»·ç±»\n- å¦‚æœè¾“å…¥æ¡ä»¶è§„å®šäº†ä¸€ä¸ªè¾“å…¥å€¼çš„é›†åˆï¼Œå¯ä»¥ç¡®å®šä¸€ä¸ªæœ‰æ•ˆç­‰ä»·ç±»å’Œä¸€ä¸ªæ— æ•ˆç­‰ä»·ç±»\n- å¦‚æœè¾“å…¥æ¡ä»¶æ˜¯ä¸€ä¸ªå¸ƒå°”è¡¨è¾¾å¼çš„æ¡ä»¶ï¼Œå¯ä»¥ç¡®å®šä¸€ä¸ªæœ‰æ•ˆç­‰ä»·ç±»å’Œä¸€ä¸ªæ— æ•ˆç­‰ä»·ç±»\n- å¦‚æœè¾“å…¥æ¡ä»¶å®šä¹‰äº†ä¸€ä¸ªâ€œå¿…é¡»â€çš„æƒ…å†µï¼Œæ¯”å¦‚â€æ ‡è¯†çš„ç¬¬ä¸€å­—ç¬¦å¿…é¡»æ˜¯å­—æ¯â€é‚£ä¹ˆå¯ä»¥ç¡®å®šä¸€ä¸ªæœ‰æ•ˆç­‰ä»·ç±»å’Œä¸€ä¸ªæ— æ•ˆç­‰ä»·ç±»\n- å¦‚æœæœ‰ç†ç”±ç¡®ä¿¡ï¼ŒæŸä¸€ç­‰ä»·ç±»ä¸­çš„å„å…ƒç´ åœ¨ç¨‹åºä¸­çš„å¤„ç†æœ‰åŒºåˆ«ï¼Œé‚£å°±æŠŠè¿™ä¸ªç­‰ä»·ç±»åˆ†æˆæ›´å°çš„ç­‰ä»·ç±»\n##### ç­‰ä»·åˆ’åˆ†ç»„åˆ\n- å¼±ä¸€èˆ¬ç­‰ä»·ç±»\n  - åªè€ƒè™‘æµ‹è¯•å› ç´ çš„æœ‰æ•ˆç­‰ä»·ç±»\n  - è¦æ±‚æ¯ä¸ªæµ‹è¯•å› ç´ çš„**æ¯ä¸ªæœ‰æ•ˆç­‰ä»·ç±»å‡ºç°ä¸€æ¬¡**\n- å¼ºä¸€èˆ¬ç­‰ä»·ç±»\n  - åªè€ƒè™‘æµ‹è¯•å› ç´ çš„æœ‰æ•ˆç­‰ä»·ç±»\n  - è¦æ±‚æµ‹è¯•æµ‹è¯•å› ç´ çš„**æœ‰æ•ˆç­‰ä»·ç±»çš„å…¨ç»„åˆ**\n- å¼±å¥å£®ç­‰ä»·ç±»\n  - å³è€ƒè™‘æœ‰æ•ˆä¹Ÿè€ƒè™‘æ— æ•ˆç­‰ä»·ç±»\n  - å¯¹äºæœ‰æ•ˆç­‰ä»·ç±»ï¼Œæ¯ä¸ªæµ‹è¯•å› ç´ çš„**æ¯ä¸ªæœ‰æ•ˆç­‰ä»·ç±»å‡ºç°ä¸€æ¬¡**\n  - å¯¹äºæ— æ•ˆç­‰ä»·ç±»ï¼Œè¦æ±‚æ¯æ¬¡ç»„åˆè€ƒè™‘**ä¸€ä¸ªæµ‹è¯•å› ç´ çš„ä¸€ä¸ªæ— æ•ˆç­‰ä»·ç±»ï¼Œå…¶ä½™æµ‹è¯•å› ç´ ä½¿ç”¨æœ‰æ•ˆç­‰ä»·ç±»**\n- å¼ºå¥å£®ç­‰ä»·ç±»\n  - å³è€ƒè™‘æœ‰æ•ˆä¹Ÿè€ƒè™‘æ— æ•ˆç­‰ä»·ç±»\n  - è¦æ±‚æµ‹è¯•å› ç´ çš„**ç­‰ä»·ç±»çš„å…¨ç»„åˆ**\n#### è¾¹ç•Œæµ‹è¯•\n- è¾¹ç•Œå€¼ï¼šä»»ä½•å€¼å¾—æµ‹è¯•çš„èŒƒå›´çš„ä¸´ç•Œç‚¹ï¼Œ**é€šå¸¸æŒ‡ç­‰ä»·ç±»çš„è¾¹ç•Œ**ï¼Œå¯åˆ†ä¸º\n  - è¾¹ç•Œå€¼ï¼šæ˜ç¡®åœ°å®šä¹‰åœ¨è§„æ ¼è¯´æ˜ä¹¦ä¸­\n  - æ¬¡è¾¹ç•Œï¼šéšå«åœ¨è½¯ä»¶ä¸­å¿…é¡»ç»è¿‡åˆ†ææ‰èƒ½è·å¾—\n  - ä»…ç‰©ç†é‡é€‚ç”¨ï¼Œé€»è¾‘å˜é‡æ…é‡\n- æµ‹è¯•è®¾è®¡æ€æƒ³\n  - å–è¾¹ç•Œç‚¹é™„è¿‘çš„å€¼ä½œä¸ºæµ‹è¯•ç”¨ä¾‹çš„è¾“å…¥ï¼Œå¯å‚è€ƒå¦‚ä¸‹çš„è®¾è®¡åŸåˆ™\n  - å¦‚æœè¾“å…¥æ¡ä»¶å®šä¹‰äº†æ•°å€¼åŒºé—´(a,b)ï¼Œé‚£ä¹ˆæµ‹è¯•ç”¨ä¾‹åº”åŒ…æ‹¬aã€bã€ç¨å¾®æ¯”aå¤§ã€ç¨å¾®æ¯”bå¤§ã€ç¨å¾®æ¯”aå°å’Œç¨å¾®æ¯”bå°ç­‰å‡ ç§æƒ…å†µ\n\nä»ç†è®ºä¸Šæ¥è¯´ï¼Œè¾¹ç•Œå€¼å¯åˆ†ä¸º\n- ä»…è€ƒè™‘æœ‰æ•ˆåŒºé—´å•ä¸ªå˜é‡è¾¹ç•Œå€¼ï¼ˆ**ä¸€èˆ¬è¾¹ç•Œå€¼**ï¼‰ï¼šç”¨åœ¨æœ€å°å€¼ï¼Œç•¥é«˜äºæœ€å°å€¼ï¼Œæ­£å¸¸å€¼ï¼Œç•¥ä½äºæœ€å¤§å€¼å’Œæœ€å¤§å€¼å¤„å–å˜é‡çš„å€¼ã€‚å¦‚æœè¢«æµ‹å˜é‡ä¸ªæ•°ä¸ºnï¼Œåˆ™æµ‹è¯•ç”¨ä¾‹ä¸ªæ•°ä¸º4n+1\n- ä»…è€ƒè™‘æœ‰æ•ˆåŒºé—´å¤šä¸ªå˜é‡è¾¹ç•Œå€¼åŒæ—¶ä½œç”¨ï¼ˆ**ä¸€èˆ¬æœ€åæƒ…å†µè¾¹ç•Œå€¼**ï¼‰ï¼šç”¨å„ä¸ªå˜é‡çš„æœ€å°å€¼ï¼Œç•¥é«˜äºæœ€å°å€¼ï¼Œæ­£å¸¸å€¼ï¼Œç•¥ä½äºæœ€å¤§å€¼å’Œæœ€å¤§å€¼çš„ç¬›å¡å°”ç§¯é›†ã€‚å¦‚æœè¢«æµ‹å˜é‡ä¸ªæ•°ä¸ºnï¼Œåˆ™æµ‹è¯•ç”¨ä¾‹ä¸ªæ•°ä¸º5n\n- åŒæ—¶è€ƒè™‘æœ‰æ•ˆåŒºé—´å’Œæ— æ•ˆåŒºé—´å•ä¸ªå˜é‡è¾¹ç•Œå€¼ï¼ˆ**å¥å£®è¾¹ç•Œå€¼**ï¼‰ï¼šé™¤äº†åœ¨æœ€å°å€¼ï¼Œç•¥é«˜äºæœ€å°å€¼ï¼Œæ­£å¸¸å€¼ï¼Œç•¥ä½äºæœ€å¤§å€¼å’Œæœ€å¤§å€¼å¤„å–å˜é‡çš„å€¼ï¼Œè¿˜è¦åœ¨ç•¥è¶…è¿‡æœ€å¤§å€¼ä»¥åŠç•¥å°äºæœ€å°å€¼ä¹‹å¤„å€¼ã€‚å¦‚æœè¢«æµ‹å˜é‡ä¸ªæ•°ä¸ºnï¼Œåˆ™æµ‹è¯•ç”¨ä¾‹ä¸ªæ•°ä¸º6n+1\n- åŒæ—¶è€ƒè™‘æœ‰æ•ˆåŒºé—´å’Œæ— æ•ˆåŒºé—´å¤šä¸ªå˜é‡è¾¹ç•Œå€¼åŒæ—¶ä½œç”¨ï¼ˆ**å¥å£®æœ€åæƒ…å†µè¾¹ç•Œå€¼**ï¼‰ï¼šç”¨å„ä¸ªå˜é‡çš„ç•¥å°äºæœ€å°å€¼ï¼Œæœ€å°å€¼ï¼Œç•¥é«˜äºæœ€å°å€¼ï¼Œæ­£å¸¸å€¼ï¼Œç•¥ä½äºæœ€å¤§å€¼ï¼Œæœ€å¤§å€¼å’Œç•¥è¶…è¿‡å¤§å€¼çš„å®Œå…¨ç»„åˆã€‚å¦‚æœè¢«æµ‹å˜é‡ä¸ªæ•°ä¸ºnï¼Œåˆ™æµ‹è¯•ç”¨ä¾‹ä¸ªæ•°ä¸º7n\n## é¢å‘ç³»ç»Ÿçš„åŠŸèƒ½æµ‹è¯•\næµ‹è¯•çº§åˆ«æœ€é«˜çš„ä¸€ç§æµ‹è¯•æ´»åŠ¨ï¼Œæ˜¯å°†å·²ç»é›†æˆå¥½çš„è½¯ä»¶ç³»ç»Ÿï¼Œä½œä¸ºæ•´ä¸ªåŸºäºè®¡ç®—æœºç³»ç»Ÿçš„ä¸€ä¸ªå…ƒç´ ï¼Œä¸è®¡ç®—æœºç¡¬ä»¶ã€å¤–è®¾ã€æŸäº›æ”¯æŒè½¯ä»¶ã€æ•°æ®å’Œäººå‘˜ç­‰å…¶å®ƒç³»ç»Ÿå…ƒç´ ç»“åˆåœ¨ä¸€èµ·ï¼Œ åœ¨å®é™…è¿è¡Œï¼ˆä½¿ç”¨ï¼‰ç¯å¢ƒä¸‹ï¼Œå¯¹è®¡ç®—æœºç³»ç»Ÿè¿›è¡Œä¸€ç³»åˆ—çš„ç»„è£…æµ‹è¯•å’Œç¡®è®¤æµ‹è¯•\n- ç³»ç»Ÿæµ‹è¯•çš„å¯¹è±¡ä¸ä»…åŒ…æ‹¬è½¯ä»¶ï¼Œè¿˜åŒ…æ‹¬ç³»ç»Ÿè½¯ä»¶æ‰€ä¾èµ–çš„ç¡¬ä»¶ã€å¤–éƒ¨è®¾å¤‡å’Œå„ç±»æ¥å£ï¼Œå…¶ç›®çš„åœ¨äºé€šè¿‡ä¸ç³»ç»Ÿçš„éœ€æ±‚å®šä¹‰ä½œæ¯”è¾ƒï¼Œå‘ç°è½¯ä»¶ä¸ç³»ç»Ÿå®šä¹‰ä¸ç¬¦åˆæˆ–ä¸ä¹‹çŸ›ç›¾çš„åœ°æ–¹ä»¥åŠç³»ç»Ÿå„ä¸ªéƒ¨åˆ†æ˜¯å¦å¯ä»¥åè°ƒå·¥ä½œ\n- ç³»ç»Ÿæµ‹è¯•åˆ†ä¸ºä¸¤å¤§ç±»åˆ«\n  - åŠŸèƒ½æµ‹è¯•\n  - éåŠŸèƒ½æµ‹è¯•\n### åŠŸèƒ½æµ‹è¯•ç”¨ä¾‹è®¾è®¡\n#### è¾“å…¥åŸŸåˆ’åˆ†\n##### è¾“å…¥åŸŸ\nä¸€ä¸ªè¾“å…¥åŸŸåˆ†ç±»å¿…é¡»æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ€§è´¨ï¼š\n- è¦†ç›–æ•´ä¸ªè¾“å…¥åŸŸï¼ˆå®Œå¤‡æ€§ï¼‰\n- åˆ†ç±»ä¹‹é—´æ²¡æœ‰é‡å ï¼ˆç‹¬ç‰¹æ€§ï¼‰\n##### è¾“å…¥åŸŸå»ºæ¨¡\n- è¯†åˆ«å¾…æµ‹å› ç´ \n- æ‰¾åˆ°å¾…æµ‹ç‰¹å¾\n- åˆ’åˆ†å¾…æµ‹ç‰¹å¾\n##### è¾“å…¥åŸŸç»„åˆç­–ç•¥\n- ACoCå…¨ç»„åˆå€¼è¦†ç›–\n  - å¿…é¡»ä½¿ç”¨æ‰€æœ‰ç‰¹å¾ä¸­çš„æ‰€æœ‰ç‰¹å¾å—ç»„åˆ\n  - æ•°é‡ï¼š$\\Pi^Q_{i=1}|B_i|$\n- ECCå•å€¼è¦†ç›–\n  - æ¯ä¸ªç‰¹å¾å—çš„ä¸€ä¸ªå€¼å¿…é¡»è‡³å°‘ç”¨äºä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹ä¸­\n  - æ•°é‡ï¼š$Max^Q_{i=1}|B_i|$\n- PWCå…¨å¯¹å¶å€¼è¦†ç›–\n  - æ¯ä¸ªç‰¹å¾çš„æ¯ä¸ªå—çš„å€¼å¿…é¡»ä¸æ¯ä¸ªå…¶ä»–ç‰¹å¾çš„æ¯ä¸ªå—çš„å€¼ç›¸ç»“åˆ\n  - æ•°é‡ï¼š$(Max^Q_{i=1}|B_i|)*(Max^Q_{j=1,j\\neq i}|B_j|)$\n- TWCå…¨Tå€¼è¦†ç›–\n  - å…¨å¯¹å¶è¦†ç›–çš„æ‹“å±•ã€‚éœ€è¦†ç›–åˆ°tä¸ªå¾…æµ‹ç‰¹å¾ä¹‹é—´çš„å…³ç³»\n- BCCåŸºæœ¬å€¼è¦†ç›–\n  - åŸºæœ¬å€¼ï¼šæŸä¸ªå¾…æµ‹ç‰¹å¾æ‰€æœ‰è¾“å…¥åŸŸåˆ’åˆ†å–å€¼ä¸­ï¼Œä½¿ç”¨é¢‘ç‡æœ€é«˜çš„é‚£ä¸ªå–å€¼\n  - ä¸€æ¬¡é’ˆå¯¹ä¸€ä¸ªè¢«æµ‹ç‰¹å¾ï¼Œç”¨å…¶éåŸºæœ¬å€¼æ›¿ä»£åŸºæœ¬å€¼ï¼Œå…¶ä½™è¢«æµ‹ç‰¹å¾ä»å–åŸºæœ¬å€¼\n  - æ•°é‡ï¼š$1+\\sum^Q_{i=1}(B_i-1)$\n- MBCCå¤šåŸºæœ¬å€¼è¦†ç›–\n  - å¦‚æœå¾…æµ‹ç‰¹å¾æœ‰å¤šä¸ªåŸºæœ¬å€¼ï¼Œé‚£ä¹ˆå°±è¦è¦†ç›–åˆ°æ‰€æœ‰åŸºæœ¬å€¼ï¼Œå…¶ä½™ä»ç„¶æ˜¯å¯¹æ¯ä¸ªå¾…æµ‹ç‰¹å¾å–éåŸºæœ¬å€¼\n#### å†³ç­–è¡¨\nç”±å››ä¸ªåŒºåŸŸç»„æˆï¼š\n- condition stubï¼šæ¡ä»¶åç§°åˆ—è¡¨\n- action stubï¼šå¦‚æœè§„åˆ™å¾—åˆ°æ»¡è¶³ï¼Œä¾‹ç¨‹å°†é‡‡å–æˆ–å¯åŠ¨çš„åŠ¨ä½œ\n- condition entryï¼šæ¡ä»¶çš„ç»„åˆ\n- action entryï¼šåœ¨æ¡ä»¶ç»„åˆä¸‹é‡‡å–çš„è¡ŒåŠ¨\n\nè¡¨ä¸­çš„æ¯ä¸€åˆ—éƒ½æ˜¯ä¸€æ¡è§„åˆ™ï¼Œå®ƒè§„å®šäº†action stubä¸­æŒ‡å®šçš„è¡ŒåŠ¨å°†åœ¨å“ªäº›æ¡ä»¶ä¸‹å‘ç”Ÿ\nä¸€ä¸ªè§„åˆ™å°±æ˜¯ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹\n#### æ­£äº¤å®éªŒæ³•\nä»å¤§é‡çš„å®éªŒç‚¹ä¸­æŒ‘é€‰å‡ºé€‚é‡çš„ã€æœ‰ä»£è¡¨æ€§çš„ç‚¹ï¼Œä¾æ®ç›¸åº”çš„æ­£äº¤è¡¨ï¼Œåˆç†åœ°å®‰æ’å®éªŒçš„ä¸€ç§ç§‘å­¦çš„å®éªŒè®¾è®¡æ–¹æ³•\n\n- å› å­ï¼šæœ‰å¯èƒ½å½±å“å®éªŒæŒ‡æ ‡çš„æ¡ä»¶\n- å› å­çš„æ°´å¹³ï¼ˆæˆ–çŠ¶æ€ï¼‰ï¼šå½±å“å®éªŒå› å­çš„å› ç´ ï¼Œåœ¨æ­£äº¤è¡¨ä¸­ç”¨â€œ0-æ°´å¹³æ•°-1â€æˆ–â€œ1-æ°´å¹³æ•°â€è¡¨ç¤º\n- æ­£äº¤è¡¨ï¼šè®°ä¸ºLæ¬¡æ•°ï¼ˆæ°´å¹³æ•°å› å­æ•°ï¼‰ï¼Œ ä¾‹å¦‚$L_8(4^1 \\times 2^4)$è¡¨ç¤ºå®éªŒæ¬¡\næ•°ä¸º8ï¼Œ1ä¸ª4æ°´å¹³çš„å› å­ï¼Œ4ä¸ª2æ°´å¹³çš„å› å­\n\n##### æµ‹è¯•æ€æƒ³\n- æ ¹æ®è¢«æµ‹è½¯ä»¶çš„è§„æ ¼è¯´æ˜ä¹¦æ‰¾å‡ºå½±å“å…¶åŠŸèƒ½å®ç°çš„æ“ä½œå¯¹è±¡å’Œå¤–éƒ¨å› ç´ ï¼ŒæŠŠå®ƒä»¬å½“ä½œå› å­ï¼Œè€ŒæŠŠå„ä¸ªå› å­çš„å–å€¼å½“ä½œçŠ¶æ€ï¼Œæ„é€ å‡ºäºŒå…ƒçš„å› ç´ åˆ†æè¡¨ï¼›ç„¶åï¼Œåˆ©ç”¨æ­£äº¤è¡¨è¿›è¡Œå„å› å­çš„çŠ¶æ€ç»„åˆï¼Œæ„é€ æœ‰æ•ˆçš„æµ‹è¯•è¾“å…¥æ•°æ®é›†\n  - æ­£äº¤è¡¨çš„å› å­å¯¹åº”è¢«æµ‹å¯¹è±¡çš„æµ‹è¯•å› ç´ \n  - å› å­çš„æ°´å¹³å¯ä»¥çœ‹æˆæ˜¯å„æµ‹è¯•å› ç´ çš„å–å€¼\n#### åœºæ™¯æ³•\n\n### åŠŸèƒ½æµ‹è¯•ç”¨ä¾‹å®ç°\n#### Automata Theoretic Approach\nW methodï¼šç”¨äºç»™å®šä¸€ä¸ªFSMä½œä¸ºè¾“å…¥ï¼Œå¯ä»¥æ±‚å‡ºèƒ½æ­é”™è¯¥FSMçš„æ‰€æœ‰è¾“å…¥åºåˆ—\n#### Control Theoretic Approach\nCoverage Based Method\n## é¢å‘ç³»ç»Ÿçš„éåŠŸèƒ½æµ‹è¯•\n### æ€§èƒ½æµ‹è¯•\n#### æ€§èƒ½æµ‹è¯•åŸºç¡€\n##### ç”¨æˆ·å…³æ³¨çš„æ€§èƒ½\n- è½¯ä»¶å¯¹ç”¨æˆ·æ“ä½œçš„å“åº”æ—¶é—´ï¼Œå³ä»å•å‡»ä¸€ä¸ªæŒ‰é’®ã€ä¸€ä¸ªé“¾æ¥å¼€å§‹ï¼Œåˆ°åº”ç”¨ç³»ç»ŸæŠŠæœ¬æ¬¡æ“ä½œçš„ç»“æœä»¥ç”¨æˆ·èƒ½å¯Ÿè§‰çš„æ–¹å¼å±•ç¤ºå‡ºæ¥çš„è¿‡ç¨‹æ‰€è€—è´¹çš„æ—¶é—´\n- ç”¨æˆ·æ‰€æ„Ÿå—åˆ°çš„å“åº”æ—¶é—´æ—¢åŒ…æ‹¬å®¢è§‚æˆåˆ†ï¼Œä¹ŸåŒ…æ‹¬ä¸»è§‚æˆåˆ†\n\n##### ç³»ç»Ÿç®¡ç†å‘˜å…³æ³¨çš„æ€§èƒ½\n- ä¸€ç±»ç‰¹æ®Šçš„ç”¨æˆ·ï¼ŒåŒæ ·å…³å¿ƒå“åº”æ—¶é—´\n- ä¸ç³»ç»Ÿèµ„æºçŠ¶æ€ç›¸å…³çš„ä¿¡æ¯\n- ä¸ç³»ç»Ÿçš„å¯æ‰©å±•æ€§ã€å¹¶å‘èƒ½åŠ›ã€æœ€å¤§å®¹é‡ç›¸å…³çš„ä¿¡æ¯\n\n##### å¼€å‘äººå‘˜å…³æ³¨çš„æ€§èƒ½\n- åŒæ ·å…³å¿ƒå“åº”æ—¶é—´ï¼Œä¹ŸåŒæ ·å…³ç³»ç®¡ç†å‘˜æ€§èƒ½\n- æœ€å…³æ³¨çš„æ˜¯ä½¿æ€§èƒ½è¡¨ç°ä¸ä½³çš„å› ç´ å’Œç”±äºå¤§é‡ç”¨æˆ·è®¿é—®å¼•å‘çš„è½¯ä»¶æ•…éšœ\n\n##### Webå‰ç«¯æ€§èƒ½\n- è€ƒå¯Ÿçš„ä¸»è¦æ˜¯æµè§ˆå™¨çš„å±•ç°å’Œè„šæœ¬æ‰§è¡Œæ—¶é—´ï¼Œä¸æœåŠ¡å™¨æœ¬èº«å¹¶æ— å¤ªå¤§çš„å…³ç³»ï¼Œä¹Ÿä¸å¹¶å‘ç”¨æˆ·é‡çš„å¤§å°å¹¶æ— éå¸¸ç›´æ¥çš„å…³ç³»\n- Webåº”ç”¨çš„å‰ç«¯å“åº”æ—¶é—´æŒ‡**æµè§ˆå™¨çš„é¡µé¢åŠ è½½æ—¶é—´**\n  - æµè§ˆå™¨çš„é¡µé¢åŠ è½½æ—¶é—´ï¼šåŒ…æ‹¬HTMLçš„è§£æã€å¯¹é¡µé¢ä¸Šçš„å›¾ç‰‡åŠCSSç­‰æ–‡ä»¶çš„è·å–å’ŒåŠ è½½ã€å®¢æˆ·ç«¯è„šæœ¬Javascriptçš„æ‰§è¡Œæ—¶é—´ä»¥åŠå¯¹é¡µé¢è¿›è¡Œå±•ç¤ºæ‰€èŠ±è´¹çš„æ—¶é—´\n  - **æ€§èƒ½é»„é‡‘æ³•åˆ™**ï¼šåªæœ‰10%-20%çš„æœ€ç»ˆç”¨æˆ·å“åº”æ—¶é—´è€—è´¹åœ¨ä¸‹è½½HTMLæ–‡æ¡£ä¸Šï¼Œå…¶ä½™çš„80-90%è€—è´¹åœ¨äº†ä¸‹è½½é¡µé¢ä¸­çš„æ‰€æœ‰ç»„ä»¶ä¸Š\n  - é«˜æ€§èƒ½å‰ç«¯ï¼šå¦‚ä½•æé«˜æµè§ˆå™¨ä¸‹è½½å’Œæ‰§è¡Œèµ„æºçš„å¹¶å‘æ€§ï¼Œå¦‚ä½•è®©æµè§ˆå™¨å°½å¿«å¼€å§‹æ¸²æŸ“é¡µé¢ï¼Œå¦‚ä½•è®©æµè§ˆå™¨å°½å¯èƒ½å……åˆ†åœ°åˆ©ç”¨ç¼“å­˜ç­‰é—®é¢˜æ˜¯å‰ç«¯æ€§èƒ½å…³æ³¨çš„ä¸»è¦é—®é¢˜\n#### æ€§èƒ½æµ‹è¯•åˆ†ç±»\n##### å¸¸è§„çš„æ€§èƒ½æµ‹è¯•\n- æ­£å¸¸æ¡ä»¶ä¸‹è¿›è¡Œçš„æµ‹è¯•ï¼Œä¸»è¦æµ‹è¯•æ­£å¸¸ä½¿ç”¨æ—¶ç³»ç»Ÿæ˜¯å¦æ»¡è¶³è¦æ±‚ï¼ŒåŒæ—¶å¯èƒ½ä¸ºäº†ä¿ç•™ç³»ç»Ÿçš„æ‰©å±•ç©ºé—´è€Œè¿›è¡Œä¸€äº›ç¨ç¨è¶…å‡ºâ€œæ­£å¸¸â€èŒƒå›´çš„æµ‹è¯•ã€‚\n##### å‹åŠ›æµ‹è¯•\n- åœ¨é«˜è´Ÿè½½ä¸‹æˆ–æé™è´Ÿè½½ä¸‹çš„æµ‹è¯•ï¼Œæ›´ä¾§é‡äºç¡®å®šåœ¨ä»€ä¹ˆè´Ÿè½½æ¡ä»¶ä¸‹ç³»ç»Ÿæ€§èƒ½å¤„äºå¤±æ•ˆçŠ¶æ€å¹¶ä»¥æ­¤æ¥è·å¾—ç³»ç»Ÿèƒ½æä¾›çš„æœ€å¤§æœåŠ¡çº§åˆ«çš„æµ‹è¯•\n- å…¶ç›®çš„åœ¨äºå‘ç°åœ¨ä»€ä¹ˆæ¡ä»¶ä¸‹ç³»ç»Ÿçš„æ€§èƒ½ä¼šå˜å¾—ä¸å¯æ¥å—\n##### å³°å€¼æµ‹è¯•\n- æµ‹è¯•ç³»ç»Ÿåœ¨é«˜å³°äº¤æ˜“æ—¶æ®µçš„æ€§èƒ½\n##### å®¹é‡æµ‹è¯•\n- é€šè¿‡ä¸æ–­å¢åŠ è´Ÿè½½ç›´è‡³ç³»ç»Ÿå´©æºƒï¼Œç¡®å®šç³»ç»Ÿèƒ½å¤Ÿæ­£å¸¸è¿è¡Œçš„æœ€å¤§è´Ÿè½½\n##### å¼ºåº¦æµ‹è¯•\n- è¿«ä½¿ç³»ç»Ÿåœ¨å¼‚å¸¸çš„èµ„æºé…ç½®ä¸‹è¿è¡Œä»¥æ£€æŸ¥ç¨‹åºå¯¹å¼‚å¸¸æƒ…å†µçš„æŠµæŠ—èƒ½åŠ›ï¼Œåˆ¤æ–­ç³»ç»Ÿçš„ç¨³å®šæ€§ä»¥åŠç³»ç»Ÿæœªæ¥çš„æ‰©å±•ç©ºé—´ï¼Œä¾‹\n- è¿è¡ŒCPUä½¿ç”¨ç‡åœ¨90%å·¦å³æ—¶ä»¥ä¸Šçš„åœºæ™¯\n- æ­£å¸¸å‹åŠ›ä¸ºç‚¹å‡»ç‡â€œ1000/sâ€ï¼Œé‚£ä¹ˆæµ‹è¯•â€œ2000/sâ€\n##### ç–²åŠ³æµ‹è¯•\n- è¿ç»­é•¿æ—¶é—´çš„æ€§èƒ½æµ‹è¯•ï¼Œå‘ç°å†…å­˜æ³„æ¼ç­‰é—®é¢˜","tags":["æµ‹è¯•"],"categories":["è®¡è½¯æ‚è°ˆ","å­¦ä¹ ç¬”è®°"]},{"title":"å¹¶è¡Œç¨‹åºè®¾è®¡ å­¦ä¹ ç¬”è®°","url":"/20230128/parallel-programming-design/","content":"## intro\nå¹¶è¡Œè®¡ç®—:\n- è¡¨ç¤ºä¸€ä¸ªç³»ç»Ÿå…·æœ‰å¤šä¸ªå¤„ç†å™¨, æ‰€æœ‰å¤„ç†å™¨å¯ä»¥è®¿é—®å…±äº«å­˜å‚¨å™¨ä»¥äº¤æ¢ä¿¡æ¯ï¼Œé€šä¿¡å¼€é”€ä½\n\nåˆ†å¸ƒå¼è®¡ç®—:\n- æ¯ä¸ªç³»ç»Ÿå…·æœ‰è‡ªå·±çš„å­˜å‚¨å™¨ï¼Œå¹¶é€šè¿‡ç½‘ç»œå°†å¤šä¸ªç³»ç»Ÿè¿é€šï¼Œç³»ç»Ÿé—´é€šè¿‡æ¶ˆæ¯ä¼ é€’çš„æ–¹å¼äº¤æ¢ä¿¡æ¯ï¼Œé€šä¿¡å¼€é”€é«˜\n\nAmdahlå®šå¾‹\n- åŠ é€Ÿæ¯” $S =\\frac{1}{(1 â€“ a + a/n)}$\n- $a$ï¼šå¯å¹¶è¡Œè®¡ç®—éƒ¨åˆ†çš„å æ¯”\n- $n$ï¼šå¹¶è¡Œå¤„ç†èŠ‚ç‚¹ä¸ªæ•°\n### å¹¶è¡Œå¼€é”€\nå¯»æ‰¾åˆ°è¶³å¤Ÿå¤šçš„å¹¶è¡Œä»»åŠ¡ï¼Œæ˜¯å®ç°é¢„æœŸåŠ é€Ÿçš„æœ€å¤§éšœç¢\nå¹¶è¡Œå¼€é”€åŒ…æ‹¬ï¼š\n- å¯åŠ¨çº¿ç¨‹æˆ–è¿›ç¨‹çš„æˆæœ¬  \n- å…±äº«æ•°æ®çš„é€šä¿¡æˆæœ¬  \n- åŒæ­¥çš„æˆæœ¬  \n- é¢å¤–çš„(å†—ä½™)è®¡ç®—\n\nåœ¨æŸäº›ç³»ç»Ÿä¸Šï¼Œæ¯ä¸€ç§å¼€é”€éƒ½å¯èƒ½æ˜¯æ¯«ç§’çº§(æ•°ç™¾ä¸‡æ¬¡æµ®ç‚¹è¿ç®—)ã€‚\næƒè¡¡ï¼šç®—æ³•éœ€è¦è¶³å¤Ÿå¤§çš„å·¥ä½œé›†(å³å¤§ç²’åº¦)ä»¥å¿«é€Ÿçš„å¹¶è¡Œè¿è¡Œï¼Œä½†åˆä¸èƒ½å¤ªå¤§ä»¥è‡³äºæ²¡æœ‰è¶³å¤Ÿçš„å¹¶è¡Œä»»åŠ¡\n\n## FP\n### å¹¶è¡Œè®¡ç®—æœºä½“ç³»ç»“æ„\n- å•æŒ‡ä»¤å¤šæ•°æ®æµæœºSIMDï¼ˆSingle-Instruction Multiple-Dataï¼‰\n- å¹¶è¡Œå‘é‡å¤„ç†æœºPVPï¼ˆParallel Vector Processorï¼‰\n- å¯¹ç§°å¤šå¤„ç†æœºSMPï¼ˆSymmetric Multiprocessorï¼‰\n- å¤§è§„æ¨¡å¹¶è¡Œå¤„ç†æœºMPP (Massively Parallel Processor)\n- å·¥ä½œç«™æœºç¾¤COW (Cluster of Workstation)\n- åˆ†å¸ƒå¼å…±äº«å­˜å‚¨DSM (Distributed Shared Memory) å¤šå¤„ç†æœº\n\n|å±æ€§|PVP|SMP|MPP|DSM|COW|\n|-|-|-|-|-|-|\n|ç»“æ„ç±»å‹|MIMD|MIMD|MIMD|MIMD|MIMD|\n|å¤„ç†å™¨ç±»å‹|ä¸“ç”¨å®šåˆ¶|å•†ç”¨|å•†ç”¨|å•†ç”¨|å•†ç”¨|\n|äº’è”ç½‘ç»œ|å®šåˆ¶äº¤å‰å¼€å…³|æ€»çº¿ã€äº¤å‰å¼€å…³|å®šåˆ¶ç½‘ç»œ|å®šåˆ¶ç½‘ç»œ|å•†ç”¨ç½‘ç»œä»¥å¤ªã€ATM|\n|é€šä¿¡æœºåˆ¶|å…±äº«å˜é‡|å…±äº«å˜é‡|æ¶ˆæ¯ä¼ é€’|å…±äº«å˜é‡|ä¿¡æ¯ä¼ é€’|\n|åœ°å€ç©ºé—´|å•åœ°å€ç©ºé—´|å•åœ°å€ç©ºé—´|å¤šåœ°å€ç©ºé—´|å•åœ°å€ç©ºé—´|å¤šåœ°å€ç©ºé—´|\n|ç³»ç»Ÿå­˜å‚¨å™¨|é›†ä¸­å…±äº«|é›†ä¸­å…±äº«|åˆ†å¸ƒéå…±äº«|åˆ†å¸ƒå…±äº«|åˆ†å¸ƒéå…±äº«|\n|è®¿é—®æ¨¡å‹|UMA|UMA|NORMA|NUMA|NORMA|\n\n- å‡åŒ€å­˜å‚¨è®¿é—®æ¨¡å‹ï¼ UMA\n- éå‡åŒ€å­˜å‚¨è®¿é—®æ¨¡å‹ï¼ NUMA\n- å…¨é«˜é€Ÿç¼“å­˜è®¿é—®æ¨¡å‹ï¼COMA\n- é«˜é€Ÿç¼“å­˜ä¸€è‡´æ€§éå‡åŒ€å­˜å‚¨è®¿é—®æ¨¡å‹ï¼CC-NUMA\n- éè¿œç¨‹å­˜å‚¨è®¿é—®æ¨¡å‹ï¼NORMA\n\n#### UMAè®¿å­˜æ¨¡å‹\nUMAï¼ˆUniform Memory Accessï¼‰æ¨¡å‹æ˜¯å‡åŒ€å­˜å‚¨è®¿é—®æ¨¡å‹çš„ç®€ç§°ã€‚å…¶ç‰¹ç‚¹æ˜¯ï¼š\n- ç‰©ç†å­˜å‚¨å™¨è¢«æ‰€æœ‰å¤„ç†å™¨å‡åŒ€å…±äº«\n- æ‰€æœ‰å¤„ç†å™¨è®¿é—®ä»»ä½•å­˜å‚¨å­—å–ç›¸åŒçš„æ—¶é—´\n- æ¯å°å¤„ç†å™¨å¯å¸¦ç§æœ‰é«˜é€Ÿç¼“å­˜\n- å¤–å›´è®¾å¤‡ä¹Ÿå¯ä»¥ä¸€å®šå½¢å¼å…±äº«\n\n#### NUMAè®¿å­˜æ¨¡å‹\nNUMA(Nonuniform Memory Access)æ¨¡å‹æ˜¯éå‡åŒ€å­˜å‚¨è®¿é—®æ¨¡å‹çš„ç®€ç§°ã€‚ç‰¹ç‚¹æ˜¯ï¼š\n- è¢«å…±äº«çš„å­˜å‚¨å™¨åœ¨ç‰©ç†ä¸Šæ˜¯åˆ†å¸ƒåœ¨æ‰€æœ‰çš„å¤„ç†å™¨ä¸­çš„ï¼Œå…¶æ‰€æœ‰æœ¬åœ°å­˜å‚¨å™¨çš„é›†åˆå°±ç»„æˆäº†å…¨å±€åœ°å€ç©ºé—´ï¼›\n- å¤„ç†å™¨è®¿é—®å­˜å‚¨å™¨çš„æ—¶é—´æ˜¯ä¸ä¸€æ ·çš„ï¼›è®¿é—®æœ¬åœ°å­˜å‚¨å™¨LMæˆ–ç¾¤å†…å…±äº«å­˜å‚¨å™¨CSMè¾ƒå¿«ï¼Œè€Œè®¿é—®å¤–åœ°çš„å­˜å‚¨å™¨æˆ–å…¨å±€å…±äº«å­˜å‚¨å™¨GSMè¾ƒæ…¢(æ­¤å³éå‡åŒ€å­˜å‚¨è®¿é—®åç§°çš„ç”±æ¥)ï¼›\n- æ¯å°å¤„ç†å™¨å¯æ‹¥æœ‰ç§æœ‰é«˜é€Ÿç¼“å­˜ï¼Œå¤–è®¾ä¹Ÿå¯ä»¥æŸç§å½¢å¼å…±äº«\n\n#### COMAè®¿å­˜æ¨¡å‹\nCOMA(Cache-Only Memory Access)æ¨¡å‹æ˜¯å…¨é«˜é€Ÿç¼“å­˜å­˜å‚¨è®¿é—®çš„ç®€ç§°ã€‚å…¶ç‰¹ç‚¹æ˜¯ï¼š\n- å„å¤„ç†å™¨èŠ‚ç‚¹ä¸­æ²¡æœ‰å­˜å‚¨å±‚æ¬¡ç»“æ„ï¼Œå…¨éƒ¨é«˜é€Ÿç¼“å­˜ç»„æˆäº†å…¨å±€åœ°å€ç©ºé—´\n- åˆ©ç”¨åˆ†å¸ƒçš„é«˜é€Ÿç¼“å­˜ç›®å½•Dè¿›è¡Œè¿œç¨‹é«˜é€Ÿç¼“å­˜çš„è®¿é—®\n- COMAä¸­çš„é«˜é€Ÿç¼“å­˜å®¹é‡ä¸€èˆ¬éƒ½å¤§äºäºŒçº§é«˜é€Ÿç¼“å­˜å®¹é‡\n- ä½¿ç”¨COMAæ—¶ï¼Œæ•°æ®å¼€å§‹æ—¶å¯ä»»æ„åˆ†é…ï¼Œå› ä¸ºåœ¨è¿è¡Œæ—¶å®ƒæœ€ç»ˆä¼šè¢«è¿ç§»åˆ°è¦ç”¨åˆ°å®ƒä»¬çš„åœ°æ–¹ã€‚\n\n\n#### CC-NUMAè®¿å­˜æ¨¡å‹\nCC-NUMAï¼ˆCoherent-Cache Nonuniform Memory Accessï¼‰æ¨¡å‹æ˜¯é«˜é€Ÿç¼“å­˜ä¸€è‡´æ€§éå‡åŒ€å­˜å‚¨è®¿é—®æ¨¡å‹çš„ç®€ç§°ã€‚å…¶ç‰¹ç‚¹æ˜¯ï¼š\n- å¤§å¤šæ•°ä½¿ç”¨åŸºäºç›®å½•çš„é«˜é€Ÿç¼“å­˜ä¸€è‡´æ€§åè®®\n- ä¿ç•™SMPç»“æ„æ˜“äºç¼–ç¨‹çš„ä¼˜ç‚¹ï¼Œä¹Ÿæ”¹å–„å¸¸è§„SMPçš„å¯æ‰©æ”¾æ€§\n- CC-NUMAå®é™…ä¸Šæ˜¯ä¸€ä¸ªåˆ†å¸ƒå…±äº«å­˜å‚¨çš„DSMå¤šå¤„ç†æœºç³»ç»Ÿ\n- å®ƒæœ€æ˜¾è‘—çš„ä¼˜ç‚¹æ˜¯ç¨‹åºå‘˜æ— éœ€æ˜ç¡®åœ°åœ¨èŠ‚ç‚¹ä¸Šåˆ†é…æ•°æ®ï¼Œç³»ç»Ÿçš„ç¡¬ä»¶å’Œè½¯ä»¶å¼€å§‹æ—¶è‡ªåŠ¨åœ¨å„èŠ‚ç‚¹åˆ†é…æ•°æ®ï¼Œåœ¨è¿è¡ŒæœŸé—´ï¼Œé«˜é€Ÿç¼“å­˜ä¸€è‡´æ€§ç¡¬ä»¶ä¼šè‡ªåŠ¨åœ°å°†æ•°æ®è¿ç§»è‡³è¦ç”¨åˆ°å®ƒçš„åœ°æ–¹\n\n#### NORMAè®¿å­˜æ¨¡å‹\nNORMAï¼ˆNo-Remote Memory Accessï¼‰æ¨¡å‹æ˜¯éè¿œç¨‹å­˜å‚¨è®¿é—®æ¨¡å‹çš„ç®€ç§°ã€‚NORMAçš„ç‰¹ç‚¹æ˜¯ï¼š\n- æ‰€æœ‰å­˜å‚¨å™¨æ˜¯ç§æœ‰çš„\n- ç»å¤§æ•°NUMAéƒ½ä¸æ”¯æŒè¿œç¨‹å­˜å‚¨å™¨çš„è®¿é—®\n- åœ¨DSMä¸­ï¼ŒNORMAå°±æ¶ˆå¤±äº†\n### å¹¶è¡Œç¨‹åºå¼€å‘æ–¹æ³•\n|å¹¶è¡Œå±‚æ¬¡|ç²’åº¦ï¼ˆæŒ‡ä»¤æ•°ï¼‰|å¹¶è¡Œå®æ–½|ç¼–ç¨‹æ”¯æŒ|\n|-|-|-|-|\n|ç”šç»†ç²’åº¦æŒ‡ä»¤çº§å¹¶è¡Œ|å‡ åæ¡ï¼Œå¦‚å¤šæŒ‡ä»¤å‘å°„ã€å†…å­˜äº¤å‰å­˜å–|ç¡¬ä»¶å¤„ç†å™¨|\n|ç»†ç²’åº¦æ•°æ®çº§å¹¶è¡Œ|å‡ ç™¾æ¡ï¼Œå¦‚å¾ªç¯æŒ‡ä»¤å—|ç¼–è¯‘å™¨|\tå…±äº«å˜é‡|\n|ä¸­ç²’åº¦æ§åˆ¶çº§å¹¶è¡Œ|å‡ åƒæ¡ï¼Œå¦‚è¿‡ç¨‹ã€å‡½æ•°|ç¨‹åºå‘˜ï¼ˆç¼–è¯‘å™¨ï¼‰|å…±äº«å˜é‡ã€æ¶ˆæ¯ä¼ é€’|\n|ç²—ç²’åº¦ä»»åŠ¡çº§å¹¶è¡Œ|æ•°ä¸‡æ¡ï¼Œå¦‚ç‹¬ç«‹çš„ä½œä¸šä»»åŠ¡|æ“ä½œç³»ç»Ÿ|æ¶ˆæ¯ä¼ é€’|\n\n- ä¸»-ä»å¼ï¼ˆMaster-Slaveï¼‰\n- å•ç¨‹åºå¤šæ•°æ®æµï¼ˆSingle Program Multiple Data ï¼‰\n- æ•°æ®æµæ°´çº¿ï¼ˆData Pipeliningï¼‰\n- åˆ†æ²»ç­–ç•¥ï¼ˆDivide and Conquerï¼‰\n#### ä¸»-ä»å¼ï¼ˆMaster-Slaveï¼‰\nåŸºæœ¬æ€æƒ³æ˜¯ï¼šå°†ä¸€ä¸ªå¾…æ±‚è§£çš„ä»»åŠ¡åˆ†æˆä¸€ä¸ª**ä¸»ä»»åŠ¡**ï¼ˆä¸»è¿›ç¨‹ï¼‰å’Œä¸€äº›**ä»ä»»åŠ¡**ï¼ˆå­è¿›ç¨‹ï¼‰\n- ä¸»è¿›ç¨‹è´Ÿè´£å°†ä»»åŠ¡çš„åˆ†è§£ã€æ´¾å‘å’Œæ”¶é›†è¯¸å„å­ä»»åŠ¡çš„æ±‚è§£ç»“æœå¹¶æœ€åæ±‡æ€»å¾—åˆ°é—®é¢˜çš„æœ€ç»ˆè§£\n- å„å­è¿›ç¨‹æ¥æ”¶ä¸»è¿›ç¨‹å‘æ¥çš„æ¶ˆæ¯ï¼›å¹¶è¡Œè¿›è¡Œå„è‡ªè®¡ç®—ï¼›å‘ä¸»è¿›ç¨‹å‘å›å„è‡ªçš„è®¡ç®—ç»“æœ\n\n#### å•ç¨‹åºå¤šæ•°æ®æµï¼ˆSPMDï¼‰\nåŸºæœ¬æ€æƒ³æ˜¯ï¼šå¹¶è¡Œè¿è¡Œçš„è¿›ç¨‹å‡æ‰§è¡Œ**ç›¸åŒçš„ä»£ç æ®µ**ï¼Œä½†å¤„ç†çš„**æ•°æ®ä¸åŒ**\n- é¦–å…ˆå°†åº”ç”¨ç¨‹åºçš„æ•°æ®é¢„å…ˆåˆ†é…ç»™å„ä¸ªè®¡ç®—è¿›ç¨‹ï¼ˆå¤„ç†å™¨ï¼‰\n- ç„¶åè®¡ç®—è¿›ç¨‹å¹¶è¡Œçš„å®Œæˆå„è‡ªçš„è®¡ç®—ä»»åŠ¡ï¼ŒåŒ…æ‹¬è®¡ç®—è¿‡ç¨‹ä¸­å„è¿›ç¨‹é—´çš„æ•°æ®äº¤æ¢ï¼ˆè¿›è¡Œé€šä¿¡åŒæ­¥ï¼‰\n- æœ€åå°†è®¡ç®—ç»“æœæ±‡é›†èµ·æ¥\n\n#### æ•°æ®æµæ°´çº¿ï¼ˆData Pipeliningï¼‰\nåŸºæœ¬æ€æƒ³æ˜¯ï¼š**å°†è®¡ç®—è¿›ç¨‹ç»„ç»‡æˆä¸€æ¡æµæ°´çº¿**ï¼Œæ¯ä¸ªè¿›ç¨‹æ‰§è¡Œç‰¹å®šçš„è®¡ç®—ä»»åŠ¡ï¼ˆç›¸å½“äºæµæ°´çº¿çš„ä¸€ä¸ªé˜¶æ®µï¼‰\n- å°†ä»»åŠ¡åœ¨åŠŸèƒ½ä¸Šåˆ’åˆ†æˆä¸€äº›å­ä»»åŠ¡ï¼ˆè¿›ç¨‹ï¼‰ï¼Œè¿™äº›å­ä»»åŠ¡å®ŒæˆæŸç§ç‰¹å®šåŠŸèƒ½çš„è®¡ç®—å·¥ä½œ\n- ä¸€æ—¦å‰ä¸€ä¸ªå­ä»»åŠ¡å®Œæˆï¼Œåç»§çš„å­ä»»åŠ¡å°±å¯ç«‹å³å¼€å§‹\n- æ•´ä¸ªè®¡ç®—è¿‡ç¨‹ä¸­å„è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ä»…å‘ç”Ÿåœ¨ç›¸é‚»çš„é˜¶æ®µä¹‹é—´ï¼Œä¸”é€šä¿¡å¯ä»¥å®Œå…¨å¼‚æ­¥åœ°è¿›è¡Œ\n\n#### åˆ†æ²»ç­–ç•¥ï¼ˆDivide and Conquerï¼‰\nåŸºæœ¬æ€æƒ³æ˜¯ï¼šå°†ä¸€ä¸ªå¤§è€Œå¤æ‚çš„é—®é¢˜åˆ†è§£æˆè‹¥å¹²ä¸ª**ç‰¹æ€§ç›¸åŒçš„å­é—®é¢˜**åˆ†è€Œæ²»ä¹‹\n- è‹¥æ‰€å¾—çš„å­é—®é¢˜è§„æ¨¡ä»å«Œè¿‡å¤§ï¼Œåˆ™å¯åå¤ä½¿ç”¨åˆ†æ²»ç­–ç•¥ï¼Œç›´è‡³å¾ˆå®¹æ˜“æ±‚è§£è¯¸å­é—®é¢˜ä¸ºæ­¢\n- é—®é¢˜æ±‚è§£å¯åˆ†ä¸ºä¸‰æ­¥ï¼šâ‘ å°†è¾“å…¥åˆ†è§£æˆè‹¥å¹²ä¸ª**è§„æ¨¡è¿‘ä¼¼ç›¸ç­‰**çš„å­é—®é¢˜ï¼›â‘¡åŒæ—¶**é€’å½’åœ°**æ±‚è§£è¯¸å­é—®é¢˜ï¼›â‘¢å½’å¹¶å„å­é—®é¢˜çš„è§£æˆä¸ºåŸé—®é¢˜çš„è§£\n\n#### PCAM\nè®¾è®¡å¹¶è¡Œåº”ç”¨çš„å››ä¸ªé˜¶æ®µï¼š\n- åˆ’åˆ†(**P**artitioning)\n- é€šä¿¡(**C**ommunication)\n- ç»„åˆ(**A**gglomeration)\n- æ˜ å°„(**M**apping)\n\nåˆ’åˆ†ï¼šåˆ†è§£æˆå°çš„ä»»åŠ¡ï¼Œå¼€æ‹“å¹¶å‘æ€§\né€šä¿¡ï¼šç¡®å®šè¯¸ä»»åŠ¡é—´çš„æ•°æ®äº¤æ¢ï¼Œç›‘æµ‹åˆ’åˆ†çš„åˆç†æ€§\nç»„åˆï¼šä¾æ®ä»»åŠ¡çš„å±€éƒ¨æ€§ï¼Œç»„åˆæˆæ›´å¤§çš„ä»»åŠ¡\næ˜ å°„ï¼šå°†æ¯ä¸ªä»»åŠ¡åˆ†é…åˆ°å¤„ç†å™¨ä¸Šï¼Œæé«˜å¹¶è¡Œæ€§èƒ½\n\n#### åŸŸåˆ†è§£\n- åˆ’åˆ†çš„**å¯¹è±¡æ˜¯æ•°æ®**ï¼Œå¯ä»¥æ˜¯ç¨‹åºä¸­çš„è¾“å…¥æ•°æ®ã€ä¸­é—´å¤„ç†æ•°æ®å’Œè¾“å‡ºæ•°æ®\n- å°†æ•°æ®åˆ†è§£æˆå¤§è‡´ç›¸ç­‰çš„å°æ•°æ®ç‰‡\n- åˆ’åˆ†æ—¶è€ƒè™‘æ•°æ®ä¸Šçš„ç›¸åº”æ“ä½œ\n- å¦‚æœä¸€ä¸ªä»»åŠ¡éœ€è¦åˆ«çš„ä»»åŠ¡ä¸­çš„æ•°æ®ï¼Œåˆ™ä¼šäº§ç”Ÿä»»åŠ¡é—´çš„é€šä¿¡\n\n#### åŠŸèƒ½åˆ†è§£\n- åˆ’åˆ†çš„**å¯¹è±¡æ˜¯è®¡ç®—**ï¼ˆäº¦ç§°ä¸ºä»»åŠ¡åˆ†è§£æˆ–è®¡ç®—åˆ’åˆ†ï¼‰ï¼Œå°†è®¡ç®—åˆ’åˆ†ä¸ºä¸åŒçš„ä»»åŠ¡ï¼Œå…¶å‡ºå‘ç‚¹ä¸åŒäºåŸŸåˆ†è§£\n- åˆ’åˆ†åï¼Œç ”ç©¶ä¸åŒä»»åŠ¡æ‰€éœ€çš„æ•°æ®ã€‚å¦‚æœè¿™äº›æ•°æ®ä¸ç›¸äº¤çš„ï¼Œåˆ™åˆ’åˆ†æ˜¯æˆåŠŸçš„ï¼›å¦‚æœæ•°æ®æœ‰ç›¸å½“çš„é‡å ï¼Œ æ„å‘³ç€å­˜ åœ¨å¤§é‡çš„é€šä¿¡å¼€é”€ï¼Œè¦é‡æ–°è¿›è¡ŒåŸŸåˆ†è§£å’ŒåŠŸèƒ½åˆ†è§£\n- åŠŸèƒ½åˆ†è§£æ˜¯ä¸€ç§æ›´æ·±å±‚æ¬¡çš„åˆ†è§£\n\n#### é€šä¿¡åˆ†æ\né€šä¿¡æ˜¯PCAMè®¾è®¡è¿‡ç¨‹çš„é‡è¦é˜¶æ®µï¼›\nåˆ’åˆ†äº§ç”Ÿçš„å„ä»»åŠ¡ï¼Œä¸€èˆ¬ä¸èƒ½å®Œå…¨ç‹¬ç«‹æ‰§è¡Œï¼Œéœ€è¦åœ¨ä»»åŠ¡é—´è¿›è¡Œæ•°æ®äº¤æµï¼Œä»è€Œäº§ç”Ÿäº†é€šä¿¡ï¼›\nåŠŸèƒ½åˆ†è§£ç¡®å®šäº†å„ä»»åŠ¡é—´çš„æ•°æ®æµï¼›\nå„ä»»åŠ¡æ˜¯å¹¶å‘æ‰§è¡Œçš„ï¼Œé€šä¿¡åˆ™é™åˆ¶äº†è¿™ç§å¹¶å‘æ€§ï¼›\n\nå››ç§é€šä¿¡æ¨¡å¼\n- å±€éƒ¨/å…¨å±€é€šä¿¡\n- ç»“æ„åŒ–/éç»“æ„åŒ–é€šä¿¡\n- é™æ€/åŠ¨æ€é€šä¿¡\n- åŒæ­¥/å¼‚æ­¥é€šä¿¡\n\n#### å±€éƒ¨é€šä¿¡\né€šä¿¡é™åˆ¶åœ¨ä¸€ä¸ªé‚»åŸŸå†…ï¼Œå³å±€éƒ¨å†…é€šä¿¡\n\n#### å…¨å±€é€šä¿¡\né€šä¿¡æ˜¯å…¨å±€çš„ï¼Œä¾‹å¦‚ï¼š\n- All to All\n- Master-Worker\n\n#### ç»“æ„åŒ–é€šä¿¡\næ¯ä¸ªä»»åŠ¡çš„é€šä¿¡æ¨¡å¼æ˜¯ç›¸åŒçš„\n\n#### éç»“æ„åŒ–é€šä¿¡\næ²¡æœ‰ä¸€ä¸ªç»Ÿä¸€çš„é€šä¿¡æ¨¡å¼ï¼Œä¾‹å¦‚ï¼šæ— ç»“æ„åŒ–ç½‘æ ¼\n\n#### é™æ€/åŠ¨æ€é€šä¿¡\né™æ€é€šä¿¡ä¸­ï¼Œé€šä¿¡ä¼™ä¼´çš„èº«ä»½ä¸éšæ—¶é—´æ”¹å˜\nåŠ¨æ€é€šä¿¡ä¸­ï¼Œé€šä¿¡ä¼™ä¼´çš„èº«ä»½åˆ™å¯èƒ½ç”±è¿è¡Œæ—¶æ‰€è®¡ç®—çš„æ•°æ®å†³å®šä¸”æ˜¯å¯å˜çš„\n\n#### åŒæ­¥/å¼‚æ­¥é€šä¿¡\nåŒæ­¥é€šä¿¡æ—¶ï¼Œæ¥æ”¶æ–¹å’Œå‘é€æ–¹ååŒæ“ä½œ\nå¼‚æ­¥é€šä¿¡ä¸­ï¼Œæ¥æ”¶æ–¹è·å–æ•°æ®æ— éœ€ä¸å‘é€æ–¹ååŒ\n\n## SMP\n### å…±äº«å†…å­˜ç³»ç»Ÿ\n- æ¯ä¸ªå¤„ç†å™¨æ‹¥æœ‰ç§æœ‰å­˜å‚¨ï¼ˆç¼“å­˜ï¼‰\n- æ‰€æœ‰å¤„ç†å™¨å…±äº«å†…å­˜ç©ºé—´\n- å¤„ç†å™¨å¯ä»¥å¹¶è¡Œè¿›è¡Œè®¡ç®—\n### å…±äº«æ•°æ®è®¿é—®\n- ç«äº‰æ¡ä»¶ï¼ˆRace Conditionï¼‰\n\t- å½“æ‰§è¡Œçš„ç»“æœå–å†³äºä¸¤ä¸ªæˆ–å¤šä¸ªäº‹ä»¶çš„æ‰§è¡Œæ—¶é—´æ—¶ï¼Œå°±å­˜åœ¨ç«äº‰æ¡ä»¶\n- ä¸´ç•ŒåŒºï¼ˆCritical Sectionï¼‰\n\t- å¯¹å…±äº«å­˜å‚¨åŒºåŸŸè¿›è¡Œæ›´æ–°çš„ä»£ç æ®µï¼Œæˆ–ä¼šé€ æˆç«äº‰æ¡ä»¶çš„ä»£ç æ®µ\n- åŸå­æ€§ï¼ˆAtomicityï¼‰\n\t- æŒ‡äº‹åŠ¡çš„ä¸å¯åˆ†å‰²æ€§ï¼Œä¸€ä¸ªäº‹åŠ¡çš„æ‰€æœ‰æ“ä½œè¦ä¹ˆä¸é—´æ–­åœ°å…¨éƒ¨è¢«æ‰§è¡Œï¼Œè¦ä¹ˆä¸€ä¸ªä¹Ÿæ²¡æœ‰æ‰§è¡Œ\n- äº’æ–¥é”ï¼ˆMutual Exclusionï¼‰\n\t- åœ¨ç¼–ç¨‹ä¸­ï¼Œå¼•å…¥äº†å¯¹è±¡äº’æ–¥é”çš„æ¦‚å¿µï¼Œæ¥ä¿è¯å…±äº«æ•°æ®æ“ä½œçš„å®Œæ•´æ€§ã€‚æŸæ®µä»£ç è¢«æ ‡è®°äº†äº’æ–¥é”ï¼Œé‚£ä¹ˆåœ¨ä»»ä½•æƒ…å†µä¸‹ï¼Œæœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥æ‰§è¡Œè¯¥æ®µä»£ç \n- è·¯éšœï¼ˆBarrierï¼‰\n\t- åŒæ­¥ç‚¹åˆç§°ä¸ºè·¯éšœ(barrier)ï¼Œåªæœ‰æ‰€æœ‰çº¿ç¨‹éƒ½æŠµè¾¾æ­¤è·¯éšœï¼Œçº¿ç¨‹æ‰èƒ½ç»§ç»­è¿è¡Œä¸‹å»ï¼Œå¦åˆ™ä¼šé˜»å¡åœ¨è·¯éšœå¤„\n## PThread\nPthreads ä¸æ˜¯ç¼–ç¨‹è¯­è¨€ï¼Œè€Œæ˜¯POSIX çº¿ç¨‹åº“ï¼Œä¹Ÿç»å¸¸ç§°ä¸ºPthreads çº¿ç¨‹åº“\n- å®šä¹‰äº†ä¸€å¥—å¤šçº¿ç¨‹ç¼–ç¨‹çš„åº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£ï¼ˆAPIï¼‰\n- åœ¨æ”¯æŒPOSIX çš„ç³»ç»Ÿ( Linux ã€Mac OS X ã€Solaris ã€HPUX ç­‰)ä¸Šæ‰æœ‰æ•ˆ\n\nPthreadsçº¿ç¨‹åº“æ”¯æŒï¼š\n- åˆ›å»ºå¹¶è¡Œç¯å¢ƒ\n- åŒæ­¥\n- éšå¼é€šä¿¡\n### å¯åŠ¨çº¿ç¨‹\nå‡½æ•°åŸå‹ï¼š\n```c\nint pthread_create(pthread_t *, const pthread_attr_t *, void * (*)(void *), void *);\n```\nè°ƒç”¨ç¤ºä¾‹ï¼š \n```c\nerrcode = pthread_create(&thread_id, &thread_attribute, &thread_fun, &fun_arg);\n```\n- `thread_id`æ˜¯çº¿ç¨‹idæˆ–å¥æŸ„\n- `thread_attribute`å±æ€§ï¼Œé€šè¿‡ä¼ é€’NULLæŒ‡é’ˆè·å¾—æ ‡å‡†é»˜è®¤å€¼\n- `thread_fun`è¦è¿è¡Œçš„å‡½æ•°(è·å–å¹¶è¿”å›void*)  \n- `fun_arg`å¯ä»¥ä¼ é€’ç»™`thread_fun`çš„å‚æ•°  \n- å¦‚æœåˆ›å»ºæ“ä½œå¤±è´¥ï¼Œé”™è¯¯ä»£ç å°†è¢«è®¾ç½®ä¸ºéé›¶ \n```c\npthread_create(&thread_handles[thread],NULL,Hello, (void*) thread);\n```\n### åœæ­¢çº¿ç¨‹\nå‡½æ•°åŸå‹ï¼š\n```c\nint pthread_join(pthread_t,void **);\n```\nè°ƒç”¨ç¤ºä¾‹ï¼š \n```c\nerrcode = pthread_create(thread_id,return);\n```\n- `thread_id`æ˜¯çº¿ç¨‹idï¼Œå‡½æ•°ç­‰å¾…`thread_id`å¯¹è±¡å…³è”çš„çº¿ç¨‹ç»“æŸ\n- `return`å‚æ•°å¯ä»¥æ¥æ”¶è¯¥çº¿ç¨‹äº§ç”Ÿçš„è¿”å›å€¼\n```c\npthread_join(thread_handles[thread], NULL);\n```\n### äº’æ–¥é”\n- Pthreadsçº¿ç¨‹åº“å®šä¹‰äº†äº’æ–¥é”å˜é‡ç±»å‹ï¼š`pthread_mutex_t`\n- ç‰¹æ®Šç±»å‹çš„å˜é‡ï¼Œé€šè¿‡æŸäº›ç‰¹æ®Šç±»å‹çš„å‡½æ•°ï¼Œäº’æ–¥é”å¯ä»¥ç”¨æ¥é™åˆ¶æ¯æ¬¡åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½è¿›å…¥ä¸´ç•ŒåŒº\n- ä½¿ç”¨`pthread_mutex_t`ç±»å‹çš„å˜é‡å‰ï¼Œå¿…é¡»åˆå§‹åŒ–\n```c\nint pthread_mutex_init(pthread_mutex_t* mutex_p, const pthread _mutexattr_t* attr_p);\n```\n- ä½¿ç”¨ç»“æŸåå›æ”¶ç©ºé—´\n```c\n int pthread_mutex_destroy(pthread_mutex_t* mutex_p) ;    \n```\n- çº¿ç¨‹è°ƒç”¨`pthread_mutex_lock`å‡½æ•°è·å¾—äº’æ–¥é”\n```c\nint pthread_mutex_lock(pthread_mutex_t* mutex_p);\n```\n- çº¿ç¨‹æ‰§è¡Œå®Œä¸´ç•ŒåŒºä»£ç åï¼Œéœ€è¦è°ƒç”¨`pthread_mutex_unlock`å‡½æ•°é‡Šæ”¾äº’æ–¥é”çš„ä½¿ç”¨æƒ\n```c\nint pthread_mutex_unlock(pthread_mutex_t* mutex_p);\n```\n\n```c\npthread_mutex_t mutex;/*å…¨å±€å˜é‡*/\n/*ä¸»å‡½æ•°*/\npthread_mutex_init(&mutex, NULL); /*äº’æ–¥é”åˆå§‹åŒ–*/\n/*å¤šçº¿ç¨‹å¹¶è¡Œæ‰§è¡Œå‡½æ•°éƒ¨åˆ†*/        \npthread_mutex_lock(&mutex);\nsum+=my_sum;\npthread_mutex_unlock(&mutex);\n/*ä¸»å‡½æ•°*/\npthread_mutex_destroy(&mutex);/*å›æ”¶äº’æ–¥é”ç©ºé—´*/\n```\n### ä¿¡å·é‡\nä¿¡å·é‡å¯ä»¥è®¤ä¸ºæ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„`unsigned int`å˜é‡ï¼Œå¯ä»¥èµ‹å€¼ä¸º0 ã€1 ã€2 â€¦â€¦ï¼Œ\n- åªæœ‰0 å’Œ1 å€¼çš„ä¿¡å·é‡ç§°ä¸ºäºŒå…ƒä¿¡å·é‡\n\näº’æ–¥é‡æœ€å¤§çš„åŒºåˆ«åœ¨äºä¿¡å·é‡æ²¡æœ‰ä¸ªä½“æ‹¥æœ‰æƒï¼Œä¸»çº¿ç¨‹ä¿¡å·é‡åˆå§‹åŒ–ï¼Œæ‰€æœ‰çº¿ç¨‹éƒ½å¯ä»¥é€šè¿‡è°ƒç”¨`sem_post`å’Œ`sem_wait`å‡½æ•°æ›´æ–°ä¿¡å·é‡çš„å€¼\néœ€è¦é“¾æ¥ä¿¡å·é‡å‡½æ•°åº“\n```c\n#include <semaphore.h>\n```\n- ä½¿ç”¨ä¿¡å·é‡å‰ï¼Œéœ€è¦åˆå§‹åŒ–\n```c\nint sem_init(sem_t* semaphore_p, int shared, unsigned initial_val);\n```\n- ç»“æŸåå›æ”¶\n```c\nint sem_destroy(sem_t* semaphore_p);\n```\n- çº¿ç¨‹å†ä¸´ç•ŒåŒºå‰è°ƒç”¨å‡½æ•°`sem_wait`å‡½æ•°ï¼š\n```c\nint sem_wait(sem_t* semaphore_p);\n```\n- å¦‚æœä¿¡å·é‡å€¼ä¸º0ï¼Œåˆ™çº¿ç¨‹é˜»å¡\n- å¦‚æœä¿¡å·é‡å€¼ä¸ºé0ï¼Œåˆ™å°†ä¿¡å·é‡å€¼å‡1\n- çº¿ç¨‹æ‰§è¡Œå®Œä¸´ç•ŒåŒºåè°ƒç”¨å‡½æ•°`sem_wait`å‡½æ•°ï¼š\n```c\nint sem_post(sem_t* semaphore_p);\n```\n- ä¿¡å·é‡çš„å€¼åŠ 1 \n\n```c\nsem_t sem;/*å…¨å±€å˜é‡*/\n/*ä¸»å‡½æ•°*/\n sem_init(&sem, 0, 1);/*ä¿¡å·é‡åˆå§‹å€¼ä¸º1*/\n/*å¤šçº¿ç¨‹å¹¶è¡Œæ‰§è¡Œå‡½æ•°éƒ¨åˆ†*/        \nsem_wait(&sem);\nsum+=my_sum;\nsem_post(&sem);\n/*ä¸»å‡½æ•°*/\nsem_destroy(&sem);/*å›æ”¶ä¿¡å·é‡ç©ºé—´*/\n```\n### æ¡ä»¶å˜é‡\næ¡ä»¶å˜é‡æ˜¯ä¸€ç§æ•°æ®å¯¹è±¡ï¼Œå…è®¸çº¿ç¨‹åœ¨æŸä¸ªæ¡ä»¶æˆ–äº‹ä»¶å‘ç”Ÿå‰éƒ½å¤„äºæŒ‚èµ·çŠ¶æ€\nå¦ä¸€ä¸ªçº¿ç¨‹å¯ä»¥é€šè¿‡ä¿¡å·æ¥å”¤é†’æŒ‚èµ·çš„çº¿ç¨‹\næ¡ä»¶å˜é‡ä¸ºå…±äº«å˜é‡ï¼Œéœ€è¦ä¸äº’æ–¥é”ä¸€èµ·ä½¿ç”¨\n- ä½¿ç”¨`pthread_cond_t`ç±»å‹çš„å˜é‡å‰ï¼Œå¿…é¡»åˆå§‹åŒ–\n```c\nint pthread_cond_init(pthread_cond_t* cond_p, const pthread _condattr_t* cond_attr_p);\n```\n- ä½¿ç”¨ç»“æŸåå›æ”¶ç©ºé—´\n```c\nint pthread_cond_destroy(pthread_cond_t* cond_p);    \n```\n- å”¤é†’ä¸€ä¸ªé˜»å¡çš„çº¿ç¨‹\n```c\nint pthread_cond_signal(pthread_cond_t* cond_p);  \n```\n- å”¤é†’æ‰€æœ‰é˜»å¡çš„çº¿ç¨‹\n```c\nint pthread_cond_broadcast(pthread_cond_t* cond_p);  \n```\n- ä½¿ç”¨äº’æ–¥é”é˜»å¡çº¿ç¨‹\n```c\nint pthread_cond_wait(pthread_cond_t* cond_p, pthread_mutex_t* mutex_p);\n```\n\n```c\n/*è°ƒç”¨pthread_cond_waitç­‰åŒäºæ‰§è¡Œå¦‚ä¸‹è¯­å¥*/\npthread_mutex_unlock(&mutex_p);\nwait_on_signal(&cond_p); \npthread_mutex_lock(&mutex_p);\n```\n\n### åŒæ­¥\n#### å¿™ç­‰å¾…å’Œäº’æ–¥é”å®ç°è·¯éšœ\n```c\n/*è·¯éšœ*/\npthread_mutex_lock(&barrier_mutex);\ncounter++;\npthread_mutex_unlock(&barrier_mutex);\nwhile(counter < thread_count);\n```\n#### ä¿¡å·é‡å®ç°è·¯éšœ\n```c\nSem_t count_sem; /*åˆå§‹å€¼ä¸º1*/\nSem_t barrier_sem; /*åˆå§‹å€¼ä¸º0*/\n/*å¤šçº¿ç¨‹å¹¶è¡Œæ‰§è¡Œå‡½æ•°éƒ¨åˆ†*/ \n/*è·¯éšœ*/\nSem_wait(&count_sem);\nif(counter == thread_count-1){\n\tcounter = 0;\n\tsem_post(&count_sem);\n\tfor(j=0;j<thread_count-1;j++)\n\t\tsem_post(&barrier_sem); /*æœ€åä¸€ä¸ªçº¿ç¨‹å”¤é†’å‰é¢é˜»å¡çš„thread_count-1ä¸ªçº¿ç¨‹*/\n}else{\n\tcounter++;\n\tsem_post(&count_sem);\n\tsem_wait(&barrier_sem);\n}\n```\n#### æ¡ä»¶å˜é‡å®ç°è·¯éšœ\n```c\n/*å…±äº«å˜é‡*/\nint counter = 0;\npthread_mutex_t mutex_p;\npthread_cond_t cond_p;\n/*å¤šçº¿ç¨‹å¹¶è¡Œæ‰§è¡Œå‡½æ•°éƒ¨åˆ†*/\n/*è·¯éšœ*/\npthread_mutex_lock(&mutex_p);\ncounter++;\nif (counter == thread_count){\n\tcounter = 0;\n\tpthread_cond_broadcast(&cond_p);\n}else{\n\twhile(pthread_cond_wait(&cond_p,&mutex_p) != 0);\n\t/*é™¤äº†pthread_cond_broadcastï¼Œå¯èƒ½æœ‰å…¶ä»–äº‹ä»¶å”¤é†’çº¿ç¨‹ï¼Œå› æ­¤éœ€è¦å°†pthread_cond_waitæ”¾è¿›whileå¾ªç¯ä¸­*/\n}\npthread_mutex_unlock(&mutex_p);\n```\n## OpenMP\nç”±ä¸‰ä¸ªä¸»è¦APIç»„ä»¶æ„æˆï¼š\n- ç¼–è¯‘å™¨æŒ‡ä»¤\n- è¿è¡Œæ—¶åº“å‡½æ•°\n- ç¯å¢ƒå˜é‡\n\næ”¯æŒä»¥å¢é‡æ–¹å¼å¹¶è¡ŒåŒ–(Incremental Parallelization)ä¸²è¡Œç¨‹åº\nåŸºäºçº¿ç¨‹çš„å¹¶è¡Œç¼–ç¨‹æ¨¡å‹\néœ€è¦ç¼–è¯‘å™¨çš„æ”¯æŒ\n### å‡†å¤‡å·¥ä½œå’Œç¼–è¯‘åˆ¶å¯¼\n- `#include <omp.h>`\n\t- åŒ…å«OpenMPçš„åº“å‡½æ•°å¤´æ–‡ä»¶\n- `#pragma omp parallel private(nthreads, tid)`\n\t- å¹¶è¡ŒåŒºåŸŸçš„ç¼–è¯‘åˆ¶å¯¼è¯­å¥\n\t- å¤§å°å†™æ•æ„Ÿ\n\t- æŒ‡ä»¤æœ€å¤šåº”ç”¨äºä¸€ä¸ªåç»§è¯­å¥ï¼Œè¯­å¥å¿…é¡»æ˜¯ä¸€ä¸ªç»“æ„å—ï¼ˆstructured blockï¼‰\n\n### å¹¶è¡ŒåŒºåŸŸç»“æ„ï¼ˆParallel Constructï¼‰\nåŸºæœ¬çš„OpenMPå¹¶è¡Œç»“æ„ï¼ŒFork-Joinæ¨¡å‹\n```c\n#pragma omp parallel [[clause[[,]clause]â€¦] \n\tstructured-block\nclause:\n\tif(scalar-expression)\n\tnum_threads(integer-expression)\n\tdefault(shared | none)\n\tprivate(list)\n\tfirstprivate(list)\n\tshared(list)\n\tcopyin(list)\n\treduction(reduction-identifier: list)\n```\n- å¹¶è¡ŒåŒºåŸŸæ˜¯å¤šçº¿ç¨‹æ‰§è¡Œçš„ä»£ç å—ï¼Œæ˜¯åŸºæœ¬çš„OpenMPå¹¶è¡Œç»“æ„\n- ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œåˆ°ä¸€ä¸ªå¹¶è¡ŒæŒ‡ä»¤æ—¶ï¼ŒForkä¸€ç»„çº¿ç¨‹å¹¶æˆä¸ºè¯¥çº¿ç¨‹ç»„çš„ä¸»çº¿ç¨‹ï¼ˆçº¿ç¨‹å·ä¸º0ï¼‰\n- ä»å¹¶è¡ŒåŒºåŸŸå¼€å§‹ï¼Œä»£ç è¢«å¤åˆ¶ï¼Œä¸€ç»„çº¿ç¨‹éƒ½æ‰§è¡Œè¯¥ä»£ç \n- å¹¶è¡ŒåŒºåŸŸå‡ºå£éšå«barrierï¼Œåªæœ‰ä¸»çº¿ç¨‹ç»§ç»­æ‰§è¡Œ\n#### ç”¨äºæ˜¾ç¤ºå®šä¹‰å˜é‡èŒƒå›´çš„å­å¥\n- **private(list)**ï¼šå°†listä¸­çš„å˜é‡å£°æ˜ä¸ºæ¯ä¸ªçº¿ç¨‹çš„ç§æœ‰å˜é‡\n\t- ä¸ºçº¿ç¨‹ç»„ä¸­æ¯ä¸ªçº¿ç¨‹å£°æ˜ä¸€ä¸ªç›¸åŒç±»å‹çš„å˜é‡\n\t- ä½œç”¨åŸŸåªåœ¨å¹¶è¡ŒåŒºåŸŸå†…\n- **shared(list)**ï¼šå°†listä¸­çš„å˜é‡å£°æ˜ä¸ºçº¿ç¨‹ç»„ä¸­çº¿ç¨‹ä¹‹é—´çš„å…±äº«å˜é‡\n- **default(shared | none)**ï¼šæŒ‡å®šå¹¶è¡ŒåŒºåŸŸå†…å˜é‡çš„å±æ€§æ˜¯sharedï¼Œnoneä½œä¸ºé»˜è®¤å€¼è¦æ±‚ç¨‹åºå‘˜å¿…é¡»æ˜¾å¼åœ°é™å®šæ‰€æœ‰å˜é‡çš„ä½œç”¨åŸŸ\n- **firstprivate(list)**ï¼šåœ¨è¿›å…¥å¹¶è¡ŒåŒºåŸŸä¹‹å‰è¿›è¡Œä¸€æ¬¡åˆå§‹åŒ–ï¼Œè®©å¹¶è¡ŒåŒºåŸŸçš„listä¸­å˜é‡çš„å€¼åˆå§‹åŒ–ä¸ºåŒåå…±äº«å˜é‡çš„å€¼\n- **lastprivate(list)**ï¼šåœ¨é€€å‡ºå¹¶è¡ŒåŒºåŸŸæ—¶ï¼Œå°†å¹¶è¡ŒåŒºåŸŸçš„listä¸­å˜é‡çš„å€¼èµ‹å€¼ç»™åŒåçš„å…±äº«å˜é‡\n\t- å¾ªç¯è¿­ä»£ï¼šå°†æœ€åä¸€æ¬¡å¾ªç¯è¿­ä»£ä¸­çš„å€¼èµ‹ç»™å¯¹åº”çš„å…±äº«å˜é‡\n\t- sectionç»“æ„ï¼šå°†è¯­æ³•ä¸Šæœ€åä¸€ä¸ªsectionè¯­å¥ä¸­çš„å€¼èµ‹ç»™å¯¹åº”çš„å…±äº«å˜é‡\n- **copyin(list)**ï¼šå°†ä¸»çº¿ç¨‹ä¸­threadprivateå˜é‡çš„å€¼æ‹·è´åˆ°æ‰§è¡Œå¹¶è¡ŒåŒºåŸŸçš„å„ä¸ªçº¿ç¨‹çš„threadprivateå˜é‡ä¸­ï¼ŒliståŒ…å«è¦å¤åˆ¶çš„å˜é‡çš„åç§°\n\t- threadprivateæ˜¯æŒ‡ä»¤ï¼ŒæŒ‡å®šå…¨å±€å˜é‡è¢«æ‰€æœ‰çº¿ç¨‹å„è‡ªäº§ç”Ÿä¸€ä¸ªç§æœ‰çš„å‰¯æœ¬ï¼Œå¯¹äºä¸åŒå¹¶è¡ŒåŒºåŸŸä¹‹é—´çš„åŒä¸€ä¸ªçº¿ç¨‹ï¼Œè¯¥å‰¯æœ¬å˜é‡æ˜¯å…±äº«çš„\n- **copyprivate(list)**ï¼šå°†å•ä¸ªçº¿ç¨‹ç§æœ‰listå˜é‡çš„å€¼å¹¿æ’­åˆ°å…¶ä»–çº¿ç¨‹çš„ç§æœ‰listå˜é‡\n\t- åªç”¨äºsingleæŒ‡ä»¤ï¼Œåœ¨ä¸€ä¸ªsingleå—çš„ç»“å°¾å¤„å®Œæˆå¹¿æ’­æ“ä½œ\n- **reduction(reduction-identifier: list)** ï¼šå¯¹listä¸­çš„å˜é‡è¿›è¡Œçº¦ç®€æ“ä½œ\n\t- ä¸ºæ¯ä¸ªçº¿ç¨‹åˆ›å»ºå¹¶åˆå§‹åŒ–listä¸­å˜é‡çš„ç§æœ‰å‰¯æœ¬ï¼ˆlistä¸­å˜é‡ä¸ºå…±äº«å˜é‡ï¼‰\n\t- å¯¹æ‰€æœ‰çº¿ç¨‹çš„ç§æœ‰å‰¯æœ¬è¿›è¡Œçº¦ç®€æ“ä½œï¼Œå¹¶å°†æœ€ç»ˆç»“æœå†™å…¥å…±äº«å˜é‡\n#### ifå­å¥\n- **if(scalar-expression)**ï¼šå¦‚æœæœ‰ifå­å¥ï¼Œé‚£ä¹ˆåªæœ‰è¡¨è¾¾å¼ä¸ºçœŸï¼ˆé0ï¼‰æ‰ä¼šåˆ›å»ºä¸€ä¸ªçº¿ç¨‹ç»„ï¼Œå¦åˆ™è¯¥åŒºåŸŸç”±ä¸»çº¿ç¨‹ä¸²è¡Œæ‰§è¡Œ\n#### num_threadså­å¥\n- **num_threads(integer-expression)**ï¼šç”¨äºè®¾ç½®è¿è¡Œå¹¶è¡ŒåŒºåŸŸçš„çº¿ç¨‹æ•°é‡ï¼Œinteger-expressionè¡¨ç¤ºçº¿ç¨‹æ•°é‡\n- å¹¶è¡ŒåŒºåŸŸçš„çº¿ç¨‹æ•°é‡ç”±ä»¥ä¸‹å› ç´ å†³å®šï¼Œä¼˜å…ˆçº§ä»é«˜åˆ°ä½ï¼š\n\t- ifå­å¥çš„è®°è¿‡\n\t- num_threadså­å¥çš„è®¾ç½®\n\t- omp_set_num_threads()åº“å‡½æ•°çš„è®¾ç½®\n\t- OMP_NUM_THREADSç¯å¢ƒå˜é‡çš„è®¾ç½®\n\t- ç¼–è¯‘å™¨é»˜è®¤å®ç°ï¼ˆä¸€èˆ¬é»˜è®¤æ€»çº¿ç¨‹æ•°ç­‰äºå¤„ç†å™¨çš„æ ¸å¿ƒæ•°ï¼‰\n### ä½¿ç”¨é™åˆ¶\n- å¹¶è¡ŒåŒºåŸŸä¸èƒ½æ˜¯è·¨è¶Šå¤šä¸ªç¨‹åºæˆ–ä»£ç æ–‡ä»¶çš„ç»“æ„åŒ–å—\n- ä»ä¸€ä¸ªå¹¶è¡ŒåŒºåŸŸåªèƒ½ç”±ä¸€ä¸ªå…¥å£å’Œä¸€ä¸ªå‡ºå£ï¼Œä»»ä½•è½¬å…¥å’Œè½¬å‡ºéƒ½æ˜¯éæ³•çš„\n\t- ä¸èƒ½åŒ…å«breakè¯­å¥\n- åªå…è®¸ä¸€ä¸ªifå­å¥å’Œä¸€ä¸ªnum_threadså­å¥\n- ç¨‹åºè¿è¡Œç»“æœä¸èƒ½ä¾èµ–äºå­å¥çš„é¡ºåº\n\n\n### å·¥ä½œå…±äº«ç»“æ„(Worksharing Constructs)\n- å·¥ä½œå…±äº«ç»“æ„ä¸ä¼šå¯åŠ¨æ–°çº¿ç¨‹ï¼Œä¸ºäº†ä½¿æŒ‡ä»¤èƒ½å¤Ÿå¹¶è¡Œæ‰§è¡Œï¼Œå¿…é¡»å°†å·¥ä½œå…±äº«ç»“æ„å°è£…åœ¨ä¸€ä¸ªå¹¶è¡ŒåŒºåŸŸä¸­\n- å·¥ä½œå…±äº«ç»“æ„å°†æ‰€åŒ…å«çš„ä»£ç åˆ’åˆ†ç»™çº¿ç¨‹ç»„çš„æˆå‘˜æ¥æ‰§è¡Œ\n- è¿›å…¥å·¥ä½œå…±äº«ç»“æ„æ²¡æœ‰barrierï¼Œä½†åœ¨å‡ºå£éšå«barrier\n\t- å¹¶è¡Œdo/for loopï¼šçº¿ç¨‹ç»„å¹¶è¡Œæ‰§è¡Œä»£ç ï¼Œå®ç°æ•°æ®å¹¶è¡Œ\n\t- å¹¶è¡Œsectionsï¼šè®¡ç®—ä»»åŠ¡åˆ†æˆå•ç‹¬çš„ã€ä¸è¿ç»­çš„éƒ¨åˆ†ï¼Œæ¯ä¸ªçº¿ç¨‹æ‰§è¡Œä¸€éƒ¨åˆ†ï¼Œå¯ä»¥å®ç°å‡½æ•°å¹¶è¡Œ\n\t- singleï¼šä¸²è¡Œæ‰§è¡Œä»£ç \n#### foræŒ‡ä»¤\nforæŒ‡ä»¤æŒ‡å®šå¾ªç¯è¯­å¥å¿…é¡»ç”±çº¿ç¨‹ç»„å¹¶è¡Œæ‰§è¡Œï¼Œ**å‡è®¾å·²ç»å¯åŠ¨äº†å¹¶è¡ŒåŒºåŸŸï¼Œå¦åˆ™å°†ä¸²è¡Œæ‰§è¡Œ**\n```c\n#pragma omp for [[clause[[,]clause]â€¦] \n\tfor-loops\nclause:\n\tschedule(kind[,chunk_size])\n\tordered[(n)]\n\tprivate(list)\n\tfirstprivate(list)\n\tlastprivate(list)\n\treduction(reduction-identifier : list)\n\tcollapse(n)\n\tnowait\n```\n##### scheduleå­å¥\n- **schedule(kind[,chunk_size])**ï¼šæè¿°å¾ªç¯è¿­ä»£å¦‚ä½•åˆ’åˆ†ç»™å¤šä¸ªçº¿ç¨‹\n- kindå¯ä»¥ä¸ºstaticï¼ˆé™æ€ï¼‰ã€dynamicï¼ˆåŠ¨æ€ï¼‰ã€guidedï¼ˆå¼•å¯¼ï¼‰ã€runtimeï¼ˆè¿è¡Œæ—¶ï¼‰ã€autoï¼ˆè‡ªåŠ¨ï¼‰äº”ç§æ¨¡å¼\n- **static**ï¼šå¾ªç¯è¿­ä»£è¢«åˆ’åˆ†æˆå°å—ï¼Œé™æ€çš„åˆ†é…ç»™çº¿ç¨‹ã€‚\n\t- chunk_sizeä¸ºå—å¤§å°ï¼Œå¦‚æœæ²¡æœ‰æŒ‡å®šåˆ™è¿­ä»£å‡åŒ€è¿ç»­åˆ’åˆ†ç»™çº¿ç¨‹\n- **dynamic**ï¼šå¾ªç¯è¿­ä»£è¢«åˆ’åˆ†æˆå°å—ï¼Œåœ¨çº¿ç¨‹é—´åŠ¨æ€è°ƒåº¦ã€‚\n\t- å½“çº¿ç¨‹å®Œæˆä¸€å—æ—¶ï¼ŒåŠ¨æ€åˆ†é…å¦ä¸€å—ï¼Œå—å¤§å°é»˜è®¤ä¸º1\n- **guided**ï¼šå½“çº¿ç¨‹è¯·æ±‚ä»»åŠ¡æ—¶ï¼Œè¿­ä»£å—è¢«åŠ¨æ€åˆ†é…ç»™çº¿ç¨‹ï¼Œç›´åˆ°æ‰€æœ‰è¿­ä»£å—è¢«åˆ†é…å®Œä¸ºæ­¢ã€‚ä¸dynamicç±»ä¼¼ï¼Œåªæ˜¯æ¯æ¬¡åˆ†é…çš„è¿­ä»£å—çš„å¤§å°ä¼šå‡å°‘ã€‚\n\t- åˆå§‹å—å¤§å°ä¸num_iterations/num_threadsæˆæ­£æ¯”\n\t- åç»­åˆ†é…çš„å—å¤§å°ä¸num_iterations_remain/num_threadsæˆæ­£æ¯”\n\t- chunk_sizeå®šä¹‰æœ€å°å—å¤§å°ï¼Œé»˜è®¤ä¸º1\n- **runtime**ï¼šè¿è¡Œæ—¶æ ¹æ®ç¯å¢ƒå˜é‡omp_scheduleåœ¨ç¡®å®šè°ƒåº¦ç±»å‹ï¼Œæœ€ç»ˆä½¿ç”¨çš„æ˜¯ä¸Šè¿°ä¸‰ç§ä¹‹ä¸€ã€‚\n- **auto**ï¼šç”±ç¼–è¯‘å™¨æˆ–è€…è¿è¡Œæ—¶ç³»ç»Ÿå†³å®šè°ƒåº¦ç±»å‹\n##### orderedå­å¥å’Œnowaitå­å¥\n- **ordered[(n)]**ï¼šæŒ‡å®šåŒºåŸŸçš„å¾ªç¯è¿­ä»£å°†æŒ‰ä¸²è¡Œé¡ºåºæ‰§è¡Œï¼Œä¸å•ä¸ªå¤„ç†å™¨å¤„ç†ç»“æœé¡ºåºä¸€è‡´\n\t- orderedå­å¥åªèƒ½ç”¨åœ¨foræˆ–parallel forä¸­\n- **nowait**ï¼šå¿½ç•¥å¹¶è¡ŒåŒºåŸŸéšå«barrierçš„åŒæ­¥ç­‰å¾…ï¼Œ\n##### collapseå­å¥\n- **collapse(n)**ï¼šæŒ‡å®šåµŒå¥—å¾ªç¯ä¸­çš„nä¸ªå¾ªç¯æŠ˜å åˆ°ä¸€ä¸ªå¤§çš„è¿­ä»£ç©ºé—´ä¸­ï¼Œå¹¶æ ¹æ®è°ƒåº¦å­å¥åˆ’åˆ†å¹¶è¡Œæ‰§è¡Œ\n\t- æ‰€æœ‰ç›¸å…³å¾ªç¯çš„é¡ºåºæ‰§è¡Œå†³å®šäº†æŠ˜å è¿­ä»£ç©ºé—´ä¸­è¿­ä»£çš„é¡ºåº\n\t- èƒ½å¤Ÿè§£å†³çº¿ç¨‹é—´è´Ÿè½½å‡è¡¡æˆ–çº¿ç¨‹è´Ÿè½½å¤ªå°çš„é—®é¢˜\n##### ä½¿ç”¨é™åˆ¶\n- ä¸èƒ½æ˜¯whileå¾ªç¯ï¼Œæˆ–è€…ä»»ä½•å¾ªç¯è¿­ä»£æ¬¡æ•°ä¸ç¡®å®šçš„å¾ªç¯\n- å¾ªç¯è¿­ä»£å˜é‡ï¼ˆiï¼‰å¿…é¡»æ˜¯æ•´æ•°ï¼Œå¹¶ä¸”å¯¹äºæ‰€æœ‰çº¿ç¨‹ï¼Œå¾ªç¯ æ§åˆ¶å‚æ•°ï¼ˆi++ï¼‰å¿…é¡»ç›¸åŒ\n- ç¨‹åºçš„æ­£ç¡®æ€§ä¸èƒ½ä¾èµ–äºæŸä¸ªçº¿ç¨‹æ‰§è¡Œçš„ç‰¹å®šè¿­ä»£\n- è·³è½¬æˆ–è·³å‡ºå¾ªç¯æ˜¯éæ³•çš„\n- å—å¤§å°å¿…é¡»ä¸ºæ•´æ•°æ¬¡è¿­ä»£\n- scheduleã€orderedå’Œcollapseå­å¥åªå¯ä»¥å‡ºç°ä¸€æ¬¡\n\n#### sectionsæŒ‡ä»¤\n- sectionsæŒ‡ä»¤æŒ‡å®šæ‰€åŒ…å«çš„ä»£ç æ®µè¢«åˆ†é…ç»™å„ä¸ªçº¿ç¨‹æ‰§è¡Œ\n- ä¸åŒsectionéƒ¨åˆ†å¯ä»¥ç”±ä¸åŒçº¿ç¨‹æ‰§è¡Œï¼Œå¦‚æœä¸€ä¸ªçº¿ç¨‹è¿è¡Œçš„å—ï¼Œä¹Ÿå¯ä»¥æ‰§è¡Œå¤šä¸ªéƒ¨åˆ†\n```c\n#pragma omp sections [clause[ [, ] clause] ...]\n{\n\t#pragma omp section\n\t\tstructured-block\n\t#pragma omp section\n\t\tstructured-block\n\t...\n}\nclause:\n\tprivate(list)\n\tfirstprivate(list)\n\tlastprivate(list)\n\treduction(reduction-identifier: list)\n\tnowait\n```\n##### ä½¿ç”¨é™åˆ¶\n- sectionsæŒ‡ä»¤çš„æœ«å°¾æœ‰éšå«çš„barrierï¼Œå¯ä»¥ä½¿ç”¨nowaitå­å¥å¿½ç•¥\n- ä¸èƒ½è·³è½¬æˆ–è·³å‡ºsectionä»£ç å—\n- sectionæŒ‡ä»¤å¿…é¡»åœ¨å°é—­çš„sectionsæŒ‡ä»¤çš„è¯æ³•èŒƒå›´å†…\n#### singleæŒ‡ä»¤\nsingleæŒ‡ä»¤æŒ‡å®šæ‰€åŒ…å«çš„ä»£ç ä»…ç”±ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œï¼Œé€šå¸¸ç”¨äºå¤„ç†éçº¿ç¨‹å®‰å…¨çš„ä»£ç æ®µï¼Œä¾‹å¦‚I/O\n```text\n#pragma omp single [clause[ [, ]clause] ...]\n\tstructured-block\nclause:\n\tprivate(list)\n\tfirstprivate(list)\n\tcopyprivate(list)\n\tnowait\n```\n##### ä½¿ç”¨é™åˆ¶\nä¸èƒ½è·³è½¬æˆ–è·³å‡ºä¸€ä¸ªsingleä»£ç å—\n\n#### åˆå¹¶ç»“æ„(Combined Constructs)\n- åˆå¹¶äº†å¹¶è¡ŒåŒºåŸŸç»“æ„ä¸å…±äº«ä»»åŠ¡ç»“æ„çš„æŒ‡ä»¤\n- parallel foræŒ‡ä»¤ï¼šåˆå¹¶parallelå’Œforä¸¤ä¸ªæŒ‡ä»¤\n\t- é™¤äº†nowaitå­å¥å¤–ï¼Œæ‰€æœ‰parallelå’Œforé€‚ç”¨çš„å­å¥å’Œè§„èŒƒä¹Ÿéƒ½é€‚ç”¨äºparallel foræŒ‡ä»¤\n- parallel sectionsæŒ‡ä»¤ï¼šåˆå¹¶parallelå’Œsectionsä¸¤ä¸ªæŒ‡ä»¤\n\t- é™¤äº†nowaitå­å¥å¤–ï¼Œæ‰€æœ‰parallelå’Œforé€‚ç”¨çš„å­å¥å’Œè§„èŒƒä¹Ÿéƒ½é€‚ç”¨äºparallel foræŒ‡ä»¤\n### åŒæ­¥ç»“æ„\nå®ç°å¤šçº¿ç¨‹é—´äº’æ–¥è®¿é—®å’ŒåŒæ­¥çš„æŒ‡ä»¤\n- **masteræŒ‡ä»¤**ï¼šæŒ‡å®šä¸€ä¸ªä»£ç åŒºåŸŸç”±ä¸»çº¿ç¨‹æ‰§è¡Œï¼Œå…¶ä»–çº¿ç¨‹è·³è¿‡è¿™ä¸ªåŒºåŸŸ\n- **criticalæŒ‡ä»¤**ï¼šæŒ‡å®šä¸€ä¸ªä»£ç åŒºåŸŸæ¯æ¬¡åªèƒ½ç”±ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œï¼ˆäº’æ–¥è®¿é—®ï¼‰ï¼Œå¯ä»¥å®ç°ä¸´ç•ŒåŒºè®¿é—®\n- **barrieræŒ‡ä»¤**ï¼šæŒ‡å®šçº¿ç¨‹ç»„æ‰€æœ‰çš„çº¿ç¨‹åœ¨æ­¤æŒ‡ä»¤å¤„åŒæ­¥\n- **atomicæŒ‡ä»¤**ï¼šæŒ‡å®šä»¥åŸå­æ–¹å¼è®¿é—®ç‰¹å®šçš„å­˜å‚¨ä½ç½®ï¼Œè¯¥æŒ‡ä»¤ä»…é€‚ç”¨äºå…¶åçš„å•ä¸ªè¯­å¥ï¼Œå¯ä»¥å®ç°ä¸€ä¸ªæœ€å°ä¸´ç•ŒåŒºçš„è®¿é—®\n- **flushæŒ‡ä»¤**ï¼šæ ‡è¯†ä¸€ä¸ªæ•°æ®åŒæ­¥ç‚¹ï¼Œå°†çº¿ç¨‹çš„å˜é‡å†™å›å†…å­˜ï¼Œå®ç°å†…å­˜æ•°æ®æ›´æ–°\n- **orderedæŒ‡ä»¤**ï¼šæŒ‡å®šå¾ªç¯è¿­ä»£ä»¥ä¸²è¡Œæ‰§è¡Œé¡ºåºæ‰§è¡Œ\n#### masteræŒ‡ä»¤\n- masteræŒ‡ä»¤æ²¡æœ‰éšå«barrier\n- è·³è½¬æˆ–è·³å‡ºmasterä»£ç å—æ˜¯éæ³•çš„\n#### criticalæŒ‡ä»¤\n```c\n#pragma omp critical [(name)]\n\tstructured-block\n```\n- å¦‚æœä¸€æ¡çº¿ç¨‹æ­£åœ¨ä¸€ä¸ªcriticalåŒºåŸŸæ‰§è¡Œè€Œå¦ä¸€ä¸ªçº¿ç¨‹åˆ°è¾¾è¿™ä¸ªåŒºåŸŸï¼Œå¹¶ä¼å›¾æ‰§è¡Œï¼Œé‚£ä¹ˆå®ƒå°†ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°ç¬¬ä¸€ä¸ªçº¿ç¨‹ç¦»å¼€è¿™ä¸ªåŒºåŸŸ\n- nameæ˜¯å¯é€‰é¡¹ï¼Œä½¿ä¸åŒçš„cirticalåŒºåŸŸå…±å­˜ï¼Œå…·æœ‰ç›¸åŒå‘½åçš„ä¸åŒçš„criticalåŒºåŸŸè¢«å½“ä½œåŒä¸€ä¸ªåŒºåŸŸï¼Œæ‰€æœ‰æœªå‘½åcriticalåŒºåŸŸè¢«å½“ä½œåŒä¸€ä¸ªåŒºåŸŸ\n#### atomicæŒ‡ä»¤\n```c\n#pragma omp atomic [atomic-clause]\n\texpression-stmt\natomic-clause: read, write, update, or capture\n```\n#### flushæŒ‡ä»¤\n- æ˜ç¡®çš„è¡¨æ˜ç¨‹åºç‚¹å¤„éœ€è¦è¿›è¡Œå†…å­˜æ›´æ–°\n- æŒ‡ä»¤éšå«flushæŒ‡ä»¤ï¼Œä¸è¿‡å¦‚æœç”±nowaitå­å¥ï¼Œåˆ™flushæŒ‡ä»¤å¤±æ•ˆï¼š\n\t- barrieræŒ‡ä»¤ï¼›\n\t- parallelæŒ‡ä»¤â€”â€”è¿›å…¥å’Œé€€å‡º\n\t- criticalæŒ‡ä»¤â€”â€”è¿›å…¥å’Œé€€å‡º\n\t- orderedæŒ‡ä»¤â€”â€”è¿›å…¥å’Œé€€å‡º\n\t- foræŒ‡ä»¤â€”â€”é€€å‡º\n\t- sectionsæŒ‡ä»¤â€”â€”é€€å‡º\n\t- singleæŒ‡ä»¤â€”â€”é€€å‡º\n#### orderedæŒ‡ä»¤\n- æŒ‡å®šå¾ªç¯è¿­ä»£ä»¥ä¸²è¡Œæ‰§è¡Œé¡ºåºæ‰§è¡Œï¼Œå¦‚æœå‰é¢çš„è¿­ä»£æ²¡æœ‰å®Œæˆï¼Œåˆ™æ‰§è¡Œåé¢è¿­ä»£çš„çº¿ç¨‹éœ€è¦ç­‰å¾…\n- orderedæŒ‡ä»¤åªèƒ½å‡ºç°åœ¨å‡ºç°åœ¨foræˆ–è€…parallel forçš„åŠ¨æ€èŒƒå›´å†…\n#### å…¶ä»–æŒ‡ä»¤\n- **threadprivateæŒ‡ä»¤**ï¼šæŒ‡å®šå…¨å±€å˜é‡è¢«æ‰€æœ‰çº¿ç¨‹å„è‡ªäº§ç”Ÿä¸€ä¸ªç§æœ‰çš„å‰¯æœ¬ï¼Œå¯¹äºä¸åŒå¹¶è¡ŒåŒºåŸŸä¹‹é—´çš„åŒä¸€ä¸ªçº¿ç¨‹ï¼Œè¯¥å‰¯æœ¬å˜é‡æ˜¯å…±äº«çš„\n### è¿è¡Œæ—¶åº“å‡½æ•°\nå‡½æ•°|åŠŸèƒ½\n-|-\n`void omp_set_num_threads(int num_threads)`|è®¾ç½®ä¸‹ä¸€ä¸ªå¹¶è¡ŒåŒºåŸŸä½¿ç”¨çš„çº¿ç¨‹æ•°é‡\n`int omp_get_num_threads(void)`|è¿”å›å½“å‰å¹¶è¡ŒåŒºåŸŸçº¿ç¨‹ç»„ä¸­çš„çº¿ç¨‹æ•°é‡\n`int omp_get_max_threads(void)`|è¿”å›å¯é€šè¿‡è°ƒç”¨omp_get_num_threadså‡½æ•°è¿”å›çš„æœ€å¤§å€¼\n`int omp_get_thread_num(void)`|è¿”å›åœ¨çº¿ç¨‹ç»„ä¸­æ‰§è¡Œæ­¤å¤„ä»£ç çš„çº¿ç¨‹å·\n`int omp_get_num_procs(void)`|è¿”å›ç¨‹åºå¯ç”¨çš„å¤„ç†å™¨æ•°é‡\n`void omp_set_dynamic(int dynamic_threads)`|å¯åŠ¨æˆ–ç¦ç”¨çº¿ç¨‹æ•°çš„åŠ¨æ€çº¿ç¨‹è°ƒæ•´\n`int omp_get_dynamic(void)`|ç”¨äºç¡®å®šæ˜¯å¦å¯åŠ¨åŠ¨æ€çº¿ç¨‹è°ƒæ•´\n`void omp_set_schedule(omp_sched_t kind, int chunk_size)`|åœ¨æŒ‡ä»¤ä¸­å°†â€œruntimeâ€ä½œä¸ºè°ƒåº¦ç±»å‹æ—¶ï¼Œè®¾ç½®å¾ªç¯è°ƒåº¦ç±»å‹\n`void omp_get_schedule(omp_sched_t *kind, int *chunk_size)`|åœ¨æŒ‡ä»¤ä¸­å°†â€œruntimeâ€ä½œä¸ºè°ƒåº¦ç±»å‹æ—¶ï¼Œè¿”å›å¾ªç¯è°ƒåº¦ç±»å‹\n`void omp_init_lock(omp_lock_t *lock)`|åˆå§‹åŒ–é”\n`void omp_destroy_lock(omp_lock_t *lock)`|ç»“æŸé”å˜é‡ä¸é”çš„ç»‘å®š\n`void omp_set_lock(omp_lock_t *lock)`|è·å¾—é”çš„æ‰€æœ‰æƒ\n`void omp_unset_lock(omp_lock_t *lock)`|é‡Šæ”¾é”\n`double omp_get_wtime(void)`|è¿”å›ä¸€ä¸ªç¨‹åºç‚¹çš„æ—¶é—´å€¼(s)\n`double omp_get_wtick(void)`|è¿”å›ä¸€ä¸ªç¨‹åºç‚¹çš„æ—¶é’Ÿå‘¨æœŸçš„æ—¶é•¿(s)\n## MPI\n- ä½¿ç”¨æ¶ˆæ¯ä¼ é€’çš„å®ç°ç§°ä¸ºæ¶ˆæ¯ä¼ é€’æ¥å£ï¼ˆMessage-Passing Interfaceï¼ŒMPIï¼‰\n- MPIæ˜¯ä¸€ä¸ªæ¶ˆæ¯ä¼ é€’æ¥å£æ ‡å‡†ï¼Œè€Œä¸æ˜¯ç¼–ç¨‹è¯­è¨€\n- MPIæ ‡å‡†å®šä¹‰äº†ä¸€ç»„å…·æœ‰å¯ç§»æ¤æ€§çš„ç¼–ç¨‹æ¥å£\n- MPIä»¥è¯­è¨€ç‹¬ç«‹çš„å½¢å¼å­˜åœ¨ï¼Œå¯è¿è¡Œåœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿå’Œç¡¬ä»¶å¹³å°ä¸Š\n- å…±æœ‰ä¸Šç™¾ä¸ªå‡½æ•°è°ƒç”¨æ¥å£ï¼ŒC/C++å’ŒFortranè¯­è¨€ä¸­å¯ä»¥ç›´æ¥å¯¹è¿™äº›å‡½æ•°è¿›è¡Œè°ƒç”¨\n### MPIåŸºæœ¬å‡½æ•°\n- MPIåˆå§‹åŒ–ï¼šé€šè¿‡`MPI_Init`å‡½æ•°è¿›å…¥MPIç¯å¢ƒå¹¶å®Œæˆæ‰€æœ‰çš„åˆå§‹åŒ–å·¥ä½œ\n```c\nint MPI_Init( int *argc, char ***argv )\n```\n- MPIç»“æŸï¼šé€šè¿‡`MPI_Finalize`å‡½æ•°ä»MPIç¯å¢ƒä¸­é€€å‡º\n```c\nint MPI_Finalize(void)\n```\n- è·å–è¿›ç¨‹çš„ç¼–å·ï¼šè°ƒç”¨`MPI_Comm_rank`å‡½æ•°è·å¾—å½“å‰è¿›ç¨‹åœ¨æŒ‡å®šé€šä¿¡åŸŸä¸­çš„ç¼–å·ï¼Œå°†è‡ªèº«ä¸å…¶ä»–ç¨‹åºåŒºåˆ†\n```c\nint MPI_Comm_rank(MPI_Comm comm, int *rank)\n```\n- è·å–æŒ‡å®šé€šä¿¡åŸŸçš„è¿›ç¨‹æ•°ï¼šè°ƒç”¨`MPI_Comm_size`å‡½æ•°è·å–æŒ‡å®šé€šä¿¡åŸŸçš„è¿›ç¨‹ä¸ªæ•°ï¼Œç¡®å®šè‡ªèº«å®Œæˆä»»åŠ¡æ¯”ä¾‹\n```c\nint MPI_Comm_size(MPI_Comm comm, int *size)\n```\n- æ¶ˆæ¯å‘é€ï¼š`MPI_Send`å‡½æ•°ç”¨äºå‘é€ä¸€ä¸ªæ¶ˆæ¯åˆ°ç›®æ ‡è¿›ç¨‹\n```c\nint MPI_Send(void *buf, int count, MPI_Datatype dataytpe, int dest, int tag, MPI_Comm comm) \n```\n- æ¶ˆæ¯æ¥æ”¶ï¼š`MPI_Recv`å‡½æ•°ç”¨äºä»æŒ‡å®šè¿›ç¨‹æ¥æ”¶ä¸€ä¸ªæ¶ˆæ¯\n```c\nint MPI_Recv(void *buf, int count, MPI_Datatype datatyepe,int source, int tag, MPI_Comm comm, MPI_Status *status)\n```\n### MPIæ¶ˆæ¯\n- æ¶ˆæ¯çš„å†…å®¹å³ä¿¡çš„å†…å®¹ï¼Œåœ¨MPIä¸­ç§°ä¸ºæ¶ˆæ¯ç¼“å†²(Message Buffer)\n- æ¶ˆæ¯ç¼“å†²ç”±ä¸‰å…ƒç»„<èµ·å§‹åœ°å€ï¼Œæ•°æ®ä¸ªæ•°ï¼Œæ•°æ®ç±»å‹>æ ‡è¯†\n- æ¶ˆæ¯çš„æ¥æ”¶/å‘é€è€…å³ä¿¡çš„åœ°å€ï¼Œåœ¨MPIä¸­ç§°ä¸ºæ¶ˆæ¯ä¿¡å°(Message Envelop)\n- æ¶ˆæ¯ä¿¡å°ç”±ä¸‰å…ƒç»„<æº/ç›®æ ‡è¿›ç¨‹ï¼Œæ¶ˆæ¯æ ‡ç­¾ï¼Œé€šä¿¡åŸŸ>æ ‡è¯† \n#### æ•°æ®ç±»å‹\n- MPIçš„æ¶ˆæ¯ç±»å‹åˆ†ä¸ºä¸¤ç§ï¼š**é¢„å®šä¹‰ç±»å‹**å’Œ**æ´¾ç”Ÿæ•°æ®ç±»å‹(Derived Data Type)**\n- **é¢„å®šä¹‰æ•°æ®ç±»å‹**ï¼šMPIæ”¯æŒå¼‚æ„è®¡ç®—(Heterogeneous Computing)\n\t- å¼‚æ„è®¡ç®—æŒ‡åœ¨ä¸åŒè®¡ç®—æœºç³»ç»Ÿä¸Šè¿è¡Œç¨‹åºï¼Œæ¯å°è®¡ç®—å¯èƒ½æœ‰ä¸åŒç”Ÿäº§å‚å•†ï¼Œä¸åŒæ“ä½œç³»ç»Ÿã€‚\n\t- MPIé€šè¿‡æä¾›é¢„å®šä¹‰æ•°æ®ç±»å‹æ¥è§£å†³å¼‚æ„è®¡ç®—ä¸­çš„äº’æ“ä½œæ€§é—®é¢˜ï¼Œå»ºç«‹å®ƒä¸å…·ä½“è¯­è¨€çš„å¯¹åº”å…³ç³»\n- **æ´¾ç”Ÿæ•°æ®ç±»å‹**ï¼šMPIå¼•å…¥æ´¾ç”Ÿæ•°æ®ç±»å‹æ¥å®šä¹‰ç”±æ•°æ®ç±»å‹ä¸åŒä¸”åœ°å€ç©ºé—´ä¸è¿ç»­çš„æ•°æ®é¡¹ç»„æˆçš„æ¶ˆæ¯ \n\n##### MPI_PACKED\n```c\ndouble A[100];\nMPI_Pack_size (50,MPI_DOUBLE,comm,&BufferSize);\nTempBuffer = malloc(BufferSize);\nj = sizeof(MPI_DOUBLE);\nPosition = 0;\nfor (i=0;i<50;i++)\n\tMPI_Pack(A+i*j,1,MPI_DOUBLE,TempBuffer,BufferSize,&Position,comm);\nMPI_Send(TempBuffer,Position,MPI_PACKED,destination,tag,comm); \n```\n- `MPI_Pack_size`å‡½æ•°æ¥å†³å®šç”¨äºå­˜æ”¾50ä¸ª`MPI_DOUBLE`æ•°æ®é¡¹çš„ä¸´æ—¶ç¼“å†²åŒºçš„å¤§å° \n- è°ƒç”¨`malloc`å‡½æ•°ä¸ºè¿™ä¸ªä¸´æ—¶ç¼“å†²åŒºåˆ†é…å†…å­˜ \n- forå¾ªç¯ä¸­å°†æ•°ç»„Açš„50ä¸ªå¶åºæ•°å…ƒç´ æ‰“åŒ…æˆä¸€ä¸ªæ¶ˆæ¯å¹¶å­˜æ”¾åœ¨ä¸´æ—¶ç¼“å†²åŒº\n- å°†ä¸´æ—¶ç¼“å†²åŒºçš„æ•°æ®ç±»å‹ä¸º`MPI_PACKED`çš„æ¶ˆæ¯å‘é€\n\næ¶ˆæ¯æ‰“åŒ…ï¼Œç„¶åå‘é€\n```c\nMPI_Pack(buf, count, dtype, \n\t\t\t//ä»¥ä¸Šä¸ºå¾…æ‰“åŒ…æ¶ˆæ¯æè¿°\n\t\t\tpackbuf, packsize, packpos, \n\t\t\t//ä»¥ä¸Šä¸ºæ‰“åŒ…ç¼“å†²åŒºæè¿°\n\t\t\tcommunicator)\n```\næ¶ˆæ¯æ¥æ”¶ï¼Œç„¶åæ‹†åŒ…\n```c\nMPI_Unpack(packbuf, packsize, packpos,\n\t\t\t//ä»¥ä¸Šä¸ºæ‹†åŒ…ç¼“å†²åŒºæè¿°\n\t\t\tbuf, count, dtype,\n\t\t\t// ä»¥ä¸Šä¸ºæ‹†åŒ…æ¶ˆæ¯æè¿°\n\t\t\tcommunicatior)\n```\n##### æ´¾ç”Ÿæ•°æ®ç±»å‹\n- **æ´¾ç”Ÿæ•°æ®ç±»å‹**å¯ä»¥ç”¨**ç±»å‹å›¾**æ¥æè¿°ï¼Œè¿™æ˜¯ä¸€ç§é€šç”¨çš„ç±»å‹æè¿°æ–¹æ³•ï¼Œå®ƒæ˜¯ä¸€ç³»åˆ—äºŒå…ƒç»„<åŸºç±»å‹ï¼Œåç§»>çš„é›†åˆï¼Œå¯ä»¥è¡¨ç¤ºæˆå¦‚ä¸‹æ ¼å¼ï¼š\n\t- {<åŸºç±»å‹0,åç§»0>ï¼ŒÂ·Â·Â·ï¼Œ<åŸºç±»å‹n-1,åç§»n-1>}\n- åœ¨æ´¾ç”Ÿæ•°æ®ç±»å‹ä¸­ï¼ŒåŸºç±»å‹å¯ä»¥æ˜¯ä»»ä½•MPIé¢„å®šä¹‰æ•°æ®ç±»å‹ï¼Œä¹Ÿå¯ä»¥æ˜¯å…¶å®ƒçš„æ´¾ç”Ÿæ•°æ®ç±»å‹ï¼Œå³æ”¯æŒæ•°æ®ç±»å‹çš„åµŒå¥—å®šä¹‰ \n\n- MPIæä¾›äº†å…¨é¢è€Œå¼ºå¤§çš„æ„é€ å‡½æ•°(Constructor Function)æ¥å®šä¹‰æ´¾ç”Ÿæ•°æ®ç±»å‹\n\nå‡½æ•°å|å«ä¹‰\n-|-\n`MPI_Type_contiguous`|å®šä¹‰ç”±ç›¸åŒæ•°æ®ç±»å‹çš„å…ƒç´ ç»„æˆçš„ç±»å‹\n`MPI_Type_vector`|å®šä¹‰ç”±æˆå—çš„å…ƒç´ ç»„æˆçš„ç±»å‹ï¼Œå—ä¹‹é—´å…·æœ‰ç›¸åŒé—´éš”\n`MPI_Type_indexed`|å®šä¹‰ç”±æˆå—çš„å…ƒç´ ç»„æˆçš„ç±»å‹ï¼Œå—é•¿åº¦å’Œåç§»ç”±å‚æ•°æŒ‡å®š\n`MPI_Type_struct`|å®šä¹‰ç”±ä¸åŒæ•°æ®ç±»å‹çš„å…ƒç´ ç»„æˆçš„ç±»å‹\n`MPI_Type_commit`|æäº¤ä¸€ä¸ªæ´¾ç”Ÿæ•°æ®ç±»å‹\n`MPI_Type_free`|é‡Šæ”¾ä¸€ä¸ªæ´¾ç”Ÿæ•°æ®ç±»å‹\n##### MPI_Type_vector\n- `MPI_Type_vector(count, blocklength, stride, oldtype, &newtype)`\n\t- countï¼šæ´¾ç”Ÿæ•°æ®ç±»å‹newtypeç”±countä¸ªæ•°æ®å—æ„æˆã€‚\n\t- blocklengthå’Œoldtypeï¼šæ¯ä¸ªæ•°æ®å—ç”±blocklengthä¸ªoldtypeç±»å‹çš„è¿ç»­æ•°æ®é¡¹ç»„æˆã€‚\n\t- strideï¼šä¸¤ä¸ªè¿ç»­æ•°æ®å—çš„èµ·å§‹ä½ç½®ä¹‹é—´çš„oldtypeç±»å‹å…ƒç´ çš„ä¸ªæ•°ã€‚å› æ­¤ï¼Œä¸¤ä¸ªå—ä¹‹é—´çš„é—´éš”å¯ä»¥ç”±(stride-blocklength)æ¥è¡¨ç¤º\n##### MPI_Type_struct\n```c\nMPI_Type_struct(\n    count, //æˆå‘˜æ•° \n    array_of_blocklengths, //æˆå‘˜å—é•¿åº¦æ•°ç»„\n    array_of_displacements,//æˆå‘˜åç§»æ•°ç»„     \n    array_of_types, //æˆå‘˜ç±»å‹æ•°ç»„\n    newtype // æ–°ç±»å‹\n) \n```\n#### é€šä¿¡åŸŸ\nMPIæä¾›ä¸°å¯Œçš„å‡½æ•°ç”¨äºç®¡ç†é€šä¿¡åŸŸ \n\n\nå‡½æ•°å|å«ä¹‰\n-|-\n`MPI_Comm_size`|è·å–æŒ‡å®šé€šä¿¡åŸŸä¸­è¿›ç¨‹çš„ä¸ªæ•°\n`MPI_Comm_rank`|è·å–å½“å‰è¿›ç¨‹åœ¨æŒ‡å®šé€šä¿¡åŸŸä¸­çš„ç¼–å·\n`MPI_Comm_compare`|å¯¹ç»™å®šçš„ä¸¤ä¸ªé€šä¿¡åŸŸè¿›è¡Œæ¯”è¾ƒ\n`MPI_Comm_dup`|å¤åˆ¶ä¸€ä¸ªå·²æœ‰çš„é€šä¿¡åŸŸç”Ÿæˆä¸€ä¸ªæ–°çš„é€šä¿¡åŸŸï¼Œä¸¤è€…é™¤é€šä¿¡ä¸Šä¸‹æ–‡ä¸åŒå¤–ï¼Œå…¶å®ƒéƒ½ä¸€æ ·\n`MPI_Comm_create`|æ ¹æ®ç»™å®šçš„è¿›ç¨‹ç»„åˆ›å»ºä¸€ä¸ªæ–°çš„é€šä¿¡åŸŸ\n`MPI_Comm_split`|ä»ä¸€ä¸ªæŒ‡å®šé€šä¿¡åŸŸåˆ†è£‚å‡ºå¤šä¸ªå­é€šä¿¡åŸŸï¼Œæ¯ä¸ªå­é€šä¿¡åŸŸä¸­çš„è¿›ç¨‹éƒ½æ˜¯åŸé€šä¿¡åŸŸä¸­çš„è¿›ç¨‹\n`MPI_Comm_free`|é‡Šæ”¾ä¸€ä¸ªé€šä¿¡åŸŸ\n#### ç»„é—´é€šä¿¡åŸŸ\n- **ç»„é—´é€šä¿¡åŸŸ**æ˜¯ä¸€ç§ç‰¹æ®Šçš„é€šä¿¡åŸŸï¼Œè¯¥é€šä¿¡åŸŸåŒ…æ‹¬äº†ä¸¤ä¸ªè¿›ç¨‹ç»„ï¼Œåˆ†å±äºä¸¤ä¸ªè¿›ç¨‹ç»„çš„è¿›ç¨‹ä¹‹é—´é€šè¿‡ç»„é—´é€šä¿¡åŸŸå®ç°é€šä¿¡\n- ä¸€èˆ¬æŠŠè°ƒç”¨è¿›ç¨‹æ‰€åœ¨çš„è¿›ç¨‹ç»„ç§°ä¸ºæœ¬åœ°è¿›ç¨‹ç»„ï¼Œè€ŒæŠŠå¦å¤–ä¸€ä¸ªç§°ä¸ºè¿œç¨‹è¿›ç¨‹ç»„\n\nå‡½æ•°å|å«ä¹‰\n-|-\n`MPI_Comm_test_inter`|åˆ¤æ–­ç»™å®šçš„é€šä¿¡åŸŸæ˜¯å¦ä¸ºç»„é—´é€šä¿¡åŸŸ\n`MPI_Comm_remote_size`|è·å–æŒ‡å®šç»„é—´é€šä¿¡åŸŸä¸­è¿œç¨‹è¿›ç¨‹ç»„çš„å¤§å°\n`MPI_Comm_remote_group`|è¿”å›ç»™å®šç»„é—´é€šä¿¡åŸŸçš„è¿œç¨‹è¿›ç¨‹ç»„\n`MPI_Intercomm_creat`|æ ¹æ®ç»™å®šçš„ä¸¤ä¸ªç»„å†…é€šä¿¡åŸŸç”Ÿæˆä¸€ä¸ªç»„é—´é€šä¿¡åŸŸã€‚\n`MPI_Intercomm_merge`|å°†ç»™å®šç»„é—´é€šä¿¡åŸŸåŒ…å«çš„ä¸¤ä¸ªè¿›ç¨‹ç»„åˆå¹¶ï¼Œå½¢æˆä¸€ä¸ªæ–°çš„ç»„å†…é€šä¿¡åŸŸ\n\n### ç‚¹å¯¹ç‚¹é€šä¿¡\n- å…±æœ‰ä¸‹é¢å››ç§é€šä¿¡æ¨¡å¼ï¼š\n\t- åŒæ­¥(synchronous)é€šä¿¡æ¨¡å¼\n\t- ç¼“å†²(buffered)é€šä¿¡æ¨¡å¼\n\t- æ ‡å‡†(standard)é€šä¿¡æ¨¡å¼\n\t- å°±ç»ª(ready)é€šä¿¡æ¨¡å¼\n- åŒæ—¶ä¹Ÿæä¾›äº†é˜»å¡å’Œéé˜»å¡ä¸¤ç§é€šä¿¡æœºåˆ¶\n- ä¸åŒé€šä¿¡æ¨¡å¼å’Œä¸åŒé€šä¿¡æœºåˆ¶çš„ç»“åˆï¼Œä¾¿äº§ç”Ÿäº†éå¸¸ä¸°å¯Œçš„ç‚¹å¯¹ç‚¹é€šä¿¡å‡½æ•°\n#### åŒæ­¥(synchronous)é€šä¿¡æ¨¡å¼\n- åŒæ­¥é€šä¿¡æ¨¡å¼ï¼šåªæœ‰ç›¸åº”çš„æ¥æ”¶è¿‡ç¨‹å·²ç»å¯åŠ¨ï¼Œå‘é€è¿‡ç¨‹æ‰æ­£ç¡®è¿”å›\n- åŒæ­¥å‘é€è¿”å›åï¼Œè¡¨ç¤ºå‘é€ç¼“å†²åŒºä¸­çš„æ•°æ®å·²ç»å…¨éƒ¨è¢«ç³»ç»Ÿç¼“å†²åŒºç¼“å­˜ï¼Œå¹¶ä¸”å·²ç»å¼€å§‹å‘é€\n- åŒæ­¥å‘é€è¿”å›åï¼Œå‘é€ç¼“å†²åŒºå¯ä»¥è¢«é‡Šæ”¾æˆ–è€…é‡æ–°ä½¿ç”¨\n#### ç¼“å†²(buffered)é€šä¿¡æ¨¡å¼\n- ç¼“å†²é€šä¿¡æ¨¡å¼ï¼šç¼“å†²é€šä¿¡æ¨¡å¼çš„å‘é€ä¸ç®¡æ¥æ”¶æ“ä½œæ˜¯å¦å·²ç»å¯åŠ¨éƒ½å¯ä»¥æ‰§è¡Œ\n- ä½†æ˜¯éœ€è¦ç”¨æˆ·ç¨‹åºäº‹å…ˆç”³è¯·ä¸€å—è¶³å¤Ÿå¤§çš„ç¼“å†²åŒºï¼Œé€šè¿‡MPI_Buffer_attachå®ç°ï¼Œé€šè¿‡MPI_Buffer_detachæ¥å›æ”¶ç”³è¯·çš„ç¼“å†²åŒº\n#### æ ‡å‡†(standard)é€šä¿¡æ¨¡å¼\n- æ ‡å‡†é€šä¿¡æ¨¡å¼ï¼šæ˜¯å¦å¯¹å‘é€çš„æ•°æ®è¿›è¡Œç¼“å†²ç”±MPIçš„å®ç°æ¥å†³å®šï¼Œè€Œä¸æ˜¯ç”±ç”¨æˆ·ç¨‹åºæ¥æ§åˆ¶\n- å‘é€å¯ä»¥æ˜¯åŒæ­¥çš„æˆ–ç¼“å†²çš„ï¼Œå–å†³äºå®ç°\n#### å°±ç»ª(ready)é€šä¿¡æ¨¡å¼\n- å°±ç»ªé€šä¿¡æ¨¡å¼ï¼šå‘é€æ“ä½œåªæœ‰åœ¨æ¥æ”¶è¿›ç¨‹ç›¸åº”çš„æ¥æ”¶æ“ä½œå·²ç»å¼€å§‹æ‰è¿›è¡Œå‘é€\n- å½“å‘é€æ“ä½œå¯åŠ¨è€Œç›¸åº”çš„æ¥æ”¶è¿˜æ²¡æœ‰å¯åŠ¨ï¼Œå‘é€æ“ä½œå°†å‡ºé”™ã€‚å°±ç»ªé€šä¿¡æ¨¡å¼çš„ç‰¹æ®Šä¹‹å¤„å°±æ˜¯æ¥æ”¶æ“ä½œå¿…é¡»å…ˆäºå‘é€æ“ä½œå¯åŠ¨\n#### é€šä¿¡æœºåˆ¶\n- é˜»å¡å’Œéé˜»å¡é€šä¿¡çš„ä¸»è¦åŒºåˆ«åœ¨äºè¿”å›åçš„èµ„æºå¯ç”¨æ€§\n- é˜»å¡é€šä¿¡è¿”å›çš„æ¡ä»¶ï¼š\n\t- é€šä¿¡æ“ä½œå·²ç»å®Œæˆï¼Œå³æ¶ˆæ¯å·²ç»å‘é€æˆ–æ¥æ”¶ã€‚\n\t- è°ƒç”¨çš„ç¼“å†²åŒºå¯ç”¨ã€‚è‹¥æ˜¯å‘é€æ“ä½œï¼Œåˆ™è¯¥ç¼“å†²åŒºå¯ä»¥è¢«å…¶å®ƒçš„æ“ä½œæ›´æ–°ï¼›è‹¥æ˜¯æ¥æ”¶æ“ä½œï¼Œè¯¥ç¼“å†²åŒºçš„æ•°æ®å·²ç»å®Œæ•´ï¼Œå¯ä»¥è¢«æ­£ç¡®å¼•ç”¨\n- éé˜»å¡é€šä¿¡è¿”å›åå¹¶ä¸æ„å‘³ç€é€šä¿¡æ“ä½œçš„å®Œæˆï¼ŒMPIè¿˜æä¾›äº†å¯¹éé˜»å¡é€šä¿¡å®Œæˆçš„æ£€æµ‹ï¼Œä¸»è¦çš„æœ‰ä¸¤ç§MPI_Waitå‡½æ•°å’ŒMPI_Testå‡½æ•°\n- MPIçš„å‘é€æ“ä½œæ”¯æŒå››ç§é€šä¿¡æ¨¡å¼ï¼Œå®ƒä»¬ä¸é˜»å¡å±æ€§ä¸€èµ·äº§ç”Ÿäº†MPIä¸­çš„8ç§å‘é€æ“ä½œ\n- MPIçš„æ¥æ”¶æ“ä½œåªæœ‰ä¸¤ç§ï¼šé˜»å¡æ¥æ”¶å’Œéé˜»å¡æ¥æ”¶\n\nMPI åŸè¯­|é˜»å¡|éé˜»å¡\n-|-|-\nStandard Send|`MPI_Send`|`MPI_Isend`\nSynchronous Send|`MPI_Ssend`|`MPI_ Issend`\nBuffered Send|`MPI_ Bsend`|`MPI_ Ibsend`\nReady Send|`MPI_ Rsend`|`MPI_ Irsend`\nReceive|`MPI_Recv`|`MPI_Irecv`\nCompletion Check|`MPI_Wait`|`MPI_Test`\n\n##### Send-Recvå‡½æ•°\n- ç»™ä¸€ä¸ªè¿›ç¨‹å‘é€æ¶ˆæ¯ï¼Œä»å¦ä¸€ä¸ªè¿›ç¨‹æ¥æ”¶æ¶ˆæ¯ï¼›\n- ç‰¹åˆ«é€‚ç”¨äºåœ¨è¿›ç¨‹é“¾ï¼ˆç¯ï¼‰ä¸­è¿›è¡Œâ€œç§»ä½â€æ“ä½œï¼Œè€Œé¿å…åœ¨é€šè®¯ä¸ºé˜»å¡æ–¹å¼æ—¶å‡ºç°æ­»é”\n```c\nMPI_Sendrecv( sendbuf, sendcount, sendtype, dest, sendtag,\n\t\t\t//ä»¥ä¸Šä¸ºæ¶ˆæ¯å‘é€çš„æè¿°\n\t\t\trecvbuf, recvcount, recvtype, source, recvtag, \n\t\t\t// ä»¥ä¸Šä¸ºæ¶ˆæ¯æ¥æ”¶çš„æè¿°\n\t\t\tcomm, status)\n```\n\n### é›†åˆé€šä¿¡\n- é›†åˆé€šä¿¡ä¸€èˆ¬å®ç°ä¸‰ä¸ªåŠŸèƒ½ï¼šé€šä¿¡ã€èšé›†å’ŒåŒæ­¥\n\t- é€šä¿¡åŠŸèƒ½ä¸»è¦å®Œæˆç»„å†…æ•°æ®çš„ä¼ è¾“ \n\t- èšé›†åŠŸèƒ½åœ¨é€šä¿¡çš„åŸºç¡€ä¸Šå¯¹ç»™å®šçš„æ•°æ®å®Œæˆä¸€å®šçš„æ“ä½œ \n\t- åŒæ­¥åŠŸèƒ½å®ç°ç»„å†…æ‰€æœ‰è¿›ç¨‹åœ¨æ‰§è¡Œè¿›åº¦ä¸Šå–å¾—ä¸€è‡´ \n- æŒ‰ç…§é€šä¿¡æ–¹å‘çš„ä¸åŒï¼Œåˆå¯ä»¥åˆ†ä¸ºä¸‰ç§ï¼š\n\t- ä¸€å¯¹å¤šé€šä¿¡ï¼šä¸€ä¸ªè¿›ç¨‹å‘å…¶å®ƒæ‰€æœ‰çš„è¿›ç¨‹å‘é€æ¶ˆæ¯ï¼Œè¿™ä¸ªè´Ÿè´£å‘é€æ¶ˆæ¯çš„è¿›ç¨‹å«åšRootè¿›ç¨‹\n\t- å¤šå¯¹ä¸€é€šä¿¡ï¼šä¸€ä¸ªè¿›ç¨‹ä»å…¶å®ƒæ‰€æœ‰çš„è¿›ç¨‹æ¥æ”¶æ¶ˆæ¯ï¼Œè¿™ä¸ªæ¥æ”¶çš„è¿›ç¨‹ä¹Ÿå«åšRootè¿›ç¨‹\n\t- å¤šå¯¹å¤šé€šä¿¡ï¼šæ¯ä¸ªè¿›ç¨‹éƒ½å‘å…¶å®ƒæ‰€æœ‰çš„è¿›ç¨‹å‘é€æˆ–è€…æ¥æ”¶æ¶ˆæ¯\n\nå‡½æ•°å|å«ä¹‰\n-|-\n`MPI_Bcast`|ä¸€å¯¹å¤šå¹¿æ’­åŒæ ·çš„æ¶ˆæ¯\n`MPI_Gather`|å¤šå¯¹ä¸€æ”¶é›†å„ä¸ªè¿›ç¨‹çš„æ¶ˆæ¯\n`MPI_Gatherv`|MPI_Gatherçš„ä¸€èˆ¬åŒ–\n`MPI_Allgather`|å…¨å±€æ”¶é›†\n`MPI_Allgatherv`|MPI_Allgatherçš„ä¸€èˆ¬åŒ–\n`MPI_Scatter`|ä¸€å¯¹å¤šæ•£æ’­ä¸åŒçš„æ¶ˆæ¯\n`MPI_Scatterv`|MPI_Scatterçš„ä¸€èˆ¬åŒ–\n`MPI_Alltoall`|å¤šå¯¹å¤šå…¨å±€äº¤æ¢æ¶ˆæ¯\n`MPI_Alltoallv`|MPI_Alltoallçš„ä¸€èˆ¬åŒ–\n`MPI_Reduce`|å¤šå¯¹ä¸€å½’çº¦\n`MPI_Allreduce`|MPI_Reduceçš„ä¸€èˆ¬åŒ–\n`MPI_Reduce`|scatter\tMPI_Reduceçš„ä¸€èˆ¬åŒ–\n`MPI_Scan`|æ‰«æ\n`MPI_Barrier`|è·¯éšœåŒæ­¥\n#### å¹¿æ’­MPI_Bcast\n- Rootè¿›ç¨‹å‘é€ç›¸åŒçš„æ¶ˆæ¯ç»™é€šä¿¡åŸŸCommä¸­çš„æ‰€æœ‰è¿›ç¨‹\n- å¯¹Rootè¿›ç¨‹æ¥è¯´ï¼Œè¿™ä¸ªä¸‰å…ƒç»„æ—¢å®šä¹‰äº†å‘é€ç¼“å†²ä¹Ÿå®šä¹‰äº†æ¥æ”¶ç¼“å†²ã€‚å¯¹å…¶å®ƒè¿›ç¨‹æ¥è¯´ï¼Œè¿™ä¸ªä¸‰å…ƒç»„åªå®šä¹‰äº†æ¥æ”¶ç¼“å†² \n```c\nMPI_Bcast(Address, Count, Datatype, Root, Comm)\n```\n\n#### æ”¶é›†MPI_Gather\n- Rootè¿›ç¨‹ä»è¿›ç¨‹åŸŸCommçš„æ‰€æœ‰è¿›ç¨‹(åŒ…æ‹¬å®ƒè‡ªå·²)æ¥æ”¶æ¶ˆæ¯\n- æ¶ˆæ¯æŒ‰ç…§è¿›ç¨‹çš„æ ‡è¯†rankæ’åºå¹¶è¿›è¡Œæ‹¼æ¥ï¼Œç„¶åå­˜æ”¾åœ¨Rootè¿›ç¨‹çš„æ¥æ”¶ç¼“å†²ä¸­\n- æ‰€æœ‰éRootè¿›ç¨‹å¿½ç•¥æ¥æ”¶ç¼“å†²\n```c\nMPI_Gather(SendAddress, SendCount, SendDatatype, RecvAddress, RecvCount, RecvDatatype, Root, Comm)\n```\n\n#### æ•£æ’­MPI_Scatter\n- Scatteræ‰§è¡Œä¸Gatherç›¸åçš„æ“ä½œ\n- Rootè¿›ç¨‹ç»™æ‰€æœ‰è¿›ç¨‹(åŒ…æ‹¬å®ƒè‡ªå·²)å‘é€ä¸åŒçš„æ¶ˆæ¯ï¼Œè¿™n (nä¸ºè¿›ç¨‹åŸŸcommåŒ…æ‹¬çš„è¿›ç¨‹ä¸ªæ•°)ä¸ªæ¶ˆæ¯åœ¨Rootè¿›ç¨‹çš„å‘é€ç¼“å†²åŒºä¸­æŒ‰è¿›ç¨‹æ ‡è¯†çš„é¡ºåºæœ‰åºåœ°å­˜æ”¾\n```c\nMPI_Scatter(SendAddress, SendCount, SendDatatype, RecvAddress, RecvCount, RecvDatatype, Root, Comm)\n```\n\n#### å…¨å±€æ”¶é›†MPI_Allgather\n- Allgatheræ“ä½œç›¸å½“äºæ¯ä¸ªè¿›ç¨‹éƒ½ä½œä¸ºRootè¿›ç¨‹æ‰§è¡Œäº†ä¸€æ¬¡Gatherè°ƒç”¨ï¼Œå³æ¯ä¸€ä¸ªè¿›ç¨‹éƒ½æŒ‰ç…§Gatherçš„æ–¹å¼æ”¶é›†æ¥è‡ªæ‰€æœ‰è¿›ç¨‹(åŒ…æ‹¬è‡ªå·±)çš„æ•°æ®\n```c\nMPI_Allgather(SendAddress, SendCount, SendDatatype, RecvAddress, RecvCount, RecvDatatype, Comm)\n```\n\n#### å…¨å±€äº¤æ¢MPI_Alltoall\n- æ¯ä¸ªè¿›ç¨‹å‘é€ä¸€ä¸ªæ¶ˆæ¯ç»™æ‰€æœ‰è¿›ç¨‹(åŒ…æ‹¬å®ƒè‡ªå·²)\n- n (nä¸ºè¿›ç¨‹åŸŸcommåŒ…æ‹¬çš„è¿›ç¨‹ä¸ªæ•°)ä¸ªæ¶ˆæ¯åœ¨å‘é€ç¼“å†²ä¸­ä»¥è¿›ç¨‹æ ‡è¯†çš„é¡ºåºæœ‰åºåœ°å­˜æ”¾ã€‚ä»æ¥æ”¶è§’åº¦çœ‹ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½ä»æ‰€æœ‰è¿›ç¨‹æ¥æ”¶ä¸€ä¸ªæ¶ˆæ¯ï¼Œè¿™nä¸ªæ¶ˆæ¯ä»¥æ ‡å·çš„é¡ºåºè¢«è¿æ¥èµ·æ¥ï¼Œå­˜æ”¾åœ¨æ¥æ”¶ç¼“å†²ä¸­\n- å…¨å±€äº¤æ¢ç­‰ä»·äºæ¯ä¸ªè¿›ç¨‹ä½œä¸ºRootè¿›ç¨‹æ‰§è¡Œäº†ä¸€æ¬¡æ•£æ’­æ“ä½œ\n```c\nMPI_Alltoall(SendAddress, SendCount, SendDatatype, RecvAddress, RecvCount, RecvDatatype, Comm)\n```\n\n#### è·¯éšœMPI_Barrier\n- åœ¨è·¯éšœåŒæ­¥æ“ä½œMPI_Barrier(Comm)ä¸­ï¼Œé€šä¿¡åŸŸCommä¸­çš„æ‰€æœ‰è¿›ç¨‹ç›¸äº’åŒæ­¥\n```c\nMPI_Barrier(Comm)\n```\n\n#### å½’çº¦MPI_Reduce\n- å½’çº¦æ“ä½œå¯¹æ¯ä¸ªè¿›ç¨‹çš„å‘é€ç¼“å†²åŒº(SendAddress)ä¸­çš„æ•°æ®æŒ‰ç»™å®šçš„æ“ä½œè¿›è¡Œè¿ç®—ï¼Œå¹¶å°†æœ€ç»ˆç»“æœå­˜æ”¾åœ¨Rootè¿›ç¨‹çš„æ¥æ”¶ç¼“å†²åŒº(RecvAddress)ä¸­\n- å‚ä¸è®¡ç®—æ“ä½œçš„æ•°æ®é¡¹çš„æ•°æ®ç±»å‹åœ¨Datatypeä¸­å®šä¹‰ï¼Œå½’çº¦æ“ä½œç”±Opå®šä¹‰\n- å½’çº¦æ“ä½œå¯ä»¥æ˜¯MPIé¢„å®šä¹‰çš„,ä¹Ÿå¯ä»¥æ˜¯ç”¨æˆ·è‡ªå®šä¹‰çš„\n- å½’çº¦æ“ä½œå…è®¸æ¯ä¸ªè¿›ç¨‹æä¾›å‘é‡å€¼ï¼Œè€Œä¸åªæ˜¯æ ‡é‡å€¼ï¼Œå‘é‡çš„é•¿åº¦ç”±Countå®šä¹‰\n```c\nMPI_Reduce(SendAddress, RecvAddress, Count, Datatype, Op, Root, Comm)\n```\n\næ“ä½œ|å«ä¹‰|æ“ä½œ|å«ä¹‰\n-|-|-|-\n`MPI_MAX`|æœ€å¤§å€¼|`MPI_LOR`|é€»è¾‘æˆ–\n`MPI_MIN`|æœ€å°å€¼|`MPI_BOR`|æŒ‰ä½æˆ–\n`MPI_SUM`|æ±‚å’Œ|`MPI_LXOR`|é€»è¾‘å¼‚æˆ–\n`MPI_PROD`|æ±‚ç§¯|`MPI_BXOR`|æŒ‰ä½å¼‚æˆ–\n`MPI_LAND`|é€»è¾‘ä¸|`MPI_MAXLOC`|æœ€å¤§å€¼ä¸”ç›¸åº”ä½ç½®\n`MPI_BAND`|æŒ‰ä½ä¸|`MPI_MINLOC`|æœ€å°å€¼ä¸”ç›¸åº”ä½ç½®\n\n#### æ‰«æMPI_scan\n- å¯ä»¥æŠŠæ‰«ææ“ä½œçœ‹ä½œæ˜¯ä¸€ç§ç‰¹æ®Šçš„å½’çº¦ï¼Œå³æ¯ä¸€ä¸ªè¿›ç¨‹éƒ½å¯¹æ’åœ¨å®ƒå‰é¢çš„è¿›ç¨‹è¿›è¡Œå½’çº¦æ“ä½œ\n- MPI_SCANè°ƒç”¨çš„ç»“æœæ˜¯ï¼šå¯¹äºæ¯ä¸€ä¸ªè¿›ç¨‹iï¼Œå®ƒå¯¹è¿›ç¨‹0,1,â€¦,içš„å‘é€ç¼“å†²åŒºçš„æ•°æ®è¿›è¡Œäº†æŒ‡å®šçš„å½’çº¦æ“ä½œ\n- æ‰«ææ“ä½œä¹Ÿå…è®¸æ¯ä¸ªè¿›ç¨‹è´¡çŒ®å‘é‡å€¼ï¼Œè€Œä¸åªæ˜¯æ ‡é‡å€¼ã€‚å‘é‡çš„é•¿åº¦ç”±Countå®šä¹‰\n```c\nMPI_scan(SendAddress, RecvAddress, Count, Datatype, Op, Comm)\n```","tags":["å¹¶è¡Œ"],"categories":["è®¡è½¯æ‚è°ˆ","å­¦ä¹ ç¬”è®°"]},{"title":"è®¡ç®—æœºç½‘ç»œ-ç½‘ç»œå±‚ å­¦ä¹ ç¬”è®°","url":"/20230128/network-layer/","content":"- è´Ÿè´£é€šè¿‡å¤šä¸ªé“¾è·¯ä»æºç«¯å‘æ¥æ”¶æ–¹ä¼ é€’æ•°æ®åŒ…\n\n## ç½‘ç»œå±‚çš„è®¾è®¡é—®é¢˜\n\n### å­˜å‚¨è½¬å‘æ•°æ®åŒ…äº¤æ¢\n\n- ä¸»æœºå‘ç½‘ç»œå‘é€æ•°æ®ï¼Œæ•°æ®åŒ…ç”±è·¯ç”±å™¨è½¬å‘\n- æ•°æ®åŒ…åˆ°è¾¾è·¯ç”±å™¨ï¼Œå¹¶è·¯ç”±å™¨çš„é“¾è·¯å±‚å®Œæˆäº†å¯¹å…¶æ ¡éªŒå’Œçš„éªŒè¯åï¼Œå®ƒå…ˆè¢«**å­˜å‚¨**åœ¨è·¯ç”±å™¨ä¸Šï¼Œç„¶åè¢«è½¬å‘åˆ°ä¸‹ä¸€ä¸ªè·¯ç”±å™¨ä¸Š\n\n### æä¾›ç»™ä¼ è¾“å±‚çš„æœåŠ¡\n\n#### é¢å‘æ— è¿æ¥çš„æœåŠ¡ï¼ˆæ•°æ®æŠ¥ç½‘ç»œï¼‰\n\n- æ¯ä¸ªæ•°æ®åŒ…éƒ½æ˜¯ç‹¬ç«‹å¤„ç†çš„\n- ç½‘ç»œå±‚åªè´Ÿè´£å°†æ•°æ®åŒ…ä»æºä¼ é€åˆ°ç›®çš„åœ°\n- æ•°æ®åŒ…ä½¿ç”¨å…¶ç›®æ ‡åœ°å€é€šè¿‡è·¯ç”±è¡¨è¿›è¡Œè½¬å‘\n    - æ•°æ®åŒ…å¯ä»¥é€šè¿‡**ä¸åŒçš„è·¯å¾„**åˆ°è¾¾ç›®çš„åœ°\n- è·¯ç”±è¡¨ä¼šç”±äºæµé‡æ‹¥å¡è€Œè¿›è¡Œæ›´æ–°\n    - ç®¡ç†è·¯ç”±è¡¨å¹¶åšå‡ºè·¯ç”±é€‰æ‹©çš„ç®—æ³•ç§°ä¸º**è·¯ç”±ç®—æ³•ï¼ˆrouting algorithmï¼‰**\n\n#### é¢å‘è¿æ¥çš„æœåŠ¡ï¼ˆè™šç”µè·¯ç½‘ç»œï¼‰\n\n- åœ¨å‘é€æ•°æ®æŠ¥ä¹‹å‰ï¼Œåº”å»ºç«‹è™šæ‹Ÿè¿æ¥ä»¥ç¡®å®šæ•°æ®æŠ¥çš„ä¼ é€è·¯å¾„\n- æ•°æ®åŒ…åŒ…å«æºåœ°å€å’Œç›®æ ‡åœ°å€ï¼Œä¸€ä¸ªæµæ ‡ç­¾ï¼Œä¸€ä¸ªè™šç”µè·¯æ ‡è¯†ç¬¦æŒ‡æ˜å±äºå“ªä¸€æ¡è™šç”µè·¯ï¼ˆVCå·ï¼‰\n- æ•°æ®åŒ…ä½¿ç”¨å…¶å†…éƒ¨çš„æ ‡è¯†ç¬¦æ²¿è™šç”µè·¯è½¬å‘\n    - è™šç”µè·¯å»ºç«‹è¿‡ç¨‹ä¸­ç¡®å®šæ¯æ¡é“¾è·¯çš„VCå·ï¼ŒåŒæ—¶åœ¨è·¯ç”±å™¨è½¬å‘è¡¨ä¸­å¢åŠ è¡¨é¡¹\n    - è¿æ¥å»ºç«‹åï¼Œæ•°æ®æŠ¥å…¨éƒ¨æ²¿**ç›¸åŒçš„è·¯å¾„**åˆ°è¾¾ç›®çš„åœ°\n- æ¯å°è·¯ç”±å™¨çš„è½¬å‘è¡¨åŒ…æ‹¬äº†VCå·çš„è½¬æ¢ã€å…¥æ¥å£ï¼Œå…¥VCå·ï¼Œå‡ºæ¥å£ï¼Œå‡ºVCå·ã€‘\n- è·¯ç”±å™¨ä¼šä¸ºå‡ºå¢ƒæµé‡åˆ†é…ä¸åŒçš„VCå·ï¼Œè¿™è¢«ç§°ä¸º**æ ‡ç­¾äº¤æ¢ï¼ˆlabel switchingï¼‰**\n    - å¤šåè®®æ ‡ç­¾äº¤æ¢ï¼ˆMPLSï¼ŒMultiiProtocol Label Switchingï¼‰ï¼Œä¸»è¦è¢«ç”¨åœ¨ISPç½‘ç»œ\n- ä¸€ä¸ªåˆ†ç»„æ²¿ç€å…¶è·¯ç”±åœ¨æ¯æ¡é“¾è·¯ä¸Šä¸ç®€å•çš„ä¿æŒç›¸åŒçš„VCå·çš„åŸå› \n    - é€é“¾è·¯VCå·ä»£æ›¿ç»Ÿä¸€å·ç å‡å°‘äº†åœ¨åˆ†ç»„é¦–éƒ¨ä¸­VCå­—æ®µçš„é•¿åº¦\n    - é€šè¿‡å…è®¸æ²¿ç€è¯¥è™šç”µè·¯è·¯å¾„çš„æ¯æ¡é“¾è·¯æœ‰ä¸åŒçš„VCå·ï¼Œå¤§å¤§ç®€åŒ–äº†è™šç”µè·¯çš„å»ºç«‹\n\n#### è™šç”µè·¯ä¸æ•°æ®æŠ¥ç½‘ç»œçš„æ¯”è¾ƒ\n\n| é—®é¢˜  | æ•°æ®åŒ…ç½‘ç»œ | è™šç”µè·¯ç½‘ç»œ |\n|-|-|-|\n| ç”µè·¯å»ºç«‹ | ä¸éœ€è¦ | éœ€è¦  |\n| å¯»å€  | æ¯ä¸ªåŒ…åŒ…å«å…¨éƒ¨çš„æºå’Œç›®æ ‡åœ°å€ | æ¯ä¸ªåŒ…åŒ…å«ç®€çŸ­çš„VCå· |\n| çŠ¶æ€ä¿¡æ¯ | è·¯ç”±å™¨ä¸ä¿ç•™è¿æ¥çŠ¶æ€ | é’ˆå¯¹æ¯ä¸ªè¿æ¥ï¼Œæ¯æ¡VCéƒ½éœ€è¦è·¯ç”±å™¨ä¿å­˜å…¶çŠ¶æ€ |\n| è·¯ç”±æ–¹å¼ | æ¯ä¸ªæ•°æ®åŒ…è¢«å•ç‹¬è·¯ç”± | å»ºç«‹VCæ—¶é€‰æ‹©è·¯ç”±ï¼Œæ‰€æœ‰åŒ…éƒ½éµå¾ªè¯¥è·¯ç”± |\n| è·¯ç”±å™¨å¤±æ•ˆçš„å½±å“ | æ²¡å½±å“ï¼Œé™¤äº†é‚£äº›è·¯ç”±å™¨å¥”æºƒæœŸé—´ä¸¢å¤±çš„åŒ… | ç©¿è¿‡æ•…éšœè·¯ç”±å™¨çš„æ‰€æœ‰VCéƒ½å°†ä¸­æ–­ |\n| æœåŠ¡è´¨é‡ | å›°éš¾  | å®¹æ˜“ï¼Œå¦‚æœåœ¨é¢„å…ˆå»ºç«‹æ¯æ¡VCæ—¶æœ‰è¶³å¤Ÿçš„èµ„æºå¯åˆ†é… |\n| æ‹¥å¡æ§åˆ¶ | å›°éš¾  | å®¹æ˜“ï¼Œå¦‚æœåœ¨é¢„å…ˆå»ºç«‹æ¯æ¡VCæ—¶æœ‰è¶³å¤Ÿçš„èµ„æºå¯åˆ†é… |\n\n## è·¯ç”±ç®—æ³•\n\n### è·¯ç”±å™¨ä¸­çš„ä¸¤ä¸ªè¿›ç¨‹\n\n#### **è·¯ç”±ï¼ˆroutingï¼‰**\n\n- å‘ç°ç½‘ç»œè·¯å¾„\n- å†³å®šä½¿ç”¨å“ªæ¡è·¯çº¿\n- ç”Ÿæˆå¹¶æ›´æ–°è·¯ç”±è¡¨\n- ä¾èµ–äºåˆ†å¸ƒå¼ç®—æ³•\n\n#### **è½¬å‘ï¼ˆforwardingï¼‰**\n\n- æ²¿è·¯å¾„å‘é€æ•°æ®åŒ…\n- åœ¨æ¯ä¸ªæ•°æ®åŒ…åˆ°è¾¾åˆ°è¾¾çš„æ—¶å€™å¯¹å®ƒè¿›è¡Œå¤„ç†ï¼Œåœ¨è·¯ç”±è¡¨ä¸­æŸ¥æ‰¾è¯¥æ•°æ®åŒ…æ‰€å¯¹åº”çš„å¤„å¢ƒçº¿è·¯\n\n### è·¯ç”±ç®—æ³•\n\n- å°†ç½‘ç»œå»ºæ¨¡ä¸ºèŠ‚ç‚¹å’Œé“¾æ¥å›¾\n- äº†è§£ç½‘ç»œæ‹“æ‰‘\n- ç®¡ç†è·¯ç”±è¡¨\n- åšå‡ºè·¯ç”±å†³ç­–\n- å†³å®šä¼˜åŒ–ä»€ä¹ˆï¼ˆä¾‹å¦‚ï¼šå…¬å¹³ä¸æ•ˆç‡ï¼‰\n- å› æ‹“æ‰‘çš„æ›´æ”¹è€Œæ›´æ–°è·¯ç”±ï¼ˆä¾‹å¦‚ï¼šå‘ç”Ÿæ•…éšœï¼‰\n\n### ä¼˜åŒ–åŸåˆ™\n\n- æœ€ä¼˜è·¯å¾„çš„æ¯ä¸ªéƒ¨åˆ†ä¹Ÿæ˜¯æœ€ä¼˜è·¯å¾„\n- ä»æ‰€æœ‰çš„æºåˆ°ä¸€ä¸ªæŒ‡å®šç›®æ ‡çš„æœ€ä¼˜è·¯å¾„çš„é›†åˆæ„æˆäº†ä¸€é¢—ä»¥ç›®æ ‡èŠ‚ç‚¹ä¸ºæ ¹çš„æ ‘ï¼Œå³**æ±‡é›†æ ‘ï¼ˆsink treeï¼‰**\n    - åœ¨ç¤ºä¾‹ä¸­ï¼Œâ€œæœ€ä¼˜â€è¡¨ç¤ºè·³æ•°æœ€å°‘\n- æ‰€æœ‰è·¯ç”±ç®—æ³•çš„ç›®æ ‡æ˜¯ä¸ºæ‰€æœ‰çš„è·¯ç”±å™¨æ‰¾åˆ°è¿™æ ·çš„æ±‡é›†æ ‘ï¼Œå¹¶æ ¹æ®æ±‡é›†æ ‘æ¥è½¬å‘æ•°æ®åŒ…\n\n### æœ€çŸ­è·¯å¾„ç®—æ³•\n\n- **Dijkstraç®—æ³•**åœ¨å›¾ä¸Šè®¡ç®—ä¸€ä¸ªæ±‡é›†æ ‘\n    - æ¯æ¡è·¯å¾„éƒ½è¢«åˆ†é…äº†ä¸€ä¸ªéè´Ÿçš„æƒé‡/è·ç¦»\n    - æœ€çŸ­è·¯å¾„æ˜¯æ€»æƒé‡æœ€å°çš„è·¯å¾„\n\n### æ³›æ´ªç®—æ³•ï¼ˆfloodingï¼‰\n\n- ä¸€ç§å‘æ‰€æœ‰ç½‘ç»œèŠ‚ç‚¹å‘é€æ•°æ®åŒ…çš„ç®€å•æ–¹æ³•ï¼Œæ˜¯ä¸€ç§æœ‰æ•ˆçš„å¹¿æ’­æ‰‹æ®µ\n- è·¯ç”±å™¨å°†æ¯ä¸€ä¸ªå…¥å¢ƒæ•°æ®åŒ…å‘é€åˆ°é™¤äº†è¯¥æ•°æ®åŒ…åˆ°è¾¾çš„é‚£æ¡çº¿è·¯ä»¥å¤–çš„æ¯ä¸€æ¡å‡ºå¢ƒçº¿è·¯\n- å¯ä»¥ä½¿ç”¨è·³è®¡æ•°å™¨æ¥ä¸€ç›´æ³›æ´ª\n- æ›´å¥½çš„æŠ€æœ¯æ˜¯è®©è·¯ç”±å™¨éœ€è·Ÿè¸ªå·²ç»æ³›æ´ªè¿‡çš„æ•°æ®åŒ…ï¼Œé¿å…ç¬¬äºŒæ¬¡å‘é€å®ƒä»¬ä»¥é˜»æ­¢æ³›æ´ª\n- æœ‰éå¸¸å¥½çš„é²æ£’æ€§\n\n### è·ç¦»çŸ¢é‡ç®—æ³•ï¼ˆdistance vector routingï¼‰\n\n- è·ç¦»çŸ¢é‡æ˜¯ä¸€ç§åˆ†å¸ƒå¼è·¯ç”±ç®—æ³•\n    - æœ€çŸ­è·¯å¾„è®¡ç®—åœ¨èŠ‚ç‚¹ä¹‹é—´åˆ†å‰²\n    - åˆè¢«ç§°ä¸ºBellman-fordï¼ˆFord-Fulkersonï¼‰ç®—æ³•\n    - æ˜¯æœ€åˆARPANETä½¿ç”¨çš„è·¯ç”±ç®—æ³•\n    - ä½¿ç”¨äºRIPåè®®ã€IGRPåè®®â€¦\n- ç®—æ³•ï¼š**â€œtell neighbors where I can go, and how farâ€**\n    - é€šå¸¸æ˜¯ä»¥å»¶è¿Ÿä½œä¸ºè·ç¦»åº¦é‡\n    - æ¯ä¸ªèŠ‚ç‚¹éƒ½çŸ¥é“åˆ°å…¶é‚»å±…çš„è·ç¦»\n    - æ¯ä¸ªèŠ‚ç‚¹å®šæœŸå‘æ‰€æœ‰é‚»å±…æ’­å‘æœ€å°å·²çŸ¥è·ç¦»çš„å‘é‡\n    - æ¯ä¸ªèŠ‚ç‚¹ä½¿ç”¨æ¥æ”¶åˆ°çš„å‘é‡æ›´æ–°è‡ªå·±çš„å‘é‡\n- æ— ç©·è®¡ç®—é—®é¢˜\n    - å¤±è´¥ï¼ˆè·¯ç”±å™¨åœæœºæˆ–é“¾è·¯æ–­è£‚ï¼‰ä¼šå¯¼è‡´DVåœ¨å¯»æ‰¾æ— æ³•åˆ°è¾¾çš„èŠ‚ç‚¹çš„è·¯å¾„æ—¶â€œè®¡æ•°åˆ°æ— ç©·å¤§â€\n\n### é“¾æ¥çŠ¶æ€è·¯ç”±ï¼ˆlink state routingï¼‰\n\n- é“¾æ¥çŠ¶æ€è·¯ç”±æ˜¯è·ç¦»çŸ¢é‡ç®—æ³•çš„æ›¿ä»£ï¼ˆç”±äºæ— ç©·è®¡ç®—é—®é¢˜ï¼‰\n    - æ›´å¤šçš„è®¡ç®—ä½†æ›´ç®€å•çš„åŠ¨æ€\n    - å¹¿æ³›åº”ç”¨äºäº’è”ç½‘ï¼ˆOSPFã€IS-ISï¼‰\n- ç®—æ³•ï¼š **â€œtell all which neighbors I haveâ€**\n    - æ¯ä¸ªèŠ‚ç‚¹åœ¨ LSPï¼ˆé“¾è·¯çŠ¶æ€åŒ…ï¼‰ä¸­æ³›æ´ªæœ‰å…³å…¶é‚»å±…çš„ä¿¡æ¯\n    - æ‰€æœ‰èŠ‚ç‚¹å­¦ä¹ å®Œæ•´çš„ç½‘ç»œå›¾\n    - æ¯ä¸ªèŠ‚ç‚¹è¿è¡Œ Dijkstra ç®—æ³•æ¥è®¡ç®—æ¯ä¸ªç›®çš„åœ°çš„è·¯å¾„\n- LSPs\n    - èŠ‚ç‚¹çš„ LSPï¼ˆé“¾è·¯çŠ¶æ€åŒ…ï¼‰åŒ…å«å‘é€æ–¹çš„æ ‡è¯†ç¬¦ã€åºå·ï¼ˆSeqï¼‰ã€å¹´é¾„ï¼ˆAgeï¼‰ã€é‚»å±…åˆ—è¡¨å’Œåˆ°è¾¾å®ƒä»¬çš„é“¾è·¯æƒé‡\n    - é“¾è·¯æƒé‡å¯ä»¥é€‰æ‹©æˆæœ¬ä¸é“¾è·¯å¸¦å®½æˆåæ¯”ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©é“¾è·¯çš„å»¶è¿Ÿ\n    - å¯ä»¥é€‰æ‹©å‘¨æœŸæ€§çš„åˆ›å»ºæ•°æ®åŒ…ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©å‘ç”Ÿé‡è¦äº‹ä»¶æ—¶æ‰åˆ›å»ºæ•°æ®åŒ…\n- å¯é æ³›æ´ª\n    - åºå·å’Œå¹´é¾„ç”¨äºå¯é æ³›æ´ª\n    - åºå·\n        - åºå·éšç€æ¯ä¸€ä¸ªæ–°æ•°æ®åŒ…å‘å‡ºè€Œé€ä¸€é€’å¢\n        - æ–°çš„æ•°æ®åŒ…ä¼šè¢«è½¬å‘åˆ°é™¤äº†å…¥å¢ƒçº¿è·¯ä¹‹å¤–çš„æ‰€æœ‰å…¶ä»–çº¿è·¯ä¸Š\n        - é‡å¤æ•°æ®åŒ…ä¼šè¢«ä¸¢å¼ƒ\n        - æ•°æ®åŒ…çš„åºå·å°äºå½“å‰çœ‹åˆ°è¿‡çš„æ¥è‡ªè¯¥æºè·¯ç”±å™¨çš„æœ€å¤§åºåˆ—å·ï¼Œåˆ™è¯¥æ•°æ®åŒ…å·²è¿‡æ—¶ï¼Œè¢«ä¸¢å¼ƒ\n    - å¹´é¾„\n        - å¹´é¾„æ¯ç§’é’Ÿå‡1\n        - å½“å¹´é¾„è¢«å‡åˆ°0æ—¶ï¼Œè¯¥ä¿¡æ¯è¢«ä¸¢å¼ƒ\n\n### å±‚æ¬¡è·¯ç”±ï¼ˆhierarchical routingï¼‰\n\n- å±‚æ¬¡è·¯ç”±å‡å°‘äº†è·¯ç”±è®¡ç®—çš„å·¥ä½œé‡ï¼Œä½†å¯èƒ½ä¼šå¯¼è‡´æ¯”å¹³é¢è·¯ç”±ç¨é•¿çš„è·¯å¾„\n\n### å¹¿æ’­è·¯ç”±ï¼ˆbroadcast routingï¼‰\n\n- å¹¿æ’­å‘æ‰€æœ‰èŠ‚ç‚¹å‘é€æ•°æ®åŒ…\n    - å¤šç›®æ ‡è·¯ç”±ï¼ˆmultidestination routingï¼‰\n    - é€†å‘è·¯å¾„è½¬å‘ï¼ˆreverse path forwardingï¼ŒRPFï¼‰\n        - åˆ¤æ–­æ•°æ®åŒ…åˆ°æ¥çš„çº¿è·¯æ˜¯å¦æ˜¯é€šå¸¸ç”¨æ¥ç»™å¹¿æ’­æºå‘é€åˆ†ç»„çš„çº¿è·¯ã€‚ å¦‚æœæ˜¯ï¼Œè·¯ç”±å™¨å°†è¯¥åˆ†ç»„è½¬å‘åˆ°é™¤åˆ°æ¥çš„é‚£æ¡çº¿è·¯ä¹‹å¤–çš„æ‰€æœ‰å…¶ä»–çº¿è·¯\n        - å¦åˆ™ï¼Œæ­¤åˆ†ç»„è¢«å½“ä½œä¸€ä¸ªå¯èƒ½çš„é‡å¤åˆ†ç»„è¢«ä¸¢å¼ƒ\n        - é€šå¸¸æ±‡é›†æ ‘è¢«ç”¨ä½œæ¥åˆ¤æ–­æ˜¯å¦æ˜¯æœ€ä½³çº¿è·¯\n\n### ç»„æ’­è·¯ç”±ï¼ˆmulticast routingï¼‰\n\n- ç»™ç»„å‘é€æ¶ˆæ¯è¢«ç§°ä¸ºç»„æ’­\n- ä¸åŒçš„ç»„æ’­æœ‰ä¸åŒçš„ç”Ÿæˆæ ‘\n- è·ç¦»çŸ¢é‡ç»„æ’­è·¯ç”±åè®®ï¼ˆDVMRPï¼‰\n- åŸºäºæ ¸å¿ƒæ ‘ï¼ˆcore-based treesï¼ŒCBTï¼‰\n    - ä½¿ç”¨å•æ£µç”Ÿæˆæ ‘è¿›è¡Œç»„æ’­\n    - ç”Ÿæˆæ ‘æ˜¯ä»æ ¸å¿ƒï¼ˆcoreï¼‰èŠ‚ç‚¹åˆ°ç»„æˆå‘˜çš„æ±‡é›†æ ‘\n    - å‘é€è€…æŠŠæ•°æ®åŒ…å‘é€ç»™æ ¸å¿ƒï¼Œå½“æ•°æ®åŒ…åˆ°è¾¾æ ¸å¿ƒåï¼Œå®ƒå†è¢«æ²¿ç€æ ‘å¾€ä¸‹è½¬å‘\n    - åœ¨æŠŠæ•°æ®åŒ…å‘é€ç»™æ ¸å¿ƒçš„è¿‡ç¨‹ä¸­ï¼Œæ•°æ®åŒ…åŒæ—¶æ²¿ç€æ ‘è½¬å‘åˆ°å…¶ä»–åˆ†æ”¯ï¼Œå³ç»„æ’­å¹¶éä»æ ¸å¿ƒå¼€å§‹\n\n### é€‰æ’­è·¯ç”±ï¼ˆanycast routingï¼‰\n\n- å‘ä¸€ä¸ªæœ€è¿‘çš„ç»„æˆå‘˜å‘é€æ•°æ®åŒ…è¢«ç§°ä¸ºé€‰æ’­\n- è·ç¦»çŸ¢é‡å’Œé“¾è·¯çŠ¶æ€è·¯ç”±ç®—æ³•å¯ä»¥ç”¨æ¥ç”Ÿæˆé€‰æ’­è·¯ç”±\n\n### ç§»åŠ¨ä¸»æœºè·¯ç”±\n\n- å¯ä»¥é€šè¿‡å®¶ä¹¡ä»£ç†ï¼ˆhome agentï¼‰è®¿é—®ç§»åŠ¨ä¸»æœº\n\n## æ‹¥å¡æ§åˆ¶ç®—æ³•\n\n### ç½‘ç»œæ€§èƒ½\n\n- ç½‘ç»œçš„æ€§èƒ½å¯ä»¥ç”¨å»¶è¿Ÿã€ååé‡å’Œä¸¢åŒ…æ¥è¡¡é‡\n    - å»¶è¿Ÿï¼šä¼ è¾“å»¶è¿Ÿã€ä¼ æ’­å»¶è¿Ÿã€å¤„ç†å»¶è¿Ÿå’Œæ’é˜Ÿå»¶è¿Ÿã€‚\n    - ç½‘ç»œä¸­ä»»ä¸€ç‚¹çš„ååé‡ï¼šæ¯ç§’é€šè¿‡è¯¥ç‚¹çš„æ¯”ç‰¹æ•°ï¼Œå³è¯¥ç‚¹çš„æ•°æ®ä¼ è¾“é€Ÿç‡\n    - ä¸¢åŒ…ï¼šä¼ è¾“è¿‡ç¨‹ä¸­ä¸¢å¤±çš„æ•°æ®åŒ…æ•°\n- æ‹¥å¡æ§åˆ¶æ˜¯ä¸€ç§æé«˜ç½‘ç»œæ€§èƒ½çš„æœºåˆ¶\n\n### æ‹¥å¡æ§åˆ¶çš„é€”å¾„\n\n- å¢åŠ èµ„æºæˆ–å‡å°‘è´Ÿè½½\n- ä¸åŒæ—¶é—´å°ºåº¦ä¸Šæ‹¥å¡æ§åˆ¶çš„é€”å¾„ï¼ˆä»æ…¢åˆ°å¿«ï¼‰\n    - ç½‘ç»œä¾›ç»™ï¼ˆå¢åŠ èµ„æºï¼‰\n    - æµé‡æ„ŸçŸ¥è·¯ç”±\n    - å‡†å…¥æ§åˆ¶\n    - æµé‡è°ƒèŠ‚\n    - è´Ÿè½½è„±è½\n\n### æµé‡æ„ŸçŸ¥è·¯ç”±ï¼ˆtraffic-aware routingï¼‰\n\n- æ ¹æ®æµé‡çš„å˜åŒ–é€‰æ‹©è·¯ç”±ï¼Œè€Œä¸ä»…ä»…æ˜¯æ‹“æ‰‘ç»“æ„çš„å˜åŒ–\n- æœ€ç›´æ¥çš„æ–¹å¼æ˜¯å°†é“¾è·¯æƒé‡è®¾ç½®ä¸ºä¸€ä¸ªé“¾è·¯å¸¦å®½ã€ä¼ è¾“å»¶è¿Ÿã€æµ‹é‡è´Ÿè½½æˆ–å¹³å‡æ’é˜Ÿå»¶è¿Ÿçš„å‡½æ•°\n- ä½†è¦æ³¨æ„é¿å…æŒ¯è¡ï¼ˆå¿½ç•¥è´Ÿè½½ï¼Œåªè€ƒè™‘å¸¦å®½å’Œä¼ è¾“å»¶è¿Ÿï¼‰\n\n### å‡†å…¥æ§åˆ¶ï¼ˆadmission controlï¼‰\n\n- é™¤éç½‘ç»œå¯ä»¥æºå¸¦é¢å¤–çš„æµé‡è€Œä¸ä¼šå˜å¾—æ‹¥å¡ï¼Œå¦åˆ™ä¸å†å»ºç«‹æ–°çš„è™šç”µè·¯\n- å¯ä»¥å’Œæµé‡æ„ŸçŸ¥è·¯ç”±ç›¸ç»“åˆ\n\n### æµé‡è°ƒèŠ‚ï¼ˆtraffic throttlingï¼‰\n\n- æ‹¥å¡çš„è·¯ç”±å™¨ï¼ˆå†…éƒ¨æ’é˜Ÿå»¶è¿Ÿï¼‰å‘å‘é€æ–¹å‘é€åé¦ˆä¿¡æ¯ä»¥é™ä½æµé‡\n- æ˜¾å¼æ‹¥å¡é€šçŸ¥ï¼ˆECNï¼‰\n    - æ ‡è®°æ•°æ®åŒ…ï¼Œæ¥æ”¶æ–¹åœ¨å‘é€åº”ç­”åŒ…æ—¶å‘ŠçŸ¥å‘é€æ–¹\n- é€è·³åå‹\n    - è®©æŠ‘åˆ¶åŒ…åœ¨æ²¿é€”çš„æ¯ä¸€è·³éƒ½å‘æŒ¥ä½œç”¨\n    - æ‹¥å¡ç‚¹ä¸Šçš„æ‹¥å¡ç°è±¡èƒ½å¾ˆå¿«å¾—åˆ°ç¼“è§£\n    - ä»£ä»·æ˜¯ä¸Šæ¸¸è·¯å¾„éœ€è¦æ¶ˆè€—æ›´å¤§çš„ç¼“å†²ç©ºé—´\n\n### è´Ÿè½½ä¸¢å¼ƒï¼ˆload sheddingï¼‰\n\n- å½“è·¯ç”±å™¨æ¥ä¸åŠå¤„ç†æ•°æ®åŒ…ï¼Œç›´æ¥å°†å®ƒä»¬ä¸¢å¼ƒ\n\n## æœåŠ¡è´¨é‡ï¼ˆQoSï¼‰\n\n### åº”ç”¨éœ€æ±‚\n\n- å¸¦å®½ã€å»¶è¿Ÿã€æŠ–åŠ¨å’Œä¸¢å¤±ç»å¯¹äº†ä¸€ä¸ªæµè¦æ±‚çš„æœåŠ¡è´¨é‡\n\n| åº”ç”¨  | å¸¦å®½  | å»¶è¿Ÿ  | æŠ–åŠ¨  | ä¸¢å¤±  |\n| --- | --- | --- | --- | --- |\n| ç”µå­é‚®ä»¶ | ä½   | ä½   | ä½   | ä¸­ç­‰  |\n| æ–‡ä»¶å…±äº« | é«˜   | ä½   | ä½   | ä¸­ç­‰  |\n| æµè§ˆç½‘é¡µ | ä¸­ç­‰  | ä¸­ç­‰  | ä½   | ä¸­ç­‰  |\n| è¿œç¨‹ç™»å½• | ä½   | ä¸­ç­‰  | ä¸­ç­‰  | ä¸­ç­‰  |\n| éŸ³é¢‘ç‚¹æ’­ | ä½   | ä½   | é«˜   | ä½   |\n| è§†é¢‘ç‚¹æ’­ | é«˜   | ä½   | é«˜   | ä½   |\n| ç”µè¯  | ä½   | é«˜   | é«˜   | ä½   |\n| è§†é¢‘ç”µè¯ | é«˜   | é«˜   | é«˜   | ä½   |\n\n- ç½‘ç»œå¯ä»¥æ”¯æŒä¸åŒç±»åˆ«çš„QoS\n- ATMç½‘ç»œæ”¯æŒï¼š\n\n| ç½‘ç»œç±»å‹ | åº”ç”¨  |\n| --- | --- |\n| æ’å®šæ¯”ç‰¹ç‡ | ç”µè¯  |\n| å®æ—¶å¯å˜æ¯”ç‰¹ç‡ | å‹ç¼©çš„è§†é¢‘ä¼šè®® |\n| éå®æ—¶å¯å˜æ¯”ç‰¹ç‡ | ç‚¹æ’­ç”µå½± |\n| å¯ç”¨æ¯”ç‰¹ç‡ | æ–‡ä»¶ä¼ è¾“ |\n\n### æµé‡æ•´å½¢ï¼ˆtraffic shapingï¼‰\n\n- æŒ‡è°ƒèŠ‚è¿›å…¥ç½‘ç»œçš„æ•°æ®æµçš„å¹³å‡é€Ÿç‡å’Œçªå‘æ€§æ‰€é‡‡ç”¨çš„æŠ€æœ¯\n- å½“ä¸€ä¸ªæµåœ¨å»ºç«‹æ—¶ï¼Œç”¨æˆ·å’Œç½‘ç»œå°±è¯¥æµçš„æµé‡æ¨¡å¼è¾¾æˆä¸€è‡´çš„åè®®\n\n#### æ¼æ¡¶/ä»¤ç‰Œæ¡¶\n\n- æ¼æ¡¶/ä»¤ç‰Œæ¡¶é™åˆ¶äº†å¹³å‡é€Ÿç‡ï¼ˆRï¼‰å’ŒçŸ­æœŸçªå‘æµé‡ï¼ˆBï¼‰\n- å¯¹äºæ¼æ¡¶ï¼Œæ— è®ºæµå…¥æ¼æ¡¶çš„æ°´çš„é€Ÿç‡æœ‰å¤šå¤§ï¼Œåªè¦ï¼Œæ¼æ¡¶ä¸­è¿˜æœ‰æ°´ï¼Œæ°´æµå‡ºæ¡¶çš„é€Ÿç‡æ˜¯ä¸€ä¸ªæ’å®šé€Ÿç‡R\n- å¯¹äºä»¤ç‰Œæ¡¶ï¼Œæ°´é¾™å¤´é€Ÿç‡ä¸ºRï¼Œæ°´æ¡¶å®¹é‡ä¸ºBã€‚ä¸ºäº†å‘é€ä¸€ä¸ªæ•°æ®åŒ…ï¼Œå¿…é¡»èƒ½ä»æ¡¶ä¸­æå‡ºæ°´æˆ–ä»¤ç‰Œ\n\n### åŒ…è°ƒåº¦ï¼ˆpacket schedulingï¼‰\n\n- åœ¨åŒä¸€ä¸ªæµçš„æ•°æ®åŒ…ä¹‹é—´ä»¥åŠåœ¨ç«äº‰æµä¹‹é—´åˆ†é…è·¯ç”±å™¨èµ„æºçš„ç®—æ³•ç§°ä¸ºåŒ…è°ƒåº¦ç®—æ³•\n- æ½œåœ¨èµ„æº\n    - å¸¦å®½\n    - ç¼“å†²åŒº\n    - CPUå‘¨æœŸ\n- å…ˆè¿›å…ˆå‡ºç®—æ³•ï¼ˆFIFOï¼‰åœ¨é˜Ÿåˆ—æ»¡æ—¶é€šå¸¸ä¸¢å¼ƒæ–°åˆ°çš„æ•°æ®åŒ…ï¼ˆå°¾ä¸¢åŒ…ï¼‰ï¼Œå¯èƒ½é€ æˆé¥¥é¥¿\n- å…¬å¹³é˜Ÿåˆ—ç®—æ³•ï¼ˆfair queueingï¼‰ï¼Œçº¿è·¯ç©ºé—²æ—¶å¾ªç¯æ‰«æå„ä¸ªæµçš„é˜Ÿåˆ—ï¼Œä»ä¸‹ä¸€ä¸ªé˜Ÿåˆ—ä¸­å–å‡ºç¬¬ä¸€ä¸ªæ•°æ®åŒ…å‘é€\n- åŠ æƒå…¬å¹³é˜Ÿåˆ—ï¼ˆWFQï¼‰ï¼Œæ•°æ®åŒ…æ¥æ•°æ®åŒ…æ”¹ä¸ºå­—èŠ‚æ¥å­—èŠ‚çš„å¾ªç¯æ–¹å¼ï¼Œä¸ºæµè®¾ç½®æƒé‡W\n- Fi = max(Ai , Fi-1) +Li/Wï¼ˆæ¯ä¸ªæµå•ç‹¬è®¡ç®—ï¼‰\n\n### å‡†å…¥æ§åˆ¶ï¼ˆadmission controlï¼‰\n\n- å‡†å…¥æ§åˆ¶é‡‡ç”¨æµè§„èŒƒï¼Œå¹¶å†³å®šç½‘ç»œæ˜¯å¦èƒ½å¤Ÿæ‰¿è½½è¯¥è§„èŒƒ\n\n### ç»¼åˆæœåŠ¡ï¼ˆintegrated servicesï¼‰\n\n- ä¸ºæ¯ä¸ªæµè®¾è®¡QoSï¼›å¤„ç†ç»„æ’­é€šä¿¡\n- RSVPï¼ˆèµ„æºé¢„ç•™åè®®ï¼‰ï¼š\n    - æ¥æ”¶æ–¹å°†è¯·æ±‚å‘é€å›å‘é€æ–¹\n    - æ²¿é€”çš„æ¯ä¸ªè·¯ç”±å™¨éƒ½ä¿ç•™èµ„æº\n    - è·¯ç”±å™¨ä¸ºåŒä¸€ä¸ªæµåˆå¹¶å¤šä¸ªè¯·æ±‚\n    - å·²è®¾ç½®æ•´ä¸ªè·¯å¾„ï¼Œæˆ–æœªè¿›è¡Œé¢„ç•™\n\n### åŒºåˆ†æœåŠ¡ï¼ˆdifferentiated servicesï¼‰\n\n- åŠ é€Ÿè½¬å‘ï¼Œå°†æœåŠ¡ç±»å‹åˆ†ä¸ºå¸¸è§„çš„å’ŒåŠ é€Ÿçš„\n- ç¡®ä¿è½¬å‘ï¼Œå°†æœåŠ¡ç±»å‹åˆ†ä¸º12ç§\n\n## ç½‘ç»œäº’è”\n\n### ä½•ä»¥è¿æ¥ç½‘ç»œ\n\n- ç½‘ç»œäº’è”åŸºäºå…±æœ‰ç½‘ç»œå±‚-IP\n\n### éš§é“\n\n- é€šè¿‡ä¸­é—´çš„ç½‘ç»œè¿æ¥ä¸¤ä¸ªç½‘ç»œ\n    - æ•°æ®åŒ…è¢«å°è£…åœ¨ä¸­é—´\n\n### æ•°æ®åŒ…åˆ†æ®µ\n\n- ç”±äºè®¸å¤šåŸå› ï¼Œç½‘ç»œå…·æœ‰ä¸åŒçš„æ•°æ®åŒ…å¤§å°é™åˆ¶\n    - é€šè¿‡åˆ†æ®µå’Œé‡ç»„å‘é€çš„å¤§æ•°æ®åŒ…\n    - é€æ˜åˆ†æ®µï¼ŒåŒ…åœ¨æ¯ä¸ªç½‘ç»œå†…åˆ†æ®µ/é‡ç»„\n    - éé€æ˜åˆ†æ®µï¼ŒåŒ…åªåœ¨ç›®çš„åœ°é‡ç»„\n- è·¯å¾„MTUå‘ç°é¿å…äº†ç½‘ç»œåˆ†æ®µ\n- è·¯ç”±å™¨å°†MTUï¼ˆæœ€å¤§ä¼ è¾“å•å…ƒï¼‰è¿”å›åˆ°æºå¹¶ä¸¢å¼ƒå¤§æ•°æ®åŒ…\n\n## Internetçš„ç½‘ç»œå±‚\n\n### IPV4\n\n- IPV4æŠ¥å¤´åŒ…å«20å­—èŠ‚å®šé•¿éƒ¨åˆ†å’Œä¸€ä¸ªå¯é€‰çš„å˜é•¿éƒ¨åˆ†\n    - ç‰ˆæœ¬ï¼š4ä½ï¼Œè®°å½•æ•°æ®åŒ…å±äºåè®®å“ªä¸ªç‰ˆæœ¬\n    - IHLï¼š4ä½ï¼Œè®°å½•å¤´éƒ¨é•¿åº¦ï¼ˆä»¥4å­—èŠ‚é•¿åº¦ä¸ºå•ä½ï¼‰ï¼Œæœ€å°å€¼ä¸º5ï¼Œæœ€å¤§å€¼ä¸º15\n    - åŒºåˆ†æœåŠ¡ï¼š8ä½ï¼Œå‰6ä½æ ‡è®°æ•°æ®åŒ…çš„æœåŠ¡ç±»åˆ«ï¼Œå2ä½æºå¸¦æ˜¾ç¤ºæ‹¥å¡é€šçŸ¥ä¿¡æ¯\n    - æ€»é•¿åº¦ï¼š16ä½ï¼Œè®°å½•æ•°æ®æŠ¥æ€»é•¿åº¦\n    - æ ‡è¯†ï¼š16ä½ï¼Œç”¨äºæ ‡è¯†æ•°æ®æŠ¥ï¼ŒåŒä¸€ä¸ªæ•°æ®åŒ…çš„æ‰€æœ‰æ®µåŒ…å«åŒæ ·çš„çš„æ ‡è¯†ç¬¦\n    - DFï¼š1ä½ï¼Œä»£è¡¨ä¸åˆ†æ®µæ ‡å¿—ä½ï¼Œ1ä»£è¡¨ä¸åˆ†æ®µ\n    - MFï¼š1ä½ï¼Œä»£è¡¨æ›´å¤šçš„æ®µæ ‡å¿—ä½ï¼Œ0ä»£è¡¨æœ€åä¸€æ®µ\n    - åˆ†æ®µåç§»é‡ï¼š13ä½ï¼ŒæŒ‡æ˜äº†è¯¥æ®µåœ¨å½“å‰æ•°æ®æŠ¥ä¸­çš„ä½ç½®ï¼ˆä»¥8å­—èŠ‚é•¿åº¦ä¸ºå•ä½ï¼‰ï¼Œé™¤äº†æ•°æ®æŠ¥çš„æœ€åä¸€ä¸ªæ®µå¤–ï¼Œå…¶ä»–æ‰€æœ‰æ®µçš„é•¿åº¦å¿…é¡»æ˜¯8å­—èŠ‚çš„å€æ•°\n    - ç”Ÿå­˜æœŸï¼ˆTTLï¼‰ï¼š8ä½ï¼Œç”¨äºé™åˆ¶æ•°æ®åŒ…ç”Ÿå­˜æœŸçš„è®¡æ•°å™¨ï¼Œé€’å‡åˆ°0æ—¶æ•°æ®åŒ…è¢«ä¸¢å¼ƒï¼Œå¹¶å‘æºä¸»æœºå‘å›æŠ¥è­¦åŒ…\n    - åè®®ï¼š8ä½ï¼Œè®°å½•ä¸Šå±‚åè®®ï¼ŒICMP01ï¼ŒIGMP02ï¼ŒTCP06ï¼ŒUDP17ï¼ŒOSPF89\n    - æ ¡éªŒå’Œï¼š16ä½\n    - æºåœ°å€ï¼š32ä½ï¼ŒæºIPåœ°å€\n    - ç›®æ ‡åœ°å€ï¼š32ä½ï¼Œç›®æ ‡IPåœ°å€\n\n### IPåœ°å€\n\n- IPv4åœ°å€æ˜¯ä¸€ä¸ª32ä½åœ°å€ï¼Œå®ƒå”¯ä¸€ä¸”åœ°å®šä¹‰äº†è®¾å¤‡åˆ°Internetçš„è¿æ¥ã€‚\n- IPv4çš„åœ°å€ç©ºé—´æ˜¯2^32\n\n#### å‰ç¼€\n\n- åœ°å€ä»¥ç§°ä¸ºå‰ç¼€çš„å—åˆ†é…\n- å‰ç¼€ç”±ç½‘ç»œéƒ¨åˆ†ç¡®å®š\n- ä¹¦å†™æ ¼å¼ï¼šåœ°å€/é•¿åº¦ï¼Œå¦‚18.0.31.0/24\n\n#### åˆ†ç±»å’Œç‰¹æ®Šå¯»å€\n\n- åˆ†ç±»å¯»å€ä¸­IPåœ°å€è¢«åˆ†ä¸º5ä¸ªç±»åˆ«\n    - Aç±»ï¼Œ1.0.0.0-127.255.255.255/8\n    - Bç±»ï¼Œ128.0.0.0-191.255.255.255/16\n    - Cç±»ï¼Œ192.0.0.0-223.255.255.255/24\n    - Dç±»ï¼Œ224.0.0.0-239.255.255.255ï¼ˆç»„æ’­åœ°å€ï¼‰\n    - Eç±»ï¼Œ240.0.0.0-255.255.255.255ï¼ˆä¿ç•™åœ°å€ï¼‰\n- ç‰¹æ®ŠIPåœ°å€\n    - 0.0.0.0 ä¸»æœº\n    - 00...00|ä¸»æœº æœ¬åœ°ç½‘ç»œä¸»æœº\n    - 255.255.255.255 æœ¬åœ°ç½‘ç»œå¹¿æ’­\n    - ç½‘ç»œ|11...11 è¿œç¨‹ç½‘ç»œå¹¿æ’­\n    - 127|ä»»ä½•å†…å®¹ å›ç¯\n\n#### å­ç½‘\n\n- åœ¨å†…éƒ¨å°†ä¸€ä¸ªç½‘ç»œå—åˆ†æˆå‡ ä¸ªéƒ¨åˆ†ä¾›å¤šä¸ªå†…éƒ¨ç½‘ç»œä½¿ç”¨ï¼Œä½†å¯¹å¤–éƒ¨ä»ç„¶åƒå•ä¸ªç½‘ç»œä¸€æ ·\n\n#### IPåœ°å€èšåˆ\n\n- èšåˆå°†å¤šä¸ªIPå‰ç¼€åˆå¹¶ä¸ºä¸€ä¸ªè¾ƒå¤§çš„å‰ç¼€ï¼Œä»¥å‡å°‘è·¯ç”±è¡¨çš„å¤§å°\n\n#### æœ€é•¿å‰ç¼€åŒ¹é…\n\n- æ•°æ®åŒ…è¢«è½¬å‘åˆ°å…·æœ‰æœ€é•¿åŒ¹é…å‰ç¼€æˆ–æœ€å°åœ°å€å—çš„æ¡ç›®\n    - ä½¿è½¬å‘å¤æ‚åŒ–ï¼Œä½†å¢åŠ äº†çµæ´»æ€§\n\n#### NAT\n\n- NATï¼ˆç½‘ç»œåœ°å€è½¬æ¢ï¼‰ç›’å°†ä¸€ä¸ªå¤–éƒ¨IPåœ°å€æ˜ å°„åˆ°å¤šä¸ªå†…éƒ¨IPåœ°å€\n    - ä½¿ç”¨TCP/UDPç«¯å£åŒºåˆ†è¿æ¥\n    - è¿ååˆ†å±‚åŸåˆ™ï¼›åœ¨å®¶åº­ç­‰ä¸­éå¸¸å¸¸è§\n- ç§æœ‰åœ°å€ï¼š\n    - 10.0.0.0-10.255.255.255/8\n    - 172.16.0.0-172.31.255.255/12\n    - 192.168.0.0-192.168.255.255/16\n\n### IPV6\n\n- IPv6çš„åœ°å€ç©ºé—´åŒ…å«$2^{128}$ä¸ªåœ°å€ã€‚è¿™ä¸ªåœ°å€ç©ºé—´æ˜¯IPv4åœ°å€çš„$2^{96}$å€\n- IPv6æŠ¥å¤´40å­—èŠ‚ï¼Œå¹¶ä¸”æ›´ç®€å•\n    - ç‰ˆæœ¬ï¼š4ä½\n    - åŒºåˆ†æœåŠ¡ï¼š8ä½ï¼Œç”¨äºåŒºåˆ†æ•°æ®åŒ…çš„æœåŠ¡ç±»åˆ«ï¼Œä¸IPV4ç›¸åŒ\n    - æµæ ‡ç­¾ï¼š20ä½ï¼Œä¸ºæºç«¯å’Œæ¥æ”¶æ–¹æä¾›äº†ä¸€ç§å»ºç«‹ä¼ªè¿æ¥çš„æ–¹å¼\n    - æœ‰æ•ˆè½½è·é•¿åº¦ï¼š16ä½\n    - ä¸‹ä¸€ä¸ªå¤´ï¼š8ä½ï¼ŒæŒ‡æ˜å½“å‰å¤´ä¹‹åè¿˜æœ‰å“ªç§æ‰©å±•å¤´ã€‚å¦‚æœå½“å‰å¤´æ˜¯æœ€åä¸€ä¸ªå¤´ï¼Œåˆ™è¯¥å­—æ®µæŒ‡å®šäº†è¯¥æ•°æ®åŒ…çš„ä¸Šå±‚åè®®ï¼ˆTCP/UDPï¼‰\n    - è·³æ•°é™åˆ¶ï¼š8ä½ï¼ŒåŒIPV4\n    - æºåœ°å€ï¼š16å­—èŠ‚\n    - ç›®æ ‡åœ°å€ï¼š16å­—èŠ‚\n- ä¸‰ç§è¿‡æ¸¡ç­–ç•¥ï¼š\n    - åŒæ ˆ\n    - éš§é“\n    - å¤´éƒ¨ç¿»è¯‘\n\n### Internetæ§åˆ¶åè®®\n\n#### ICMPï¼ˆInternetæ§åˆ¶æ¶ˆæ¯åè®®ï¼‰\n\n- å¤„ç†é”™è¯¯å’Œæ§åˆ¶æ¶ˆæ¯\n- æ¯ä¸€ç§æ¶ˆæ¯è¢«å°è£…åœ¨IPåŒ…ä¸­\n- å¦‚æœè·¯ç”±å™¨ä¸èƒ½ä¼ é€’æˆ–è½¬å‘æ•°æ®åŒ…ï¼Œå®ƒä¼šå‘æºå‘é€ä¸€æ¡ICMPâ€œä¸»æœºä¸å¯è®¿é—®â€æ¶ˆæ¯\n- è‹¥è·¯ç”±å™¨æ¥æ”¶åˆ°æœ¬åº”å‘é€è‡³å¦ä¸€è·¯ç”±å™¨çš„æ•°æ®åŒ…ï¼Œåˆ™å‘å‘é€æ–¹å‘é€ICMPâ€œé‡å®šå‘â€æ¶ˆæ¯ï¼›å‘é€æ–¹ä¿®æ”¹å…¶è·¯ç”±è¡¨\n- ICMPâ€œè·¯ç”±å™¨å‘ç°â€æ¶ˆæ¯å…è®¸ä¸»æœºäº†è§£å…¶ç½‘ç»œä¸­çš„è·¯ç”±å™¨ï¼Œå¹¶åˆå§‹åŒ–å’Œæ›´æ–°å…¶è·¯ç”±è¡¨\n- ICMPå›é€è¯·æ±‚å’Œå›å¤æœ‰åŠ©äºè¯Šæ–­å¹¶ç”¨äºâ€œpingâ€\n\n#### ARPï¼ˆåœ°å€è§£æåè®®ï¼‰\n\n- ARPå…è®¸èŠ‚ç‚¹ä»IPåœ°å€ä¸­æŸ¥æ‰¾ç›®æ ‡ä»¥å¤ªç½‘åœ°å€\n\n#### RARPï¼ˆåå‘åœ°å€è½¬æ¢åè®®ï¼‰\n\n- RARPå…è®¸å±€åŸŸç½‘çš„ç‰©ç†æœºå™¨ä»ç½‘å…³æœåŠ¡å™¨çš„ ARP è¡¨æˆ–è€…ç¼“å­˜ä¸Šè¯·æ±‚å…¶ IP åœ°å€\n- RARP requestä¹Ÿæ˜¯å¹¿æ’­ï¼Œæ²¡æœ‰ç›®æ ‡åœ°å€ï¼›RARP replyä¹Ÿæ˜¯æœ‰ç›®æ ‡åœ°å€ï¼Œä¹Ÿæ˜¯å•æ’­\n\n#### DHCPï¼ˆåŠ¨æ€ä¸»æœºé…ç½®åè®®ï¼‰\n\n- DHCPæ˜¯ä¸€ä¸ªåº”ç”¨å±‚ç¨‹åºï¼Œä½¿ç”¨å®¢æˆ·æœº-æœåŠ¡å™¨èŒƒä¾‹ï¼Œå®é™…ä¸Šåœ¨ç½‘ç»œå±‚å¸®åŠ©TCP/IP\n- å®¢æˆ·æœºç™»å½•æœåŠ¡å™¨æ—¶å°±å¯ä»¥è‡ªåŠ¨è·å¾—æœåŠ¡å™¨åˆ†é…çš„IPåœ°å€å’Œå­ç½‘æ©ç \n    - DHCP DISCOVERï¼Œå®¢æˆ·ç«¯å¯»æ‰¾DHCPæœåŠ¡å™¨ä½ç½®æ—¶æ‰€ä½¿ç”¨çš„æŠ¥æ–‡\n    - DHCP OFFERï¼Œå‘ŠçŸ¥ç”¨æˆ·æœ¬æœåŠ¡å™¨å¯ä»¥ä¸ºå…¶æä¾›IPåœ°å€\n    - DHCP REQUESTï¼Œå‘è¯¥æœåŠ¡å™¨å‘é€ä¸€ä¸ªå¹¿æ’­çš„Requestè¯·æ±‚æŠ¥æ–‡é€šå‘Šé€‰æ‹©çš„æœåŠ¡å™¨ã€‚å¸Œæœ›è·å¾—æ‰€åˆ†é…çš„IPåœ°å€\n    - DHCP ACKï¼Œå‘é€ACKåº”ç­”æŠ¥æ–‡ï¼Œé€šçŸ¥ç”¨æˆ·å¯ä»¥ä½¿ç”¨åˆ†é…çš„IPåœ°å€\n\n#### MPLSï¼ˆå¤šåè®®æ ‡ç­¾äº¤æ¢ï¼‰\n\n- ä¸€ç§åœ¨å¼€æ”¾çš„é€šä¿¡ç½‘ä¸Šåˆ©ç”¨æ ‡ç­¾å¼•å¯¼æ•°æ®é«˜é€Ÿã€é«˜æ•ˆä¼ è¾“çš„æ–°æŠ€æœ¯\n- MPLSä»‹äºIPç½‘ç»œå±‚å’Œé“¾è·¯å±‚åè®®ä¹‹é—´ï¼Œæœ‰æ—¶è¢«ç§°ä¸º2.5å±‚åè®®\n- MPLSæ²¿ç€å·²å»ºç«‹çš„è·¯å¾„å‘é€æ•°æ®åŒ…\n- åœ¨è¿›å…¥MPLSç½‘ç»œï¼ˆå¦‚ISPï¼‰æ—¶æ ¹æ®IPåœ°å€æ·»åŠ æ ‡ç­¾ï¼Œåœ¨ç¦»å¼€æ—¶åˆ é™¤\n    - è½¬å‘ä»…åœ¨MPLSç½‘ç»œå†…ä½¿ç”¨æ ‡ç­¾\n\n#### OSPF/å¼€æ”¾å¼æœ€çŸ­è·¯å¾„ä¼˜å…ˆï¼ˆå†…éƒ¨ç½‘å…³è·¯ç”±åè®®/IGPï¼‰\n\n- OSPFï¼ˆOpen Shortest Path Firstå¼€æ”¾å¼æœ€çŸ­è·¯å¾„ä¼˜å…ˆï¼‰è®¡ç®—å•ä¸ªç½‘ç»œï¼ˆå¦‚ISPï¼‰çš„è·¯ç”±\n    - å°†ç½‘ç»œå»ºæ¨¡ä¸ºåŠ æƒè¾¹å›¾\n- OSPFå°†ä¸€ä¸ªå¤§å‹ç½‘ç»œï¼ˆè‡ªæ²»ç³»ç»Ÿï¼‰åˆ’åˆ†ä¸ºè¿æ¥åˆ°ä¸»å¹²åŒºåŸŸçš„åŒºåŸŸ\n    - æœ‰åŠ©äºæ‰©å¤§è§„æ¨¡\n\n#### BGP/è¾¹ç•Œç½‘å…³åè®®ï¼ˆå¤–éƒ¨ç½‘å…³è·¯ç”±åè®®/EGPï¼‰\n\n- BGPï¼ˆè¾¹ç•Œç½‘å…³åè®®ï¼‰è®¡ç®—äº’è¿è‡ªæ²»ç½‘ç»œä¸­çš„è·¯ç”±\n    - å…³é”®ä½œç”¨æ˜¯å°Šé‡ç½‘ç»œçš„è·¯ç”±æ”¿ç­–çº¦æŸ\n\n#### Internetç»„æ’­\n\n- ç»„å…·æœ‰ä¿ç•™çš„IPåœ°å€èŒƒå›´ï¼ˆDç±»ï¼‰\n- é€šè¿‡åè®®ï¼ˆå¦‚PIMï¼‰è®¡ç®—çš„è·¯ç”±ï¼š\n    - å¯†é›†æ¨¡å¼ä½¿ç”¨å¸¦å‰ªæçš„RPF(é€†å‘è·¯å¾„è½¬å‘æ ‘)\n    - ç¨€ç–æ¨¡å¼ä½¿ç”¨æ ¸å¿ƒæ ‘(CBT)\n- IPç»„æ’­é™¤äº†åœ¨å•ä¸ªç½‘ç»œä¸­ï¼ˆå¦‚æ•°æ®ä¸­å¿ƒã€æœ‰çº¿ç”µè§†ç½‘ç»œï¼‰å¤–ï¼Œæ²¡æœ‰å¾—åˆ°å¹¿æ³›åº”ç”¨","tags":["è®¡ç®—æœºç½‘ç»œ"],"categories":["è®¡è½¯æ‚è°ˆ","å­¦ä¹ ç¬”è®°"]},{"title":"è®¡ç®—æœºç½‘ç»œ-ä»‹è´¨è®¿é—®æ§åˆ¶å­å±‚ å­¦ä¹ ç¬”è®°","url":"/20230128/mac-layer/","content":"- è´Ÿè´£ç¡®å®šå¤šè·¯è®¿é—®ä¿¡é“ä¸‹ä¸€ä¸ªä½¿ç”¨è€…\n- æ•°æ®é“¾è·¯å±‚çš„ä¸€ä¸ªé‡è¦éƒ¨åˆ†ï¼Œç‰¹åˆ«æ˜¯å¯¹äºå±€åŸŸç½‘\n\n## ä¿¡é“åˆ†é…é—®é¢˜\n\n- ç”¨äºæ¥è‡ªNä¸ªç”¨æˆ·çš„å›ºå®šé€šé“å’Œæµé‡\n    - ä½¿ç”¨FDMã€TDMã€CDMAç­‰åˆ’åˆ†å¸¦å®½\n    - è¿™æ˜¯ä¸€ç§é™æ€åˆ†é…ï¼Œä¾‹å¦‚è°ƒé¢‘æ”¶éŸ³æœº\n    - è¿™ç§é™æ€åˆ†é…å¯¹äºçªå‘æµé‡çš„æ€§èƒ½å¾ˆå·®\n    - åˆ†é…ç»™ç”¨æˆ·çš„èµ„æºæœ‰æ—¶ä¼šè¢«é—²ç½®\n- åŠ¨æ€åˆ†é…åœ¨ç”¨æˆ·éœ€è¦æ—¶ä¸ºå…¶æä¾›é€šé“\n    - å¯¹äºNä¸ªç”¨æˆ·ï¼Œæ•ˆç‡å¯èƒ½æ˜¯Nå€\n\n### åŠ¨æ€ä¿¡é“åˆ†é…çš„å‡è®¾\n\n- æµé‡ç‹¬ç«‹\n- å•ä¿¡é“\n- å†²çªå¯è§‚å¯Ÿ\n- æ—¶é—´è¿ç»­æˆ–åˆ†æ§½\n- è½½æ³¢ä¾¦å¬æˆ–ä¸å¬\n\n## å¤šè®¿é—®åè®®\n\n### ALOHA\n\n- ç”±å¤å¨å¤·å¤§å­¦çš„Norm Abramsonå¼€å‘\n- å®Œå…¨åˆ†æ•£åè®®\n\n#### çº¯ALOHA\n\n- åœ¨çº¯ALOHAä¸­ï¼Œç”¨æˆ·åªè¦æœ‰æ•°æ®å°±å‘é€å¸§\n- ç”¨æˆ·åœ¨å‘ç”Ÿå†²çªåé€‰æ‹©éšæœºçš„æ—¶é—´åé‡è¯•\n    - ä½è´Ÿè½½ä¸‹çš„é«˜æ•ˆä½å»¶è¿Ÿ\n- å½“å…¶ä»–ç”¨æˆ·åœ¨ä¸¤å€äºå¸§æ—¶é—´çš„è„†å¼±æ—¶æ®µå†…ä¼ è¾“æ—¶ï¼Œä¼šå‘ç”Ÿå†²çª\n- å°†å‘é€ç«¯ä¸æ—¶é—´æ§½åŒæ­¥å¯ä»¥å‡å°‘å†²çª\n    - å¸§æ—¶é—´ï¼šå¸§é•¿åº¦é™¤ä»¥æ¯”ç‰¹ç‡\n- ååé‡$S = G \\times e^ {(-2G)}$\n- æœ€å¤§ååé‡å‡ºç°åœ¨$G = 0.5ï¼ŒS = 1/2e = 18.4\\%$\n\n#### åˆ†æ§½ALOHA\n\n- åˆ†æ§½ALOHAçš„æ•ˆç‡æ˜¯çº¯ALOHAçš„ä¸¤å€\n- ä½è´Ÿè½½æµªè´¹æ—¶é—´æ§½ï¼Œé«˜è´Ÿè½½å¯¼è‡´ç¢°æ’\n- ååé‡$S = G \\times e^ {(-G)}$\n- æœ€å¤§ååé‡å‡ºç°åœ¨$G = 1ï¼ŒS = 1/e = 36.8\\%$\n\n### CSMA\n\n- CSMAé€šè¿‡æ„ŸçŸ¥ä¿¡é“æ”¹è¿›äº†ALOHA\n    - å¦‚æœç”¨æˆ·æ„Ÿè§‰åˆ°å…¶ä»–äººï¼Œåˆ™ä¸ä¼šå‘é€\n    - â€œå…ˆæ„ŸçŸ¥åä¼ è¾“â€æˆ–â€œå…ˆå¬åè¯´â€çš„åŸåˆ™\n- 1-åšæŒCSMAæŒç»­ä¾¦å¬ï¼Œä¸€æœ‰ç©ºé—²ç«‹å³å‘é€\n- éåšæŒCSMAå¦‚æœä¾¦å¬å­˜åœ¨è½½æ³¢ï¼Œåˆ™ç­‰å¾…éšæœºæ—¶é—´ï¼Œç„¶åé‡å¤ä¸Šè¿°æ­¥éª¤ï¼Œä¼šå¸¦æ¥æ›´å¤§å»¶è¿Ÿï¼Œä½†æœ‰æ›´å¥½çš„ä¿¡é“åˆ©ç”¨ç‡\n- p-åšæŒCSMAè¯•ç”¨ä¸åˆ†æ—¶é—´æ§½çš„ä¿¡é“ã€‚å¦‚æœä¾¦å¬æ—¶ä¿¡é“ç©ºé—²ï¼Œåˆ™æŒ‰æ¦‚ç‡på‘é€æ•°æ®ï¼Œæ¦‚ç‡1-pæ¨è¿Ÿåˆ°ä¸‹ä¸€ä¸ªæ—¶é—´æ§½ï¼Œå¦‚æœå‘ç”Ÿå†²çªï¼Œåˆ™ç­‰å¾…éšæœºæ—¶é—´ï¼Œç„¶åé‡å¤ä¸Šè¿°æ­¥éª¤\n\n#### å¸¦å†²çªæ£€æµ‹çš„CSMA\n\n- CSMA/CDçš„æ”¹è¿›æ˜¯æ£€æµ‹/ä¸­æ­¢å†²çª\n- å‡å°‘ç«äº‰æ—¶é—´ä»¥æé«˜æ€§èƒ½\n- ä¸€ä¸ªç«™åœ¨å‘é€å¸§åç›‘å¬ä»‹è´¨ï¼Œä»¥æŸ¥çœ‹ä¼ è¾“æ˜¯å¦æˆåŠŸ\n    - å¦‚æœæ˜¯è¿™æ ·çš„è¯ï¼Œè¿™ä¸ªç«™å°±ç»“æŸäº†\n    - å¦‚æœå‘ç”Ÿç¢°æ’ï¼Œå°†ç«‹å³ç»ˆæ­¢å‘é€ï¼Œéšæœºç­‰å¾…ä¸€æ®µæ—¶é—´åå¸§å°†å†æ¬¡å‘é€\n- ä¸€ä¸ªç«™ä¼ è¾“äº†2Ï„åæ²¡æœ‰ç›‘å¬åˆ°å†²çªï¼Œåˆ™å¯ä»¥ç¡®ä¿è‡ªå·±æŠ“ä½äº†ä¿¡é“ï¼ˆÏ„ä¸ºä¸¤ä¸ªç›¸è·æœ€è¿œçš„ç«™ä¼ æ’­ä¿¡å·æ‰€éœ€è¦çš„æ—¶é—´ï¼‰\n\n### æ— å†²çªåè®®\n\n- æ— å†²çªåè®®å®Œå…¨é¿å…å†²çª\n- å‘é€æ–¹å¿…é¡»çŸ¥é“ä½•æ—¶è½®åˆ°ä»–ä»¬å‘é€\n\n#### ä½å›¾åè®®\n\n- å¦‚æœå‘é€æ–¹æœ‰æ•°æ®ï¼Œåˆ™åœ¨ç«äº‰æ§½ä¸­è®¾ç½®ä¸€ä½\n- å‘é€è€…ä¾æ¬¡å‘é€ï¼›æ¯ä¸ªäººéƒ½çŸ¥é“è°æœ‰æ•°æ®\n\n#### ä»¤ç‰Œä¼ é€’\n\n- ä»¤ç‰Œå‘é€ç¯å®šä¹‰å‘é€é¡ºåº\n    - å…·æœ‰ä»¤ç‰Œçš„ç«™ç‚¹å¯ä»¥åœ¨é€šè¿‡ä¹‹å‰å‘é€å¸§\n    - ä¹Ÿå¯ä»¥åœ¨æ²¡æœ‰ç¯çš„æƒ…å†µä¸‹ä½¿ç”¨ï¼Œä¾‹å¦‚ä»¤ç‰Œæ€»çº¿\n\n#### äºŒè¿›åˆ¶å€’è®¡æ•°\n\n- äºŒè¿›åˆ¶å€’è®¡æ•°æ”¹è¿›äº†ä½å›¾åè®®\n- ç«™ç‚¹åœ¨äº‰ç”¨æ’æ§½ä¸­ä»¥äºŒè¿›åˆ¶ä½ä¸²çš„å½¢å¼å¹¿æ’­è‡ªå·±çš„åœ°å€\n- å¼‚æˆ–è¿™äº›ä½ï¼›ç«™ç‚¹åœ¨å‘é€â€œ0â€ä½†å¼‚æˆ–ç»“æœä¸ºâ€œ1â€æ—¶æ”¾å¼ƒ\n\n### æœ‰é™ç«äº‰åè®®\n\n- åœ¨ä½è´Ÿè½½ä¸‹é‡‡ç”¨ç«äº‰çš„åšæ³•è€Œæä¾›è¾ƒçŸ­çš„å»¶è¿Ÿï¼Œè€Œåœ¨é«˜è´Ÿè½½ä¸‹é‡‡ç”¨æ— å†²çªæŠ€æœ¯ï¼Œä»è€Œè·å¾—è‰¯å¥½çš„ä¿¡é“æ•ˆç‡\n- å°†ç«™åˆ†æˆå‡ ç»„ï¼Œå…¶ä¸­åªæœ‰å¾ˆå°‘ä¸€éƒ¨åˆ†å¯èƒ½æƒ³è¦å‘é€\n    - é¿å…å› ç©ºé—²æ—¶é—´å’Œå†²çªè€Œé€ æˆçš„æµªè´¹\n\n#### è‡ªé€‚åº”æ ‘éå†åè®®\n\n- æ ‘å°†ç«™ç‚¹åˆ†æˆç»„ï¼ˆèŠ‚ç‚¹ï¼‰è¿›è¡Œè½®è¯¢\n    - æ·±åº¦ä¼˜å…ˆæœç´¢å…·æœ‰å†²çªçš„èŠ‚ç‚¹ä¸‹çš„æ ‘\n    - å¦‚æœ>1ä¸ªç«™ç‚¹ï¼Œåˆ™åœ¨è¾ƒä½å±‚å¼€å§‹æœç´¢\n\n### æ— çº¿å±€åŸŸç½‘åè®®\n\n- ä¸æœ‰çº¿ç›¸æ¯”ï¼Œæ— çº¿å…·æœ‰å¤æ‚æ€§\n- èŠ‚ç‚¹å¯èƒ½å…·æœ‰ä¸åŒçš„è¦†ç›–åŒºåŸŸï¼Œè¿™å¯¼è‡´äº†éšè—ç»ˆç«¯å’Œæš´éœ²ç»ˆç«¯\n- èŠ‚ç‚¹æ— æ³•æ£€æµ‹å†²çªï¼Œå³å‘é€æ—¶æ— æ³•æ„ŸçŸ¥å†²çªï¼Œè¿™ä½¿ç¢°æ’å˜å¾—æ˜‚è´µä¸”å¿…é¡»é¿å…\n\n#### éšè—ç»ˆç«¯\n\n- éšè—ç»ˆç«¯æ˜¯å‘é€æ–¹ï¼Œå®ƒä»¬ä¸èƒ½ç›¸äº’æ„ŸçŸ¥ï¼Œä½†ä¼šåœ¨é¢„æœŸçš„æ¥æ”¶æ–¹å¤„å‘ç”Ÿç¢°æ’\n\n#### æš´éœ²ç»ˆç«¯\n\n- æš´éœ²ç»ˆç«¯æ˜¯èƒ½å¤Ÿç›¸äº’æ„ŸçŸ¥ä½†ä»èƒ½å®‰å…¨ä¼ è¾“ï¼ˆåˆ°ä¸åŒæ¥æ”¶å™¨ï¼‰çš„å‘é€æ–¹\n\n#### å†²çªé¿å…å¤šè·¯è®¿é—®ï¼ˆMACAï¼‰\n\n- MACAåè®®æˆäºˆAå‘é€ç»™Bçš„è®¿é—®æƒï¼š\n    - Aå‘Bå‘é€RTSï¼›Bå›å¤CTS\n    - Aå¯ä»¥ä½¿ç”¨æš´éœ²ä½†ä¸éšè—çš„ç»ˆç«¯è¿›è¡Œå‘é€\n\n## ä»¥å¤ªç½‘\n\n### ç»å…¸ä»¥å¤ªç½‘\n\n- ä¸€æ¡å…±äº«åŒè½´ç”µç¼†ï¼Œæ‰€æœ‰ä¸»æœºéƒ½è¿æ¥åˆ°è¯¥ç”µç¼†\n- é«˜è¾¾10 Mbpsï¼Œé‡‡ç”¨æ›¼å½»æ–¯ç‰¹ç¼–ç \n- ä¸»æœºè¿è¡Œç»å…¸çš„ä»¥å¤ªç½‘åè®®è¿›è¡Œè®¿é—®\n- MACåè®®æ˜¯1-persistent CSMA/CDï¼ˆæ—©æœŸï¼‰\n- ä½¿ç”¨BEBï¼ˆäºŒè¿›åˆ¶æŒ‡æ•°åé€€çš„CSMA/CAï¼‰è®¡ç®—ç¢°æ’åçš„éšæœºå»¶è¿Ÿï¼ˆåé€€ï¼‰\n- å¸§æ ¼å¼ä»ç„¶ç”¨äºç°ä»£ä»¥å¤ªç½‘\n    - DIX å‰å¯¼ç +ç›®æ ‡åœ°å€+æºåœ°å€+ç±»å‹+æ•°æ®+å¡«å……+æ ¡éªŒå’Œ\n    - IEEE802.3 å‰å¯¼ç ï¼ˆSOFï¼‰+ç›®æ ‡åœ°å€+æºåœ°å€+é•¿åº¦+æ•°æ®+å¡«å……+æ ¡éªŒå’Œ\n    - æœ€å¤§æ•°æ®é•¿åº¦1500å­—èŠ‚ï¼Œæœ€å°æ•°æ®é•¿åº¦46å­—èŠ‚ï¼ˆå¸§æœ€å°æ•°æ®é•¿åº¦64å­—èŠ‚ï¼Œä¸ºäº†æœ‰æ•ˆå†²çªæ£€æµ‹ï¼‰\n\n#### BEB\n\n- åœ¨ç¬¬iæ¬¡å†²çªåï¼Œä»0-2^i-1ä¹‹é—´é€‰æ‹©ä¸€ä¸ªéšæœºæ•°ï¼Œç­‰å¾…è¿™ä¹ˆå¤šçš„æ—¶é—´æ§½\n- è¾¾åˆ°10æ¬¡å†²çªåï¼Œéšæœºæ•°çš„é€‰æ‹©åŒºé—´è¢«å›ºå®šåœ¨1023\n- 16æ¬¡å†²çªåï¼Œæ”¾å¼ƒåŠªåŠ›å¹¶è¿”å›ä¸€ä¸ªå¤±è´¥æŠ¥å‘Š\n\n#### å•æ’­/ç»„æ’­/å¤šæ’­\n\n- è¦æ‰¾åˆ°åœ°å€çš„ç±»å‹ï¼Œæˆ‘ä»¬éœ€è¦æŸ¥çœ‹å·¦è¾¹çš„ç¬¬äºŒä¸ªåå…­è¿›åˆ¶æ•°å­—\n    - å¦‚æœæ˜¯å¶æ•°ï¼Œåˆ™åœ°å€ä¸ºå•æ’­\n    - å¦‚æœæ˜¯å¥‡æ•°ï¼Œåˆ™åœ°å€ä¸ºå¤šæ’­\n    - å¦‚æœæ‰€æœ‰æ•°å­—éƒ½æ˜¯Fï¼Œåˆ™ä¸ºå¹¿æ’­åœ°å€\n\n#### æ€§èƒ½\n\n- é€‚ç”¨äºå¤§å¸§ï¼Œå³ä½¿æœ‰å¤šä¸ªå‘é€è€…\n- å°å¸§ï¼ˆå’Œé•¿å±€åŸŸç½‘ï¼‰æ€§èƒ½ä¸‹é™\n\n### äº¤æ¢å¼ä»¥å¤ªç½‘\n\n- é›†çº¿å™¨å°†æ‰€æœ‰çº¿è·¯è¿æ¥åˆ°å•ä¸ªCSMA/CDåŸŸä¸­\n- äº¤æ¢æœºå°†æ¯ä¸ªç«¯å£éš”ç¦»åˆ°å•ç‹¬çš„åŸŸ\n    - å¤šç«¯å£çš„ååé‡è¦å¤§å¾—å¤š\n    - æ— éœ€ä½¿ç”¨å¸¦æœ‰å…¨åŒå·¥çº¿è·¯çš„CSMA/CD\n\n### å¿«é€Ÿä»¥å¤ªç½‘\n\n- å¿«é€Ÿä»¥å¤ªç½‘æ‰©å±•ä»¥å¤ªç½‘ï¼Œä»10 Mbpsæ‰©å±•åˆ°100 Mbps\n    - MACå­å±‚ä¿æŒä¸å˜\n    - ä¸ºäº†ä¿æŒå¸§çš„æœ€å°å¤§å°ï¼Œç½‘ç»œç”µç¼†çš„æœ€å¤§é•¿åº¦åº”ç¼©çŸ­10å€\n    - åŒç»çº¿ï¼ˆ5ç±»ï¼‰å æ®å¸‚åœº\n\n### åƒå…†/10åƒå…†ä»¥å¤ªç½‘\n\n- åœ¨è®¡ç®—æœº/äº¤æ¢æœºä¹‹é—´ä½¿ç”¨å…¨åŒå·¥çº¿è·¯\n- åœ°å€é•¿åº¦ã€å¸§æ ¼å¼ä»¥åŠæœ€å¤§å’Œæœ€å°å¸§é•¿åº¦ä¿æŒä¸å˜ã€‚\n- ä¸ºäº†å®ç°1 Gbpsçš„æ•°æ®é€Ÿç‡ï¼Œè¿™ä¸å†å¯èƒ½ä¿æŒMACå­å±‚ä¸å˜\n- åƒå…†ä»¥å¤ªç½‘æœ‰ä¸¤ç§ä¸åŒçš„ä»‹è´¨è®¿é—®æ–¹æ³•ï¼š\n    - **åŠåŒå·¥**ï¼šä¸é›†çº¿å™¨ä¸€èµ·ä½¿ç”¨ã€‚éœ€è¦CSMA/CDã€‚æœ€å¤§è·ç¦»æ˜¯ä¼ ç»Ÿä»¥å¤ªç½‘ï¼ˆ2500mï¼‰çš„1/100å€ï¼ˆ2500m->25mï¼‰\n    - **å…¨åŒå·¥**ï¼šâ€œæ­£å¸¸â€æ¨¡å¼ã€‚ç”¨äºä¸­å¤®äº¤æ¢æœºã€‚æ‰€æœ‰çš„çº¿è·¯å…·æœ‰ç¼“å†²èƒ½åŠ›ã€‚æ²¡æœ‰ç«äº‰ï¼Œæ— éœ€CSMA/CD\n- å¢åŠ åŠå¾„çš„ä¸¤ä¸ªæ ‡å‡†åŠŸèƒ½ï¼š\n    - **è½½æ³¢æ‰©å……ï¼ˆcarrier extensionï¼‰**ï¼šå‘Šè¯‰ç¡¬ä»¶åœ¨æ­£å¸¸å¸§ï¼ˆ64å­—èŠ‚ï¼‰åæ·»åŠ è‡ªå·±çš„å¡«å……ï¼Œä»¥å°†å¸§æ‰©å±•åˆ°512å­—èŠ‚\n    - **å¸§çªå‘ï¼ˆframe burstingï¼‰**ï¼šå…è®¸å‘é€æ–¹åœ¨ä¸€æ¬¡ä¼ è¾“ä¸­ä¼ è¾“å¤šä¸ªå¸§çš„ä¸²è”åºåˆ—\n- è¿™ä¸¤ä¸ªåŠŸèƒ½å°†ç½‘ç»œçš„åŠå¾„æ‰©å±•åˆ°200ç±³\n\n## æ— çº¿å±€åŸŸç½‘\n\n### 802.11ä½“ç³»ç»“æ„å’Œåè®®æ ˆ\n\n- æ— çº¿å®¢æˆ·ç«¯ä¸æœ‰çº¿APï¼ˆæ¥å…¥ç‚¹ï¼‰å…³è”\n    - è¿™è¢«ç§°ä¸ºåŸºç¡€è®¾æ–½æ¨¡å¼ï¼›ä¹Ÿæœ‰æ²¡æœ‰APçš„è‡ªç»„ç»‡æ¨¡å¼ï¼Œè¾ƒç½•è§\n- MACç”¨äºä¸åŒçš„ç‰©ç†å±‚\n\n### 802.11ç‰©ç†å±‚\n\n- ç½‘å¡ä¸å¤šä¸ªç‰©ç†å±‚å…¼å®¹\n    - ä¾‹å¦‚802.11 a/b/g\n\n### 802.11MACå­å±‚\n\n- CSMA/CAæ’å…¥åé€€æ§½ä»¥é¿å…å†²çª\n- MACå¯¹æ— çº¿é”™è¯¯ä½¿ç”¨ACK/é‡ä¼ \n\n### 802.11å¸§ç»“æ„\n\n- å¸§å› å…¶ç±»å‹è€Œå¼‚ï¼ˆå¸§æ§åˆ¶ï¼‰\n- æ•°æ®å¸§æœ‰3ä¸ªåœ°å€è¦é€šè¿‡APä¼ é€’\n\n## æ•°æ®é“¾è·¯å±‚äº¤æ¢\n\n### å­¦ä¹ ç½‘æ¡¥\n\n- åå‘å­¦ä¹ ç®—æ³•é€‰æ‹©è¾“å‡ºç«¯å£ï¼š\n    - å°†å¸§ä¸Šçš„æºåœ°å€ä¸è¾“å…¥ç«¯å£å…³è”\n    - å¸¦æœ‰ç›®æ ‡åœ°å€çš„å¸§è¢«é€åˆ°å·²ç»å­¦ä¹ è¿‡çš„ç«¯å£\n    - æœªå­¦ä¹ çš„ç›®çš„åœ°å°†å‘é€åˆ°æ‰€æœ‰å…¶ä»–ç«¯å£ï¼ˆæ³›æ´ªç®—æ³•ï¼‰\n\n### ç”Ÿæˆæ ‘ç½‘æ¡¥\n\n- å…·æœ‰å¾ªç¯å’Œåªæœ‰åå‘å­¦ä¹ çš„æ¡¥æ¥æ‹“æ‰‘å°†å¯¼è‡´å¸§æ°¸è¿œå¾ªç¯\n    - éœ€è¦æ”¯æŒç”Ÿæˆæ ‘æ¥è§£å†³é—®é¢˜\n- æ•°æ®è½¬å‘ç«¯å£çš„å­é›†ç”¨äºé¿å…å¾ªç¯\n- ä½¿ç”¨Perlmanç”Ÿæˆç®—æ³•é€‰æ‹©Perlmanç”Ÿæˆæ ‘\n\n### è™šæ‹Ÿå±€åŸŸç½‘\n\n- VLANï¼ˆè™šæ‹ŸLANï¼‰å°†ä¸€ä¸ªç‰©ç†LANæ‹†åˆ†ä¸ºå¤šä¸ªé€»è¾‘LANï¼Œä»¥ç®€åŒ–ç®¡ç†ä»»åŠ¡\n    - ç«¯å£æ ¹æ®å…¶VLANâ€œç€è‰²â€","tags":["è®¡ç®—æœºç½‘ç»œ"],"categories":["è®¡è½¯æ‚è°ˆ","å­¦ä¹ ç¬”è®°"]},{"title":"ç®—æ³•å¯¼è®º å­¦ä¹ ç¬”è®°","url":"/20221229/clrs-book-note/","content":"## åŸºç¡€çŸ¥è¯†\n### ç®—æ³•åŸºç¡€\n#### å¢é‡æ–¹æ³•\n##### æ’å…¥æ’åº\n```text\nINSERTION-SORT(A)\nfor j = 2 to A.length\n    key = A[j]\n    i = j - 1\n    while i > 0 and A[j] > key\n        A[i + 1] = A[i]\n        i = i - 1\n    A[i + 1] = key\n```\n##### å¾ªç¯ä¸å˜å¼\nå¾ªç¯ä¸å˜å¼ä¸»è¦ç”¨æ¥å¸®åŠ©æˆ‘ä»¬ç†è§£ç®—æ³•çš„æ­£ç¡®æ€§ã€‚å…³äºå¾ªç¯ä¸å˜å¼ï¼Œæˆ‘ä»¬å¿…é¡»è¯æ˜ä¸‰æ¡æ€§è´¨ï¼š  \n- **åˆå§‹åŒ–**ï¼šå¾ªç¯çš„ç¬¬ä¸€æ¬¡è¿­ä»£ä¹‹å‰ï¼Œå®ƒä¸ºçœŸ\n- **ä¿æŒ**ï¼šå¦‚æœå¾ªç¯çš„æŸæ¬¡è¿­ä»£ä¹‹å‰å®ƒä¸ºçœŸï¼Œé‚£ä¹ˆä¸‹æ¬¡è¿­ä»£ä¹‹å‰å®ƒä»ç„¶ä¸ºçœŸ\n- **ç»ˆæ­¢**ï¼šåœ¨å¾ªç¯ç»ˆæ­¢æ—¶ï¼Œä¸å˜å¼ä¸ºæˆ‘ä»¬æä¾›ä¸€ä¸ªæœ‰ç”¨çš„æ€§è´¨ï¼Œè¯¥æ€§è´¨æœ‰åŠ©äºè¯æ˜ç®—æ³•æ˜¯æ­£ç¡®çš„\n#### åˆ†æ²»æ³•\nåˆ†æ²»æ³•çš„æ€æƒ³ï¼šå°†åŸé—®é¢˜åˆ†è§£ä¸ºå‡ ä¸ªè§„æ¨¡è¾ƒå°ä½†ç±»ä¼¼äºåŸé—®é¢˜çš„å­é—®é¢˜ï¼Œé€’å½’åœ°æ±‚è§£è¿™äº›å­é—®é¢˜ï¼Œç„¶åå†åˆå¹¶è¿™äº›å­é—®é¢˜çš„è§£æ¥å»ºç«‹åŸé—®é¢˜çš„è§£\nåˆ†æ²»æ¨¡å¼åœ¨æ¯å±‚é€’å½’æ—¶éƒ½æœ‰ä¸‰ä¸ªæ­¥éª¤ï¼š\n- **åˆ†è§£**åŸé—®é¢˜ä¸ºè‹¥å¹²å­é—®é¢˜ï¼Œè¿™äº›å­é—®é¢˜æ˜¯åŸé—®é¢˜çš„è§„æ¨¡è¾ƒå°çš„å®ä¾‹\n- **è§£å†³**è¿™äº›å­é—®é¢˜ï¼Œé€’å½’åœ°æ±‚è§£å„å­é—®é¢˜ã€‚ç„¶è€Œï¼Œè‹¥å­é—®é¢˜çš„è§„æ¨¡è¶³å¤Ÿå°ï¼Œåˆ™ç›´æ¥æ±‚è§£\n- **åˆå¹¶**è¿™äº›å­é—®é¢˜çš„è§£æˆåŸé—®é¢˜çš„è§£\n##### å½’å¹¶æ’åº\n- **åˆ†è§£**ï¼šåˆ†è§£å¾…æ’åºçš„nä¸ªå…ƒç´ çš„åºåˆ—æˆå„å…·n/2ä¸ªå…ƒç´ çš„ä¸¤ä¸ªå­åºåˆ—\n- **è§£å†³**ï¼šä½¿ç”¨å½’å¹¶æ’åºé€’å½’åœ°æ’åºä¸¤ä¸ªå­åºåˆ—\n- **åˆå¹¶**ï¼šåˆå¹¶ä¸¤ä¸ªå·²æ’åºçš„å­åºåˆ—ä»¥äº§ç”Ÿå·²æ’åºçš„ç­”æ¡ˆ\n\næˆ‘ä»¬é€šè¿‡è°ƒç”¨ä¸€ä¸ªè¾…åŠ©è¿‡ç¨‹ `MERGE(A, p, q, r)` æ¥å®Œæˆåˆå¹¶ï¼Œå…¶ä¸­$A$æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œ $p$ã€$q$å’Œ$r$æ˜¯æ•°ç»„ä¸‹æ ‡ï¼Œæ»¡è¶³$p \\leq q < r$ã€‚è¯¥è¿‡ç¨‹å‡è®¾å­æ•°ç»„$A[p..q]$å’Œ$A[q+1..r]$éƒ½å·²æ’å¥½åº\nè¿‡ç¨‹ `MERGE` éœ€è¦$\\Theta(n)$çš„æ—¶é—´ï¼Œå…¶ä¸­$n=r-p+1$æ˜¯å¸¦åˆå¹¶å…ƒç´ çš„æ€»æ•°\n```text\nMERGE(A, p, q, r)\nn1 = q - p + 1\nn2 = r - q\nlet L[1..n1 + 1] and R[1..n2 + 1] be new arrays\nfor i = 1 to n1\n    L[i] = A[p + i - 1]\nfor j = 1 to n2\n    R[j] = A[q + j]\nL[n1 + 1] = âˆ\nR[n2 + 1] = âˆ\ni = 1\nj = 1\nfor k = p to r\n    if L[i] <= R[j]\n        A[k] = L[i]\n        i = i + 1\n    else \n        A[k] = R[j]\n        j = j + 1\n```\n```text\nMERGE-SORT(A, p, r)\nif p < r\n    q = âŒŠ(p + r)/2âŒ‹\n    MERGE-SORT(A, p, q)\n    MERGE-SORT(A, q+1, r)\n    MERGE(A, p, q, r)\n```\n##### åˆ†æåˆ†æ²»ç®—æ³•\nå‡è®¾$T(n)$æ˜¯è§„æ¨¡ä¸º$n$çš„ä¸€ä¸ªé—®é¢˜çš„è¿è¡Œæ—¶é—´ï¼š\n- è‹¥é—®é¢˜è§„æ¨¡è¶³å¤Ÿå°ï¼Œåˆ™ç›´æ¥æ±‚è§£éœ€è¦å¸¸é‡æ—¶é—´$\\Theta(1)$\n- å‡è®¾æŠŠåŸé—®é¢˜åˆ†è§£ä¸º$a$ä¸ªå­é—®é¢˜ï¼Œæ¯ä¸ªå­é—®é¢˜çš„è§„æ¨¡æ˜¯åŸé—®é¢˜çš„$1/b$ã€‚ä¸ºäº†æ±‚è§£ä¸€ä¸ªè§„æ¨¡ä¸º$n/b$çš„å­é—®é¢˜ï¼Œéœ€è¦$T(n/b)$çš„æ—¶é—´ï¼Œæ‰€ä»¥éœ€è¦$aT(n/b)$çš„æ—¶é—´æ¥æ±‚è§£$a$ä¸ªå­é—®é¢˜\n- åˆ†è§£é—®é¢˜æˆå­é—®é¢˜éœ€æ—¶é—´$D(n)$\n- åˆå¹¶å­é—®é¢˜çš„è§£æˆåŸé—®é¢˜çš„è§£éœ€æ—¶é—´$C(n)$\n\né‚£ä¹ˆå¾—åˆ°é€’å½’å¼ï¼š\n$$\nT(n) =\n\\begin{cases}\n\\Theta(1) \\qquad & n \\leq c \\\\\naT(n/b)+D(n)+C(n) \\qquad & other\n\\end{cases}\n$$\n\nå¯¹äºå½’å¹¶æ’åºï¼Œå…¶æœ€åæƒ…å†µè¿è¡Œæ—¶é—´$T(n)$çš„é€’å½’å¼ï¼š\n$$\nT(n) =\n\\begin{cases}\n\\Theta(1) \\qquad & n = 1 \\\\\n2T(n/2)+\\Theta(n) \\qquad &  n>1\n\\end{cases} = \\Theta(nlgn)\n$$\n### å‡½æ•°å¢é•¿\n#### æ¸è¿›è®°å·\n##### $\\Theta$è®°å·\nå¯¹äºä¸€ä¸ªç»™å®šçš„å‡½æ•°$g(n)$ï¼Œç”¨$\\Theta(g(n))$æ¥è¡¨ç¤ºä»¥ä¸‹å‡½æ•°çš„é›†åˆï¼š  \n$\\Theta(g(n))=\\{f(n):\\text{å­˜åœ¨æ­£å¸¸é‡}c_1\\text{ã€}c_2\\text{å’Œ}n_0\\text{ï¼Œä½¿å¾—å¯¹æ‰€æœ‰}n \\geq n_0\\text{ï¼Œæœ‰}0\\leq c_1g(n) \\leq f(n) \\leq c_2g(n)\\}$\n\n![$\\Theta$](https://d-sketon.top/img/clrs-book/1.png)\n\næˆ‘ä»¬ç§°$g(n)$æ˜¯$f(n)$çš„ä¸€ä¸ª**æ¸è¿›ç´§ç¡®ç•Œ**\n##### $O$è®°å·\nå¯¹äºä¸€ä¸ªç»™å®šçš„å‡½æ•°$g(n)$ï¼Œç”¨$O(g(n))$æ¥è¡¨ç¤ºä»¥ä¸‹å‡½æ•°çš„é›†åˆï¼š  \n$O(g(n))=\\{f(n):\\text{å­˜åœ¨æ­£å¸¸é‡}c\\text{å’Œ}n_0\\text{ï¼Œä½¿å¾—å¯¹æ‰€æœ‰}n \\geq n_0\\text{ï¼Œæœ‰}0\\leq f(n) \\leq cg(n)\\}$\n\n![$O$](https://d-sketon.top/img/clrs-book/2.png)\n\n\næˆ‘ä»¬ç§°$g(n)$æ˜¯$f(n)$çš„ä¸€ä¸ª**æ¸è¿›ä¸Šç•Œ**\n##### $\\Omega$è®°å·\nå¯¹äºä¸€ä¸ªç»™å®šçš„å‡½æ•°$g(n)$ï¼Œç”¨$\\Omega(g(n))$æ¥è¡¨ç¤ºä»¥ä¸‹å‡½æ•°çš„é›†åˆï¼š  \n$\\Omega(g(n))=\\{f(n):\\text{å­˜åœ¨æ­£å¸¸é‡}c\\text{å’Œ}n_0\\text{ï¼Œä½¿å¾—å¯¹æ‰€æœ‰}n \\geq n_0\\text{ï¼Œæœ‰}0\\leq cg(n) \\leq f(n)\\}$\n\n![$\\Omega$](https://d-sketon.top/img/clrs-book/3.png)\n\næˆ‘ä»¬ç§°$g(n)$æ˜¯$f(n)$çš„ä¸€ä¸ª**æ¸è¿›ä¸‹ç•Œ**\n##### $o$è®°å·\nå¯¹äºä¸€ä¸ªç»™å®šçš„å‡½æ•°$g(n)$ï¼Œç”¨$o(g(n))$æ¥è¡¨ç¤ºä»¥ä¸‹å‡½æ•°çš„é›†åˆï¼š  \n$o(g(n))=\\{f(n):\\text{å­˜åœ¨æ­£å¸¸é‡}c\\text{å’Œ}n_0\\text{ï¼Œä½¿å¾—å¯¹æ‰€æœ‰}n \\geq n_0\\text{ï¼Œæœ‰}0\\leq f(n) < cg(n)\\}$\næˆ‘ä»¬ç§°$g(n)$æ˜¯$f(n)$çš„ä¸€ä¸ª**éæ¸è¿›ç´§ç¡®ä¸Šç•Œ**\n##### $\\omega$è®°å·\nå¯¹äºä¸€ä¸ªç»™å®šçš„å‡½æ•°$g(n)$ï¼Œç”¨$\\omega(g(n))$æ¥è¡¨ç¤ºä»¥ä¸‹å‡½æ•°çš„é›†åˆï¼š  \n$\\omega(g(n))=\\{f(n):\\text{å­˜åœ¨æ­£å¸¸é‡}c\\text{å’Œ}n_0\\text{ï¼Œä½¿å¾—å¯¹æ‰€æœ‰}n \\geq n_0\\text{ï¼Œæœ‰}0\\leq cg(n) < f(n)\\}$\næˆ‘ä»¬ç§°$g(n)$æ˜¯$f(n)$çš„ä¸€ä¸ª**éæ¸è¿›ç´§ç¡®ä¸‹ç•Œ**\n##### æ¯”è¾ƒå„ç§å‡½æ•°\n- ä¼ é€’æ€§\n$f(n) = \\Theta(g(n)) \\land g(n) = \\Theta(h(n)) \\rightarrow f(n) = \\Theta(h(n))$\n$f(n) = O(g(n)) \\land g(n) = O(h(n)) \\rightarrow f(n) = O(h(n))$\n$f(n) = \\Omega(g(n)) \\land g(n) = \\Omega(h(n)) \\rightarrow f(n) = \\Omega(h(n))$\n$f(n) = o(g(n)) \\land g(n) = o(h(n)) \\rightarrow f(n) = o(h(n))$\n$f(n) = \\omega(g(n)) \\land g(n) = \\omega(h(n)) \\rightarrow f(n) = \\omega(h(n))$\n- è‡ªåæ€§\n$f(n) = \\Theta(f(n))$\n$f(n) = O(f(n))$\n$f(n) = \\Omega(f(n))$\n- å¯¹ç§°æ€§\n$f(n) = \\Theta(g(n)) \\leftrightarrow g(n) = \\Theta(f(n))$\n- è½¬ç½®å¯¹ç§°æ€§\n$f(n) = O(g(n)) \\leftrightarrow g(n) = \\Omega(f(n))$\n$f(n) = o(g(n)) \\leftrightarrow g(n) = \\omega(f(n))$\n- ç±»æ¯”\n$f(n) = O(g(n)) \\rightarrow a \\leq b$\n$f(n) = \\Omega(g(n)) \\rightarrow a \\geq b$\n$f(n) = \\Theta(g(n)) \\rightarrow a = b$\n$f(n) = o(g(n)) \\rightarrow a < b$\n$f(n) = \\omega(g(n)) \\rightarrow a > b$\n#### æ ‡å‡†è®°å·ä¸å¸¸ç”¨å‡½æ•°\n##### å¤šé¡¹å¼\nå¯¹äºä¸€ä¸ª$d$æ¬¡æ¸è¿›æ­£çš„å¤šé¡¹å¼$p(n)$ï¼Œæœ‰ï¼š\n$$p(n)=\\Theta(n^d)$$\n##### æŒ‡æ•°\nä»»æ„åº•å¤§äº1çš„æŒ‡æ•°å‡½æ•°æ¯”ä»»æ„å¤šé¡¹å¼å‡½æ•°å¢é•¿å¾—å¿«ï¼š\n$$n^b = o(a^n),a>1$$\n##### å¯¹æ•°\nå¯¹æ‰€æœ‰å®æ•°$a>0$ï¼Œ$b>0$ï¼Œ$c>0$å’Œ$n$ï¼Œæœ‰ï¼š\n$$a = b^{log_b a}$$\n\n$$log_c(ab) = log_c a + log_c b$$\n\n$$log_b a^n = n log_b a$$\n\n$$log_b a = \\frac{log_c a}{log_c b}$$\n\n$$log_b(1/a) = -log_b a$$\n\n$$log_b a = \\frac{1}{log_a b}$$\n\n$$a^{log_b c} = c^{log_b a}$$\n\nä»»æ„æ­£çš„å¤šé¡¹å¼å‡½æ•°éƒ½æ¯”ä»»æ„å¤šåº•æ•°å‡½æ•°å¢é•¿å¾—å¿«ï¼š\n$$lg^b n = o(n^a)$$\n##### é˜¶ä¹˜\n**æ–¯ç‰¹æ—è¿‘ä¼¼å…¬å¼**ï¼š\n$$n!=\\sqrt{2\\pi n}(\\frac{n}{e})^n(1+\\Theta(\\frac{1}{n}))$$\n\n$$n!=\\sqrt{2\\pi n}(\\frac{n}{e})^n e^{a_n}, \\frac{1}{12n+1}<a_n<\\frac{1}{12n}$$\n\nç»™å‡ºäº†ä¸€ä¸ªæ›´ç´§ç¡®çš„ä¸Šç•Œå’Œä¸‹ç•Œï¼š\n$$n!=o(n^n)$$\n\n$$n!=\\omega(2^n)$$\n\n$$lg(n!)=\\Theta(nlgn)$$\n##### å¤šé‡å‡½æ•°\nå‡è®¾$f(n)$ä¸ºå®æ•°é›†ä¸Šçš„ä¸€ä¸ªå‡½æ•°ï¼Œå¯¹éè´Ÿæ•´æ•°$i$ï¼Œæˆ‘ä»¬é€’å½’åœ°å®šä¹‰ï¼š\n$$\nf^{(i)}(n) =\n\\begin{cases}\nn \\qquad & i = 1 \\\\\nf(f^{(i-1)}(n)) \\qquad &  i>1\n\\end{cases}\n$$\n##### å¤šé‡å¯¹æ•°å‡½æ•°\nå®šä¹‰å¤šé‡å¯¹æ•°å‡½æ•°ä¸ºï¼š\n$$lg*n=min\\{i \\geq 0:lg^{(i)}n \\leq 1\\}$$\n\nå¤šé‡å¯¹æ•°æ˜¯ä¸€ä¸ªå¢é•¿**éå¸¸æ…¢**çš„å‡½æ•°:\n- $lg*2=1$\n- $lg*4=2$\n- $lg*16=3$\n- $lg*65536=4$\n- $lg*(2^{65536})=5$\n### åˆ†æ²»ç­–ç•¥\n- **ä»£å…¥æ³•**ï¼šæˆ‘ä»¬çŒœæµ‹ä¸€ä¸ªç•Œï¼Œç„¶åç”¨æ•°å­¦å½’çº³æ³•è¯æ˜è¿™ä¸ªç•Œæ˜¯æ­£ç¡®çš„\n- **é€’å½’æ ‘æ³•**ï¼šå°†é€’å½’å¼è½¬æ¢ä¸ºä¸€æ£µæ ‘ï¼Œå…¶ç»“ç‚¹è¡¨ç¤ºä¸åŒå±‚æ¬¡çš„é€’å½’è°ƒç”¨äº§ç”Ÿçš„ä»£ä»·ã€‚ç„¶åé‡‡ç”¨è¾¹ç•Œå’ŒæŠ€æœ¯æ¥æ±‚è§£é€’å½’å¼\n- **ä¸»æ–¹æ³•**ï¼šå¯æ±‚è§£å½¢å¦‚ä¸‹é¢å…¬å¼çš„é€’å½’å¼çš„ç•Œï¼š\n$$T(n)=aT(n/b)+f(n),a\\geq 1,b>1$$\n#### æœ€å¤§å­æ•°ç»„é—®é¢˜\nå¯»æ‰¾Açš„å’Œæœ€å¤§çš„éç©ºè¿ç»­å­æ•°ç»„ï¼Œè¿™æ ·çš„è¿ç»­å­æ•°ç»„ä¸º**æœ€å¤§å­æ•°ç»„**\n##### ä½¿ç”¨åˆ†æ²»ç­–ç•¥çš„æ±‚è§£æ–¹æ³•\n$A[low..high]$çš„ä»»ä½•è¿ç»­å­æ•°ç»„$A[i..j]$æ‰€å¤„çš„ä½ç½®å¿…ç„¶æ˜¯ä¸€ä¸‹ä¸‰ç§æƒ…å†µä¹‹ä¸€ï¼š\n- å®Œå…¨ä½äºå­æ•°ç»„$A[low..mid]$ä¸­ï¼Œå› æ­¤$low \\leq i \\leq j \\leq mid$\n- å®Œå…¨ä½äºå­æ•°ç»„$A[mid+1..high]$ä¸­ï¼Œå› æ­¤$mid < i \\leq j \\leq high$\n- è·¨è¶Šäº†ä¸­ç‚¹ï¼Œå› æ­¤$low \\leq i \\leq mid < j \\leq high$\n\nè¿‡ç¨‹ `FIND-MAX-CROSSING-SUBARRAY(A, low, mid, high)` æ¥æ”¶æ•°ç»„$A$å’Œä¸‹æ ‡$low$ï¼Œ$mid$å’Œ$high$ä¸ºè¾“å…¥ï¼Œè¿”å›ä¸€ä¸ªä¸‹æ ‡å…ƒç»„åˆ’å®šè·¨è¶Šä¸­ç‚¹çš„æœ€å¤§å­æ•°ç»„çš„è¾¹ç•Œï¼Œå¹¶è¿”å›æœ€å¤§å­æ•°ç»„ä¸­å€¼çš„å’Œï¼š\n```text\nFIND-MAX-CROSSING-SUBARRAY(A, low, mid, high)\nleft-sum = -âˆ\nsum = 0\nfor i = mid downto low\n    sum = sum + A[i]\n    if sum > left-sum\n        left-sum = sum\n        max-left = i\nright-sum = -âˆ\nsum = 0\nfor j = mid + 1 to high\n    sum = sum + A[j]\n    if sum > right-sum\n        right-sum = sum\n        max-right = j\nreturn (max-left, max-right, left-sum + right-sum)\n```\n```text\nFIND-MAXINUM-SUBARRAY(A, low, high)\nif high == low\n    return (low, high, A[low])\nelse mid = âŒŠ(low + high)/2âŒ‹\n    (left-low, right-high, left-sum) = FIND-MAXINUM-SUBARRAY(A, low, mid)\n    (right-low, right-high, right-sum) = FIND-MAXINUM-SUBARRAY(A, mid+1, high)\n    (cross-low, cross-high, cross-zum) = FIND-MAX-CROSSING-SUBARRAY(A, low, mid, high)\n    if left-sum >= right-sum and left-sum >= cross-sum\n        return (left-low, left-high, left-sum)\n    elseif right-sum >= left-sum and right-sum >= cross-sum\n        return (right-low, right-high, right-sum)\n    else return (cross-low, cross-high, cross-sum)\n```\n##### åˆ†æ²»ç®—æ³•çš„åˆ†æ\n`FIND-MAXINUM-SUBARRAY` è¿è¡Œæ—¶é—´$T(n)$çš„é€’å½’å¼ï¼š\n$$\nT(n) =\n\\begin{cases}\n\\Theta(1) \\qquad & n = 1 \\\\\n2T(n/2) + \\Theta(n) \\qquad &  n>1\n\\end{cases} = \\Theta(nlgn)\n$$\n#### çŸ©é˜µä¹˜æ³•çš„Strassenç®—æ³•\n##### åŸºç¡€çš„çŸ©é˜µä¹˜æ³•\nå¤æ‚åº¦ $\\Theta (n^3)$\n```text\nSQUARE-MATRIX-MULTIPLY(A, B)\nn = A.rows\nlet C be a new n * n matrix\nfor i = 1 to n\n    for j = 1 to n\n        c_ij = 0\n        for k = 1 to n\n            c_ij = c_ij + a_ik * b_kj\nreturn C\n```\n##### ç®€å•çš„åˆ†æ²»ç®—æ³•\nå‡å®šå°†$A$ï¼Œ$B$å’Œ$C$å‡åˆ†è§£ä¸º4ä¸ª$n/2 \\times n/2$çš„å­çŸ©é˜µï¼š\n$$\nA = \\begin{bmatrix}\nA_{11} & A_{12} \\\\\nA_{21} & A_{22}\n\\end{bmatrix}\n,\nB = \\begin{bmatrix}\nB_{11} & B_{12} \\\\\nB_{21} & B_{22}\n\\end{bmatrix}\n,\nC = \\begin{bmatrix}\nC_{11} & C_{12} \\\\\nC_{21} & C_{22}\n\\end{bmatrix}\n$$\n\nå¯ä»¥å°†å…¬å¼$C = A \\cdot B$æ”¹å†™ä¸ºï¼š\n$$\n\\begin{bmatrix}\nC_{11} & C_{12} \\\\\nC_{21} & C_{22}\n\\end{bmatrix} = \n\\begin{bmatrix}\nA_{11} & A_{12} \\\\\nA_{21} & A_{22}\n\\end{bmatrix} \\cdot\n\\begin{bmatrix}\nB_{11} & B_{12} \\\\\nB_{21} & B_{22}\n\\end{bmatrix}\n$$\n```text\nSQUARE-MATRIX-MULTIPLY-RECURSIVE(A, B)\nn = A.rows\nlet C be a new n * n matrix\nif n == 1\n    c_11 = a_11 * b_11\nelse partition A, B and C as in equations \n    C_11 = SQUARE-MATRIX-MULTIPLY-RECURSIVE(A_11, B_11) + SQUARE-MATRIX-MULTIPLY-RECURSIVE(A_12, B_21)\n    C_12 = SQUARE-MATRIX-MULTIPLY-RECURSIVE(A_11, B_12) + SQUARE-MATRIX-MULTIPLY-RECURSIVE(A_12, B_22)\n    C_21 = SQUARE-MATRIX-MULTIPLY-RECURSIVE(A_21, B_11) + SQUARE-MATRIX-MULTIPLY-RECURSIVE(A_22, B_21)\n    C_22 = SQUARE-MATRIX-MULTIPLY-RECURSIVE(A_21, B_12) + SQUARE-MATRIX-MULTIPLY-RECURSIVE(A_22, B_22)\n```\n`SQUARE-MATRIX-MULTIPLY-RECURSIVE` è¿è¡Œæ—¶é—´$T(n)$çš„é€’å½’å¼ï¼š\n$$\nT(n) =\n\\begin{cases}\n\\Theta(1) \\qquad & n = 1 \\\\\n8T(n/2) + \\Theta(n^2) \\qquad &  n>1\n\\end{cases} = \\Theta(n^3)\n$$\n##### Strassenæ–¹æ³•\n`Strassen`è¿è¡Œæ—¶é—´$T(n)$çš„é€’å½’å¼ï¼š\n$$\nT(n) =\n\\begin{cases}\n\\Theta(1) \\qquad & n = 1 \\\\\n7T(n/2) + \\Theta(n^2) \\qquad &  n>1\n\\end{cases} = \\Theta(n^{lg_7})\n$$\n#### ä»£å…¥æ³•æ±‚è§£é€’å½’å¼\n**ä»£å…¥æ³•**æ±‚è§£é€’å½’å¼åˆ†ä¸ºä¸¤æ­¥ï¼š\n- çŒœæµ‹è§£çš„å½¢å¼\n- ç”¨æ•°å­¦å½’çº³æ³•æ±‚å‡ºè§£çš„å¸¸æ•°ï¼Œå¹¶è¯æ˜è§£æ˜¯æ­£ç¡®çš„\n\nä¾‹å¦‚ï¼Œç¡®å®šä¸‹åˆ—é€’å½’å¼çš„ä¸Šç•Œï¼š\n$$T(n)=2T(\\lfloor n/2 \\rfloor)+n$$\nçŒœæµ‹å…¶è§£ä¸º$T(n)=O(nlgn)$\né¦–å…ˆå‡å®šæ¬¡ä¸Šç•Œå¯¹æ‰€æœ‰æ­£æ•°$m<n$éƒ½æˆç«‹ï¼Œç‰¹åˆ«å¯¹äº$m=\\lfloor n/2 \\rfloor$ï¼Œæœ‰$T(\\lfloor n/2 \\rfloor) \\leq c\\lfloor n/2 \\rfloor lg(\\lfloor n/2 \\rfloor)$ã€‚å°†å…¶å¸¦å…¥é€’å½’å¼ï¼Œæœ‰ï¼š\n\n$T(n) \\leq 2(c\\lfloor n/2 \\rfloor lg(\\lfloor n/2 \\rfloor)) + n \\leq cn lg(n/2) + n \\\\\n= cnlgn-cnlg2+n\\\\\n=cnlgn-cn+n\\\\\n\\leq cnlgn$\nå…¶ä¸­ï¼Œåªè¦$c \\leq 1$ï¼Œæœ€åä¸€æ­¥éƒ½ä¼šæˆç«‹\n#### é€’å½’æ ‘æ±‚è§£é€’å½’å¼\nåœ¨**é€’å½’æ ‘**ä¸­ï¼Œæ¯ä¸ªç»“ç‚¹è¡¨ç¤ºä¸€ä¸ªå•ä¸€å­é—®é¢˜çš„ä»£ä»·ï¼Œå­é—®é¢˜å¯¹åº”æŸæ¬¡é€’å½’å‡½æ•°è°ƒç”¨\næˆ‘ä»¬å°†æ ‘ä¸­çš„æ¯å±‚ä¸­çš„ä»£ä»·æ±‚å’Œï¼Œå¾—åˆ°æ¯å±‚ä»£ä»·ï¼Œç„¶åå°†æ‰€æœ‰å±‚çš„ä»£ä»·æ±‚å’Œï¼Œå¾—åˆ°æ‰€æœ‰å±‚æ¬¡çš„é€’å½’è°ƒç”¨çš„æ€»ä»£ä»·\n#### ä¸»æ–¹æ³•æ±‚è§£é€’å½’å¼\nä»¤$a\\leq 1$å’Œ$b>1$æ˜¯å¸¸æ•°ï¼Œ$f(n)$æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œ$T(n)$æ˜¯å®šä¹‰åœ¨éè´Ÿæ•´æ•°ä¸Šçš„é€’å½’å¼ï¼š\n$$T(n)=aT(n/b)+f(n)$$\n\n- è‹¥å¯¹æŸä¸ªå¸¸æ•°$\\epsilon >0$æœ‰$f(n)=O(n^{log_ba-\\epsilon})$ï¼Œåˆ™$T(n)=\\Theta(n^{log_ba})$\n- è‹¥å¯¹äºæŸä¸ªå¸¸æ•°$k\\geq 0$æœ‰$f(n)=\\Theta(n^{log_ba}lg^kn)$ï¼Œåˆ™$T(n)=\\Theta(n^{log_ba}lg^{k+1}n)$\n- è‹¥å¯¹æŸä¸ªå¸¸æ•°$\\epsilon >0$æœ‰$f(n)=\\Omega(n^{log_ba+\\epsilon})$ï¼Œä¸”å¯¹æŸä¸ªå¸¸æ•°$c<1$å’Œæ‰€æœ‰è¶³å¤Ÿå¤§çš„$n$æœ‰$af(n/b) \\leq cf(n)$ï¼Œåˆ™$T(n)=\\Theta(f(n))$\n### éšæœºç®—æ³•\n#### é›‡ä½£é—®é¢˜\n```text\nHIRE-ASSISTANT(n)\nbest = 0\nfor i = 1 to n\n    interview candidate i\n    if candidate i is better than candidate best\n        best = i\n        hire candidate i\n```\n##### æœ€åæƒ…å†µåˆ†æ\nåœ¨æœ€åæƒ…å†µä¸‹ï¼Œå½“åº”è˜è€…è´¨é‡æŒ‰å‡ºç°çš„æ¬¡åºä¸¥æ ¼é€’å¢æ—¶ï¼Œæ€»è´¹ç”¨æ˜¯$O(c_hn)$\n##### éšæœºç®—æ³•\nå¦‚æœä¸€ä¸ªç®—æ³•çš„è¡Œä¸ºä¸ä»…ç”±è¾“å…¥å†³å®šï¼Œè€Œä¸”ä¹Ÿç”±**éšæœºæ•°ç”Ÿæˆå™¨**äº§ç”Ÿçš„æ•°å€¼å†³å®šï¼Œåˆ™ç§°è¿™ä¸ªç®—æ³•æ˜¯**éšæœºçš„**\n#### æŒ‡ç¤ºå™¨éšæœºå˜é‡\nç»™å®šä¸€ä¸ªæ ·æœ¬ç©ºé—´$S$å’Œä¸€ä¸ªäº‹ä»¶$A$ï¼Œé‚£ä¹ˆäº‹ä»¶$A$å¯¹åº”çš„**æŒ‡ç¤ºå™¨éšæœºå˜é‡**$I\\{A\\}$å®šä¹‰ä¸ºï¼š\n$$\nI\\{A\\} =\n\\begin{cases}\n1 \\qquad & if\\  A \\ occurs \\\\\n0 \\qquad &  if \\  A \\ does\\  not\\  occur\n\\end{cases}\n$$\n\nç»™å®šä¸€ä¸ªæ ·æœ¬ç©ºé—´$S$å’Œ$S$ä¸­çš„ä¸€ä¸ªäº‹ä»¶$A$ï¼Œè®¾$X_A=I\\{A\\}$ï¼Œé‚£ä¹ˆ$E[X_A]=Pr\\{A\\}$\n##### ç”¨æŒ‡ç¤ºå™¨éšæœºå˜é‡åˆ†æé›‡ä½£é—®é¢˜\nåº”è˜è€…$i$æ¯”åº”è˜è€…1åˆ°$i-1$æ›´æœ‰èµ„æ ¼çš„æ¦‚ç‡ä¸º$1/i$\n$E[X_i]=1/i$\næ‰€ä»¥æœ‰ï¼š\n$E[X]\\\\\n=E[\\sum_{i=i}^n X_i]\\\\\n= \\sum_{i=1}^nE[X_i]\\\\\n=\\sum_{i=1}^n1/i\\\\\n=lnn+O(1)\n$\nç®—æ³• `HIRE-ASSISTANT` æ€»çš„é›‡ä½£è´¹ç”¨å¹³å‡æƒ…å½¢ä¸‹ä¸º$O(c_hlnn)$\n#### éšæœºç®—æ³•\nè¿‡ç¨‹ `RANDOMIZED-HIRE-ASSISTANT` çš„é›‡ä½£è´¹ç”¨æœŸæœ›æ˜¯$O(c_hlnn)$ï¼š\n```text\nRANDOMIZED-HIRE-ASSISTANT(n)\nrandomly permute the list of candidates\nbest = 0\nfor i = 1 to n\n    interview candidate i\n    if candidate i is better than candidate best\n        best = i\n        hire candidate i\n```\n##### éšæœºæ’åˆ—æ•°ç»„\nå‡è®¾æ‰€æœ‰ä¼˜å…ˆçº§éƒ½ä¸åŒï¼Œåˆ™è¿‡ç¨‹ `PERMUTE-BY-SORTING` äº§ç”Ÿè¾“å…¥çš„å‡åŒ€éšæœºæ’åˆ—ï¼š\n```text\nPERMUTE-BY-SORTING(A)\nn = A.length\nlet P[1..n] be a new array\nfor i = 1 to n\n    P[i] = RANDOM(1, n^3)\nsort A, using P as sort keys\n```\nè¿‡ç¨‹ `RANDOMIZE-IN-PLACE` å¯è®¡ç®—å‡ºä¸€ä¸ªå‡åŒ€éšæœºæ’åˆ—ï¼š\n```text\nRANDOMIZE-IN-PLACE(A)\nn = A.length\nfor i = 1 to n\n    swap A[i] with A[RANDOM(i, n)]\n```\n## æ’åºå’Œé¡ºåºç»Ÿè®¡é‡\n### å †æ’åº\n#### å †\n**å †**æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå®ƒå¯ä»¥è¢«çœ‹æˆä¸€ä¸ªè¿‘ä¼¼çš„å®Œå…¨äºŒå‰æ ‘\n- æ ‘ä¸Šçš„æ¯ä¸€ä¸ªç»“ç‚¹å¯¹åº”æ•°ç»„ä¸­çš„ä¸€ä¸ªå…ƒç´ \n- é™¤äº†æœ€åº•å±‚å¤–ï¼Œè¯¥æ ‘æ˜¯å®Œå…¨å……æ»¡çš„\n- $A.length$è¡¨ç¤ºæ•°ç»„å…ƒç´ çš„ä¸ªæ•°\n- $A.heap-size$è¡¨ç¤ºæœ‰å¤šå°‘ä¸ªå †å…ƒç´ å­˜å‚¨åœ¨è¯¥æ•°ç»„ä¸­\n- $0 \\leq A.heap-size \\leq A.length$\n- ä¸€ä¸ªå †ä¸­çš„ç»“ç‚¹çš„**é«˜åº¦**å°±ä¸ºè¯¥ç»“ç‚¹åˆ°å¶ç»“ç‚¹æœ€é•¿ç®€å•è·¯å¾„ä¸Šè¾¹çš„æ•°ç›®\n\n![heap](https://d-sketon.top/img/clrs-book/4.png)\n\nè®¡ç®—çˆ¶ç»“ç‚¹ã€å·¦å­©å­å’Œå³å­©å­çš„ä¸‹æ ‡ï¼š\n```text\nPARENT(i)\n    return âŒŠi/2âŒ‹\n\nLEFT(i)\n    return 2i\n\nRIGHT(i)\n    return 2i + 1\n```\nåœ¨**æœ€å¤§å †**ä¸­ï¼Œ**æœ€å¤§å †æ€§è´¨**æŒ‡é™¤äº†æ ¹ä»¥å¤–çš„æ‰€æœ‰ç»“ç‚¹$i$éƒ½è¦æ»¡è¶³ï¼š\n$$A[PARENT(i)] \\geq A[i]$$\n\nåœ¨**æœ€å°å †**ä¸­ï¼Œ**æœ€å°å †æ€§è´¨**æŒ‡é™¤äº†æ ¹ä»¥å¤–çš„æ‰€æœ‰ç»“ç‚¹$i$éƒ½è¦æ»¡è¶³ï¼š\n$$A[PARENT(i)] \\leq A[i]$$\n\n#### ç»´æŠ¤å †çš„æ€§è´¨\nå‡å®šæ ¹ç»“ç‚¹ä¸º `LEFT(i)` å’Œ `RIGHT(i)` çš„äºŒå‰æ ‘éƒ½æ˜¯æœ€å¤§å †ï¼Œ`MAX-HEAPIFY` é€šè¿‡è®©$A[i]$çš„å€¼åœ¨æœ€å¤§å †ä¸­â€œé€çº§ä¸‹é™â€ï¼Œä»è€Œä½¿å¾—ä»¥ä¸‹æ ‡$i$ä¸ºæ ¹ç»“ç‚¹çš„å­æ ‘é‡æ–°éµå¾ªæœ€å¤§å †çš„æ€§è´¨ï¼š\n```text\nMAX-HEAPIFY(A, i)\nl = LEFT(i)\nr = RIGHT(i)\nif l <= A.heap-size and A[l] > A[i]\n    largest = l\nelse\n    largest = i\nif r <= A.heap-size and A[r] > A[largest]\n    largest = r\nif largest != i\n    exchange A[i] with A[largest]\n    MAX-HEAPIFY(A, largest)\n```\nå› ä¸ºæ¯ä¸ªå­©å­çš„å­æ ‘çš„å¤§å°è‡³å¤šä¸º$2n/3$ï¼ˆæœ€åæƒ…å†µå‘ç”Ÿåœ¨æ ‘çš„æœ€åº•å±‚æ°å¥½åŠæ»¡çš„æ—¶å€™ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢é€’å½’å¼åˆ»ç”» `MAX-HEAPIFY` çš„è¿è¡Œæ—¶é—´ï¼š\n$$T(n) \\leq T(2n/3)+\\Theta(1) = O(lgn) = O(h)$$\n#### å»ºå †\nå¯ä»¥ç”¨è‡ªåº•å‘ä¸Šçš„æ–¹æ³•åˆ©ç”¨è¿‡ç¨‹ `MAX-HEAPIFY` æŠŠä¸€ä¸ªå¤§å°ä¸º$n=A.length$çš„æ•°ç»„$A[1..n]$è½¬æ¢ä¸ºæœ€å¤§å †ï¼š\n```text\nBUILD-MAX-HEAP(A)\nA.heap-size = A.length\nfor i = âŒŠA.length/2âŒ‹ downto  1\n    MAX-HEAPIFY(A, i)\n```\nåœ¨ä¸€ä¸ªé«˜åº¦ä¸º$h$çš„ç»“ç‚¹ä¸Šè¿è¡Œ `MAX-HEAPIFY` çš„ä»£ä»·æ˜¯$O(h)$ï¼Œæˆ‘ä»¬å¯ä»¥å°† `BUILD-MAX-HEAP` çš„æ€»ä»£ä»·è¡¨ç¤ºä¸ºï¼š\n$$\\sum^{\\lfloor lgn \\rfloor}_{h=0} \\lceil \\frac{n}{2^{h+1}} \\rceil O(h) = O(n \\sum^{\\lfloor lgn \\rfloor}_{h=0} \\frac{h}{2^h}) =  O(n \\sum^{\\infty}_{h=0} \\frac{h}{2^h}) =O(n)$$\n\nå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨**çº¿æ€§æ—¶é—´**å†…ï¼ŒæŠŠä¸€ä¸ªæ— åºæ•°ç»„æ„é€ æˆä¸€ä¸ªæœ€å¤§å †\n#### å †æ’åºç®—æ³•\n`HEAPSORT` è¿‡ç¨‹çš„æ—¶é—´å¤æ‚åº¦æ˜¯$O(nlgn)$ï¼š\n```text\nHEAPSORT(A)\nBUILD-MAX-HEAP(A)\nfor i = A.length downto 2\n    exchange A[1] with A[i]\n    A.heap-size = A.heap-size - 1\n    MAX-HEAPIFY(A, 1)\n```\n#### ä¼˜å…ˆé˜Ÿåˆ—\nä¼˜å…ˆé˜Ÿåˆ—æ˜¯ä¸€ç§ç”¨æ¥ç»´æŠ¤ç”±ä¸€ç»„å…ƒç´ æ„æˆçš„é›†åˆ$S$çš„æ•°æ®ç»“æ„ï¼Œå…¶ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½æœ‰ä¸€ä¸ªç›¸å…³çš„å€¼ï¼Œç§°ä¸ºå…³é”®å­—ã€‚ä¸€ä¸ªæœ€å¤§ä¼˜å…ˆé˜Ÿåˆ—æ”¯æŒä»¥ä¸‹æ“ä½œï¼š\n- `INSERT(S, x)`ï¼šæŠŠå…ƒç´ $x$æ’å…¥é›†åˆ$S$ä¸­\n- `MAXIMUM(S)`ï¼šè¿”å›$S$ä¸­å…·æœ‰æœ€å¤§é”®å­—çš„å…ƒç´ \n- `EXTRACT-MAX(S)`ï¼šå»æ‰å¹¶è¿”å›$S$ä¸­çš„å…·æœ‰æœ€å¤§é”®å­—çš„å…ƒç´ \n- `INCREASE-KEY(S, x, k)`ï¼šå°†å…ƒç´ $x$çš„å…³é”®å­—å¢åŠ åˆ°$k$ï¼Œè¿™é‡Œå‡è®¾$k$çš„å€¼ä¸å°äº$x$çš„åŸå…³é”®å­—å€¼\n\nä¼˜å…ˆé˜Ÿåˆ—å¯ä»¥ç”¨å †æ¥å®ç°ï¼š\n`HEAP-MAXMIUM` æ—¶é—´å¤æ‚åº¦$\\Theta(1)$ï¼š\n```text\nHEAP-MAXMIUM(A)\n    return A[1]\n```\n`HEAP-EXTRACT-MAX` æ—¶é—´å¤æ‚åº¦$O(lgn)$ï¼š\n```text\nHEAP-EXTRACT-MAX(A)\nif A.heap-size <  1 \n    error \"heap underflow\"\nmax = A[1]\nA[1] = A[A.heap-size]\nA.heap-size = A.heap-size - 1\nMAX-HEAPIFY(A, 1)\nreturn max\n```\n`HEAP-INCREASE-KEY` æ—¶é—´å¤æ‚åº¦$O(lgn)$ï¼š\n```text\nHEAP-INCREASE-KEY(A, i, key)\nif key < A[i]\n    error \"new key is smaller than current key\"\nA[i] = key\nwhile i > 1 and A[PARENT(i)] < A[i]\n    exchange A[i] with A[PARENT(i)]\n    i = PARENT(i)\n```\n`MAX-HEAP-INSERT` æ—¶é—´å¤æ‚åº¦$O(lgn)$ï¼š\n```text\nMAX-HEAP-INSERT(A, key)\nA.heap-size = A.heap-size + 1\nA[A.heap-size] = -âˆ\nHEAP-INCRERASE-KEY(A, A.heap-size, key)\n```\n### å¿«é€Ÿæ’åº\n#### å¿«é€Ÿæ’åºæè¿°\nå¯¹ä¸€ä¸ªå­æ•°ç»„$A[p..r]$è¿›è¡Œå¿«é€Ÿæ’åºçš„ä¸‰æ­¥åˆ†æ²»è¿‡ç¨‹ï¼š\n- **åˆ†è§£**ï¼šæ•°ç»„$A[p..r]$è¢«åˆ’åˆ†ä¸ºä¸¤ä¸ªï¼ˆå¯èƒ½ä¸ºç©ºï¼‰å­æ•°ç»„$A[p..q-1]$å’Œ$A[q+1..r]$ï¼Œä½¿å¾—$A[p..q-1]$ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½å°äºç­‰äº$A[q]$ï¼Œè€Œ$A[q]$ä¹Ÿå°äºç­‰äº$A[q+1..r]$ä¸­çš„æ¯ä¸ªå…ƒç´ ã€‚å…¶ä¸­ï¼Œè®¡ç®—ä¸‹æ ‡$q$ä¹Ÿæ˜¯åˆ’åˆ†è¿‡ç¨‹çš„ä¸€éƒ¨åˆ†\n- **è§£å†³**ï¼šé€šè¿‡é€’å½’è°ƒç”¨å¿«é€Ÿæ’åºï¼Œå¯¹å­æ•°ç»„$A[p..q-1]$å’Œ$A[q+1..r]$è¿›è¡Œæ’åº\n- **åˆå¹¶**ï¼šå› ä¸ºå­æ•°ç»„éƒ½æ˜¯åŸå€æ’åºçš„ï¼Œæ‰€ä»¥ä¸éœ€è¦åˆå¹¶æ“ä½œï¼šæ•°ç»„$A[p..r]$å·²ç»æœ‰åº\n```text\nQUICKSORT(A, p, r)\nif p < r\n    q = PARTITION(A, p, r)\n    QUICKSORT(A, p, q-1)\n    QUICKSORT(A, q+1, r)\n```\n`PARTITION` è¿‡ç¨‹å®ç°äº†å¯¹å­æ•°ç»„$A[p..r]$çš„åŸå€é‡æ’ï¼š\n```text\nPARTITION(A, p, r)\nx = A[r]\ni = p - 1\nfor j = p to r-1\n    if A[j] <= x\n        i = i + 1\n        exchange A[i] with A[j]\nexchange A[i+1] with A[r]\nreturn i+1\n```\n\n![partition](https://d-sketon.top/img/clrs-book/5.png)\n\n#### å¿«é€Ÿæ’åºæ€§èƒ½\n##### æœ€åæƒ…å†µåˆ’åˆ†\nå½“åˆ’åˆ†äº§ç”Ÿçš„ä¸¤ä¸ªå­é—®é¢˜åˆ†åˆ«åŒ…å«äº†$n-1$ä¸ªå…ƒç´ å’Œ0ä¸ªå…ƒç´ æ—¶ï¼Œä¸ºæœ€åæƒ…å†µ\næ­¤æ—¶ç®—æ³•é€’å½’å¼å¯ä»¥è¡¨ç¤ºä¸ºï¼š\n$$T(n)=T(n-1)+T(0)+\\Theta(n) =T(n-1) + \\Theta(n) = \\Theta(n^2)$$\n##### æœ€å¥½æƒ…å†µåˆ’åˆ†\nåœ¨å¯èƒ½çš„æœ€å¹³è¡¡çš„åˆ’åˆ†ä¸­ï¼Œ`PARTITION` å¾—åˆ°çš„ä¸¤ä¸ªå­é—®é¢˜çš„è§„æ¨¡éƒ½ä¸å¤§äº$n/2$\næ­¤æ—¶ç®—æ³•é€’å½’å¼å¯ä»¥è¡¨ç¤ºä¸ºï¼š\n$$T(n)=2T(n/2)+\\Theta(n)=\\Theta(nlgn)$$\n##### å¹³è¡¡çš„åˆ’åˆ†\nä»»ä½•ä¸€ç§**å¸¸æ•°æ¯”ä¾‹**çš„åˆ’åˆ†éƒ½ä¼šäº§ç”Ÿæ·±åº¦ä¸º$\\Theta(lgn)$çš„é€’å½’æ ‘ï¼Œå…¶ä¸­æ¯ä¸€å±‚çš„æ—¶é—´ä»£ä»·éƒ½æ˜¯$O(n)$\nå› æ­¤ï¼Œåªè¦åˆ’åˆ†æ˜¯**å¸¸æ•°æ¯”ä¾‹**çš„ï¼Œç®—æ³•çš„è¿è¡Œæ—¶é—´æ€»æ˜¯$O(nlgn)$\n##### å¯¹äºå¹³å‡æƒ…å†µçš„ç›´è§‚è§‚å¯Ÿ\nå½“å¥½å’Œå·®çš„åˆ’åˆ†äº¤æ›¿å‡ºç°æ—¶ï¼Œå¿«é€Ÿæ’åºçš„æ—¶é—´å¤æ‚åº¦ä¸å…¨æ˜¯å¥½çš„åˆ’åˆ†æ—¶ä¸€æ ·ï¼Œä»ç„¶æ˜¯$O(nlgn)$ã€‚åŒºåˆ«åªæ˜¯$O$ç¬¦å·ä¸­éšå«çš„å¸¸æ•°å› å­è¦ç•¥å¤§ä¸€äº›\n#### å¿«é€Ÿæ’åºéšæœºåŒ–ç‰ˆæœ¬\né€šè¿‡å¯¹åºåˆ—$p,..,r$çš„éšæœºæŠ½æ ·ï¼Œæˆ‘ä»¬æœŸæœ›åœ¨å¹³å‡æƒ…å†µä¸‹ï¼Œå¯¹è¾“å…¥æ•°ç»„çš„åˆ’åˆ†æ˜¯æ¯”è¾ƒå‡è¡¡çš„ï¼š\n```text\nRANDOMIZED-PARTITION(A, p, r)\ni = RANDOM(p, r)\nexchange A[r] with A[i]\nreturn PARTITION(A, p, r)\n```\n```text\nRANDOMIZED-QUICKSORT(A, p, r)\nif p < r\n    q = RANDOMIZED-PARTITION(A, p, r)\n    RANDOMIZED-QUICKSORT(A, p, q-1)\n    RANDOMIZED-QUICKSORT(A, q+1, r)\n```\n#### å¿«é€Ÿæ’åºåˆ†æ\n##### æœ€åæƒ…å†µåˆ†æ\nå¿«é€Ÿæ’åºçš„æœ€åæƒ…å†µè¿è¡Œæ—¶é—´æ˜¯$\\Theta(n^2)$\n##### æœŸæœ›è¿è¡Œæ—¶é—´\nå¿«é€Ÿæ’åºçš„æœŸæœ›è¿è¡Œæ—¶é—´æ˜¯$O(nlgn)$\n### çº¿æ€§æ—¶é—´æ’åº\n#### æ’åºç®—æ³•çš„ä¸‹ç•Œ\n##### å†³ç­–æ ‘æ¨¡å‹\næ¯”è¾ƒæ’åºå¯ä»¥è¢«æŠ½è±¡ä¸ºä¸€æ£µ**å†³ç­–æ ‘**\n**å†³ç­–æ ‘**æ˜¯ä¸€æ£µå®Œå…¨äºŒå‰æ ‘ï¼Œå®ƒå¯ä»¥è¡¨ç¤ºåœ¨ç»™å®šè¾“å…¥è§„æ¨¡æƒ…å†µä¸‹ï¼ŒæŸä¸€ç»™å®šæ’åºç®—æ³•å¯¹æ‰€æœ‰å…ƒç´ çš„æ¯”è¾ƒæ“ä½œ\nåœ¨å†³ç­–æ ‘ä¸­ï¼Œæ¯ä¸ªå†…éƒ¨ç»“ç‚¹éƒ½ä»¥$i:j$æ ‡è®°ï¼Œå…¶ä¸­$i$å’Œ$j$æ»¡è¶³$1 \\leq i,j \\leq n$ï¼Œ$n$æ˜¯è¾“å…¥åºåˆ—ä¸­çš„å…ƒç´ ä¸ªæ•°\næ¯ä¸€ä¸ªå†…éƒ¨ç»“ç‚¹è¡¨ç¤ºä¸€æ¬¡æ¯”è¾ƒ$a_i \\leq a_j$\n- å·¦å­æ ‘è¡¨ç¤ºä¸€æ—¦æˆ‘ä»¬ç¡®å®š$a_i \\leq a_j$ä¹‹åçš„åç»­æ¯”è¾ƒ\n- å³å­æ ‘è¡¨ç¤ºä¸€æ—¦æˆ‘ä»¬ç¡®å®š$a_i > a_j$ä¹‹åçš„åç»­æ¯”è¾ƒ\n\nå¯¹äºä¸€ä¸ªæ­£ç¡®çš„æ¯”è¾ƒæ’åºç®—æ³•æ¥è¯´ï¼Œ$n$ä¸ªå…ƒç´ çš„$n!$ç§å¯èƒ½çš„æ’åˆ—éƒ½åº”è¯¥å‡ºç°åœ¨å†³ç­–æ ‘çš„å¶ç»“ç‚¹ä¸Šã€‚è€Œä¸”ï¼Œæ¯ä¸€ä¸ªå¶ç»“ç‚¹éƒ½å¿…é¡»æ˜¯å¯ä»¥ä»æ ¹ç»“ç‚¹ç»ç”±æŸæ¡è·¯å¾„åˆ°è¾¾çš„\n\n![decisionTree](https://d-sketon.top/img/clrs-book/6.png)\n\n##### æœ€åæƒ…å†µçš„ä¸‹ç•Œ\nåœ¨æœ€åæƒ…å†µä¸‹ï¼Œä»»ä½•æ¯”è¾ƒæ’åºç®—æ³•éƒ½éœ€è¦åš$\\Omega(nlgn)$æ¬¡æ¯”è¾ƒï¼š\nè€ƒè™‘ä¸€æ£µé«˜åº¦ä¸º$h$ï¼Œå…·æœ‰$l$ä¸ªå¯è¾¾å¶ç»“ç‚¹çš„å†³ç­–æ ‘ï¼Œå®ƒå¯¹åº”ä¸€ä¸ªå¯¹$n$ä¸ªå…ƒç´ æ‰€åšçš„æ¯”è¾ƒæ’åºã€‚å› ä¸ºè¾“å…¥æ•°æ®çš„$n!$ç§å¯èƒ½çš„æ’åˆ—éƒ½æ˜¯å¶ç»“ç‚¹ï¼Œæ‰€ä»¥æœ‰$n! \\leq l$ã€‚ç”±äºåœ¨ä¸€ä¸ªé«˜åº¦ä¸º$h$çš„äºŒå‰æ ‘ä¸­ï¼Œå¶ç»“ç‚¹çš„æ•°ç›® ä¸å¤šäº$2^h$ï¼Œæ‰€ä»¥æœ‰ï¼š\n$$n! \\leq l \\leq 2^h$$\n\nå¯¹è¯¥å¼ä¸¤è¾¹å–å¯¹æ•°ï¼Œæœ‰$h \\geq lg(n!) = \\Omega(nlgn)$\n#### è®¡æ•°æ’åº\nè®¡æ•°æ’åºå‡è®¾$n$ä¸ªè¾“å…¥å…ƒç´ ä¸­çš„æ¯ä¸€ä¸ªéƒ½æ˜¯åœ¨0åˆ°$k$åŒºé—´å†…çš„ä¸€ä¸ª**æ•´æ•°**ï¼Œå…¶ä¸­$k$ä¸ºæŸä¸ªæ•´æ•°ã€‚å½“$k=O(n)$æ—¶ï¼Œæ’åºçš„è¿è¡Œæ—¶é—´ä¸º$\\Theta(n)$\n\nåœ¨è®¡æ•°æ’åºçš„ä»£ç ä¸­ï¼Œå‡è®¾è¾“å…¥æ˜¯ä¸€ä¸ªæ•°ç»„$A[1..n]$ï¼Œ$A.length = n$ï¼Œ$B[1..n]$å­˜æ”¾æ’åºçš„è¾“å‡ºï¼Œ$C[0..k]$æä¾›ä¸´æ—¶å­˜å‚¨ç©ºé—´ï¼š\n```text\nCOUNTING-SORT(A, B, k)\nlet C[0..k] be a new array\nfor i = 0 to k\n    C[i] = 0\nfor j = 1 to A.length\n    C[A[j]] = C[A[j]] + 1\nfor i = 1 to k\n    C[i] = C[i-1] + C[i]\nfor j = A.length downto 1\n    B[C[A[j]]] = A[j]\n    C[A[j]] = C[A[j]] - 1\n```\nè®¡æ•°æ’åºæ—¶é—´å¤æ‚åº¦$\\Theta(k+n)$ï¼Œå½“$k=O(n)$æ—¶ï¼Œæ—¶é—´å¤æ‚åº¦$\\Theta(n)$\n#### åŸºæ•°æ’åº\nå‡è®¾$n$ä¸ª$d$ä½çš„å…ƒç´ å­˜æ”¾åœ¨æ•°ç»„$A$ä¸­ï¼Œå…¶ä¸­ç¬¬1ä½æ˜¯æœ€ä½ä½ï¼Œç¬¬$d$ä½æ˜¯æœ€é«˜ä½ï¼š\n```text\nRADIX-SORT(A, d)\nfor i = 1 to d\n    use a stable sort to sort array A on digit i\n```\nç»™å®šä¸€ä¸ª$b$ä½æ•°å’Œä»»ä½•æ­£æ•´æ•°$r\\leq b$ï¼Œå¦‚æœ `RADIX-SORT` ä½¿ç”¨çš„ç¨³å®šæ’åºç®—æ³•å¯¹æ•°æ®å–å€¼åŒºé—´æ˜¯0åˆ°$k$çš„è¾“å…¥è¿›è¡Œæ’åºè€—æ—¶$\\Theta(n+k)$ï¼Œé‚£ä¹ˆå®ƒå°±å¯ä»¥åœ¨$\\Theta((b/r)(n+2^r))$æ—¶é—´å†…å°†è¿™äº›æ•°æ®æ’å¥½åº\n#### æ¡¶æ’åº\næ¡¶æ’åºå‡è®¾è¾“å…¥æ•°æ®æœä»å‡åŒ€åˆ†å¸ƒï¼Œå¹³å‡æƒ…å†µä¸‹å®ƒçš„æ—¶é—´ä»£ä»·ä¸º$O(n)$\n\nå‡è®¾è¾“å…¥æ˜¯ä¸€ä¸ªåŒ…å«$n$ä¸ªå…ƒç´ çš„æ•°ç»„$A$ï¼Œä¸”æ¯ä¸ªå…ƒç´ $A[i]$æ»¡è¶³$0 \\leq A[i] < 1$ã€‚ç®—æ³•è¿˜éœ€è¦ä¸€ä¸ªä¸´æ—¶æ•°ç»„$B[0..n-1]$æ¥å­˜æ”¾é“¾è¡¨ï¼ˆå³æ¡¶ï¼‰ï¼Œå¹¶å‡è®¾å­˜åœ¨ä¸€ç§ç”¨äºç»´æŠ¤è¿™äº›é“¾è¡¨çš„æœºåˆ¶ï¼š\n```text\nBUCKET-SORT(A)\nn = A.length\nlet B[0..n-1] be a new array\nfor i = 0 to n-1\n    make B[i] an empty list\nfor i = 1 to n\n    insert A[i] into list B[âŒŠnA[i]âŒ‹]\nfor i = 0 to n-1\n    sort list B[i] with insertion sort\nconcatenate the lists B[0]..B[n-1] together in order\n```\næ¡¶æ’åºçš„æœŸæœ›è¿è¡Œæ—¶é—´ä¸ºï¼š\n$$\\Theta(n)+n \\cdot O(2-1/n) = \\Theta(n)$$\n\n### ä¸­ä½æ•°å’Œé¡ºåºç»Ÿè®¡é‡\n#### æœ€å°å€¼å’Œæœ€å¤§å€¼\nå‡è®¾è¯¥é›†åˆå…ƒç´ å­˜æ”¾åœ¨æ•°ç»„$A$ä¸­ï¼Œä¸”$A.length = n$ï¼š\n```text\nMINIMUM(A)\nmin = A[1]\nfor i = 2 to A.length\n    if min > A[i]\n        min = A[i]\nreturn min\n```\nä¸ºäº†ç¡®å®šæœ€å°å€¼ï¼Œå¿…é¡»è¦åš$n-1$æ¬¡æ¯”è¾ƒ\n##### åŒæ—¶æ‰¾åˆ°æœ€å°å€¼å’Œæœ€å¤§å€¼\næœ€å¤š$3\\lfloor n/2 \\rfloor$æ¬¡æ¯”è¾ƒå°±å¯ä»¥åŒæ—¶æ‰¾åˆ°æœ€å°å€¼å’Œæœ€å¤§å€¼ï¼š\né¦–å…ˆï¼Œæˆ‘ä»¬å°†ä¸€å¯¹è¾“å…¥å…ƒç´ ç›¸äº’è¿›è¡Œæ¯”è¾ƒï¼Œç„¶åæŠŠè¾ƒå°çš„ä¸å½“å‰æœ€å°å€¼æ¯”è¾ƒï¼ŒæŠŠè¾ƒå¤§çš„ä¸å½“å‰æœ€å¤§å€¼è¿›è¡Œæ¯”è¾ƒã€‚è¿™æ ·ï¼Œå¯¹æ¯ä¸¤ä¸ªå…ƒç´ å…±éœ€3æ¬¡æ¯”è¾ƒï¼š\n- å¦‚æœ$n$æ˜¯**å¥‡æ•°**ï¼Œæˆ‘ä»¬å°±å°†æœ€å°å€¼å’Œæœ€å¤§å€¼çš„åˆå€¼è®¾ä¸ºç¬¬ä¸€ä¸ªå…ƒç´ çš„å€¼ï¼Œç„¶åæˆå¯¹åœ°å¤„ç†ä½™ä¸‹çš„å…ƒç´ \n- å¦‚æœ$n$æ˜¯**å¶æ•°**ï¼Œå°±å¯¹å‰ä¸¤ä¸ªå…ƒç´ åšä¸€æ¬¡æ¯”è¾ƒï¼Œä»¥å†³å®šæœ€å°å€¼å’Œæœ€å¤§å€¼çš„åˆå€¼ï¼Œç„¶åæˆå¯¹å¤„ç†ä½™ä¸‹çš„å…ƒç´ \n#### æœŸæœ›ä¸ºçº¿æ€§æ—¶é—´çš„é€‰æ‹©ç®—æ³•\n`RANDOMIZED-SELECT` è¿”å›æ•°ç»„$A[p..r]$ä¸­ç¬¬$i$å°çš„å…ƒç´ ï¼š\n```text\nRANDOMIZED-SELECT(A, p, r, i)\nif p == r\n    return A[p]\nq = RANDOMIZE-PARTITOOPN(A, p, r)\nk = q - p + 1\nif i == k\n    return A[q]\nelse if i < k\n    return RANDOMIZED-SELECT(A, p, q-1, r)\nelse \n    return RANDOMIZED-SELECT(A, q+1, r, i-k)\n```\n`RANDOMIZED-SELECT` çš„æœ€åæƒ…å†µè¿è¡Œæ—¶é—´ä¸º$\\Theta(n^2)$ï¼ŒæœŸæœ›è¿è¡Œæ—¶é—´ä¸º$\\Theta(n)$\n#### æœ€åæƒ…å†µä¸ºçº¿æ€§æ—¶é—´çš„é€‰æ‹©ç®—æ³•\né€šè¿‡æ‰§è¡Œä¸‹åˆ—æ­¥éª¤ï¼Œç®—æ³• `SELECT` å¯ä»¥ç¡®å®šä¸€ä¸ªæœ‰$n>1$ä¸ªä¸åŒå…ƒç´ çš„è¾“å…¥æ•°ç»„ä¸­çš„ç¬¬$i$å°çš„å…ƒç´ \n- å°†è¾“å…¥æ•°ç»„çš„$n$ä¸ªå…ƒç´ åˆ’åˆ†ä¸º$\\lfloor n/5 \\rfloor$ç»„ï¼Œæ¯ç»„5ä¸ªå…ƒç´ ï¼Œä¸”è‡³å¤šåªæœ‰ä¸€ç»„ç”±å‰©ä¸‹çš„$n \\ mod \\ 5$ä¸ªå…ƒç´ ç»„æˆ\n- å¯»æ‰¾è¿™$\\lceil n/5 \\rceil$ç»„ä¸­æ¯ä¸€ç»„çš„ä¸­ä½æ•°ï¼šé¦–å…ˆå¯¹æ¯ç»„å…ƒç´ è¿›è¡Œæ’å…¥æ’åºï¼Œç„¶åç¡®å®šæ¯ç»„æœ‰åºå…ƒç´ çš„ä¸­ä½æ•°\n- å¯¹ç¬¬2æ­¥ä¸­æ‰¾å‡ºçš„$\\lceil n/5 \\rceil$ä¸ªä¸­ä½æ•°ï¼Œé€’å½’è°ƒç”¨ `SELECT` ä»¥æ‰¾å‡ºå…¶ä¸­ä½æ•°$x$ï¼ˆå¦‚æœæœ‰å¶æ•°ä¸ªä¸­ä½æ•°ï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œçº¦å®š$x$æ˜¯è¾ƒå°çš„ä¸­ä½æ•°ï¼‰\n- åˆ©ç”¨ä¿®æ”¹è¿‡çš„ `PARTITION` ç‰ˆæœ¬ï¼ŒæŒ‰ä¸­ä½æ•°çš„ä¸­ä½æ•°$x$å¯¹è¾“å…¥æ•°ç»„è¿›è¡Œåˆ’åˆ†ã€‚è®©$k$æ¯”åˆ’åˆ†çš„ä½åŒºä¸­çš„å…ƒç´ æ•°ç›®å¤š1ï¼Œå› æ­¤$x$æ˜¯ç¬¬$k$å°çš„å…ƒç´ ï¼Œå¹¶ä¸”æœ‰$n-k$ä¸ªå…ƒç´ åœ¨åˆ’åˆ†çš„é«˜åŒº\n- å¦‚æœ$i=k$ï¼Œåˆ™è¿”å›$x$ã€‚å¦‚æœ$i<k$ï¼Œåˆ™åœ¨ä½åŒºé€’å½’è°ƒç”¨ `SELECT` æ¥æ‰¾å‡ºç¬¬$i$å°çš„å…ƒç´ ã€‚å¦‚æœ$i>k$ï¼Œåˆ™åœ¨é«˜åŒºé€’å½’æŸ¥æ‰¾ç¬¬$i-k$å°çš„å…ƒç´ \n\n![select](https://d-sketon.top/img/clrs-book/7.png)\n\nåœ¨ç¬¬2æ­¥æ‰¾å‡ºçš„ä¸­ä½æ•°ä¸­ï¼Œè‡³å°‘æœ‰ä¸€åŠå¤§äºæˆ–ç­‰äºä¸­ä½æ•°çš„ä¸­ä½æ•°$x$ã€‚å› æ­¤ï¼Œåœ¨è¿™$\\lceil n/5 \\rceil$ä¸ªç»„ä¸­ï¼Œé™¤äº†å½“$n$ä¸èƒ½è¢«5æ•´é™¤æ—¶äº§ç”Ÿçš„æ‰€å«å…ƒç´ å°‘äº5çš„é‚£ä¸ªç»„å’ŒåŒ…å«$x$çš„é‚£ä¸ªç»„ä¹‹å¤–ï¼Œè‡³å°‘æœ‰ä¸€åŠçš„ç»„ä¸­æœ‰3ä¸ªå…ƒç´ å¤§äº$x$ã€‚ä¸ç®—è¿™ä¸¤ä¸ªç»„ï¼Œå¤§äº$x$çš„å…ƒç´ ä¸ªæ•°è‡³å°‘ä¸ºï¼š\n$$3(\\lceil \\frac{1}{2} \\lceil \\frac{n}{5} \\rceil\\rceil - 2) \\geq \\frac{3n}{10}-6$$\n\nç±»ä¼¼åœ°ï¼Œè‡³å°‘æœ‰$3n/10-6$ä¸ªå…ƒç´ å°äº$x$ã€‚å› æ­¤ï¼Œåœ¨æœ€åæƒ…å†µä¸‹ï¼Œåœ¨ç¬¬5æ­¥ä¸­ï¼Œ`SELECT` çš„é€’å½’è°ƒç”¨æœ€å¤šä½œç”¨äº$7n/10+6$ä¸ªå…ƒç´ ã€‚\nç”±æ­¤å¯ä»¥å¾—åˆ°å¦‚ä¸‹é€’å½’å¼ï¼š\n$$\nT(n) \\leq\n\\begin{cases}\n\\Theta(1) \\qquad & n < 140 \\\\\nT(\\lceil n/5 \\rceil) + T(7n/10+6) + O(n) \\qquad &  n\\geq 140\n\\end{cases} = O(n)\n$$\n\n## é«˜çº§è®¾è®¡å’Œåˆ†ææŠ€æœ¯\n### åŠ¨æ€è§„åˆ’\næˆ‘ä»¬é€šå¸¸æŒ‰å¦‚ä¸‹4ä¸ªæ­¥éª¤æ¥è®¾è®¡ä¸€ä¸ªåŠ¨æ€è§„åˆ’ç®—æ³•ï¼š\n- åˆ»ç”»ä¸€ä¸ªæœ€ä¼˜è§£çš„ç»“æ„ç‰¹å¾\n- é€’å½’åœ°å®šä¹‰æœ€ä¼˜è§£çš„å€¼\n- è®¡ç®—æœ€ä¼˜è§£çš„å€¼ï¼Œé€šå¸¸é‡‡ç”¨è‡ªåº•å‘ä¸Šçš„æ–¹æ³•\n- åˆ©ç”¨è®¡ç®—å‡ºçš„ä¿¡æ¯æ„é€ ä¸€ä¸ªæœ€ä¼˜è§£\n#### é’¢æ¡åˆ‡å‰²\nç»™å®šä¸€æ®µé•¿åº¦ä¸º$n$è‹±å¯¸çš„é’¢æ¡å’Œä¸€ä¸ªä»·æ ¼è¡¨$p_i(i=1,2,...,n)$ï¼Œæ±‚åˆ‡å‰²é’¢æ¡æ–¹æ¡ˆï¼Œä½¿å¾—é”€å”®æ”¶ç›Š$r_n$æœ€å¤§\n\nè‡ªé¡¶å‘ä¸‹ `CUT-ROD`è¿‡ç¨‹ï¼ŒåŠ å…¥äº†å¤‡å¿˜æœºåˆ¶ï¼Œæ—¶é—´å¤æ‚åº¦$\\Theta(n^2)$ï¼š\n```text\nMEMORIZED-CUT-ROD(p, n)\nlet r[0..n] be a new array\nfor i = 0 to n\n    r[i] = -âˆ\nreturn MEMORIZED-CUT-ROD-AUX(p, n, r)\n\nMEMORIZED-CUT-ROD-AUX(p, n, r)\nif r[n] >=0\n    return r[n]\nif n == 0\n    q = 0\nelse \n    q = -âˆ\n    for i = 1 to n\n    q = max(q, p[i] + MEMORIZED-CUT-ROD-AUX(p, n-i, r))\nr[n] = q\nreturn q\n```\nè‡ªåº•å‘ä¸Šç‰ˆæœ¬ï¼Œæ—¶é—´å¤æ‚åº¦$\\Theta(n^2)$ï¼š\n```text\nBOTTOM-UP-CUT-ROD(p, n)\nlet r[0..n] be a new array\nr[0] = 0\nfor j = 1 to n\n    q = -âˆ\n    for i = 1 to j\n        q = max(q, p[i] + r[j-i])\n    r[j] = q\nreturn r[n]\n```\n##### é‡æ„è§£\n`BOTTOM-UP-CUT-ROD` çš„æ‰©å±•ç‰ˆæœ¬ï¼Œå®ƒå¯¹é•¿åº¦ä¸º$j$çš„é’¢æ¡ä¸ä»…è®¡ç®—æœ€å¤§æ”¶ç›Šå€¼$r_j$ï¼Œè¿˜ä¿å­˜æœ€ä¼˜è§£å¯¹åº”çš„ç¬¬ä¸€æ®µé’¢æ¡çš„åˆ‡å‰²é•¿åº¦$s_j$ï¼š\n```text\nEXTENDED-BOTTOM-UP-CUT-ROD(p, n)\nlet r[0..n] and s[0..n] be new arrays\nr[0] = 0\nfor j = 1 to n\n    q = -âˆ\n    for i = 1 to j\n        if q < p[i] + r[j-i]\n            q = p[i] + r[j-i]\n            s[j] = i\n    r[j] = q\nreturn r and s\n```\næœ€åè¾“å‡ºé•¿åº¦ä¸º$n$çš„é’¢æ¡çš„å®Œæ•´çš„æœ€ä¼˜åˆ‡å‰²æ–¹æ¡ˆï¼š\n```text\nPRINT-CUT-ROD-SOLUTION(p, n)\n(r, s) = EXTENDED-BOTTOM-UP-CUT-ROD(p, n)\nwhile n > 0\n    print s[n]\n    n = n - s[n]\n```\n#### çŸ©é˜µé“¾ä¹˜æ³•\nç»™å®šä¸€ä¸ª$n$ä¸ªçŸ©é˜µçš„åºåˆ—ï¼ˆçŸ©é˜µé“¾ï¼‰$\\langle A_1,A_2,...,A_n\\rangle$ï¼Œæˆ‘ä»¬å¸Œæœ›è®¡ç®—å®ƒä»¬çš„ä¹˜ç§¯ï¼š\n$$A_1A_2...A_n$$\n\nç”±äºçŸ©é˜µä¹˜æ³•æ»¡è¶³ç»“åˆå¾‹ï¼Œå› æ­¤ä»»ä½•åŠ æ‹¬å·çš„æ–¹æ³•éƒ½ä¼šå¾—åˆ°ç›¸åŒçš„è®¡ç®—ç»“æœ\n\næˆ‘ä»¬ç§°æœ‰å¦‚ä¸‹æ€§è´¨çš„çŸ©é˜µä¹˜ç§¯é“¾ä¸º**å®Œå…¨æ‹¬å·åŒ–çš„**ï¼šå®ƒæ˜¯å•ä¸€çŸ©é˜µï¼Œæˆ–è€…æ˜¯ä¸¤ä¸ªå®Œå…¨æ‹¬å·åŒ–çš„çŸ©é˜µä¹˜ç§¯é“¾çš„ç§¯\nç»™å®š$n$ä¸ªçŸ©é˜µçš„é“¾$\\langle A_1,A_2,...,A_n\\rangle$ï¼ŒçŸ©é˜µ$A_i$çš„è§„æ¨¡ä¸º$p_{i-1} * p_i(1 \\leq i \\leq n)$ï¼Œæ±‚å®Œå…¨æ‹¬å·åŒ–æ–¹æ¡ˆï¼Œä½¿å¾—è®¡ç®—ä¹˜ç§¯$A_1A_2...A_n$æ‰€éœ€æ ‡é‡ä¹˜æ³•æ¬¡æ•°æœ€å°‘\n\nä»¤$m[i,j]$è¡¨ç¤ºè®¡ç®—çŸ©é˜µ$A_{i..j}$æ‰€éœ€æ ‡é‡ä¹˜æ³•æ¬¡æ•°çš„æœ€å°å€¼ï¼Œåˆ™$A_iA_{i+1}...A_j$æœ€å°ä»£ä»·æ‹¬å·åŒ–æ–¹æ¡ˆçš„é€’å½’æ±‚è§£å…¬å¼ä¸ºï¼š\n$$\nm[i,j] \\leq\n\\begin{cases}\n0 \\qquad & i = j \\\\\nmin_{i \\leq k < j}\\{m[i,k]+m[k+1,j]+p_{i-1}p_kp_j\\} \\qquad & i <j\n\\end{cases} \n$$\n\n`MATRIX-CHAIN-ORDER` æ—¶é—´å¤æ‚åº¦$O(n^3)$ï¼Œå¦å¤–è¿˜éœ€è¦$\\Theta(n^2)$çš„å†…å­˜ç©ºé—´æ¥ä¿å­˜è¡¨$m$å’Œ$s$ï¼š\n```text\nMATRIX-CHAIN-ORDER(p)\nn = p.length - 1\nlet m[1..n,1..n] and s[1..n-1,2..n] be new tables\nfor i = 1 to n\n    m[i,i] = 0\nfor l = 2 to n  //l is the chain length\n    for i = 1 to n-l+1\n        j = i + l - 1\n        m[i,j] = âˆ\n        for k = i to j-1\n            q = m[i, k] + m[k+1, j] + p_i-1p_kp_j\n            if q < m[i,j]\n                m[i,j] = q\n                s[i,j] = k\nreturn m and s\n```\nè°ƒç”¨ `PRINT-OPTIMAL-PARENS` å¯è¾“å‡º$\\langle A_1,A_2,...,A_n\\rangle$çš„æœ€ä¼˜æ‹¬å·åŒ–æ–¹æ¡ˆï¼š\n```text\nPRINT-OPTIMAL-PARENS(s, i, j)\nif i == j\n    print \"A\"\nelse \n    print \"(\"\n    PRINT-OPTIMAL-PARENS(s, i, s[i,j])\n    PRINT-OPTIMAL-PARENS(s, s[i,j]+1, j)\n    print \")\"\n```\n#### æœ€é•¿å…¬å…±å­åºåˆ—ï¼ˆLCSï¼‰\nç»™å®šä¸€ä¸ªåºåˆ—$X = \\langle x_1,x_2...x_m\\rangle$ï¼Œä»¤ä¸€ä¸ªåºåˆ—$Z=\\langle z_1,z_2,...,z_k\\rangle$æ»¡è¶³å¦‚ä¸‹æ¡ä»¶æ—¶ç§°ä¸º$X$çš„**å­åºåˆ—**ï¼šå­˜åœ¨ä¸€ä¸ªä¸¥æ ¼é€’å¢çš„$X$çš„ä¸‹æ ‡åºåˆ—$\\langle i_1,i_2,...,i_k\\rangle$ï¼Œå¯¹æ‰€æœ‰$j=1,2,...,k$ï¼Œæ»¡è¶³$x_i=z_j$\nç»™å®šä¸¤ä¸ªåºåˆ—$X = \\langle x_1,x_2...x_m\\rangle$å’Œ$Y =\\langle y_1,y_2,...,y_n\\rangle$ï¼Œæ±‚$X$å’Œ$Y$é•¿åº¦æœ€é•¿çš„å…¬å…±å­åºåˆ—\n\næˆ‘ä»¬å®šä¹‰$c[i,j]$è¡¨ç¤º$X_i$å’Œ$Y_j$çš„ `LCS` çš„é•¿åº¦ï¼Œå¯å¾—å¦‚ä¸‹å…¬å¼ï¼š\n$$\nc[i,j] \\leq\n\\begin{cases}\n0 \\qquad & i = 0 \\lor j = 0 \\\\\nc[i-1,j-1]+1 \\qquad & i,j >0 \\land x_i = y_i \\\\\nmax(c[i,j-1],c[i-1,j]) & i,j >0 \\land x_i \\neq y_i\n\\end{cases} \n$$\n\n`LCS-LENGTH` æ—¶é—´å¤æ‚åº¦$\\Theta(mn)$ï¼š\n```text\nLCS-LENGTH(X, Y)\nm = X.length\nn = Y.length\nlet b[1..m,1..n] and c[0..m,0..n] be new tables\nfor i = 1 to m\n    c[i,0] = 0\nfor j = 0 to n\n    c[0,j] = 0\nfor i = 1 to m\n    for j = 1 to n\n        if xi == yj\n            c[i,j] = c[i-1,j-1] + 1\n            b[i,j] = \"â†–\"\n        elseif c[i-1,j] >= c[i,j-1]\n            c[i,j] = c[i-1,j]\n            b[i,j] = \"â†‘\"\n        else \n            c[i,j] = c[i,j-1]\n            b[i,j] = \"â†\"\nreturn c and b\n```\nè°ƒç”¨ `PRINT-LCS` å¯æ‰“å°å‡º$X$å’Œ$Y$çš„ä¸€ä¸ª `LCS`ï¼š\n```text\nPRINT-LCS(b, X, i, j)\nif x == 0 or j == 0\n    return\nif b[i,j] == \"â†–\"\n    PRINT-LCS(b, X, i-1, j-1)\n    print xi\nelseif b[i,j] == \"â†‘\"\n    PRINT-LCS(b, X, i-1, j)\nelse\n    PRINT-LCS(b, X, i, j-1)\n```\n#### æœ€ä¼˜äºŒå‰æœç´¢æ ‘\nç»™å®šä¸€ä¸ª$n$ä¸ªä¸åŒå…³é”®å­—çš„å·²æ’åºçš„åºåˆ—$K=\\langle k_1,k_2,...,k_n \\rangle ,k_1<k_2<...<k_n$ï¼Œæˆ‘ä»¬å¸Œæœ›ç”¨è¿™äº›å…³é”®å­—æ„é€ ä¸€æ£µäºŒå‰æœç´¢æ ‘ï¼Œå¯¹æ¯ä¸ªå…³é”®å­—$k_i$ï¼Œéƒ½æœ‰ä¸€ä¸ªæ¦‚ç‡$p_i$è¡¨ç¤ºå…¶æœç´¢é¢‘ç‡ã€‚æœ‰äº›è¦æœç´¢çš„å€¼å¯èƒ½ä¸åœ¨$K$ä¸­ï¼Œå› æ­¤æˆ‘ä»¬è¿˜æœ‰$n+1$ä¸ªâ€œä¼ªå…³é”®å­—â€$d_0,d_1,...,d_n$è¡¨ç¤ºä¸åœ¨$K$ä¸­çš„å€¼ã€‚$d_0$è¡¨ç¤ºæ‰€æœ‰å°äº$k_1$çš„å€¼ï¼Œ$d_n$è¡¨ç¤ºæ‰€æœ‰å¤§äº$k_n$çš„å€¼ï¼Œå¯¹$i=1,2,...,n-1$ï¼Œä¼ªå…³é”®å­—$d_i$è¡¨ç¤ºæ‰€æœ‰åœ¨$k_i$å’Œ$k_{i+1}$ä¹‹é—´çš„å€¼ã€‚å¯¹æ¯ä¸ªä¼ªå…³é”®å­—$d_i$ï¼Œä¹Ÿéƒ½æœ‰ä¸€ä¸ªæ¦‚ç‡$q_i$è¡¨ç¤ºå¯¹åº”çš„æœç´¢é¢‘ç‡ã€‚æ¯ä¸ªå…³é”®å­—$k_i$æ˜¯ä¸€ä¸ªå†…éƒ¨ç»“ç‚¹ï¼Œè€Œæ¯ä¸ªä¼ªå…³é”®å­—$d_i$æ˜¯ä¸€ä¸ªå¶ç»“ç‚¹ï¼š\n\n![binaryTree](https://d-sketon.top/img/clrs-book/8.png)\n\næœ‰å¦‚ä¸‹å…¬å¼ï¼š\n$$\\sum^{n}_{i=1}p_i+\\sum^n_{i=0}q_i=1$$\n\nåœ¨$T$ä¸­è¿›è¡Œä¸€æ¬¡æœç´¢çš„æœŸæœ›ä»£ä»·ä¸ºï¼š\n$$E[cost]=1+\\sum^{n}_{i=1}depth_T(k_i) \\cdot p_i + \\sum^n_{i=0}depth_T(d_i) \\cdot q_i$$\n\nå¯¹äºä¸€ä¸ªç»™å®šçš„æ¦‚ç‡é›†åˆã€‚æˆ‘ä»¬å¸Œæœ›æ„é€ ä¸€æ£µæœŸæœ›æœç´¢ä»£ä»·æœ€å°çš„äºŒå‰æœç´¢æ ‘ï¼Œæˆ‘ä»¬ç§°ä¸º**æœ€ä¼˜äºŒå‰æœç´¢æ ‘**\n\nå®šä¹‰$e[i,j]$ä¸ºåœ¨åŒ…å«å…³é”®å­—$k_i,...,k_j$çš„æœ€ä¼˜äºŒå‰æœç´ æ ‘ä¸­è¿›è¡Œä¸€æ¬¡æœ‰æ‰€çš„æœŸæœ›ä»£ä»·ï¼Œå…¶ä¸­$i \\geq i$ï¼Œ$j \\leq n$ä¸”$j\\geq i-1$ï¼ˆå½“$j=i-1$æ—¶ï¼Œå­æ ‘ä¸åŒ…å«å®é™…å…³é”®å­—ï¼ŒåªåŒ…å«ä¼ªå…³é”®å­—$d_{i-1}$ï¼‰\n\nå½“ä¸€æ£µå­æ ‘æˆä¸ºä¸€ä¸ªç»“ç‚¹çš„å­æ ‘æ—¶ï¼Œå¯¹äºåŒ…å«å…³é”®å­—$k_i,..k_j$çš„å­æ ‘ï¼Œå­æ ‘çš„æœŸæœ›æœç´¢ä»£ä»·çš„å¢åŠ å€¼ä¸ºï¼š\n$$\nw(i,j)=\\sum^j_{l=i}p_l+\\sum^j_{l=i-1}q_l\n$$\n\né€’å½’å…¬å¼ï¼š\n$$\ne[i,j] \\leq\n\\begin{cases}\nq_{i-1} \\qquad & j=i-1 \\\\\nmin_{i \\leq r \\leq j}\\{e[i,r-1]+e[r+1,j]+w(i,j)\\} \\qquad  & i \\leq j\n\\end{cases} \n$$\n\n`OPTIMAL-BST` æ—¶é—´å¤æ‚åº¦$\\Theta(n^3)$ï¼š\n```text\nOPTIMAL-BST(p, q, n)\nlet e[1..n+1,0..n],w[1..n+1,0..n] and root[1..n,1..n] be new tables\nfor i = 1 to n+1\n    e[i,i-1] = q_{i-1}\n    w[i,i-1] = q_{i-1}\nfor l = 1 to n\n    for i = 1 to n-l+1\n        j = i+l-1\n        e[i,j] = âˆ\n        w[i,j] = w[i,j-1] + p_j +q_j\n        for r = i to j\n            t = e[i,r-1] + e[r+1,j] + w[i,j]\n            if t < e[i,j]\n                e[i,j] = t\n                root[i,j] = r\nreturn e and root\n```\n### è´ªå¿ƒç®—æ³•\n#### æ´»åŠ¨é€‰æ‹©é—®é¢˜\nå‡å®šæœ‰ä¸€ä¸ª$n$ä¸ª**æ´»åŠ¨**çš„é›†åˆ$S=\\{a_1,a_2,...,a_n\\}$ã€‚è¿™äº›æ´»åŠ¨ä½¿ç”¨åŒä¸€ä¸ªèµ„æºï¼Œè€Œè¿™ä¸ªèµ„æºåœ¨æŸä¸ªæ—¶åˆ»åªèƒ½ä¾›ä¸€ä¸ªæ´»åŠ¨ä½¿ç”¨ã€‚æ¯ä¸ªæ´»åŠ¨$a_i$éƒ½æœ‰ä¸€ä¸ª**å¼€å§‹æ—¶é—´**$s_i$å’Œ**ç»“æŸæ—¶é—´**$f_i$ï¼Œå…¶ä¸­$0\\leq s_i < f_i < \\infty$ã€‚å¦‚æœè¢«é€‰ä¸­ï¼Œä»»åŠ¡$a_i$å‘ç”Ÿåœ¨åŠå¼€æ—¶é—´åŒºé—´$[s_i,f_i)$æœŸé—´ã€‚å¦‚æœä¸¤ä¸ªæ´»åŠ¨$a_i$å’Œ$a_j$æ»¡è¶³$[s_i,f_i)$å’Œ$[s_j,f_j)$ä¸é‡å ï¼Œåˆ™ç§°å®ƒä»¬æ˜¯**å…¼å®¹**çš„\n\nåœ¨**æ´»åŠ¨é€‰æ‹©é—®é¢˜**ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›é€‰å‡ºä¸€ä¸ª**æœ€å¤§å…¼å®¹æ´»åŠ¨é›†**ï¼Œå‡å®šæ´»åŠ¨å·²æŒ‰ç»“æŸæ—¶é—´çš„å•è°ƒé€’å¢é¡ºåºæ’åˆ—ï¼š\n$$f_1\\leq f_2 \\leq .. \\leq f_{n-1} \\leq f_n$$\n\n##### æœ€ä¼˜å­ç»“æ„\nç”¨$c[i,j]$è¡¨ç¤ºé›†åˆ$S_{ij}$çš„æœ€ä¼˜è§£çš„å¤§å°ï¼Œåˆ™å¯å¾—é€’å½’å¼ï¼š\n$$\nc[i,j] \\leq\n\\begin{cases}\n0 \\qquad & S_{ij} = \\emptyset \\\\\nmax_{a_k \\in S_{ij}}\\{c[i,k]+c[k,j]+1\\} \\qquad  & S_{ij} \\neq \\emptyset\n\\end{cases} \n$$\n\n##### è´ªå¿ƒé€‰æ‹©\nè€ƒè™‘ä»»æ„éç©ºå­é—®é¢˜$S_k$ï¼Œä»¤$a_m$æ˜¯$S_k$ä¸­ç»“æŸæ—¶é—´æœ€æ—©çš„æ´»åŠ¨ï¼Œåˆ™$a_m$åœ¨$S_k$çš„æŸä¸ªæœ€å¤§å…¼å®¹æ´»åŠ¨å­é›†ä¸­\n##### é€’å½’è´ªå¿ƒç®—æ³•\næ±‚è§£åŸé—®é¢˜å¯è°ƒç”¨ `RECURSIVE-ACTIVITY-SELECTOR(s, f, 0, n)`ï¼Œåœ¨è¾“å…¥æ´»åŠ¨å·²æŒ‰ç»“æŸæ—¶é—´æ’åºçš„å‰æä¸‹ï¼Œæ—¶é—´å¤æ‚åº¦$\\Theta(n)$ï¼š\n```text\nRECURSIVE-ACTIVITY-SELECTOR(s, f, k, n)\nm = k + 1\nwhile m <= n and s[m] < f[k]\n    m = m + 1\nif m <= n\n    return {a_m} âˆª RECURSIVE-ACTIVITY-SELECTOR(s, f, m, n)\nelse\n    return âˆ…\n```\n##### è¿­ä»£è´ªå¿ƒç®—æ³•\nåœ¨è¾“å…¥æ´»åŠ¨å·²æŒ‰ç»“æŸæ—¶é—´æ’åºçš„å‰æä¸‹ï¼Œæ—¶é—´å¤æ‚åº¦$\\Theta(n)$ï¼š\n```text\nGREEDY-ACTIVITY-SELECTOR(s, f)\nn = s.length\nA = {a_1}\nk = 1\nfor m = 2 to n\n    if s[m] >= f[k]\n        A = A âˆª {a_m}\n        k = m\nreturn A\n```\n#### éœå¤«æ›¼ç¼–ç \n##### å‰ç¼€ç \nå‰ç¼€ç ï¼Œå³æ²¡æœ‰ä»»ä½•ç å­—æ˜¯å…¶ä»–ç å­—çš„å‰ç¼€ã€‚å‰ç¼€ç å¯ä»¥ä¿è¯è¾¾åˆ°æœ€ä¼˜æ•°æ®å‹ç¼©ç‡\n\nä½¿ç”¨**äºŒå‰æ ‘**æ¥è¡¨ç¤ºå‰ç¼€ç ï¼šå…¶å¶ç»“ç‚¹ä¸ºç»™å®šçš„å­—ç¬¦ã€‚å­—ç¬¦çš„äºŒè¿›åˆ¶ç å­—ç”¨ä»æ ¹ç»“ç‚¹åˆ°è¯¥å­—ç¬¦å¶ç»“ç‚¹çš„ç®€å•è·¯å¾„è¡¨ç¤ºã€‚å…¶ä¸­ `0` æ„å‘³ç€â€œè½¬å‘å·¦å­©å­â€ï¼Œ`1` æ„å‘³ç€â€œè½¬å‘å³å­©å­â€ï¼š\n\n![Huffman](https://d-sketon.top/img/clrs-book/9.png)\n\næ–‡ä»¶çš„æœ€ä¼˜ç¼–ç æ–¹æ¡ˆæ€»æ˜¯å¯¹åº”ä¸€æ£µæ»¡äºŒå‰æ ‘ï¼Œå³æ¯ä¸ªéå¶ç»“ç‚¹éƒ½æœ‰ä¸¤ä¸ªå­©å­ç»“ç‚¹\nè‹¥$C$ä¸ºå­—æ¯è¡¨ä¸”æ‰€æœ‰å­—ç¬¦çš„å‡ºç°é¢‘ç‡ä¸ºæ­£æ•°ï¼Œåˆ™æœ€ä¼˜å‰ç¼€ç å¯¹åº”çš„æ ‘æ°å¥½æœ‰$|C|$ä¸ªå¶ç»“ç‚¹ï¼Œæ¯ä¸ªå¶ç»“ç‚¹å¯¹åº”å­—æ¯è¡¨ä¸­çš„ä¸€ä¸ªå­—ç¬¦ï¼Œä¸”æ°æœ‰$|C|-1$ä¸ªå†…éƒ¨ç»“ç‚¹\n\nç»™å®šä¸€æ£µå¯¹åº”å‰ç¼€ç çš„æ ‘$T$ã€‚å¯¹äºå­—æ¯è¡¨$C$ä¸­çš„æ¯ä¸ªå­—ç¬¦$c$ï¼Œä»¤å±æ€§$c.freq$è¡¨ç¤º$c$åœ¨æ–‡ä»¶ä¸­å‡ºç°çš„é¢‘ç‡ï¼Œä»¤$d_T(c)$è¡¨ç¤º$c$çš„å¶ç»“ç‚¹åœ¨æ ‘ä¸­çš„æ·±åº¦ã€‚åˆ™ç¼–ç æ–‡ä»¶éœ€è¦ï¼š\n$$B(T)=\\sum_{c \\in C} c.freq \\cdot d_T(c)$$\n\nä¸ªäºŒè¿›åˆ¶ä½ï¼Œæˆ‘ä»¬å°†$B(T)$å®šä¹‰ä¸º$T$çš„ä»£ä»·\n##### æ„é€ éœå¤«æ›¼ç¼–ç \nå‡å®š$C$æ˜¯ä¸€ä¸ª$n$ä¸ªå­—ç¬¦çš„é›†åˆï¼Œè€Œå…¶ä¸­æ¯ä¸ªå­—ç¬¦$c \\in C$éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå…¶å±æ€§$c.freq$ç»™å‡ºäº†å­—ç¬¦çš„å‡ºç°é¢‘ç‡ã€‚ç®—æ³•ä½¿ç”¨äº†ä¸€ä¸ªä»¥å±æ€§$freq$ä¸ºå…³é”®å­—æœ€å°ä¼˜å…ˆé˜Ÿåˆ—$Q$ï¼š\n```text\nHUFFMAN(C)\nn = |C|\nQ = C\nfor i = 1 to n-1\n    allocate a new node z\n    z.left = x = EXTRACT-MIN(Q)\n    z.right = y = EXTRACT-MIN(Q)\n    z.freq = x.freq + y.freq\n    INSERT(Q, z)\nreturn EXTRACT-MIN(Q)\n```\nå‡å®š$Q$æ˜¯ä½¿ç”¨æœ€å°äºŒå‰å †å®ç°ï¼Œ`HUFFMAN` æ—¶é—´å¤æ‚åº¦$O(nlgn)$\nå¦‚æœå°†æœ€å°äºŒå‰å †æ¢ä¸º `van Emde Boas` æ ‘ï¼Œæ—¶é—´å¤æ‚åº¦$O(nlglgn)$\n### æ‘Šè¿˜åˆ†æ\n#### èšåˆåˆ†æ\nè¿™ç§æ–¹æ³•ç”¨æ¥ç¡®å®šä¸€ä¸ª$n$ä¸ªæ“ä½œçš„åºåˆ—çš„æ€»ä»£ä»·çš„ä¸Šç•Œ$T(n)$ã€‚å› è€Œæ¯ä¸ªæ“ä½œçš„å¹³å‡ä»£ä»·ä¸º$T(n)/n$ã€‚æˆ‘ä»¬å°†å¹³å‡ä»£ä»·ä½œä¸ºæ¯ä¸ªæ“ä½œçš„æ‘Šè¿˜ä»£ä»·ï¼Œå› æ­¤æ‰€æœ‰æ“ä½œå…·æœ‰ç›¸åŒçš„æ‘Šè¿˜ä»£ä»·\n##### æ ˆæ“ä½œ\nè€ƒè™‘ç”±$n$ä¸ª `PUSH`ã€`POP` å’Œ `MULTIPOP` ç»„æˆçš„æ“ä½œåºåˆ—åœ¨ä¸€ä¸ªç©ºæ ˆä¸Šçš„æ‰§è¡Œæƒ…å†µã€‚å…¶ä»£ä»·è‡³å¤šä¸º$O(n)$ï¼Œä¸€ä¸ªæ“ä½œçš„å¹³å‡æ—¶é—´ä¸º$O(n)/n=O(1)$ã€‚æ‰€ä»¥ï¼Œæ‰€æœ‰ä¸‰ç§æ ˆæ“ä½œçš„æ‘Šè¿˜ä»£ä»·éƒ½æ˜¯$O(1)$\n##### äºŒè¿›åˆ¶è®¡æ•°å™¨é€’å¢\næˆ‘ä»¬ç”¨ä¸€ä¸ªä½æ•°ç»„$A[0..k-1]$ä½œä¸ºè®¡æ•°å™¨ï¼Œå…¶ä¸­$A.length = k$ã€‚å½“è®¡æ•°å™¨ä¸­ä¿å­˜çš„äºŒè¿›åˆ¶å€¼ä¸º$x$æ—¶ï¼Œ$x$çš„æœ€ä½ä½ä¿å­˜åœ¨$A[0]$ä¸­ï¼Œè€Œæœ€é«˜ä½ä¿å­˜åœ¨$A[k-1]$ä¸­ã€‚åˆå§‹æ—¶$x=0$ï¼Œå› æ­¤å¯¹æ‰€æœ‰$i=0,1,..,k-1$ï¼Œ$A[i]=0$ã€‚ä¸ºäº†å°†1ï¼ˆæ¨¡$2^k$ï¼‰åŠ åˆ°è®¡æ•°å™¨çš„å€¼ä¸Šï¼Œæˆ‘ä»¬ä½¿ç”¨å¦‚ä¸‹è¿‡ç¨‹ï¼š\n```text\nINCEREMENT(A)\ni = 0\nwhile i < A.length and A[i] == 1\n    A[i] = 0\n    i = i + 1\nif i < A.length\n    A[i] = 1\n```\nä¸€èˆ¬åœ°ï¼Œå¯¹ä¸€ä¸ªåˆå€¼ä¸º0çš„è®¡æ•°å™¨ï¼Œåœ¨æ‰§è¡Œä¸€ä¸ªç”±$n$ä¸ª `INCEREMENT` æ“ä½œç»„æˆçš„åºåˆ—çš„è¿‡ç¨‹ä¸­ï¼Œ$A[i]$ä¼šç¿»è½¬$\\lfloor n/2^i \\rfloor$æ¬¡ã€‚æ€»ç¿»è½¬æ¬¡æ•°ä¸ºï¼š\n$$\\sum^{k-1}_{i=0}\\lfloor \\frac{n}{2^i} \\rfloor < n \\sum^{\\infty}_{i=0}\\frac{1}{2^i}=2n$$\n\nå› æ­¤ï¼Œå¯¹ä¸€ä¸ªåˆå€¼ä¸º0çš„è®¡æ•°å™¨ï¼Œæ‰§è¡Œä¸€ä¸ª$n$ä¸ª `INCEREMENT` æ“ä½œçš„åºåˆ—çš„æœ€åæƒ…å†µæ—¶é—´ä¸º$O(n)$ã€‚æ¯ä¸ªæ“ä½œçš„å¹³å‡ä»£ä»·ï¼Œå³æ‘Šè¿˜ä»£ä»·ä¸º$O(n)/n=O(1)$\n#### æ ¸ç®—æ³•\nç”¨æ ¸ç®—æ³•è¿›è¡Œæ‘Šè¿˜åˆ†ææ—¶ï¼Œæˆ‘ä»¬å¯¹ä¸åŒæ“ä½œèµ‹äºˆä¸åŒè´¹ç”¨ï¼Œèµ‹äºˆæŸäº›é€ æˆçš„è´¹ç”¨å¯èƒ½å¤šäºæˆ–å°‘äºå…¶å®é™…ä»£ä»·ã€‚æˆ‘ä»¬å°†èµ‹äºˆä¸€ä¸ªæ“ä½œçš„è´¹ç”¨ç§°ä¸ºå®ƒçš„**æ‘Šè¿˜ä»£ä»·**\nå½“ä¸€ä¸ªæ“ä½œçš„æ‘Šè¿˜ä»£ä»·è¶…å‡ºå…¶å®é™…ä»£ä»·æ—¶ï¼Œæˆ‘ä»¬å°†å·®é¢å­˜å…¥æ•°æ®ç»“æ„ä¸­çš„ç‰¹å®šå¯¹è±¡ï¼Œå­˜å…¥çš„å·®é¢ç§°ä¸º**ä¿¡ç”¨**\nå¯¹äºåç»­æ“ä½œä¸­æ‘Šè¿˜ä»£ä»·å°äºå®é™…ä»£ä»·çš„æƒ…å†µï¼Œä¿¡ç”¨å¯ä»¥ç”¨æ¥æ”¯ä»˜å·®é¢\n\nå¦‚æœç”¨$c_i$è¡¨ç¤ºç¬¬$i$ä¸ªæ“ä½œçš„çœŸå®ä»£ä»·ï¼Œç”¨$\\hat{c_i}$è¡¨ç¤ºå…¶æ‘Šè¿˜ä»£ä»·ï¼Œåˆ™å¯¹ä»»æ„$n$ä¸ªæ“ä½œçš„åºåˆ—ï¼Œè¦æ±‚ï¼š\n$$\\sum^n_{i=1} \\hat{c_i} \\geq \\sum^n_{i=1}c_i$$\nå³æ•°æ®ç»“æ„æ‰€å…³è”çš„ä¿¡ç”¨å¿…é¡»ä¸€ç›´ä¸ºéè´Ÿå€¼\n##### æ ˆæ“ä½œ\nä¸ºæ“ä½œèµ‹äºˆå¦‚ä¸‹æ‘Šè¿˜ä»£ä»·ï¼š\n|æ“ä½œ|ä»£ä»·|\n|-|-|\nPUSH|2\nPOP|0\nMULTIPOP|0\n\nç”¨1ç¾å…ƒæ”¯ä»˜å‹æ ˆæ“ä½œçš„å®é™…ä»£ä»·ï¼Œå°†å‰©ä½™1ç¾å…ƒå­˜ä¸ºä¿¡ç”¨ï¼Œç”¨æ¥æ”¯ä»˜å°†æ¥å‡ºæ ˆæ“ä½œçš„ä»£ä»·\nç”±äºæ ˆä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½å­˜æœ‰1ç¾å…ƒçš„ä¿¡ç”¨ï¼Œè€Œæ ˆä¸­çš„å…ƒç´ å§‹ç»ˆæ˜¯éè´Ÿçš„ï¼Œå› æ­¤å¯ä»¥ä¿è¯æ€»ä¿¡ç”¨å€¼æ˜¯éè´Ÿçš„\nå› æ­¤ï¼Œå¯¹ä»»æ„$n$ä¸ª `PUSH`ã€`POP` å’Œ `MULTIPOP` æ“ä½œç»„æˆçš„åºåˆ—ï¼Œæ€»æ‘Šè¿˜ä»£ä»·ä¸ºæ€»å®é™…ä»£ä»·çš„ä¸Šç•Œç”±äºæ€»æ‘Šè¿˜ä»£ä»·ä¸º$O(n)$ï¼Œæ€»å®é™…ä»£ä»·ä¹Ÿæ˜¯$O(n)$\n##### äºŒè¿›åˆ¶è®¡æ•°å™¨é€’å¢\nä¸ºæ“ä½œèµ‹äºˆå¦‚ä¸‹æ‘Šè¿˜ä»£ä»·ï¼š\n|æ“ä½œ|ä»£ä»·|\n|-|-|\nä¸€æ¬¡ç½®ä½æ“ä½œ|2\n\nå½“è¿›è¡Œç½®ä½æ—¶ï¼Œç”¨1ç¾å…ƒæ”¯ä»˜ç½®ä¸ºæ“ä½œçš„å®é™…ä»£ä»·ï¼Œå¦1ç¾å…ƒå­˜ä¸ºä¿¡ç”¨ï¼Œç”¨æ¥æ”¯ä»˜å°†æ¥å¤ä½æ“ä½œçš„ä»£ä»·\nç”±äºæ¯ä½éƒ½å­˜æœ‰1ç¾å…ƒçš„ä¿¡ç”¨ï¼Œè€Œè®¡æ•°å™¨ä¸­1çš„ä¸ªæ•°å§‹ç»ˆæ˜¯éè´Ÿçš„ï¼Œå› æ­¤å¯ä»¥ä¿è¯æ€»ä¿¡ç”¨å€¼æ˜¯éè´Ÿçš„\nå› æ­¤ï¼Œå¯¹ä»»æ„$n$ä¸ª `INCREMENT` æ“ä½œï¼Œæ€»æ‘Šè¿˜ä»£ä»·ä¸ºæ€»å®é™…ä»£ä»·çš„ä¸Šç•Œã€‚ç”±äºæ€»æ‘Šè¿˜ä»£ä»·ä¸º$O(n)$ï¼Œæ€»å®é™…ä»£ä»·ä¹Ÿæ˜¯$O(n)$\n#### åŠ¿èƒ½æ³•\næˆ‘ä»¬å°†å¯¹ä¸€ä¸ªåˆå§‹æ•°æ®ç»“æ„$D_0$æ‰§è¡Œ$n$ä¸ªæ“ä½œã€‚å¯¹æ¯ä¸ª$i=1,2,...,n$ï¼Œä»¤$c_i$ä¸ºç¬¬$i$ä¸ªæ“ä½œçš„å®é™…ä»£ä»·ï¼Œä»¤$D_i$ä¸ºåœ¨æ•°æ®ç»“æ„$D_{i-1}$ä¸Šæ‰§è¡Œç¬¬$i$ä¸ªæ“ä½œå¾—åˆ°çš„ç»“æœæ•°æ®ç»“æ„ã€‚**åŠ¿å‡½æ•°**$\\Phi$å°†æ¯ä¸ªæ•°æ®ç»“æ„$D_i$æ˜ å°„åˆ°ä¸€ä¸ªå®æ•°$\\Phi(D_i)$ï¼Œæ­¤å€¼å³ä¸ºå…³è”åˆ°æ•°æ®ç»“æ„$D_i$çš„åŠ¿ã€‚ç¬¬$i$ä¸ªæ“ä½œçš„**æ‘Šè¿˜ä»£ä»·**$\\hat{c_i}$ç”¨åŠ¿å‡½æ•°$\\Phi$å®šä¹‰ä¸ºï¼š\n$$\\hat{c_i}=c_i+\\Phi(D_i)-\\Phi(D_{i-1})$$\n\n$n$ä¸ªæ“ä½œçš„æ€»æ‘Šè¿˜ä»£ä»·ä¸ºï¼š\n$$\\sum^n_{i=1} \\hat{c_i} = \\sum^n_{i=1}(c_i+\\Phi(D_i)-\\Phi(D_{i-1}))=\\sum^n_{i=1}c_i+\\Phi(D_n)-\\Phi(D_0)$$\n\nå¦‚æœèƒ½å®šä¹‰ä¸€ä¸ªåŠ¿å‡½æ•°$\\Phi$ï¼Œä½¿å¾—$\\Phi(D_n) \\geq \\Phi(D_0)$ï¼Œåˆ™æ€»æ‘Šè¿˜ä»£ä»·$\\sum^n_{i=1} \\hat{c_i}$ç»™å‡ºäº†æ€»å®é™…ä»£ä»·$\\sum^n_{i=1}{c_i}$çš„ä¸€ä¸ªä¸Šç•Œ\n\næˆ‘ä»¬é€šå¸¸å°†$\\Phi(D_0)$ç®€å•å®šä¹‰ä¸º0ï¼Œç„¶åè¯´æ˜å¯¹æ‰€æœ‰$i$ï¼Œæœ‰$\\Phi(D_i) \\geq 0$\n##### æ ˆæ“ä½œ\nå¯¹äºåˆå§‹çš„ç©ºæ ˆ$D_0$ï¼Œæœ‰$\\Phi(D_0)=0$ã€‚ç”±äºæ ˆä¸­å¯¹è±¡æ•°ç›®æ°¸è¿œä¸å¯èƒ½ä¸ºè´Ÿï¼Œæ‰€ä»¥ç¬¬$i$æ­¥æ“ä½œå¾—åˆ°çš„æ ˆ$D_i$å…·æœ‰éè´Ÿçš„åŠ¿ï¼Œå³ï¼š\n$$\\Phi(D_i) \\geq 0 = \\Phi(D_0)$$\n\nå¦‚æœç¬¬$i$ä¸ªæ“ä½œæ˜¯ `PUSH` æ“ä½œï¼Œæ­¤æ—¶æ ˆä¸­åŒ…å«$s$ä¸ªå¯¹è±¡ï¼Œåˆ™åŠ¿å·®ä¸ºï¼š\n$$\\Phi(D_i)-\\Phi(D_{i-1}) = (s+1)-s = 1$$\n\n`PUSH` æ‘Šè¿˜ä»£ä»·ä¸ºï¼š\n$$\\hat{c_i} = c_i+\\Phi(D_i)-\\Phi(D_{i-1}) = 1+1=2$$\n\nå¦‚æœç¬¬$i$ä¸ªæ“ä½œæ˜¯ `MULTIPOP` æ“ä½œï¼Œå°†$k'=min(k,s)$ä¸ªå¯¹è±¡å¼¹å‡ºæ ˆï¼Œåˆ™åŠ¿å·®ä¸ºï¼š\n$$\\Phi(D_i)-\\Phi(D_{i-1}) =-k'$$\n\n`MULTIPOP` æ‘Šè¿˜ä»£ä»·ä¸ºï¼š\n$$\\hat{c_i} = c_i+\\Phi(D_i)-\\Phi(D_{i-1}) = k'-k'=0$$\n\nå¦‚æœç¬¬$i$ä¸ªæ“ä½œæ˜¯ `POP` æ“ä½œï¼Œæ­¤æ—¶æ ˆä¸­åŒ…å«$s$ä¸ªå¯¹è±¡ï¼Œåˆ™åŠ¿å·®ä¸ºï¼š\n$$\\Phi(D_i)-\\Phi(D_{i-1}) = (s-1)-s = -1$$\n\n`POP` æ‘Šè¿˜ä»£ä»·ä¸ºï¼š\n$$\\hat{c_i} = c_i+\\Phi(D_i)-\\Phi(D_{i-1}) = 1-1=0$$\n\næ¯ä¸ªæ“ä½œçš„æ‘Šè¿˜ä»£ä»·éƒ½æ˜¯$O(1)$ï¼Œå› æ­¤ï¼Œ$n$ä¸ªæ“ä½œçš„æ€»æ‘Šè¿˜ä»£ä»·ä¸º$O(n)$ï¼Œä¸ºæ€»å®é™…ä»£ä»·çš„ä¸Šç•Œï¼Œæ‰€ä»¥$n$ä¸ªæ“ä½œçš„æœ€åæƒ…å†µæ—¶é—´ä¸º$O(n)$\n##### äºŒè¿›åˆ¶è®¡æ•°å™¨é€’å¢\nå°†è®¡æ•°å™¨æ‰§è¡Œ$i$æ¬¡ `INCREMENT` æ“ä½œåçš„åŠ¿å®šä¹‰ä¸º$b_i$ï¼š$i$æ¬¡æ“ä½œåè®¡æ•°å™¨ä¸­1çš„ä¸ªæ•°\nå‡è®¾ç¬¬$i$ä¸ª `INCREMENT` æ“ä½œå°†$t_i$ä¸ªä½å¤ä½ï¼Œåˆ™å…¶å®é™…ä»£ä»·è‡³å¤šä¸º$t_i+1$ã€‚åŠ¿å·®ä¸ºï¼š\n$$\\Phi(D_i)-\\Phi(D_{i-1}) \\leq (b_{i-1}-t_i+1)-b_{i-1}=1-t_i$$\næ‘Šè¿˜ä»£ä»·ä¸ºï¼š\n$$\\hat{c_i} = c_i+\\Phi(D_i)-\\Phi(D_{i-1}) \\leq (t_i+1)+(1-t_i)=2$$\nå¦‚æœè®¡æ•°å™¨ä»0å¼€å§‹ï¼Œåˆ™$\\Phi(D_0)=0$ã€‚ç”±äºå¯¹æ‰€æœ‰$i$å‡æœ‰$\\Phi(D_i)\\geq 0$ï¼Œå› æ­¤ï¼Œä¸€ä¸ª$n$ä¸ª `INCREMENT` æ“ä½œçš„åºåˆ—çš„æ€»æ‘Šè¿˜ä»£ä»·æ˜¯æ€»å®é™…ä»£ä»·çš„ä¸Šç•Œï¼Œæœ€åæƒ…å†µæ—¶é—´ä¸º$O(n)$\n#### åŠ¨æ€è¡¨\n##### è¡¨æ‰©å¼ \n```text\nTABLE-INSERT(T, x)\nif T.size == 0\n    allocate T.table with 1 slot\n    T.size = 1\nif T.num == T.size\n    allocate newtable with 2*T.size slots\n    insert all items in T.table into newtable\n    free T.table\n    T.table = newtable\n    T.size = 2 * T.size\ninsert x into T.table\nT.num = T.num + 1\n```\nç¬¬$i$ä¸ªæ“ä½œçš„ä»£ä»·ä¸ºï¼š\n$$\nc_i =\n\\begin{cases}\ni \\qquad & i-1 = 2^k \\\\\n1 \\qquad  & other\n\\end{cases} \n$$\n\n$n$ä¸ª `TABLE-INSERT` æ“ä½œçš„æ€»ä»£ä»·ä¸ºï¼š\n$$\\sum^n_{i=1}c_i \\leq n+\\sum^{\\lfloor lgn \\rfloor}_{j=0}2^j<n+2n=3n $$\n## å›¾ç®—æ³•\n### åŸºæœ¬çš„å›¾ç®—æ³•\n#### å›¾çš„è¡¨ç¤º\n##### é‚»æ¥é“¾è¡¨\nå¯¹äºå›¾$G=(V,E)$æ¥è¯´ï¼Œå…¶é‚»æ¥é“¾è¡¨è¡¨ç¤ºç”±ä¸€ä¸ªåŒ…å«$|V|$æ¡é“¾è¡¨çš„æ•°ç»„$Adj$æ‰€æ„æˆï¼Œæ¯ä¸ªç»“ç‚¹æœ‰ä¸€æ¡é“¾è¡¨\nå¯¹äºæ¯ä¸ªç»“ç‚¹$u \\in V$ï¼Œé‚»æ¥é“¾è¡¨$Adj[u]$åŒ…å«æ‰€æœ‰ä¸ç»“ç‚¹$u$ä¹‹é—´æœ‰è¾¹ç›¸è¿çš„ç»“ç‚¹$v$\n- å¦‚æœ$G$æ˜¯ä¸€ä¸ªæœ‰å‘å›¾ï¼Œåˆ™å¯¹äºè¾¹$(u,v)$æ¥è¯´ï¼Œç»“ç‚¹$v$å°†å‡ºç°åœ¨é“¾è¡¨$Adj[u]$é‡Œï¼Œå› æ­¤ï¼Œæ‰€æœ‰é‚»æ¥é“¾è¡¨çš„é•¿åº¦ä¹‹å’Œç­‰äº$|E|$\n- å¦‚æœ$G$æ˜¯ä¸€ä¸ªæ— å‘å›¾ï¼Œåˆ™å¯¹äºè¾¹$(u,v)$æ¥è¯´ï¼Œç»“ç‚¹$v$å°†å‡ºç°åœ¨é“¾è¡¨$Adj[u]$é‡Œï¼Œç»“ç‚¹$u$å°†å‡ºç°åœ¨é“¾è¡¨$Adj[v]$é‡Œï¼Œå› æ­¤ï¼Œæ‰€æœ‰é‚»æ¥é“¾è¡¨çš„é•¿åº¦ä¹‹å’Œç­‰äº$2|E|$\n- ä¸è®ºæ˜¯æœ‰å‘å›¾è¿˜æ˜¯æ— å‘å›¾ï¼Œé‚»æ¥é“¾è¡¨å­˜å‚¨ç©ºé—´éœ€æ±‚å‡ä¸º$\\Theta(V+E)$\n\nå¯¹é‚»æ¥é“¾è¡¨ç¨åŠ ä¿®æ”¹ï¼Œå°±å¯ä»¥ç”¨æ¥è¡¨ç¤º**æƒé‡å›¾**ï¼šåªéœ€è¦å°†è¾¹$(u,v)$çš„æƒé‡å€¼$w(u,v)$å­˜æ”¾æ”¾åœ¨ç»“ç‚¹$u$çš„é‚»æ¥é“¾è¡¨é‡Œ\né‚»æ¥é“¾è¡¨çš„ä¸€ä¸ªæ½œåœ¨ç¼ºé™·æ˜¯æ— æ³•å¿«é€Ÿåˆ¤æ–­ä¸€æ¡è¾¹$(u,v)$æ˜¯å¦æ˜¯å›¾ä¸­çš„ä¸€æ¡è¾¹\n\n![linkedlistgraph](https://d-sketon.top/img/clrs-book/10.png)\n\n##### é‚»æ¥çŸ©é˜µ\nå›¾$G$çš„é‚»æ¥çŸ©é˜µè¡¨ç¤ºç”±ä¸€ä¸ª$|V| \\times |V|$çš„çŸ©é˜µ$A=(a_{ij})$äºˆä»¥è¡¨ç¤ºï¼Œè¯¥çŸ©é˜µæ»¡è¶³ä¸‹è¿°æ¡ä»¶ï¼š\n$$\na_{ij} =\n\\begin{cases}\n1 \\qquad & (i,j) \\in E \\\\\n0 \\qquad  & other\n\\end{cases} \n$$\n\nä¸ç®¡ä¸€ä¸ªå›¾æœ‰å¤šå°‘æ¡è¾¹ï¼Œé‚»æ¥çŸ©é˜µçš„ç©ºé—´éœ€æ±‚å‡ä¸º$\\Theta(V^2)$\né‚»æ¥çŸ©é˜µä¹Ÿå¯ä»¥ç”¨æ¥è¡¨ç¤º**æƒé‡å›¾**ï¼šç›´æ¥å°†è¾¹$(u,v) \\in E$çš„æƒé‡$w(u,v)$å­˜æ”¾åœ¨é‚»æ¥çŸ©é˜µä¸­çš„ç¬¬$u$è¡Œç¬¬$v$åˆ—è®°å½•ä¸Š\n\n![matrixgraph](https://d-sketon.top/img/clrs-book/11.png)\n\n#### å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰\nä¸ºäº†è·Ÿè¸ªç®—æ³•çš„è¿›å±•ï¼Œå¹¿åº¦ä¼˜å…ˆæœç´¢åœ¨æ¦‚å¿µä¸Šå°†æ¯ä¸ªç»“ç‚¹æ¶‚ä¸Šç™½è‰²ã€ç°è‰²æˆ–é»‘è‰²ã€‚æ‰€æœ‰ç»“ç‚¹åœ¨ä¸€å¼€å§‹çš„æ—¶å€™å‡æ¶‚ä¸Šç™½è‰²ã€‚åœ¨ç®—æ³•çš„æ¨è¿›è¿‡ç¨‹ä¸­ï¼Œè¿™äº›ç»“ç‚¹å¯èƒ½ä¼šå˜æˆç°è‰²æˆ–é»‘è‰²\nå¦‚æœè¾¹$(u,v) \\in E$ä¸”ç»“ç‚¹$u$æ˜¯é»‘è‰²ï¼Œåˆ™ç»“ç‚¹$v$æ—¢å¯èƒ½æ˜¯ç°è‰²ä¹Ÿå¯èƒ½æ˜¯é»‘è‰²ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ‰€æœ‰ä¸é»‘è‰²ç»“ç‚¹é‚»æ¥çš„ç»“ç‚¹éƒ½ä»¥è¢«å‘ç°ã€‚å¯¹äºç°è‰²ç»“ç‚¹æ¥è¯´ï¼Œå…¶é‚»æ¥ç»“ç‚¹ä¸­å¯èƒ½å­˜åœ¨æœªè¢«å‘ç°çš„ç™½è‰²ç»“ç‚¹\nåœ¨æ‰§è¡Œå¹¿åº¦ä¼˜å…ˆæœç´¢çš„è¿‡ç¨‹ä¸­å°†æ„é€ å‡ºä¸€æ£µå¹¿åº¦ä¼˜å…ˆæ ‘\n\nå‡å®šè¾“å…¥å›¾$G=(V,E)$æ˜¯ä»¥é‚»æ¥é“¾è¡¨æ‰€è¡¨ç¤ºçš„ï¼š\n```text\nBFS(G, s)\nfor each vertex u in G.V - {s}\n    u.color = WHITE\n    u.d = âˆ\n    u.Ï€ = NIL\ns.color = GRAY\ns.d = 0\ns.Ï€ = NIL\nQ = âˆ…\nENQUEUE(Q, s)\nwhile Q != âˆ…\n    u = DEQUEUE(Q)\n    for each v in G.Adj[u]\n        if v.color == WHITE\n            v.color = GRAY\n            v.d = u.d + 1\n            v.Ï€ = u\n            ENQUEUE(Q, v)\n    u.color = BLACK\n```\n\n![bfs](https://d-sketon.top/img/clrs-book/12.png)\n\n##### åˆ†æ\nå¹¿åº¦ä¼˜å…ˆæœç´¢çš„æ€»è¿è¡Œæ—¶é—´ä¸º$O(V+E)$\n##### æœ€çŸ­è·¯å¾„\næˆ‘ä»¬å®šä¹‰ä»æºç»“ç‚¹$s$åˆ°ç»“ç‚¹$v$çš„**æœ€çŸ­è·¯å¾„è·ç¦»**$\\delta(s,v)$ä¸ºä»ç»“ç‚¹$s$åˆ°ç»“ç‚¹$v$ä¹‹é—´æ‰€æœ‰è·¯å¾„é‡Œé¢æœ€å°‘çš„è¾¹æ•°\nå¦‚æœä»ç»“ç‚¹$s$åˆ°ç»“ç‚¹$v$ä¹‹é—´æ²¡æœ‰è·¯å¾„ï¼Œåˆ™$\\delta(s,v) = \\infty$\næˆ‘ä»¬ç§°ä»ç»“ç‚¹$s$åˆ°ç»“ç‚¹$v$çš„é•¿åº¦ä¸º$\\delta(s,v)$çš„è·¯å¾„ä¸º$s$åˆ°$v$çš„**æœ€çŸ­è·¯å¾„**\n\nè®¾$G=(V,E)$ä¸ºä¸€ä¸ªæœ‰å‘å›¾æˆ–æ— å‘å›¾ï¼Œåˆå‡è®¾ `BFS` ä»¥$s$ä¸ºæºç»“ç‚¹åœ¨å›¾$G$ä¸Šè¿è¡Œã€‚é‚£ä¹ˆåœ¨ç®—æ³•æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œ`BFS` å°†å‘ç°ä»æºç»“ç‚¹$s$å¯ä»¥åˆ°è¾¾çš„æ‰€æœ‰ç»“ç‚¹$v \\in V$ï¼Œå¹¶åœ¨ç®—æ³•ç»ˆæ­¢æ—¶ï¼Œå¯¹äºæ‰€æœ‰çš„$v \\in V,v.d = \\delta(s,v)$ã€‚è€Œä¸”ï¼Œå¯¹äºä»»æ„å¯ä»¥ä»$s$åˆ°è¾¾çš„ç»“ç‚¹$v \\neq s$ï¼Œä»æºç»“ç‚¹$s$åˆ°ç»“ç‚¹$v$çš„å…¶ä¸­ä¸€æ¡æœ€çŸ­è·¯å¾„ä¸ºä»ç»“ç‚¹$s$åˆ°ç»“ç‚¹$v.\\pi$çš„æœ€çŸ­è·¯å¾„å†åŠ ä¸Šè¾¹$(v.\\pi,v)$\n\n##### å¹¿åº¦ä¼˜å…ˆæ ‘\næˆ‘ä»¬å®šä¹‰å›¾$G$çš„**å‰é©±å­å›¾**ä¸º$G_\\pi =(V_\\pi,E_\\pi)$ï¼Œå…¶ä¸­$V_\\pi = \\{v\\in V:v.\\pi \\neq NIL\\} \\cup \\{s\\}$ï¼Œ$E_\\pi = \\{(v.\\pi,v):v \\in V_\\pi - \\{s\\}\\}$\nå½“è¿è¡Œåœ¨ä¸€ä¸ªæœ‰å‘æˆ–æ— å‘å›¾$G=(V,E)$ä¸Šæ—¶ï¼Œ`BFS` è¿‡ç¨‹æ‰€å»ºé€ å‡ºæ¥çš„$\\pi$å±æ€§ä½¿å¾—å‰é©±å­å›¾$G_\\pi=(V_\\pi,E_\\pi)$æˆä¸ºä¸€æ£µå¹¿åº¦ä¼˜å…ˆæ ‘\n\n`PRINT-PATH` å¯æ‰“å°å‡ºä»æºç»“ç‚¹$s$åˆ°ç»“ç‚¹$v$çš„ä¸€æ¡æœ€çŸ­è·¯å¾„ä¸Šçš„æ‰€æœ‰ç»“ç‚¹ï¼Œè¿™é‡Œå‡å®š `BFS` å·²ç»è®¡ç®—å‡ºä¸€æ£µå¹¿åº¦ä¼˜å…ˆæ ‘ï¼š\n```text\nPRINT-PATH(G, s, v)\nif v == s\n    print s\nelseif v.Ï€ == NIL\n    print \"no path from\" s \"to\" v \"exists\"\nelse\n    PRINT-PATH(G, s, v.Ï€)\n    print v\n```\n#### æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰\næˆ‘ä»¬å®šä¹‰å›¾$G$çš„**å‰é©±å­å›¾**ä¸º$G_\\pi =(V,E_\\pi)$ï¼Œå…¶ä¸­$E_\\pi = \\{(v.\\pi,v):v \\in V \\land v.\\pi \\neq NIL\\}$\nä¸å¹¿åº¦ä¼˜å…ˆæœç´¢ä¸åŒï¼Œæ·±åº¦ä¼˜å…ˆæœç´¢çš„å‰é©±å­å›¾å¯èƒ½ç”±**å¤šé¢—æ ‘**ç»„æˆï¼Œå› ä¸ºæœç´¢å¯èƒ½ä»å¤šä¸ªæºç»“ç‚¹é‡å¤è¿›è¡Œ\næ·±åº¦ä¼˜å…ˆæœç´¢çš„å‰é©±å­å›¾å½¢æˆä¸€ä¸ªç”±å¤šé¢—**æ·±åº¦ä¼˜å…ˆæ ‘**æ„æˆçš„**æ·±åº¦ä¼˜å…ˆæ£®æ—**ï¼Œæ£®æ—$E_\\pi$ä¸­çš„è¾¹ä»ç„¶ç§°ä¸º**æ ‘è¾¹**\n\nåƒå¹¿åº¦ä¼˜å…ˆæœç´¢ä¸€æ ·ï¼Œæ·±åº¦ä¼˜å…ˆæœç´¢ç®—æ³•åœ¨æœç´¢è¿‡ç¨‹ä¸­ä¹Ÿæ˜¯å¯¹ç»“ç‚¹è¿›è¡Œæ¶‚è‰²æ¥æŒ‡æ˜ç»“ç‚¹çš„çŠ¶æ€ã€‚æ¯ä¸ªç»“ç‚¹çš„åˆå§‹é¢œè‰²éƒ½æ˜¯ç™½è‰²ï¼Œåœ¨ç»“ç‚¹è¢«**å‘ç°**åå˜ä¸ºç°è‰²ï¼Œåœ¨å…¶é‚»æ¥é“¾è¡¨è¢«æ‰«æ**å®Œæˆ**åå˜ä¸ºé»‘è‰²ã€‚è¯¥æ–¹æ³•å¯ä»¥ä¿è¯æ¯ä¸ªç»“ç‚¹ä»…åœ¨ä¸€æ£µæ·±åº¦ä¼˜å…ˆæ ‘ä¸­å‡ºç°ï¼Œå› æ­¤ï¼Œæ‰€æœ‰çš„æ·±åº¦ä¼˜å…ˆæ ‘æ˜¯ä¸ç›¸äº¤çš„\n\næ·±åº¦ä¼˜å…ˆç®—æ³•åœ¨æ¯ä¸ªç»“ç‚¹ç›–ä¸Šä¸€ä¸ª**æ—¶é—´æˆ³**ã€‚æ¯ä¸ªç»“ç‚¹$v$æœ‰ä¸¤ä¸ªæ—¶é—´æˆ³ï¼šç¬¬ä¸€ä¸ªæ—¶é—´æˆ³$v.d$è®°å½•ç»“ç‚¹$v$ç¬¬ä¸€æ¬¡è¢«å‘ç°çš„æ—¶é—´ï¼ˆæ¶‚ä¸Šç°è‰²çš„æ—¶å€™ï¼‰ï¼Œç¬¬äºŒä¸ªæ—¶é—´æˆ³$v.f$è®°å½•çš„æ˜¯æœç´¢å®Œæˆå¯¹$v$çš„é‚»æ¥é“¾è¡¨æ‰«æçš„æ—¶é—´ï¼ˆæ¶‚ä¸Šé»‘è‰²çš„æ—¶å€™ï¼‰\n\nè¾“å…¥å›¾$G$æ—¢å¯ä»¥æ˜¯æ— å‘å›¾ï¼Œå¯ä»¥æ˜¯æœ‰å‘å›¾ã€‚å˜é‡$time$æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œç”¨æ¥è®¡ç®—æ—¶é—´æˆ³ï¼š\n```text\nDFS(G)\nfor each vertex u in G.V\n    u.color = WHITE\n    u.Ï€ = NIL\ntime = 0\nfor each vertex u in G.V\n    if u.color == WHITE\n        DFS-VISIT(G, u)\n\nDFS-VISIT(G, u)\ntime = time + 1\nu.d = time\nu.color = GRAY\nfor each v in G.Adj[u]\n    if v.color == WHITE\n        v.Ï€ = u\n        DFS-VISIT(G, v)\nu.color = BLACK\ntime = time + 1\nu.f = time\n```\n\n![dfs](https://d-sketon.top/img/clrs-book/13.png)\n\n##### åˆ†æ\næ·±åº¦ä¼˜å…ˆæœç´¢çš„æ€»è¿è¡Œæ—¶é—´ä¸º$O(V+E)$\n##### æ·±åº¦ä¼˜å…ˆæœç´¢çš„æ€§è´¨\n**æ‹¬å·åŒ–å®šç†**ï¼šåœ¨å¯¹æœ‰å‘æˆ–æ— å‘å›¾$G=(V,E)$è¿›è¡Œçš„ä»»æ„æ·±åº¦ä¼˜å…ˆæœç´¢ä¸­ï¼Œå¯¹äºä»»æ„ä¸¤ä¸ªç»“ç‚¹$u$å’Œ$v$æ¥è¯´ï¼Œä¸‹é¢ä¸‰ç§æƒ…å†µåªæœ‰ä¸€æˆç«‹ï¼š\n- åŒºé—´$[u.d,u.f]$å’ŒåŒºé—´$[v.d,v.f]$å®Œå…¨åˆ†ç¦»ï¼Œåœ¨æ·±åº¦ä¼˜å…ˆæ£®æ—ä¸­ï¼Œç»“ç‚¹$u$ä¸æ˜¯ç»“ç‚¹$v$çš„åä»£ï¼Œç»“ç‚¹$v$ä¹Ÿä¸æ˜¯ç»“ç‚¹$u$çš„åä»£\n- åŒºé—´$[u.d,u.f]$å®Œå…¨åŒ…å«åœ¨åŒºé—´$[v.d,v.f]$å†…ï¼Œåœ¨æ·±åº¦ä¼˜å…ˆæ ‘ä¸­ï¼Œç»“ç‚¹$u$æ˜¯ç»“ç‚¹$v$çš„åä»£\n- åŒºé—´$[v.d,v.f]$å®Œå…¨åŒ…å«åœ¨åŒºé—´$[u.d,u.f]$å†…ï¼Œåœ¨æ·±åº¦ä¼˜å…ˆæ ‘ä¸­ï¼Œç»“ç‚¹$v$æ˜¯ç»“ç‚¹$u$çš„åä»£\n\n**åä»£åŒºé—´çš„åµŒå¥—**ï¼šåœ¨æœ‰å‘æˆ–æ— å‘å›¾$G$çš„æ·±åº¦ä¼˜å…ˆæ£®æ—ä¸­ï¼Œç»“ç‚¹$v$æ˜¯ç»“ç‚¹$u$çš„çœŸåä»£å½“ä¸”ä»…å½“$u.d<v.d<v.f<u.f$æˆç«‹\n**ç™½è‰²è·¯å¾„å®šç†**ï¼šåœ¨æœ‰å‘æˆ–æ— å‘å›¾$G=(V,E)$çš„æ·±åº¦ä¼˜å…ˆæ£®æ—ä¸­ï¼Œç»“ç‚¹$v$æ˜¯ç»“ç‚¹$u$çš„åä»£å½“ä¸”ä»…å½“åœ¨å‘ç°ç»“ç‚¹$u$çš„æ—¶é—´$u.d$ï¼Œå­˜åœ¨ä¸€æ¡ä»ç»“ç‚¹$u$åˆ°ç»“ç‚¹$v$çš„å…¨éƒ¨ç”±ç™½è‰²ç»“ç‚¹æ‰€æ„æˆçš„è·¯å¾„\n##### è¾¹çš„åˆ†ç±» \n- **æ ‘è¾¹**ï¼šä¸ºæ·±åº¦ä¼˜å…ˆæ£®æ—$G_\\pi$ä¸­çš„è¾¹ï¼Œå¦‚æœç»“ç‚¹$v$æ˜¯å› ç®—æ³•å¯¹è¾¹$(u,v)$çš„æ¢ç´¢è€Œé¦–å…ˆè¢«å‘ç°ï¼Œåˆ™$(u,v)$æ˜¯ä¸€æ¡æ ‘è¾¹\n- **åå‘è¾¹**ï¼šåå‘è¾¹$(u,v)$æ˜¯å°†ç»“ç‚¹$u$è¿æ¥åˆ°å…¶åœ¨æ·±åº¦ä¼˜å…ˆæ ‘ä¸­ï¼ˆä¸€ä¸ªï¼‰ç¥–å…ˆç»“ç‚¹$v$çš„è¾¹ã€‚ç”±äºæœ‰å‘å›¾ä¸­å¯ä»¥æœ‰è‡ªå¾ªç¯ï¼Œè‡ªå¾ªç¯ä¹Ÿè¢«è®¤ä¸ºæ˜¯åå‘è¾¹\n- **å‰å‘è¾¹**ï¼šæ˜¯å°†ç»“ç‚¹$u$è¿æ¥åˆ°å…¶åœ¨æ·±åº¦ä¼˜å…ˆæ ‘ä¸­ä¸€ä¸ªåä»£ç»“ç‚¹$v$çš„è¾¹$(u,v)$\n- **æ¨ªå‘è¾¹**ï¼šæŒ‡å…¶ä»–æ‰€æœ‰çš„è¾¹ã€‚è¿™äº›è¾¹å¯ä»¥è¿æ¥åŒä¸€æ£µæ·±åº¦ä¼˜å…ˆæ ‘ä¸­çš„ç»“ç‚¹ï¼Œåªè¦å…¶ä¸­ä¸€ä¸ªç»“ç‚¹ä¸æ˜¯å¦å¤–ä¸€ä¸ªç»“ç‚¹çš„ç¥–å…ˆï¼Œä¹Ÿå¯ä»¥è¿æ¥ä¸åŒæ·±åº¦ä¼˜å…ˆæ ‘ä¸­çš„ä¸¤ä¸ªç»“ç‚¹\n\nç»“ç‚¹$v$çš„é¢œè‰²èƒ½å¤Ÿå‘Šè¯‰æˆ‘ä»¬å…³äºè¯¥æ¡è¾¹çš„ä¸€äº›ä¿¡æ¯ï¼š\n- ç»“ç‚¹$v$ä¸º**ç™½è‰²**è¡¨æ˜è¯¥æ¡è¾¹$(u,v)$æ˜¯ä¸€æ¡æ ‘è¾¹\n- ç»“ç‚¹$v$ä¸º**ç°è‰²**è¡¨æ˜è¯¥æ¡è¾¹$(u,v)$æ˜¯ä¸€æ¡åå‘è¾¹\n- ç»“ç‚¹$v$ä¸º**é»‘è‰²**è¡¨æ˜è¯¥æ¡è¾¹$(u,v)$æ˜¯ä¸€æ¡å‰å‘è¾¹æˆ–æ¨ªå‘è¾¹\n  \nåœ¨å¯¹æ— å‘å›¾$G$è¿›è¡Œæ·±åº¦ä¼˜å…ˆæœç´¢æ—¶ï¼Œæ¯æ¡è¾¹è¦ä¹ˆæ˜¯**æ ‘è¾¹**ï¼Œè¦ä¹ˆæ˜¯**åå‘è¾¹**\n#### æ‹“æ‰‘æ’åº\nå¯¹äºä¸€ä¸ªæœ‰å‘æ— ç¯å›¾$G=(V,E)$æ¥è¯´ï¼Œå…¶æ‹“æ‰‘æ’åºæ˜¯$G$ä¸­æ‰€æœ‰ç»“ç‚¹çš„ä¸€ç§çº¿æ€§æ¬¡åºï¼Œè¯¥æ¬¡åºæ»¡è¶³å¦‚ä¸‹æ¡ä»¶ï¼š\nå¦‚æœå›¾$G$åŒ…å«è¾¹$(u,v)$ï¼Œåˆ™ç»“ç‚¹$u$åœ¨æ‹“æ‰‘æ’åºä¸­å¤„äºç»“ç‚¹$v$çš„å‰é¢ï¼ˆå¦‚æœå›¾$G$åŒ…å«ç¯è·¯ï¼Œåˆ™ä¸å¯èƒ½æ’å‡ºä¸€ä¸ªçº¿æ€§æ¬¡åºï¼‰\n\nä¸‹é¢çš„ç®€å•ç®—æ³•å¯ä»¥å¯¹ä¸€ä¸ªæœ‰å‘æ— ç¯å›¾è¿›è¡Œæ‹“æ‰‘æ’åºï¼Œå®Œæˆæ—¶é—´$\\Theta(V+E)$ï¼š\n```text\nTOPOLOGICAL-SORT(G)\ncall DFS(G) to compute finishing times v.f for each vertex v\nas each vertex is finished, insert it onto the front of a linked list\nreturn the linked list of vertices\n```\n#### å¼ºè¿é€šåˆ†é‡\næœ‰å‘å›¾$G=(V,E)$çš„å¼ºè¿é€šåˆ†é‡æ˜¯ä¸€ä¸ªæœ€å¤§ç»“ç‚¹é›†åˆ$C \\subseteq V$ï¼Œå¯¹äºè¯¥é›†åˆä¸­çš„ä»»æ„ä¸€å¯¹ç»“ç‚¹$u$å’Œ$v$æ¥è¯´ï¼Œè·¯å¾„$u \\leadsto v$å’Œè·¯å¾„$v \\leadsto u$åŒæ—¶å­˜åœ¨\n\nä¸‹é¢çš„ `Kosaraju` ç®—æ³•ä½¿ç”¨ä¸¤æ¬¡æ·±åº¦ä¼˜å…ˆæœç´¢æ¥è®¡ç®—æœ‰å‘å›¾$G-=(V,E)$çš„å¼ºè¿é€šåˆ†é‡ï¼Œæ—¶é—´å¤æ‚åº¦$\\Theta(V+E)$ï¼š\n```text\nSTRONGLY-CONNECTED-COMPONENTS(G)\ncall DFS(G) to compute finishing times u.f for each vertex u\ncompute G^T\ncall DFS(G^T), but in the main loop of DFS, consider the vertices\n    in order of decreasing u.f (as computed in line 1)\noutput the vertices of each tree in the depth-first forest formed in line 3 as a \n    separate strongly connected component\n```\n### æœ€å°ç”Ÿæˆæ ‘\n#### æœ€å°ç”Ÿæˆæ ‘çš„å½¢æˆ\nå‡å®šæœ‰ä¸€ä¸ªè¿é€šæ— å‘å›¾$G=(V,E)$å’Œæƒé‡å‡½æ•°$w:E\\rightarrow \\Reals$ã€‚æˆ‘ä»¬å¸Œæœ›æ‰¾å‡ºå›¾$G$çš„ä¸€æ£µæœ€å°ç”Ÿæˆæ ‘\n\nä½¿ç”¨è´ªå¿ƒç­–ç•¥æ¥ç”Ÿæˆæœ€å°ç”Ÿæˆæ ‘ï¼š\n```text\nGENERIC-MST(G, w)\nA = âˆ…\nwhile A does not form a spanning tree\n    find an edge(u,v) that is safe for A\n    A = A âˆª {(u,v)}\nreturn A\n```\n#### Kruskalç®—æ³•\n`Kruskal` ç®—æ³•ä½¿ç”¨ä¸€ä¸ªä¸ç›¸äº¤é›†åˆæ•°æ®ç»“æ„æ¥ç»´æŠ¤å‡ ä¸ªäº’ä¸ç›¸äº¤çš„å…ƒç´ é›†åˆã€‚æ¯ä¸ªé›†åˆä»£è¡¨å½“å‰æ£®æ—ä¸­çš„ä¸€æ£µæ ‘ã€‚é€šè¿‡æµ‹è¯• `FIND-SET(u)` æ˜¯å¦ç­‰äº `FIND-SET(v)` æ¥åˆ¤æ–­ç»“ç‚¹$u$å’Œç»“ç‚¹$v$æ˜¯å¦å±äºåŒä¸€æ£µæ ‘ï¼Œä½¿ç”¨ `UNION` è¿‡ç¨‹æ¥å¯¹ä¸¤æ£µæ ‘è¿›è¡Œåˆå¹¶\næ—¶é—´å¤æ‚åº¦$O(ElgV)$ï¼š\n```text\nMST-KRUSKAL(G, w)\nA = âˆ…\nfor each vertex v in G.V\n    MAKE-SET(v)\nsort the edges of G.E into nondecreasing order by weight w\nfor each edge(u,v) in G.E, taken in nondecreasing order by weight\n    if FIND-SET(u) != FIND-SET(v)\n        A = A âˆª {(u,v)}\n        UNION(u,v)\nreturn A\n```\n#### Primç®—æ³•\n`Prim` ç®—æ³•æ¯ä¸€æ­¥åœ¨è¿æ¥é›†åˆ$A$å’Œ$A$ä¹‹å¤–çš„ç»“ç‚¹çš„æ‰€æœ‰è¾¹ä¸­ï¼Œé€‰æ‹©ä¸€æ¡è½»é‡çº§è¾¹åŠ å…¥åˆ°$A$ä¸­\n\nè¿é€šå›¾$G$å’Œæœ€å°ç”Ÿæˆæ ‘çš„æ ¹ç»“ç‚¹$r$å°†ä½œä¸ºç®—æ³•çš„è¾“å…¥ã€‚åœ¨ç®—æ³•çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæ‰€æœ‰**ä¸åœ¨**æ ‘$A$ä¸­çš„ç»“ç‚¹éƒ½å­˜æ”¾åœ¨ä¸€ä¸ªåŸºäº$key$å±æ€§çš„æœ€å°ä¼˜å…ˆé˜Ÿåˆ—$Q$ä¸­ã€‚å¯¹æ¯ä¸ªç»“ç‚¹$v$ï¼Œå±æ€§$v.key$ä¿å­˜çš„æ˜¯è¿æ¥$v$å’Œæ ‘ä¸­ç»“ç‚¹çš„æ‰€æœ‰è¾¹ä¸­æœ€å°è¾¹çš„æƒé‡ã€‚å±æ€§$v.\\pi$ç»™å‡ºçš„æ˜¯ç»“ç‚¹$v$åœ¨æ ‘ä¸­çš„çˆ¶ç»“ç‚¹\n\nè‹¥ä½¿ç”¨äºŒå‰æœ€å°ä¼˜å…ˆé˜Ÿåˆ—ï¼Œæ—¶é—´å¤æ‚åº¦$O(VlgV+ElgV)=O(ElgV)$ï¼›è‹¥ä½¿ç”¨æ–æ³¢é‚£å¥‘å †æ¥å®ç°æœ€å°ä¼˜å…ˆé˜Ÿåˆ—ï¼Œæ—¶é—´å¤æ‚åº¦$O(E+VlgV)$ï¼š\n```text\nMST-PRIM(G, w, r)\nfor each u in G.V\n    u.key = âˆ\n    u.Ï€ = NIL\nr.key = 0\nQ = G.V\nwhile Q != âˆ…\n    u = EXTRACT-MIN(Q)\n    for each v in G.Adj[u]\n    if v in Q and w(u,v)  < v.key\n        v.Ï€ = u\n        v.key = w(u,v)\n```\n### å•æºæœ€çŸ­è·¯å¾„\nåœ¨**æœ€çŸ­è·¯å¾„é—®é¢˜**ä¸­ï¼Œæˆ‘ä»¬ç»™å®šä¸€ä¸ªå¸¦æƒé‡çš„æœ‰å‘å›¾$G=(V,E)$å’Œæƒé‡å‡½æ•°$w: E\\rightarrow \\Reals$ï¼Œè¯¥æƒé‡å‡½æ•°å°†æ¯æ¡è¾¹æ˜ å°„åˆ°å®æ•°å€¼çš„æƒé‡ä¸Š\nå›¾ä¸­ä¸€æ¡è·¯å¾„$p=\\langle v_0,v_1,...,b_k \\rangle$çš„æƒé‡$w(p)$æ˜¯æ„æˆè¯¥è·¯å¾„çš„æ‰€æœ‰è¾¹çš„æƒé‡ä¹‹å’Œï¼š\n$$\nw(p)=\\sum^k_{i=1}w(v_{i-1},v_i)\n$$\n\nå®šä¹‰ä»ç»“ç‚¹a$u$åˆ°ç»“ç‚¹$v$çš„**æœ€çŸ­è·¯å¾„æƒé‡**$\\delta(u,v)$å¦‚ä¸‹ï¼š\n$$\n\\delta(u,v)\\leq\n\\begin{cases}\nmin\\{w(p):u \\leadsto^p v \\} \\qquad & if \\ exists \\ a\\ path\\ from\\ u \\ to \\ v \\\\\n\\infty \\qquad  & other\n\\end{cases} \n$$\nä»ç»“ç‚¹$u$åˆ°ç»“ç‚¹$v$çš„**æœ€çŸ­è·¯å¾„**å®šä¹‰ä¸ºä»»ä½•ä¸€æ¡æƒé‡ä¸º$w(p)=\\delta(w,v)$çš„ä»$u$åˆ°$v$çš„è·¯å¾„$p$\n#### å¸¸è§„æ¦‚å¿µ\n##### è´Ÿæƒé‡çš„è¾¹\nå¦‚æœå›¾$G=(V,E)$ä¸åŒ…å«ä»æºç»“ç‚¹$s$å¯ä»¥åˆ°è¾¾çš„æƒé‡ä¸ºè´Ÿå€¼çš„ç¯è·¯ï¼Œåˆ™å¯¹äºæ‰€æœ‰çš„ç»“ç‚¹$v \\in V$ï¼Œæœ€çŸ­è·¯å¾„æƒé‡$\\delta(s,v)$éƒ½æœ‰ç²¾ç¡®å®šä¹‰ï¼Œå³ä½¿å…¶å–å€¼ä¸ºè´Ÿæ•°\nå¦‚æœå›¾$G$åŒ…å«ä»$s$å¯ä»¥è¾¾åˆ°çš„æƒé‡ä¸ºè´Ÿå€¼çš„ç¯è·¯ï¼Œåˆ™æœ€çŸ­è·¯å¾„æƒé‡æ— å®šä¹‰\n##### ç¯è·¯\næœ€çŸ­è·¯å¾„ä¸èƒ½åŒ…å«æƒé‡ä¸ºè´Ÿå€¼çš„ç¯è·¯\næœ€çŸ­è·¯å¾„ä¸èƒ½åŒ…å«æƒé‡ä¸ºæ­£å€¼çš„ç¯è·¯\n##### æœ€çŸ­è·¯å¾„çš„è¡¨ç¤º\n$\\pi$å€¼æ‰€è¯±å¯¼çš„**å‰é©±å­å›¾**$G_\\pi=(V_\\pi,E_\\pi)$å®šä¹‰å¦‚ä¸‹ï¼š\n$$V_\\pi = \\{v\\in V:v.\\pi \\neq NIL\\} \\cup \\{s\\}$$\n\n$$E_\\pi = \\{(v.\\pi,v) \\in E:v \\in V_\\pi - \\{s\\}\\}$$\n\nåœ¨ç®—æ³•ç»ˆæ­¢æ—¶ï¼Œ$G_\\pi$æ˜¯ä¸€æ£µ**æœ€çŸ­è·¯å¾„æ ‘**\næœ€çŸ­è·¯å¾„ä¸ä¸€å®šæ˜¯å”¯ä¸€çš„ï¼Œæœ€çŸ­è·¯å¾„æ ‘ä¹Ÿä¸ä¸€å®šæ˜¯å”¯ä¸€çš„\n##### æ¾å¼›æ“ä½œ\nå¯¹äºæ¯ä¸ªç»“ç‚¹$v$ï¼Œæˆ‘ä»¬ç»´æŒä¸€ä¸ªå±æ€§$v.d$æ¥è®°å½•ä»åŸç»“ç‚¹$s$åˆ°ç»“ç‚¹$v$çš„æœ€çŸ­è·¯å¾„æƒé‡çš„ä¸Šç•Œã€‚æˆ‘ä»¬ç§°$v.d$ä¸º$s$åˆ°$v$çš„**æœ€çŸ­è·¯å¾„ä¼°è®¡**ã€‚æˆ‘ä»¬ä½¿ç”¨ä¸‹é¢è¿è¡Œæ—¶é—´ä¸º$\\Theta(V)$çš„ç®—æ³•æ¥å¯¹æœ€çŸ­è·¯å¾„ä¼°è®¡å’Œå‰é©±ç»“ç‚¹è¿›è¡Œåˆå§‹åŒ–ï¼š\n```text\nINITIALIZE-SINGLE-SOURCE(G, s)\nfor each vertex v in G.V\n    v.d = âˆ\n    v.Ï€ = NIL\ns.d = 0\n```\n`RELAX` è¿‡ç¨‹å¯¹è¾¹$(u,v)$åœ¨$O(1)$æ—¶é—´å†…è¿›è¡Œæ¾å¼›æ“ä½œï¼š\n```text\nRELAX(u, v, w)\nif v.d > u.d + w(u,v)\n    v.d = u.d + w(u,v)\n    v.Ï€ = u\n```\n##### æœ€çŸ­è·¯å¾„å’Œæ¾å¼›æ“ä½œçš„æ€§è´¨\n**ä¸‰è§’ä¸ç­‰å¼æ€§è´¨**ï¼šå¯¹äºä»»ä½•è¾¹$(u,v) \\in E$ï¼Œæœ‰$\\delta(s,v) \\leq \\delta(s,u)+w(u,v)$\n**ä¸Šç•Œæ€§è´¨**ï¼šå¯¹äºæ‰€æœ‰çš„ç»“ç‚¹$v \\in V$ï¼Œæœ‰$v.d \\geq \\delta(s,v)$ã€‚ä¸€æ—¦$v.d$çš„å–å€¼è¾¾åˆ°$\\delta(s,v)$ï¼Œå…¶å€¼å°†ä¸å†å‘ç”Ÿå˜åŒ–\n**éè·¯å¾„æ€§è´¨**ï¼šå¦‚æœä»ç»“ç‚¹$s$åˆ°ç»“ç‚¹$v$ä¹‹é—´ä¸å­˜åœ¨è·¯å¾„ï¼Œåˆ™æœ‰$v.d=\\delta(s,v)=\\infty$\n**æ”¶æ•›æ€§è´¨**ï¼šå¯¹äºæŸäº›ç»“ç‚¹$u,v \\in V$ï¼Œå¦‚æœ$s \\leadsto u \\rightarrow v$æ˜¯å›¾$G$ä¸­çš„ä¸€æ¡æœ€çŸ­è·¯å¾„ï¼Œå¹¶ä¸”åœ¨å¯¹è¾¹$(u,v)$è¿›è¡Œæ¾å¼›å‰çš„ä»»æ„æ—¶é—´æœ‰$u.d=\\delta(s,u)$ï¼Œåˆ™åœ¨ä¹‹åçš„æ‰€æœ‰æ—¶é—´æœ‰$v.d=\\delta(s,v)$\n**è·¯å¾„æ¾å¼›æ€§è´¨**ï¼šå¦‚æœ$p=\\langle v_0,v_1,...,v_k \\rangle$æ˜¯ä»æºç»“ç‚¹$s=v_0$åˆ°ç»“ç‚¹$v_k$çš„ä¸€æ¡æœ€çŸ­è·¯å¾„ï¼Œä¸”å¯¹$p$ä¸­çš„è¾¹æ‰€è¿›è¡Œçš„æ¾å¼›çš„æ¬¡åºä¸º$(v_0,v_1)$ï¼Œ$(v_1,v_2)$ï¼Œ...ï¼Œ$(v_{k-1},v_k)$ï¼Œåˆ™$v_k.d=\\delta(s,v_k)$ï¼Œè¯¥æ€§è´¨çš„æˆç«‹ä¸ä»»ä½•å…¶ä»–çš„æ¾å¼›æ“ä½œæ— å…³ï¼Œå³ä½¿è¿™äº›æ¾å¼›æ“ä½œæ˜¯ä¸å¯¹$p$ä¸Šçš„è¾¹æ‰€è¿›è¡Œçš„æ¾å¼›æ“ä½œæ˜¯ç©¿æ’è¿›è¡Œçš„\n#### Bellman-Fordç®—æ³•\n`Bellman-Ford` ç®—æ³•è§£å†³ä¸€èˆ¬æƒ…å†µä¸‹çš„å•å…ƒæœ€çŸ­è·¯å¾„é—®é¢˜ï¼Œè¾¹çš„æƒé‡å¯ä»¥ä¸ºè´Ÿå€¼\n`Bellman-Ford` ç®—æ³•è¿”å› `TRUE` å€¼å½“ä¸”ä»…å½“è¾“å…¥å›¾ä¸åŒ…å«å¯ä»¥ä»æºç»“ç‚¹åˆ°è¾¾çš„æƒé‡ä¸ºè´Ÿå€¼çš„ç¯è·¯ï¼š\n```text\nBELLMAN-FORD(G, w, s)\nINITIALIZE-SINGLE-SOURCE(G, s)\nfor i = 1 to |G.V| - 1\n    for each edge(u,v) in G.E\n        RELAX(u, v, w)\nfor each edge(u,v) in G.E\n    if v.d > u.d + w(u,v)\n        return FALSE\nreturn TRUE\n```\n`Bellman-Ford` ç®—æ³•æ€»è¿è¡Œæ—¶é—´$O(VE)$\n#### æœ‰å‘æ— ç¯å›¾ä¸­çš„å•æºæœ€çŸ­è·¯å¾„é—®é¢˜\næ ¹æ®ç»“ç‚¹çš„æ‹“æ‰‘æ’åºæ¬¡åºæ¥å¯¹å¸¦æƒé‡çš„æœ‰å‘æ— ç¯å›¾$G=(V,E)$è¿›è¡Œè¾¹çš„æ¾å¼›æ“ä½œï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥åœ¨$O(V,E)$æ—¶é—´å†…è®¡ç®—å‡ºä»å•ä¸ªæºç»“ç‚¹åˆ°æ‰€æœ‰ç»“ç‚¹ä¹‹é—´çš„æœ€çŸ­è·¯å¾„ï¼š\n```text\nDAG-SHORTEST-PATHS(G, w, s)\ntopologically sort the vertices of G\nINITIALIZE-SINGLE-SOURCE(G, s)\nfor each vertex u, taken in topologically sorted order\n    for each vertex v in G.Adj[u]\n    RELAX(u, v, w)\n```\n#### Dijkstraç®—æ³•\n`Dijkstra` ç®—æ³•è¦æ±‚æ‰€æœ‰è¾¹çš„æƒé‡éƒ½ä¸ºéè´Ÿå€¼ï¼š\n```text\nDIJKSTRA(G, w, s)\nINITIALIZE-SINGLE-SOURCE(G, s)\nS = âˆ…\nQ = G.V\nwhile Q != âˆ…\n    u = EXTRACT-MIN(Q)\n    S = S âˆª {u}\n    for each vertex v in G.Adj[u]\n        RELAX(u, v, w)\n```\n`Dijkstra` ç®—æ³•æ€»è¿è¡Œæ—¶é—´ä¾èµ–äºæœ€å°ä¼˜å…ˆé˜Ÿåˆ—çš„å®ç°ï¼š\n- é€šè¿‡åˆ©ç”¨ç»“ç‚¹çš„ç¼–å·ä¸º$1 - |V|$æ¥ç»´æŒæœ€å°ä¼˜å…ˆé˜Ÿåˆ—ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ¯æ¬¡ `INSERT` å’Œ `DECREASE-KEY` æ“ä½œçš„æ‰§è¡Œæ—¶é—´ä¸º$O(1)$ï¼Œæ¯æ¬¡ `EXTRACT-MIN` çš„æ“ä½œæ—¶é—´ä¸º$O(V)$ï¼Œç®—æ³•æ€»è¿è¡Œæ—¶é—´ä¸º$O(V^2+E)=O(V^2)$\n- è‹¥å›¾ä¸ºç¨€ç–å›¾ï¼Œç‰¹åˆ«åœ°ï¼Œå¦‚æœ$E=o(V^2/lgV)$ï¼Œåˆ™å¯ä»¥é€šè¿‡äºŒå‰å †æ¥å®ç°æœ€å°ä¼˜å…ˆé˜Ÿåˆ—ï¼Œæ¯æ¬¡ `EXTRACT-MIN` çš„æ“ä½œæ—¶é—´ä¸º$O(lgV)$ï¼Œæ¯æ¬¡ `DECREASE-KEY` çš„æ“ä½œæ—¶é—´ä¸º$O(lgV)$ï¼Œæ„å»ºæœ€å°äºŒå‰å †çš„æˆæœ¬ä¸º$O(V)$ï¼Œç®—æ³•æ€»è¿è¡Œæ—¶é—´ä¸º$O((V+E)lgV)$ã€‚è‹¥æ‰€æœ‰ç»“ç‚¹éƒ½å¯ä»¥ä»æºç»“ç‚¹åˆ°è¾¾ï¼Œåˆ™è¯¥æ—¶é—´ä¸º$O(ElgV)$\n- è‹¥ä½¿ç”¨æ–æ³¢é‚£å¥‘å †æ¥æ—¶é—´æœ€å°ä¼˜å…ˆé˜Ÿåˆ—ï¼Œæ¯æ¬¡ `EXTRACT-MIN` çš„æ“ä½œæ—¶é—´ä¸º$O(lgV)$ï¼Œæ¯æ¬¡ `DECREASE-KEY` çš„æ“ä½œæ—¶é—´ä¸º$O(1)$ï¼Œç®—æ³•æ€»è¿è¡Œæ—¶é—´ä¸º$O(VlgV+E)$\n#### å·®åˆ†çº¦æŸå’Œæœ€çŸ­è·¯å¾„\n##### å·®åˆ†çº¦æŸç³»ç»Ÿ\nè®¾å‘é‡$x=(x_1,x_2,...,x_n)$ä¸ºå·®åˆ†çº¦æŸç³»ç»Ÿ$Ax \\leq b$çš„ä¸€ä¸ªè§£ï¼Œè®¾$d$ä¸ºä»»æ„å¸¸æ•°ï¼Œåˆ™$x+d=(x_1+d,x_2+d,...,x_n+d)$ä¹Ÿæ˜¯è¯¥å·®åˆ†çº¦æŸç³»ç»Ÿçš„ä¸€ä¸ªè§£\n##### çº¦æŸå›¾\nç»™å®šå·®åˆ†çº¦æŸç³»ç»Ÿ$Ax \\leq b$ï¼Œå…¶å¯¹åº”çš„**çº¦æŸå›¾**æ˜¯ä¸€ä¸ªå¸¦æƒé‡çš„æœ‰å‘å›¾$G=(V,E)$ï¼Œè¿™é‡Œï¼š\n$$V=\\{v_0,v_1,...,v_n\\}$$\n\n$$E=\\{(v_i,v_j):v_j-v_i \\leq b_k\\text{æ˜¯ä¸€ä¸ªçº¦æŸæ¡ä»¶}\\} \\cup \\{(v_0,v_1),(v_0,v_2),...(v_0,v_n)\\}$$\n\n- çº¦æŸå›¾åŒ…å«ä¸€ä¸ªé¢å¤–çš„ç»“ç‚¹$v_0$ï¼Œç”¨æ¥ä¿è¯å›¾ä¸­è‡³å°‘å­˜åœ¨ä¸€ä¸ªç»“ç‚¹ï¼Œä»å…¶å‡ºå‘å¯ä»¥åˆ°è¾¾æ‰€ä»¥å…¶ä»–çš„ç»“ç‚¹\n- å¦‚æœ$x_j-x_i \\leq b_k$æ˜¯ä¸€ä¸ªå·®åˆ†çº¦æŸæ¡ä»¶ï¼Œåˆ™è¾¹$(v_i,v_j)$çš„æƒé‡ä¸º$w(v_i,v_j)=b_k$\n- æ‰€æœ‰ä»ç»“ç‚¹$v_0$å‘å‡ºçš„è¾¹çš„æƒé‡ä¸º0\n\nç»™å®šå·®åˆ†çº¦æŸç³»ç»Ÿ$Ax \\leq b$ï¼Œè®¾$G=(V,E)$æ˜¯è¯¥å·®åˆ†çº¦æŸç³»ç»Ÿæ‰€å¯¹åº”çš„çº¦æŸå›¾ã€‚å¦‚æœå›¾$G$ä¸åŒ…å«æƒé‡ä¸ºè´Ÿå€¼çš„ç¯è·¯ï¼Œåˆ™ï¼š\n$$x=(\\delta(v_0,v_1),\\delta(v_0,v_2),...,\\delta(v_0,v_n))$$\n\næ˜¯è¯¥ç³»ç»Ÿçš„ä¸€ä¸ªå¯è¡Œè§£ã€‚å¦‚æœå›¾$G$åŒ…å«æƒé‡ä¸ºè´Ÿå€¼çš„ç¯è·¯ï¼Œåˆ™è¯¥ç³»ç»Ÿæ²¡æœ‰å¯è¡Œè§£\n##### æ±‚è§£å·®åˆ†çº¦æŸç³»ç»Ÿ\nä¸€ä¸ªæœ‰$n$ä¸ªæœªçŸ¥å˜é‡å’Œ$m$ä¸ªçº¦æŸæ¡ä»¶çš„å·®åˆ†çº¦æŸç³»ç»Ÿæ‰€ç”Ÿæˆçš„çº¦æŸå›¾æœ‰$n+1$ä¸ªç»“ç‚¹å’Œ$m+n$æ¡è¾¹ã€‚ä½¿ç”¨ `Bellman-Ford` ç®—æ³•å¯ä»¥åœ¨$O((n+1)(m+n)) = O(n^2+mn)$æ—¶é—´å†…æ±‚è§£è¯¥ç³»ç»Ÿ\n\n### æ‰€æœ‰ç»“ç‚¹å¯¹çš„æœ€çŸ­è·¯å¾„\nå‡å®šç»“ç‚¹çš„ç¼–å·ä¸º$1,2,...,|V|$ï¼Œå› æ­¤ï¼Œç®—æ³•çš„è¾“å…¥å°†æ˜¯ä¸€ä¸ª$n \\times n$çš„çŸ©é˜µ$W$ï¼Œè¯¥çŸ©é˜µä»£è¡¨çš„æ˜¯ä¸€ä¸ªæœ‰$n$ä¸ªç»“ç‚¹çš„æœ‰å‘å›¾$G=(V,E)$çš„è¾¹çš„æƒé‡ï¼Œå³$W=(w_{ij})$ï¼Œå…¶ä¸­ï¼š\n$$\nw_{ij} =\n\\begin{cases}\n0 \\qquad & i=j \\\\\nw_{ij} \\qquad & i \\neq j \\land (i,j) \\in E \\\\\n\\infty \\qquad & i \\neq j \\land (i,j) \\notin E\n\\end{cases} \n$$\n\næˆ‘ä»¬å…è®¸å­˜åœ¨è´Ÿæƒé‡çš„è¾¹ï¼Œä½†å‡å®šå›¾ä¸­ä¸åŒ…æ‹¬æƒé‡ä¸ºè´Ÿå€¼çš„ç¯è·¯\n\næ‰€æœ‰ç»“ç‚¹å¯¹æœ€çŸ­è·¯å¾„ç®—æ³•çš„è¡¨æ ¼è¾“å‡ºä¹Ÿæ˜¯ä¸€ä¸ª$n \\times n$çš„çŸ©é˜µ$D=(d_{ij})$ï¼Œå…¶ä¸­$d_{ij}$ä»£è¡¨çš„æ˜¯ä»ç»“ç‚¹$i$åˆ°ç»“ç‚¹$j$çš„ä¸€æ¡æœ€çŸ­è·¯å¾„çš„æƒé‡\nå‰é©±ç»“ç‚¹çŸ©é˜µ$\\Pi =(\\pi_{ij})$ï¼Œå…¶ä¸­$\\pi_{ij}$åœ¨$i=j$æˆ–ä»$i$åˆ°$j$ä¸å­˜åœ¨è·¯å¾„æ—¶ä¸º$NIL$ï¼Œåœ¨å…¶ä»–æƒ…å†µä¸‹ç»™å‡ºçš„æ˜¯ä»ç»“ç‚¹$i$åˆ°ç»“ç‚¹$j$çš„æŸæ¡æœ€çŸ­è·¯å¾„ä¸Šç»“ç‚¹$j$çš„å‰é©±ç»“ç‚¹ã€‚ç”±çŸ©é˜µ$\\Pi$çš„ç¬¬$i$è¡Œæ‰€è¯±å¯¼çš„å­å›¾ä¸€ä¸ªæ˜¯ä¸€æ£µæ ¹ç»“ç‚¹ä¸º$i$çš„æœ€çŸ­è·¯å¾„æ ‘ã€‚å¯¹äºæ¯ä¸ªç»“ç‚¹$i \\in V$ï¼Œå®šä¹‰å›¾$G$å¯¹äºç»“ç‚¹$i$çš„å‰é©±å­å›¾ä¸º$G_{\\pi,i}=(V_{\\pi,i},E_{\\pi,i})$ï¼Œå…¶ä¸­ï¼š\n$$V_{\\pi,i}=\\{j\\in V:\\pi_{ij} \\neq NIL\\} \\cup \\{i\\} \\qquad E_{\\pi,i}=\\{(\\pi_{ij},j):j\\in V_{\\pi,i}-\\{i\\}\\}$$\n\nå¦‚æœ$G_{\\pi,i}$æ˜¯ä¸€æ£µæœ€çŸ­è·¯å¾„æ ‘ï¼Œåˆ™ä¸‹é¢çš„è¿‡ç¨‹å°†æ‰“å°å‡ºä»ç»“ç‚¹$i$åˆ°ç»“ç‚¹$j$çš„ä¸€æ¡æœ€çŸ­è·¯å¾„ï¼š\n```text\nPRINT-ALL-PAIRS-SHORTEST-PATH(Î , i, j)\nif i == j\n    print i\nelseif Ï€_{ij} == NIL\n    print \"no path from\" i \"to\" j \"exists\"\nelse\n    PRINT-ALL-PAIRS-SHORTEST-PATH(Î , i, Ï€_{ij})\n    print j\n```\n#### æœ€çŸ­è·¯å¾„å’ŒçŸ©é˜µä¹˜æ³•\n##### æœ€çŸ­è·¯å¾„çš„ç»“æ„\nè€ƒè™‘ä»ç»“ç‚¹$i$åˆ°ç»“ç‚¹$j$çš„ä¸€æ¡æœ€çŸ­è·¯å¾„$p$ï¼Œå‡å®š$p$è‡³å¤šåŒ…å«$m$æ¡è¾¹ï¼Œè¿˜å‡å®šæ²¡æœ‰æƒé‡ä¸ºè´Ÿå€¼çš„ç¯è·¯ï¼Œä¸”$m$ä¸ºæœ‰é™å€¼ã€‚å¦‚æœ$i=j$ï¼Œåˆ™$p$çš„æƒé‡ä¸º0ä¸”ä¸åŒ…å«ä»»ä½•è¾¹ã€‚å¦‚æœç»“ç‚¹$i$å’Œç»“ç‚¹$j$ä¸åŒï¼Œåˆ™å°†è·¯å¾„åˆ†è§£ä¸º$i \\leadsto^{p'}k \\rightarrow j$ï¼Œå…¶ä¸­è·¯å¾„$p'$è‡³å¤šåŒ…å«$m-1$æ¡è¾¹ï¼Œåˆ™æœ‰ï¼š\n$$\\delta(i,j)=\\delta(i,k)+w_{kj}$$\n##### æ‰€æœ‰ç»“ç‚¹å¯¹æœ€çŸ­è·¯å¾„é—®é¢˜çš„é€’å½’è§£\nè®¾$l^{(m)}_{ij}$ä¸ºä»ç»“ç‚¹$i$åˆ°ç»“ç‚¹$j$çš„è‡³å¤šåŒ…å«$m$æ¡è¾¹çš„ä»»æ„è·¯å¾„ä¸­çš„æœ€å°æƒé‡ã€‚å½“$m=0$æ—¶ï¼Œä»ç»“ç‚¹$i$åˆ°ç»“ç‚¹$j$ä¹‹é—´å­˜åœ¨ä¸€æ¡æ²¡æœ‰è¾¹çš„æœ€çŸ­è·¯å¾„å½“ä¸”ä»…å½“$i=j$ï¼Œå› æ­¤æœ‰ï¼š\n$$\nl^{(m)}_{ij} =\n\\begin{cases}\n0 \\qquad & i=j \\\\\n\\infty \\qquad & i \\neq j \n\\end{cases} \n$$\n\né€’å½’å®šä¹‰ï¼š\n$$\nl^{(m)}_{ij} = min\\{l^{(m-1)}_{ij},min_{1 \\leq k \\leq n}\\{l^{(m-1)}_{ij} +w_{kj}\\}\\} = min_{1 \\leq k \\leq n}\\{l^{(m-1)}_{ij} + w_{kj}\\}\n$$\n\næœ€çŸ­è·¯å¾„æƒé‡å¯ä»¥ç”±ä¸‹é¢çš„å…¬å¼ç»™å‡ºï¼š\n$$\n\\delta(i,j)=l^{(n-1)}_{ij}=l^{(n)}_{ij}=l^{(n+1)}_{ij} = ...\n$$\n##### è‡ªåº•å‘ä¸Šè®¡ç®—æœ€çŸ­è·¯å¾„æƒé‡\n`EXTEND-SHORTEST-PATHS` è¿‡ç¨‹å¯ä»¥åœ¨ç»™å®š$w$å’Œ$L^{(m-1)}$çš„æƒ…å†µä¸‹ï¼Œè®¡ç®—å‡º$L^{(m)}$ï¼Œç®—æ³•è¿è¡Œæ—¶é—´$\\Theta(n^3)$ï¼š\n```text\nEXTEND-SHORTEST-PATHS(L, W)\nn = L.rows\nlet L' = (l'_{ij}) be a new n * n matrix\nfor i = 1 to n\n    for j = 1 to n\n        l'_{ij} = âˆ\n        for k = 1 to n\n            l'_{ij} = min(l'_{ij}, l_{ik} + w_{kj})\nreturn L'\n```\nè®¾$A \\cdot B$è¡¨ç¤ºç”±ç®—æ³• `EXTEND-SHORTEST-PATHS(A, B)` æ‰€è¿”å›çš„çŸ©é˜µâ€œä¹˜ç§¯â€ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—å‡ºä¸‹é¢ç”±$n-1$ä¸ªçŸ©é˜µæ‰€æ„æˆçš„çŸ©é˜µåºåˆ—ï¼š\n$L^{(1)} = L^{(0)} \\cdot W = W$\n$L^{(2)} = L^{(1)} \\cdot W = W^2$\n$L^{(3)} = L^{(2)} \\cdot W = W^3$\n...\n$L^{(n-1)} = L^{(n-2)} \\cdot W = W^{n-1}$\n\n`SLOW-ALL-PAIRS-SHORTEST-PATHS` è¿‡ç¨‹å¯ä»¥åœ¨$\\Theta(n^4)$çš„æ—¶é—´å†…è®¡ç®—å‡ºçŸ©é˜µ$L^{(n-1)} = W^{n-1}$ï¼š\n```text\nSLOW-ALL-PAIRS-SHORTEST-PATHS(W)\nn = W.rows\nL(1) = W\nfor m = 2 to n-1\n    let L(m) be a new n * n matrix\n    L(m) = EXTEND-SHORTEST-PATHS(L(m-1), W)\nreturn L(n-1)\n```\nå¯ä»¥ä»…ç”¨$\\lceil lg(n-1) \\rceil$ä¸ªçŸ©é˜µä¹˜ç§¯æ¥è®¡ç®—çŸ©é˜µ$L^{(n-1)}$ï¼š\n$L^{(1)} = W$\n$L^{(2)} = W^2 = W \\cdot W$\n$L^{(4)} = W^4 = W^2 \\cdot W^2$\n$L^{(8)} = W^8 = W^4 \\cdot W^4$\n...\n$L^{(2^{\\lceil lg(n-1) \\rceil})} = W^{2^{\\lceil lg(n-1) \\rceil}} = W^{2^{\\lceil lg(n-1) \\rceil-1}} \\cdot W^{2^{\\lceil lg(n-1) \\rceil-1}}$\nç”±äº$2^{\\lceil lg(n-1) \\rceil}\\geq n-1$ï¼Œæœ€åæœ‰$L^{(2^{\\lceil lg(n-1) \\rceil})}=L^{(n-1)}$\n`FASTER-ALL-PAIRS-SHORTEST-PATHS` è¿‡ç¨‹ä½¿ç”¨é‡å¤å¹³æ–¹æŠ€æœ¯æ¥è®¡ç®—ä¸Šè¿°çŸ©é˜µåºåˆ—ï¼Œè¿è¡Œæ—¶é—´ä¸º$\\Theta(n^3lgn)$ï¼š\n```text\nFASTER-ALL-PAIRS-SHORTEST-PATHS(W)\nn = W.rows\nL(1) = W\nm = 1\nwhile m < n-1\n    let L(2m) be a new n * n matrix\n    L(2m) = EXTEND-SHORTEST-PATHS(L(m), L(m))\nreturn L(m)\n```\n#### Floyd-Warshallç®—æ³•\n##### æ‰€æœ‰ç»“ç‚¹å¯¹æœ€çŸ­è·¯å¾„é—®é¢˜çš„ä¸€ä¸ªé€’å½’è§£\nè®¾$d^{(k)}_{ij}$ä¸ºä»ç»“ç‚¹$i$åˆ°ç»“ç‚¹$j$çš„æ‰€æœ‰ä¸­é—´ç»“ç‚¹å…¨éƒ¨å–è‡ªé›†åˆ$\\{1,2,...,k\\}$çš„ä¸€æ¡æœ€çŸ­è·¯å¾„çš„æƒé‡ã€‚é€’å½’å®šä¹‰$d^{(k)}_{ij}$å¦‚ä¸‹ï¼š\n$$\nd^{(k)}_{ij} =\n\\begin{cases}\nw_{ij} \\qquad & k=0 \\\\\nmin(d^{(k-1)}_{ij},d^{(k-1)}_{ik}+d^{(k-1)}_{kj}) \\qquad & k \\geq 1\n\\end{cases} \n$$\n\nçŸ©é˜µ$D^{(n)} = (d^{(n)}_{ij})$ç»™å‡ºçš„å°±æ˜¯æœ€åçš„ç­”æ¡ˆï¼šå¯¹äºæ‰€æœ‰çš„$i,j \\in V$ï¼Œ$d^{(n)}_{ij}=\\delta(i,j)$\n##### è‡ªåº•å‘ä¸Šè®¡ç®—æœ€çŸ­è·¯å¾„æƒé‡\n`FLOYD-WARSHALL` ç®—æ³•çš„è¾“å…¥ä¸ºä¸€ä¸ª$n \\times n$çš„çŸ©é˜µ$W$ï¼Œè¿”å›æœ€çŸ­è·¯å¾„æƒé‡çŸ©é˜µ$D^{(n)}$ï¼Œè¿è¡Œæ—¶é—´ä¸º$\\Theta(V^3)$ï¼š\n```text\nFLOYD-WARSHALL(W)\nn = W.rows\nD(0) = W\nfor k = 1 to n\n    let D(k) = (d(k)_{ij}) be a new n * n matrix\n    for i = 1 to n\n        for j = 1 to n\n            d(k)_{ij} = min(d(k-1)_{ij},d(k-1)_{ik}+d(k-1)_{kj})\nreturn D(n)\n```\n##### æ„å»ºä¸€æ¡æœ€çŸ­è·¯å¾„\nåœ¨ `Floyd-Warshall` ç®—æ³•ä¸­ï¼Œæœ‰å¤šç§ä¸åŒçš„æ–¹æ³•æ¥æ„å»ºæœ€çŸ­è·¯å¾„\n- å…ˆè®¡ç®—æœ€çŸ­è·¯å¾„æƒé‡çŸ©é˜µ$D$ï¼Œç„¶åä»$D$çŸ©é˜µæ¥æ„é€ å‰é©±çŸ©é˜µ$\\Pi$\n- å¯ä»¥åœ¨è®¡ç®—çŸ©é˜µ$D^{(k)}$çš„åŒæ—¶è®¡ç®—å‰é©±çŸ©é˜µ$\\Pi$ã€‚å³è®¡ç®—ä¸€ä¸ªçŸ©é˜µåºåˆ—$\\Pi^{(0)}$ï¼Œ$\\Pi^{(1)}$ï¼Œ...ï¼Œ$\\Pi^{(n)}$ã€‚å®šä¹‰$\\pi^{(k)}_{ij}$ä¸ºä»ç»“ç‚¹$i$åˆ°ç»“ç‚¹$j$çš„ä¸€æ¡æ‰€æœ‰ä¸­é—´ç»“ç‚¹éƒ½å–è‡ªé›†åˆ$\\{1,2,...,k\\}$çš„æœ€çŸ­è·¯å¾„ä¸Š$j$çš„å‰é©±ç»“ç‚¹\n\nå½“$k=0$æ—¶ï¼Œä»$i$åˆ°$j$çš„ä¸€æ¡æœ€çŸ­è·¯å¾„æ²¡æœ‰ä¸­é—´ç»“ç‚¹ï¼Œå› æ­¤ï¼š\n$$\n\\pi^{(0)}_{ij} =\n\\begin{cases}\nNIL \\qquad & i=j \\lor w_{ij} = \\infty \\\\\ni \\qquad & i \\neq j \\land w_{ij} < \\infty\n\\end{cases} \n$$\n\nå¯¹äº$k \\geq 1$ï¼Œå¦‚æœè€ƒè™‘è·¯å¾„$i \\leadsto k \\leadsto j,k \\neq j$ï¼Œåˆ™æ‰€é€‰æ‹©çš„ç»“ç‚¹$j$çš„å‰é©±ä¸æˆ‘ä»¬é€‰æ‹©çš„ä»ç»“ç‚¹$k$åˆ°ç»“ç‚¹$j$çš„ä¸€æ¡ä¸­é—´ç»“ç‚¹å…¨éƒ¨å–è‡ªé›†åˆ$\\{1,2,...,k-1\\}$çš„æœ€çŸ­è·¯å¾„ä¸Šçš„å‰é©±æ˜¯ä¸€æ ·çš„ã€‚å¦åˆ™ï¼Œæ‰€é€‰æ‹©çš„ç»“ç‚¹$j$çš„å‰é©±ä¸é€‰æ‹©çš„ä»ç»“ç‚¹$i$åˆ°ç»“ç‚¹$j$çš„ä¸€æ¡ä¸­é—´ç»“ç‚¹å…¨éƒ¨å–è‡ªé›†åˆ$\\{1,2,...,k-1\\}$çš„æœ€çŸ­è·¯å¾„ä¸Šçš„å‰é©±æ˜¯ä¸€æ ·çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äº$k \\geq 1$ï¼Œæœ‰ï¼š\n$$\n\\pi^{(k)}_{ij} =\n\\begin{cases}\n\\pi^{(k-1)}_{ij} \\qquad & d^{(k-1)}_{ij} \\leq d^{(k-1)}_{ik}+d^{(k-1)}_{kj} \\\\\n\\pi^{(k-1)}_{kj} \\qquad & d^{(k-1)}_{ij}  >   d^{(k-1)}_{ik}+d^{(k-1)}_{kj}\n\\end{cases} \n$$\n##### æœ‰å‘å›¾çš„ä¼ é€’é—­åŒ…\nå®šä¹‰å›¾$G$çš„**ä¼ é€’é—­åŒ…**ä¸ºå›¾$G^*=(V,E^*)$ï¼Œå…¶ä¸­$E^*=\\{(i,j):å¦‚æœå›¾Gä¸­åŒ…å«ä¸€æ¡ä»ç»“ç‚¹iåˆ°ç»“ç‚¹jçš„è·¯å¾„\\}$\n\nä¸€ç§æ—¶é—´å¤æ‚åº¦ä¸º$\\Theta(n^3)$çš„è®¡ç®—å›¾$G$çš„ä¼ é€’é—­åŒ…çš„åŠæ³•æ˜¯ç»™$E$çš„æ¯æ¡è¾¹èµ‹äºˆæƒé‡1ï¼Œç„¶åè¿è¡Œ `Floyd-Warshall` ç®—æ³•ã€‚å¦‚æœå­˜åœ¨ä¸€æ¡ä»ç»“ç‚¹$i$åˆ°ç»“ç‚¹$j$çš„è·¯å¾„ï¼Œåˆ™æœ‰$d_{ij}<n$ï¼›å¦åˆ™$d_{ij}=\\infty$\n\nå¦ä¸€ç§ç±»ä¼¼åŠæ³•æ˜¯ï¼šä»¥é€»è¾‘æˆ–æ“ä½œï¼ˆ$\\lor$ï¼‰å’Œé€»è¾‘ä¸æ“ä½œï¼ˆ$\\land$ï¼‰æ¥æ›¿æ¢ `Floyd-Warshall` ç®—æ³•ä¸­çš„ç®—æœ¯æ“ä½œ `min` å’Œ `+`ï¼Œä»¥æ­¤èŠ‚çœæ—¶é—´å’Œç©ºé—´\n\nå¯¹äº$i,j,k=1,2,...,n$ï¼Œå®šä¹‰ï¼šå¦‚æœå›¾$G$ä¸­å­˜åœ¨ä¸€æ¡ä»ç»“ç‚¹$i$åˆ°ç»“ç‚¹$j$çš„æ‰€æœ‰ä¸­é—´ç»“ç‚¹éƒ½å–è‡ªé›†åˆ$\\{1,2,...,k\\}$çš„è·¯å¾„ï¼Œåˆ™$t^{(k)}_{ij}$ä¸º1ï¼›å¦åˆ™ï¼Œ$t^{(k)}_{ij}$ä¸º0ã€‚é€’å½’å®šä¹‰å¦‚ä¸‹ï¼š\n$$\nt^{(0)}_{ij} =\n\\begin{cases}\n0 \\qquad & i \\neq j \\land (i,j) \\notin E \\\\\n1 \\qquad & i = j \\lor (i,j) \\in E\n\\end{cases} \n$$\n\nå¯¹äº$k \\geq 1$ï¼š\n$$\nt^{(k)}_{ij} = t^{(k-1)}_{ij} \\lor (t^{(k-1)}_{ik} \\land t^{(k-1)}_{kj})\n$$\n```text\nTRANSITIVE-CLOSURE(G)\nn = |G.V|\nlet T(0) = (t(0)_{ij}) be a new n * n matrix\nfor i = 1 to n\n    for j = 1 to n\n        if i == j or (i,j) in G.E\n            t(0)_{ij} = 1\n        else\n            t(0)_{ij} = 0\nfor k = 1 to n\n    let T(k) = (t(k)_{ij}) be a new n * n matrix\n    for i = 1 to n\n        for j = 1 to n\n            t(k)_{ij} = t(k-1)_{ij} || (t(k-1)_{ik} && t(k-1)_{kj})\nreturn T(n)\n```\n#### ç”¨äºç¨€ç–å›¾çš„Johnsonç®—æ³•\n`Johnson` ç®—æ³•å¯ä»¥åœ¨$O(V^2lgV+VE)$æ—¶é—´å†…æ‰¾åˆ°æ‰€æœ‰ç»“ç‚¹å¯¹ä¹‹é—´çš„æœ€çŸ­è·¯å¾„\n\n`Johnson` ç®—æ³•ä½¿ç”¨çš„æŠ€æœ¯ç§°ä¸º**é‡æ–°èµ‹äºˆæƒé‡**ï¼š\nå¦‚æœå›¾$G=(V,E)$ä¸­æ‰€æœ‰çš„è¾¹æƒé‡$w$å‡ä¸ºéè´Ÿå€¼ï¼Œåˆ™å¯ä»¥é€šè¿‡å¯¹æ¯ä¸€ä¸ªç»“ç‚¹è¿è¡Œä¸€æ¬¡ `Dijkstra` ç®—æ³•æ¥æ‰¾åˆ°æ‰€æœ‰ç»“ç‚¹å¯¹ä¹‹é—´çš„æœ€çŸ­è·¯å¾„ï¼›å¦‚æœä½¿ç”¨æ–æ³¢é‚£å¥‘å †æœ€å°ä¼˜å…ˆé˜Ÿåˆ—ï¼Œè¯¥ç®—æ³•çš„è¿è¡Œæ—¶é—´$O(V^2lgV+VE)$\nå¦‚æœå›¾$G=(V,E)$åŒ…å«æƒé‡ä¸ºè´Ÿå€¼çš„è¾¹ï¼Œä½†æ²¡æœ‰æƒé‡ä¸ºè´Ÿå€¼çš„ç¯è·¯ï¼Œåˆ™åªè¦è®¡ç®—å‡ºä¸€ç»„æ–°çš„éè´Ÿæƒé‡å€¼ï¼Œç„¶åä½¿ç”¨åŒæ ·çš„æ–¹æ³•ã€‚æ–°èµ‹äºˆçš„æƒé‡$\\hat{w}$å¿…é¡»æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªé‡è¦æ€§è´¨ï¼š\n- å¯¹äºæ‰€æœ‰ç»“ç‚¹å¯¹$u,v \\in V$ï¼Œä¸€æ¡è·¯å¾„$p$æ˜¯åœ¨ä½¿ç”¨æƒé‡å‡½æ•°$w$æ—¶ä»ç»“ç‚¹$u$åˆ°ç»“ç‚¹$v$çš„ä¸€æ¡æœ€çŸ­è·¯å¾„ï¼Œå½“ä¸”ä»…å½“$p$æ˜¯åœ¨ä½¿ç”¨æƒé‡å‡½æ•°$\\hat{w}$æ—¶ä»$u$åˆ°$v$çš„ä¸€æ¡æœ€çŸ­è·¯å¾„\n- å¯¹äºæ‰€æœ‰çš„è¾¹$(u,v)$ï¼Œæ–°æƒé‡$\\hat{w}(u,v)$ä¸ºéè´Ÿå€¼\n\n##### é‡æ–°èµ‹äºˆæƒé‡æ¥ç»´æŒæœ€çŸ­è·¯å¾„\nç»™å®šå¸¦æƒé‡çš„æœ‰å‘å›¾$G=(V,E)$ï¼Œå…¶æƒé‡å‡½æ•°ä¸º$w:E \\rightarrow \\Reals$ï¼Œè®¾$h:V \\rightarrow \\Reals$ä¸ºä»»æ„å‡½æ•°ï¼Œè¯¥å‡½æ•°å°†ç»“ç‚¹æ˜ å°„åˆ°å®æ•°ä¸Šã€‚å¯¹äºæ¯æ¡è¾¹$(u,v) \\in E$ï¼Œå®šä¹‰ï¼š\n$$\n\\hat{w}(u,v)=w(u,v)+h(u)-h(v)\n$$\n\nè®¾$p=\\langle v_0,v_1,...,v_k \\rangle$ä¸ºä»ç»“ç‚¹$v_0$åˆ°ç»“ç‚¹$v_k$çš„ä»»æ„ä¸€æ¡ç†è§£ï¼Œé‚£ä¹ˆ$p$æ˜¯åœ¨ä½¿ç”¨æƒé‡å‡½æ•°$w$æ—¶ä»ç»“ç‚¹$v_0$åˆ°ç»“ç‚¹$v_k$çš„ä¸€æ¡æœ€çŸ­è·¯å¾„ï¼Œå½“ä¸”ä»…å½“$p$æ˜¯åœ¨ä½¿ç”¨æƒé‡å‡½æ•°$\\hat{w}$æ—¶ä»ç»“ç‚¹$v_0$åˆ°ç»“ç‚¹$v_k$çš„ä¸€æ¡æœ€çŸ­è·¯å¾„ï¼Œå³$w(p)=\\delta(v_0,v_k)$å½“ä¸”ä»…å½“$\\hat{w}(p)=\\hat{\\delta}(v_0,v_k)$ã€‚è€Œä¸”ï¼Œå›¾$G$åœ¨ä½¿ç”¨æƒé‡å‡½æ•°$w$æ—¶ä¸åŒ…å«æƒé‡ä¸ºè´Ÿå€¼çš„ç¯è·¯ï¼Œå½“ä¸”ä»…å½“$p$åœ¨ä½¿ç”¨æƒé‡å‡½æ•°$\\hat{w}$ä¹Ÿä¸åŒ…æ‹¬æƒé‡ä¸ºè´Ÿå€¼çš„ç¯è·¯ã€‚\n\n##### è®¡ç®—æ‰€æœ‰ç»“ç‚¹å¯¹ä¹‹é—´çš„æœ€çŸ­è·¯å¾„\n`Johnson` ç®—æ³•åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­éœ€è¦ä½¿ç”¨ `Bellman-Ford` ç®—æ³•å’Œ `Dijkstra` ç®—æ³•ä½œä¸ºå­ç¨‹åºæ¥è®¡ç®—æ‰€æœ‰ç»“ç‚¹å¯¹ä¹‹é—´çš„æœ€çŸ­è·¯å¾„ã€‚è¯¥ç®—ç®—å‡å®šæ‰€æœ‰çš„è¾¹éƒ½ä¿æŒåœ¨é‚»æ¥é“¾è¡¨é‡Œï¼Œå…¶è¿”å›ä¸€ä¸ª$|V| \\times |V|$çš„çŸ©é˜µ$D=d_{ij},d_{ij}=\\delta(i,j)$ï¼Œæˆ–è€…æŠ¥å‘Šè¾“å…¥å›¾åŒ…å«ä¸€ä¸ªæƒé‡ä¸ºè´Ÿå€¼çš„ç¯è·¯ï¼š\n```text\nJOHNSON(G, w)\ncompute G', where G'.V = G.V âˆª {s},\n    G'.E = G.E âˆª {(s,v):v in G.V} \n    and w(s,v) = 0 for all v in G.V \nif BELLMAN-FOLD(G', w, s) == FALSE\n    print \"the input graph contains a negative-weight cycle\"\nelse\n    for each vertex v in G'.V\n        set h(v) to the value of Î´(s, v) computed by the Bellman-Ford algorithm\n    for each edge(u, v) in G'.E\n        \\hat_w(u,v) = w(u,v) + h(u) - h(v)\n    let D = (d_{uv}) be a new n * n matrix\n    for each vertex u in G.V\n        run DIJKSTRA(G, \\hat_w, u) to compute \\hat_Î´(u, v) for all v in G.V\n        for each vertex v in G.V\n        d_{uv} = \\hat_Î´(u, v) + h(v) - h(u)\n    return D\n```\nå¦‚æœä½¿ç”¨æ–æ³¢é‚£å¥‘å †æ¥å®ç° `Dijkstra` ç®—æ³•é‡Œçš„æœ€å°ä¼˜å…ˆé˜Ÿåˆ—ï¼Œåˆ™ `Johnson` ç®—æ³•çš„è¿è¡Œæ—¶é—´ä¸º$O(V^2lgV+VE)$ï¼Œä½¿ç”¨æ›´ç®€å•çš„äºŒå‰æœ€å°å †å®ç°åˆ™è¿è¡Œæ—¶é—´ä¸º$O(VElgV)$\n### æœ€å¤§æµ\n#### æµç½‘ç»œ\n##### æµç½‘ç»œå’Œæµ\næµç½‘ç»œ$G=(V,E)$æ˜¯ä¸€ä¸ªæœ‰å‘å›¾ï¼Œå›¾ä¸­æ¯æ¡è¾¹$(u,v) \\in E$æœ‰ä¸€ä¸ªéè´Ÿçš„**å®¹é‡å€¼**$c(u,v) \\geq 0$\nå¦‚æœè¾¹é›†åˆ$E$åŒ…å«ä¸€æ¡è¾¹$(u,v)$ï¼Œåˆ™å›¾ä¸­ä¸å­˜åœ¨åæ–¹å‘çš„è¾¹$(v,u)$\nåœ¨å›¾ä¸­ä¸å…è®¸è‡ªå¾ªç¯ï¼Œå¯¹äºæ¯ä¸ªç»“ç‚¹$v \\in V$ï¼Œæµç½‘ç»œéƒ½åŒ…å«ä¸€æ¡è·¯å¾„$s \\leadsto v \\leadsto t$\næµç½‘ç»œå›¾æ˜¯è¿é€šçš„ï¼Œä¸”ç”±äºé™¤æºç»“ç‚¹å¤–çš„æ¯ä¸ªç»“ç‚¹éƒ½è‡³å°‘æœ‰ä¸€æ¡è¿›å…¥çš„è¾¹ï¼Œæœ‰$|E| \\geq |V|-1$\n\n![flowNetwork](https://d-sketon.top/img/clrs-book/14.png)\n\næµçš„å½¢å¼åŒ–å®šä¹‰ï¼š\nè®¾$G=(V,E)$ä¸ºä¸€ä¸ªæµç½‘ç»œï¼Œå…¶å®¹é‡å‡½æ•°ä¸º$c$ã€‚è®¾$s$ä¸ºç½‘ç»œçš„æºç»“ç‚¹ï¼Œ$t$ä¸ºæ±‡ç‚¹ã€‚$G$ä¸­çš„æµæ˜¯ä¸€ä¸ªå®å€¼å‡½æ•°$f$ï¼š$V \\times V \\rightarrow \\Reals$ï¼Œæ»¡è¶³ä¸‹é¢çš„ä¸¤æ¡æ€§è´¨ï¼š\n- **å®¹é‡é™åˆ¶**ï¼šå¯¹äºæ‰€æœ‰çš„ç»“ç‚¹$uï¼Œv \\in V$ï¼Œè¦æ±‚$0 \\leq f(u,v) \\leq c(u,v)$\n- **æµé‡å®ˆæ’**ï¼šå¯¹äºæ‰€æœ‰çš„ç»“ç‚¹$u \\in V- \\{s,t\\}$ï¼Œè¦æ±‚ï¼š\n$$\\sum_{v\\in V}f(u,v) = \\sum_{v\\in V}f(v,u) $$\n\nå½“$(u,v) \\notin E$æ—¶ï¼Œä»ç»“ç‚¹$u$åˆ°ç»“ç‚¹$v$ä¹‹é—´æ²¡æœ‰æµï¼Œå› æ­¤$f(u,v)=0$\n\nä¸€ä¸ªæµ$f$çš„å€¼$|f|$å®šä¹‰å¦‚ä¸‹ï¼š\n$$|f|=\\sum_{v \\in V}f(s,v)-\\sum_{v \\in V}f(v,s)$$\n#### Ford-Fulkersonæ–¹æ³•\n`Ford-Fulkerson` æ–¹æ³•å¾ªç¯å¢åŠ æµçš„å€¼ã€‚åœ¨å¼€å§‹çš„æ—¶å€™ï¼Œå¯¹äºæ‰€æœ‰çš„ç»“ç‚¹$u,v \\in V$ï¼Œ$f(u,v)=0$ï¼Œç»™å‡ºçš„åˆå§‹æµå€¼ä¸º0ã€‚åœ¨æ¯æ¬¡è¿­ä»£ä¸­ï¼Œæˆ‘ä»¬å°†å›¾$G$çš„æµå€¼è¿›è¡Œå¢åŠ ï¼Œæ–¹æ³•å°±æ˜¯åœ¨ä¸€ä¸ªå…³è”çš„**æ®‹å­˜ç½‘ç»œ**$G_f$ä¸­å¯»æ‰¾ä¸€æ¡**å¢å¹¿è·¯å¾„**ã€‚é‡å¤å¯¹æµè¿›è¡Œè¿™ä¸€è¿‡ç¨‹ï¼Œç›´åˆ°æ®‹å­˜ç½‘ç»œä¸­ä¸å†å¢åŠ å¢å¹¿è·¯å¾„ä¸ºæ­¢ï¼š\n```text\nFORD-FULKERSON-METHOD(G, s, t)\ninitialize flow f to 0\nwhile there exists an augmenting path p in the residual network Gf\n    augment flow f along p\nreturn f\n```\n##### æ®‹å­˜ç½‘ç»œ\næ®‹å­˜ç½‘ç»œç”±é‚£äº›ä»æœ‰ç©ºé—´å¯¹æµé‡è¿›è¡Œè°ƒæ•´çš„è¾¹æ„æˆã€‚æµç½‘ç»œçš„ä¸€æ¡è¾¹å¯ä»¥å…è®¸çš„é¢å¤–æµé‡ç­‰äºè¯¥è¾¹çš„å®¹é‡å‡å»è¯¥è¾¹ä¸Šçš„æµé‡ï¼š\n- å¦‚æœè¯¥å·®å€¼ä¸ºæ­£ï¼Œåˆ™å°†è¯¥æ¡è¾¹ç½®äºå›¾$G_f$ä¸­ï¼Œå¹¶å°†å…¶æ®‹å­˜å®¹é‡è®¾ç½®ä¸º$c_f(u,v)=c(u,v)-f(u,v)$ï¼›åŒæ—¶å°†è¾¹$(v,u)$åŠ å…¥åˆ°å›¾$G_f$ä¸­ï¼Œå¹¶å°†å…¶æ®‹å­˜å®¹é‡è®¾ç½®ä¸º$c_f(v,u)=f(u,v)$\n- å¦‚æœè¾¹$(u,v)$çš„æµé‡ç­‰äºå…¶å®¹é‡ï¼Œåˆ™å…¶$c_f(u,v)=0$ï¼Œè¯¥æ¡è¾¹å°†ä¸å±äºå›¾$G_f$\n\nå½¢å¼åŒ–åœ°ï¼Œå‡å®šæœ‰ä¸€ä¸ªæµç½‘ç»œ$G=(V,E)$ï¼Œå…¶æºç»“ç‚¹ä¸º$s$ï¼Œæ±‡ç‚¹ä¸º$t$ã€‚è®¾$f$ä¸ºå›¾$G$ä¸­çš„ä¸€ä¸ªæµï¼Œè€ƒè™‘ç»“ç‚¹å¯¹$u,v \\in V$ï¼Œå®šä¹‰**æ®‹å­˜å®¹é‡**$c_f(u,v)$ï¼š\n$$\nc_f(u,v) =\n\\begin{cases}\nc(u,v)-f(u,v) \\qquad & (u,v) \\in E\\\\\nf(v,u) \\qquad & (v,u) \\in E\\\\\n0 \\qquad & other\n\\end{cases} \n$$\n\nç»™å®šä¸€ä¸ªæµç½‘ç»œ$G=(V,E)$å’Œä¸€ä¸ªæµ$f$ï¼Œåˆ™ç”±$f$æ‰€è¯±å¯¼çš„å›¾$G$çš„**æ®‹å­˜ç½‘ç»œ**ä¸º$G_f=(V,E_f)$ï¼Œå…¶ä¸­ï¼š\n$$\nE_f = \\{(u,v) \\in V \\times V:c_f(u,v)>0\\}\n$$\n\nå¦‚æœ$f$æ˜¯$G$çš„ä¸€ä¸ªæµï¼Œ$f'$æ˜¯å¯¹åº”çš„æ®‹å­˜ç½‘ç»œ$G_f$ä¸­çš„ä¸€ä¸ªæµï¼Œå®šä¹‰$f \\uparrow f'$ä¸ºæµ$f'$å¯¹æµ$f$çš„é€’å¢ï¼Œå®ƒæ˜¯ä¸€ä¸ªä»$V \\times V \\rightarrow \\Reals$çš„å‡½æ•°ï¼Œå…¶å®šä¹‰å¦‚ä¸‹ï¼š\n$$\n(f \\uparrow f')(u,v) =\n\\begin{cases}\nf(u,v)+f'(u,v)-f'(v,u) \\qquad & (u,v) \\in E\\\\\n0 \\qquad & other\n\\end{cases} \n$$\n##### å¢å¹¿è·¯å¾„\nç»™å®šæµç½‘ç»œ$G=(V,E)$å’Œæµ$f$ï¼Œå¢å¹¿è·¯å¾„$p$æ˜¯æ®‹å­˜ç½‘ç»œ$G_f$ä¸­ä¸€æ¡ä»æºç»“ç‚¹$s$åˆ°æ±‡ç‚¹$t$çš„ç®€å•è·¯å¾„\næˆ‘ä»¬ç§°åœ¨ä¸€æ¡å¢å¹¿è·¯å¾„$p$ä¸Šèƒ½å¤Ÿä¸ºæ¯æ¡è¾¹å¢åŠ çš„æµé‡çš„æœ€å¤§å€¼ä¸ºè·¯å¾„$p$çš„**æ®‹å­˜å®¹é‡**ï¼Œè¯¥å®¹é‡ç”±ä¸‹é¢çš„è¡¨è¾¾å¼ç»™å‡ºï¼š\n$$\nc_f(p)=min\\{c_f(u,v):(u,v)\\text{å±äºè·¯å¾„}p\\}\n$$\n\n##### æµç½‘ç»œçš„åˆ‡å‰²\næµç½‘ç»œ$G=(V,E)$ä¸­çš„ä¸€ä¸ªåˆ‡å‰²$(S,T)$å°†ç»“ç‚¹é›†åˆ$V$åˆ’åˆ†ä¸º$S$å’Œ$T=V-S$ä¸¤ä¸ªé›†åˆï¼Œä½¿å¾—$s \\in S$ï¼Œ$t \\in T$ã€‚è‹¥$f$æ˜¯ä¸€ä¸ªæµï¼Œåˆ™å®šä¹‰æ¨ªè·¨åˆ‡å‰²$(S,T)$çš„**å‡€æµé‡**$f(S,T)$å¦‚ä¸‹ï¼š\n$$\nf(S,T)=\\sum_{u\\in S}\\sum_{v \\in T}f(u,v)-\\sum_{u\\in S}\\sum_{v \\in T}f(v,u)\n$$\n\nåˆ‡å‰²$(S,T)$çš„**å®¹é‡**ï¼š\n$$\nc(S,T)=\\sum_{u\\in S}\\sum_{v \\in T}c(u,v)\n$$\n\nä¸€ä¸ªç½‘ç»œçš„æœ€å°åˆ‡å‰²æ˜¯æ•´ä¸ªç½‘ç»œä¸­å®¹é‡æœ€å°çš„åˆ‡å‰²\n\nè®¾$f$ä¸ºæµç½‘ç»œ$G$çš„ä¸€ä¸ªæµï¼Œè¯¥æµç½‘ç»œçš„æºç»“ç‚¹ä¸º$s$ï¼Œæ±‡ç‚¹ä¸º$t$ï¼Œè®¾$(S,T)$ä¸ºæµç½‘ç»œ$G$çš„ä»»æ„åˆ‡å‰²ï¼Œåˆ™æ¨ªè·¨åˆ‡å‰²$(S,T)$çš„å‡€æµé‡ä¸º$f(S,T)=|f|$\næµç½‘ç»œ$G$ä¸­ä»»æ„æµ$f$çš„å€¼ä¸èƒ½è¶…è¿‡$G$çš„ä»»æ„åˆ‡å‰²çš„å®¹é‡\nè®¾$f$ä¸ºæµç½‘ç»œ$G=(V,E)$ä¸­çš„ä¸€ä¸ªæµï¼Œè¯¥æµç½‘ç»œçš„æºç»“ç‚¹ä¸º$s$ï¼Œæ±‡ç‚¹ä¸º$t$ï¼Œåˆ™ä¸‹é¢çš„æ¡ä»¶æ˜¯ç­‰ä»·çš„ï¼š\n- $f$æ˜¯$G$çš„ä¸€ä¸ªæœ€å¤§æµ\n- æ®‹å­˜ç½‘ç»œ$G_f$ä¸åŒ…æ‹¬ä»»ä½•å¢å¹¿è·¯å¾„\n- $|f|=c(S,T)$ï¼Œå…¶ä¸­$(S,T)$æ˜¯æµç½‘ç»œ$G$çš„æŸä¸ªåˆ‡å‰²\n##### åŸºæœ¬çš„Ford-Fulkersonç®—æ³•\nåœ¨ `Ford-Fulkerson` æ–¹æ³•çš„æ¯æ¬¡è¿­ä»£ä¸­ï¼Œå¯»æ‰¾æŸæ¡å¢å¹¿è·¯å¾„$p$ï¼Œç„¶åä½¿ç”¨$p$æ¥å¯¹æµ$f$è¿›è¡Œä¿®æ”¹ï¼ˆå¢åŠ ï¼‰ã€‚é€šè¿‡ä¸ºæ¯æ¡è¾¹$(u,v) \\in E$æ›´æ–°æµå±æ€§$(u,v).f$æ¥è®¡ç®—æµç½‘ç»œ$G=(V,E)$ä¸­çš„æœ€å¤§æµï¼š\n```text\nFORD-FULKERSON(G, s, t)\nfor each edge(u,v) in G.E\n    (u,v).f = 0\nwhile there exists a path p from s to t in the residual network Gf\n    cf(p) = min{cf(u,v):(u,v)is in p}\n    for each edge(u,v) in p\n        if (u,v) in E\n            (u,v).f = (u,v).f + cf(p)\n        else\n            (u,v).f = (u,v).f - cf(p)\n```\nå¦‚æœ$f^*$è¡¨ç¤ºè½¬æ¢åç½‘ç»œä¸­çš„ä¸€ä¸ªæœ€å¤§æµï¼Œåˆ™ `Ford-Fulkerson` ç®—æ³•çš„è¿è¡Œæ—¶é—´ä¸º$O(E|f^*|)$\n##### Edmonds-Karpç®—æ³•\né€šè¿‡åœ¨ç®—æ³•ç¬¬3è¡Œå¯»æ‰¾å¢å¹¿è·¯å¾„çš„æ“ä½œä¸­ä½¿ç”¨å¹¿åº¦ä¼˜å…ˆæœç´¢æ¥æ”¹å–„ `Ford-Fulkerson` ç®—æ³•çš„æ•ˆç‡ï¼š\nåœ¨æ®‹å­˜ç½‘ç»œä¸­é€‰æ‹©çš„å¢å¹¿è·¯å¾„æ˜¯ä¸€æ¡ä»æºç»“ç‚¹$s$åˆ°æ±‡ç‚¹$t$çš„æœ€çŸ­è·¯å¾„ï¼Œå…¶ä¸­æ¯æ¡è¾¹çš„æƒé‡ä¸ºå•ä½è·ç¦»\n`Edmonds-Karp` ç®—æ³•çš„è¿è¡Œæ—¶é—´ä¸º$O(VE^2)$","tags":["ç®—æ³•"],"categories":["è®¡è½¯æ‚è°ˆ","å­¦ä¹ ç¬”è®°"]},{"title":"Hexoæºç åˆ†æï¼ˆä¸€ï¼‰issue #4976çš„ç ”ç©¶","url":"/20220912/hexo-source1/","content":"\n> ç”±äºHexoä¸­ä½¿ç”¨äº†`bluebird`è¿™ä¸ªPromiseåº“ï¼Œä¼šå¯¼è‡´ä»£ç è¾ƒéš¾ç†è§£\n> æœ¬æ–‡ä¼šçœç•¥ä¸€äº›å’Œissueæ— å…³çš„ä»£ç \n\næœ€è¿‘çœ‹åˆ°äº†Hexoçš„[issue #4976](https://github.com/hexojs/hexo/issues/4976)ï¼Œå…¶ä¸­æåˆ°äº†å¤§æ–‡ä»¶çš„CSSåœ¨ç”Ÿæˆçš„è¿‡ç¨‹ä¸­å¯èƒ½ä¼šä¸¢å¤±éƒ¨åˆ†ä»£ç ã€‚æœ¬äººæ„Ÿè§‰è¿™ä¸ªé—®é¢˜éå¸¸æœ‰æ„æ€ï¼Œäºæ˜¯è‡ªå·±ä¹Ÿå°è¯•äº†ä¸€ä¸‹å¤§æ–‡ä»¶çš„CSSï¼Œæ²¡æƒ³åˆ°ä¹ŸæˆåŠŸå¤ç°äº†è¿™ä¸ªé—®é¢˜ã€‚\nå…ˆè¯´ç»“è®ºï¼šé—®é¢˜åº”è¯¥å‡ºç°åœ¨`post.js`ä¸­çš„`escapeAllSwigTags()`å‡½æ•°ã€‚ç”±äºå‹ç¼©è¿‡çš„CSSä¸­å¯èƒ½å‡ºç°è¯¸å¦‚{% raw %}{#main {% endraw %} è¿™æ ·çš„è¯­å¥ï¼Œè€Œè¿™æ ·çš„è¯­å¥ä¼šåœ¨è¿™ä¸ªå‡½æ•°ä¸­è¢«å½“æˆswigæ¨¡æ¿è¿›è¡Œå¤„ç†ï¼Œå¯¼è‡´äº†ä»£ç çš„ä¸¢å¤±ã€‚\nè§£å†³æ–¹æ³•ï¼šåœ¨`_config.yml`çš„`skip_render`ä¸­æ·»åŠ CSSçš„ç›¸å¯¹è·¯å¾„\nä»¥ä¸‹ä¸ºæ’æŸ¥çš„è¿‡ç¨‹å’Œéƒ¨åˆ†æºç çš„åˆ†æï¼š\n## hexo-cli\nhexoä¸­æ‰€è¾“å…¥çš„å‘½ä»¤å®é™…è¿è¡Œçš„æ˜¯`hexo/bin/hexo`æ–‡ä»¶ï¼š\n```js\n#!/usr/bin/env node\nrequire('hexo-cli')();\n```\nhexoæ–‡ä»¶ä¸­ç›´æ¥å¯¼å…¥`hexo-cli`æ¨¡å—ï¼ŒæŸ¥çœ‹`hexo-cli`å…¥å£ç‚¹ï¼š\n```json\n{\n  \"main\": \"lib/hexo\"\n}\n```\nå³å…¥å£ç‚¹ä¸º`hexo/node_modules/hexo-cli/lib/hexo.js`ï¼Œå…¶æ¨¡å—å¯¼å‡ºï¼š\n```js\nmodule.exports = entry;\n```\næŸ¥çœ‹`entry()`å‡½æ•°ï¼š\nå…¶è¾“å…¥ä¸¤ä¸ªå‚æ•°`cwd`å’Œ`args`ã€‚åœ¨è¯¥å‡½æ•°ä¸­è°ƒç”¨äº†`loadModule()`å‡½æ•°ï¼Œå¹¶å°†å…¶è¿”å›ç»“æœèµ‹å€¼ç»™`hexo`ï¼Œæ¥ç€è°ƒç”¨å…¶`init()`å‡½æ•°\n```js\nfunction entry(cwd = process.cwd(), args) {\n  //...\n  //æ­¤æ—¶çš„hexoå˜é‡ä¸æ˜¯çœŸæ­£çš„Hexoå¯¹è±¡\n  let hexo = new Context(cwd, args);\n\n  //...\n\n  return findPkg(cwd, args).then(path => {\n    if (!path) return;\n\n    hexo.base_dir = path;\n\n    return loadModule(path, args).catch(err => {\n      //...\n    });\n  }).then(mod => {\n    //å°†loadModuleè¿”å›çš„Hexoå¯¹è±¡èµ‹å€¼ç»™hexo\n    if (mod) hexo = mod;\n    //å¼•å…¥consoleæ¨¡å—ï¼Œå…¶ä¸­åŒ…å«éƒ¨åˆ†å‘½ä»¤å¦‚initï¼Œhelpå’Œversion\n    require('./console')(hexo);\n    //è°ƒç”¨å…¶init()å‡½æ•°\n    return hexo.init();\n  }).then(() => {\n    //...\n  }).catch(handleError);\n}\n```\næŸ¥çœ‹`loadModule()`å‡½æ•°ï¼Œåœ¨è¯¥å‡½æ•°ä¸­åˆ›å»ºHexoå¯¹è±¡å¹¶è¿”å›ï¼š\n```js\nfunction loadModule(path, args) {\n  return Promise.try(() => {\n    const modulePath = resolve.sync('hexo', { basedir: path });\n    const Hexo = require(modulePath);\n    //åˆ›å»ºHexoå¯¹è±¡ï¼Œargsä»£è¡¨å‘½ä»¤å‚æ•°\n    return new Hexo(path, args);\n  });\n}\n```\n\n> æ€»ç»“ï¼šhexo-cliä¸­åˆ›å»ºHexoå¯¹è±¡ï¼Œå¹¶è°ƒç”¨å…¶init()å‡½æ•°\n\n## hexoåˆå§‹åŒ–\næŸ¥çœ‹`hexo`å…¥å£ç‚¹ï¼š\n```json\n{\n  \"main\": \"lib/hexo\"\n}\n```\nå³å…¥å£ç‚¹ä¸º`hexo/lib/hexo/index.js`ï¼Œå…¶æ¨¡å—å¯¼å‡ºï¼š\n```js\nmodule.exports = Hexo;\n```\nå…ˆæŸ¥çœ‹Hexoç±»çš„æ„é€ å‡½æ•°ï¼Œåœ¨è¯¥å‡½æ•°ä¸­ä¸»è¦ä¸ºå±æ€§èµ‹å€¼ï¼Œåˆå§‹åŒ–é…ç½®æ–‡ä»¶ï¼›åŒæ—¶åˆå§‹åŒ–æ•°æ®åº“ï¼Œç»‘å®šæŸ¥è¯¢æ–¹æ³•\n```js\nconstructor(base = process.cwd(), args = {}) {\n  super();\n  //åˆå§‹åŒ–å„ç§è·¯å¾„å˜é‡\n  this.base_dir = base + sep;\n  this.public_dir = join(base, 'public') + sep;\n  this.source_dir = join(base, 'source') + sep;\n  this.plugin_dir = join(base, 'node_modules') + sep;\n  this.script_dir = join(base, 'scripts') + sep;\n  this.scaffold_dir = join(base, 'scaffolds') + sep;\n  this.theme_dir = join(base, 'themes', defaultConfig.theme) + sep;\n  this.theme_script_dir = join(this.theme_dir, 'scripts') + sep;\n  //åˆå§‹åŒ–ç¯å¢ƒå˜é‡\n  this.env = {\n    args,\n    debug: Boolean(args.debug),\n    safe: Boolean(args.safe),\n    silent: Boolean(args.silent),\n    env: process.env.NODE_ENV || 'development',\n    version,\n    cmd: args._ ? args._[0] : '',\n    init: false\n  };\n  //åˆå§‹åŒ–å„ç±»extendæ¨¡å—\n  this.extend = {\n    console: new Console(),\n    deployer: new Deployer(),\n    filter: new Filter(),\n    generator: new Generator(),\n    helper: new Helper(),\n    injector: new Injector(),\n    migrator: new Migrator(),\n    processor: new Processor(),\n    renderer: new Renderer(),\n    tag: new Tag()\n  };\n  //å…¶ä½™çš„åˆå§‹åŒ–\n  this.config = { ...defaultConfig };\n\n  this.log = logger(this.env);\n\n  this.render = new Render(this);\n\n  this.route = new Router();\n\n  this.post = new Post(this);\n\n  this.scaffold = new Scaffold(this);\n\n  this._dbLoaded = false;\n\n  this._isGenerating = false;\n\n  // If `output` is provided, use that as the\n  // root for saving the db. Otherwise default to `base`.\n  const dbPath = args.output || base;\n  //...\n  //åˆå§‹åŒ–æ•°æ®åº“ï¼Œç”¨äºä¸´æ—¶å­˜å‚¨éœ€è¦ç”Ÿæˆå’Œå¤„ç†çš„åŸå§‹æ–‡ä»¶\n  this.database = new Database({\n    version: dbVersion,\n    path: join(dbPath, 'db.json')\n  });\n  //åˆå§‹åŒ–é…ç½®æ–‡ä»¶\n  const mcp = multiConfigPath(this);\n\n  this.config_path = args.config ? mcp(base, args.config, args.output)\n    : join(base, '_config.yml');\n  //æ³¨å†Œæ•°æ®åº“ä¸­çš„æ¨¡å‹ï¼ˆç›¸å½“äºè¡¨ï¼‰ï¼Œæ¨¡å‹ä¸­å…·ä½“çš„schemaå®šä¹‰å¯ä»¥æŸ¥é˜…hexo/lib/modelsä¸­å¯¹åº”çš„æ¨¡å—\n  registerModels(this);\n\n  this.source = new Source(this);\n  this.theme = new Theme(this);\n  this.locals = new Locals(this);\n  //ç»‘å®šlocalçš„æŸ¥è¯¢æ–¹æ³•\n  this._bindLocals();\n}\n```\nç”±äºåœ¨`hexo-cli`è°ƒç”¨äº†Hexoç±»ä¸­çš„`init()`å‡½æ•°ï¼ŒæŸ¥çœ‹è¯¥å‡½æ•°ï¼š\n```js\ninit() {\n  //...\n\n  //åŠ è½½å¤–éƒ¨plugins\n  require('../plugins/console')(this);  //æ§åˆ¶å°æ’ä»¶ï¼Œç”¨äºå¤„ç†è¾“å…¥çš„æŒ‡ä»¤\n  require('../plugins/filter')(this);   //è¿‡æ»¤å™¨æ’ä»¶\n  require('../plugins/generator')(this);//ç”Ÿæˆå™¨æ’ä»¶ï¼Œç”¨äºç”Ÿæˆè½¬æ¢åçš„æ–‡ä»¶\n  require('../plugins/helper')(this);\n  require('../plugins/injector')(this);\n  require('../plugins/processor')(this);//å¤„ç†å™¨æ’ä»¶ï¼Œç”¨äºæ–‡ä»¶ç”Ÿæˆå‰çš„é¢„å¤„ç†\n  require('../plugins/renderer')(this);\n  require('../plugins/tag')(this);\n\n  //åŠ è½½é…ç½®\n  return Promise.each([\n    'update_package', // Update package.json\n    'load_config', // Load config\n    'load_theme_config', // Load alternate theme config\n    'load_plugins' // Load external plugins & scripts\n  ], name => require(`./${name}`)(this)).then(() => this.execFilter('after_init', null, { context: this })).then(() => {\n    // Ready to go!\n    this.emit('ready');\n  });\n}\n```\nè‡³æ­¤ï¼ŒHexoåˆå§‹åŒ–å®Œæˆï¼Œå¯ä»¥å¼€å§‹æ‰§è¡Œç”¨æˆ·è¾“å…¥çš„æŒ‡ä»¤\n## generate\n`hexo/lib/plugins/console`ç”¨äºå¤„ç†ç”¨æˆ·è¾“å…¥çš„æŒ‡ä»¤\n`hexo/lib/plugins/console/index.js`æ˜¯è¯¥æ¨¡å—çš„å…¥å£ï¼Œè¯¥æ¨¡å—ç”¨äºå‘å¯¹åº”çš„extendä¸­æ³¨å†Œæ¨¡å—ï¼Œä»¥ä¸‹ä»¥generateå‘½ä»¤ä¸ºä¾‹ï¼š\n```js\nmodule.exports = function(ctx) {\n  const { console } = ctx.extend;\n  //...\n  //æ³¨å†Œgenerateç›¸å…³å¤„ç†æ¨¡å—ï¼Œrequire('./generate')\n  console.register('generate', 'Generate static files.', {\n    options: [\n      {name: '-d, --deploy', desc: 'Deploy after generated'},\n      {name: '-f, --force', desc: 'Force regenerate'},\n      {name: '-w, --watch', desc: 'Watch file changes'},\n      {name: '-b, --bail', desc: 'Raise an error if any unhandled exception is thrown during generation'},\n      {name: '-c, --concurrency', desc: 'Maximum number of files to be generated in parallel. Default is infinity'}\n    ]\n  }, require('./generate'));\n\n  //...\n};\n```\næŸ¥çœ‹åŒç›®å½•ä¸‹çš„`generate.js`æ¨¡å—ï¼š\nå…¶åˆ›å»ºäº†Generaterå¯¹è±¡ï¼Œå¹¶è°ƒç”¨äº†`this.load()`å‡½æ•°ï¼Œç”±äºthiså°±æ˜¯Hexoå¯¹è±¡ï¼Œæ‰€ä»¥ç›¸å½“äºè°ƒç”¨äº†Hexoå¯¹è±¡ä¸­çš„`load()`å‡½æ•°\n```js\nfunction generateConsole(args = {}) {\n  const generator = new Generater(this, args);\n  //å¦‚æœæŒ‡ä»¤ä¸­å­˜åœ¨ -w æˆ– --watch åˆ™ä¼šæ‰§è¡Œä»¥ä¸‹ä»£ç \n  if (generator.watch) {\n    return generator.execWatch();\n  }\n  //å…ˆè°ƒç”¨load()å‡½æ•°åŠ è½½éœ€è¦ç”Ÿæˆçš„æ–‡ä»¶ï¼Œä¹‹åæ‰è¿›è¡Œç”Ÿæˆæ“ä½œ\n  return this.load().then(() => generator.firstGenerate()).then(() => {\n    //å¦‚æœæŒ‡ä»¤ä¸­å­˜åœ¨ -d æˆ– --deployï¼Œåˆ™ä¼šæ‰§è¡Œä»¥ä¸‹ä»£ç \n    if (generator.deploy) {\n      return generator.execDeploy();\n    }\n  });\n}\n\nmodule.exports = generateConsole;\n```\næŸ¥çœ‹Hexoç±»ä¸­çš„`load()`å‡½æ•°ï¼š\nè¯¥å‡½æ•°é¦–å…ˆè°ƒç”¨`load_database.js`ä¸­çš„`loadDatabase`æ¨¡å—ï¼Œå…ˆæ£€æŸ¥æ˜¯å¦åœ¨æ ¹ç›®å½•ä¸‹å­˜åœ¨`db.json`æ•°æ®åº“æ–‡ä»¶ï¼Œå¦‚æœæœ‰åˆ™è¿›è¡Œè¯»å–ï¼Œå¦åˆ™ç›´æ¥è¿”å›\nç”±äºhexoå°†éœ€è¦å¤„ç†çš„æ–‡ä»¶åˆ†æˆäº†`source`ï¼ˆ\\sourceç›®å½•ä¸‹çš„æ–‡ä»¶ï¼‰å’Œ`theme`ï¼ˆ\\themesç›®å½•ä¸‹çš„æ–‡ä»¶ï¼‰ï¼Œæ‰€ä»¥åˆ†åˆ«éœ€è¦å¯¹è¿™ä¸¤ä¸ªéƒ¨åˆ†æ‰§è¡Œ`process()`å‡½æ•°è¿›è¡Œé¢„å¤„ç†\nåœ¨å¼‚æ­¥è°ƒç”¨ç»“æŸåï¼Œéœ€è¦ç”Ÿæˆçš„æ–‡ä»¶å·²ç»è¢«å­˜å…¥äº†hexoå¯¹è±¡ä¸­çš„`database`å±æ€§ä¸­ï¼Œç­‰å¾…è¢«ç”Ÿæˆã€‚æ­¤æ—¶æ‰§è¡Œ`mergeCtxThemeConfig()`å‡½æ•°è¿›è¡Œé…ç½®çš„èåˆï¼Œå¹¶è°ƒç”¨`_generate()`å‡½æ•°ç”¨äºæ‰§è¡Œç”Ÿæˆå‰å’Œç”Ÿæˆåçš„è¿‡æ»¤å™¨ï¼ˆfilterï¼‰\nç”±äºCSSæ–‡ä»¶ä½äº`\\source`ç›®å½•ä¸‹ï¼Œæ‰€ä»¥CSSæ–‡ä»¶ä¼šåœ¨`this.source.process()`ä¸­è¢«å¤„ç†\n```js\nload(callback) {\n  //æ£€æŸ¥æ˜¯å¦åœ¨æ ¹ç›®å½•ä¸‹å­˜åœ¨`db.json`æ•°æ®åº“æ–‡ä»¶ï¼Œå¦‚æœæœ‰åˆ™è¿›è¡Œè¯»å–ï¼Œå¦åˆ™ç›´æ¥è¿”å›\n  return loadDatabase(this).then(() => {\n    this.log.info('Start processing');\n    //è¿›è¡Œé¢„å¤„ç†ï¼Œå°†æ–‡ä»¶è¯»å…¥æ•°æ®åº“ä¸­\n    return Promise.all([\n      this.source.process(),\n      this.theme.process()\n    ]);\n  }).then(() => {\n    //èåˆé…ç½®æ–‡ä»¶\n    mergeCtxThemeConfig(this);\n    //æ‰§è¡Œç”Ÿæˆå‰å’Œç”Ÿæˆåçš„è¿‡æ»¤å™¨ï¼ˆfilterï¼‰\n    return this._generate({ cache: false });\n  }).asCallback(callback);\n}\n```\nç”±äºissueä¸­æ‰€æåˆ°çš„CSSæ–‡ä»¶å±äºsoruceï¼Œæ‰€ä»¥åªéœ€è¦ç ”ç©¶`this.source.process()`\n## processor\næŸ¥çœ‹`hexo/lib/box/index.js`ä¸­çš„`process()`å‡½æ•°ï¼š\né‡ç‚¹åœ¨äºæœ€åçš„returnè¯­å¥ï¼Œé€šè¿‡`_readDir()`å‡½æ•°è¯»å–æ–‡ä»¶åˆ°æ•°æ®åº“ä¸­ï¼Œå†ä½¿ç”¨è¿‡æ»¤å™¨å¤„ç†è¢«åˆ é™¤çš„æ–‡ä»¶ã€‚è€Œissueä¸­æåˆ°çš„é—®é¢˜æ­£æ˜¯åœ¨å°†æ–‡ä»¶è¯»å–åˆ°æ•°æ®åº“ä¸­å‘ç”Ÿçš„\n```js\nprocess(callback) {\n  const { base, Cache, context: ctx } = this;\n\n  return stat(base).then(stats => {\n    //...\n\n    // Handle deleted files\n    return this._readDir(base)\n      .then(files => cacheFiles.filter(path => !files.includes(path)))\n      .map(path => this._processFile(File.TYPE_DELETE, path));\n  }).catch(err => {\n    //...\n  }).asCallback(callback);\n}\n```\næŸ¥çœ‹åŒæ–‡ä»¶ä¸‹`_readDir()`å‡½æ•°ï¼š\nå‡½æ•°æ¯”è¾ƒç®€å•ï¼Œå³é€’å½’è¯»å–ç‰¹å®šç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶ï¼Œæ£€æŸ¥å…¶çŠ¶æ€å¹¶ä½¿ç”¨`_processFile()`å‡½æ•°è¿›è¡Œå¤„ç†\nè¯»å–æ–‡ä»¶æœ¬èº«ä¸å­˜åœ¨é—®é¢˜ï¼Œé—®é¢˜å‡ºåœ¨å¯¹è¯»å–å‡ºæ¥æ•°æ®çš„å¤„ç†ä¸Š\n```js\n_readDir(base, prefix = '') {\n  const results = [];\n  return readDirWalker(base, results, this.ignore, prefix)\n    .return(results)\n    .map(path => this._checkFileStatus(path))\n    .map(file => this._processFile(file.type, file.path).return(file.path));\n}\n```\næŸ¥çœ‹åŒæ–‡ä»¶ä¸‹`_processFile`å‡½æ•°ï¼š\n`bluebird`çš„ä½¿ç”¨ä½¿å¾—ä»£ç è¾ƒéš¾ç†è§£ï¼Œå¤§æ„å°±æ˜¯å¯¹äºæ¯ä¸ª`path`ï¼Œåˆ¤æ–­å…¶æ˜¯å¦åŒ¹é…`processor`ä¸­çš„`pattern`ã€‚å¦‚æœåŒ¹é…ï¼Œåˆ™æ‰§è¡Œ`processor`ä¸­çš„`process()`å‡½æ•°ï¼Œå¹¶å°†ç»“æœè¿”å›\n```js\n_processFile(type, path) {\n\n  //...\n  //å¯¹this.processorä¸­çš„æ¯ä¸ªprocessoréƒ½è¿›è¡Œå¦‚ä¸‹æ“ä½œ\n  return Promise.reduce(this.processors, (count, processor) => {\n    //åˆ¤æ–­pathæ˜¯å¦åŒ¹é…processorä¸­çš„pattern\n    const params = processor.pattern.match(path);\n    //å¦‚æœä¸åŒ¹é…ï¼Œåˆ™ç›´æ¥è¿”å›\n    if (!params) return count;\n    const file = new File({\n      source: join(base, path),\n      path,\n      params,\n      type\n    });\n    //å¦åˆ™ï¼Œæ‰§è¡Œprocessorä¸­çš„processæ–¹æ³•ï¼Œå¹¶å°†ç»“æœè¿”å›\n    return Reflect.apply(Promise.method(processor.process), ctx, [file])\n  }, 0).catch(err => {\n    ctx.log.error({ err }, 'Process failed: %s', magenta(path));\n  }).finally(() => {\n    this._processingFiles[path] = false;\n  }).thenReturn(path);\n}\n```\næ³¨æ„ï¼Œè¿™é‡Œçš„`this`æ˜¯hexoå¯¹è±¡ä¸­çš„`source`è€Œé`theme`ï¼Œæ‰€ä»¥æŸ¥çœ‹`hexo/lib/hexo/source.js`ï¼š\n```js\nclass Source extends Box {\n  constructor(ctx) {\n    super(ctx, ctx.source_dir);\n\n    this.processors = ctx.extend.processor.list();\n  }\n}\n```\nç»§ç»­æŸ¥çœ‹`hexo/lib/extend/processor.js`ï¼š\nå¯ä»¥çŸ¥é“æœ€ç»ˆprocessorsä¸­çš„å¤„ç†å™¨å°±æ˜¯é‚£äº›åˆå§‹åŒ–æ—¶è¢«æ³¨å†Œçš„å¤„ç†å™¨ï¼ˆå’Œconsoleä¸€æ ·ï¼‰\n```js\nclass Processor {\n  constructor() {\n    this.store = [];\n  }\n\n  list() {\n    return this.store;\n  }\n\n  register(pattern, fn) {\n      //...\n    this.store.push({\n      pattern: new Pattern(pattern),\n      process: fn\n    });\n  }\n}\n```\nç»§ç»­æŸ¥çœ‹`hexo/lib/plugins/processor/index.js`ï¼š\nå¯ä»¥çŸ¥é“`asset`ã€`data`å’Œ`post`ä¸‰ä¸ªå¤„ç†å™¨è¢«æˆåŠŸæ³¨å†Œï¼Œè€ŒCSSæ–‡ä»¶æ˜¯å½’å±äº`asset`è¿›è¡Œå¤„ç†çš„\n```js\nmodule.exports = ctx => {\n  const { processor } = ctx.extend;\n\n  function register(name) {\n    const obj = require(`./${name}`)(ctx);\n    processor.register(obj.pattern, obj.process);\n  }\n\n  register('asset');\n  register('data');\n  register('post');\n};\n```\nç»§ç»­æŸ¥çœ‹`hexo/lib/plugins/processor/asset.js`ï¼š\nCSSæ–‡ä»¶çš„`renderable`æ˜¯`true`ï¼Œæ‰€ä»¥ä¼šè¿›å…¥`processPage()`å‡½æ•°ä¸­\n```js\nmodule.exports = ctx => {\n  return {\n    pattern: new Pattern(path => {\n      if (isExcludedFile(path, ctx.config)) return;\n\n      return {\n        //å¦‚æœè¿™é‡Œ_config.ymlä¸­è®¾ç½®äº†skip_renderï¼Œåˆ™è¿™é‡Œçš„renderableä¼šå˜ä¸ºfalseï¼Œä¹Ÿå°±ä¸ä¼šå‚ä¸ä¹‹åçš„è½¬ä¹‰äº†\n        renderable: ctx.render.isRenderable(path) && !isMatch(path, ctx.config.skip_render)\n      };\n    }),\n\n    process: function assetProcessor(file) {\n      if (file.params.renderable) {\n        return processPage(ctx, file);\n      }\n\n      return processAsset(ctx, file);\n    }\n  };\n};\n```\nç»§ç»­æŸ¥çœ‹`processPage()`å‡½æ•°ï¼š\nåœ¨è¯¥å‡½æ•°ä¸­ï¼Œä¸»è¦æ˜¯è¯»å–å¯¹åº”æ–‡ä»¶ï¼Œè¿›è¡Œä¸€å®šçš„å¤„ç†åå°†ç»“æœå­˜å…¥æ•°æ®åº“çš„`Page`æ¨¡å‹ä¸­\n```js\nfunction processPage(ctx, file) {\n  const Page = ctx.model('Page');\n  const { path } = file;\n  const doc = Page.findOne({source: path});\n  const { config } = ctx;\n  const { timezone: timezoneCfg } = config;\n\n  //...\n\n  return Promise.all([\n    file.stat(),\n    //è¯»å–æ–‡ä»¶\n    file.read()\n  ]).spread((stats, content) => {\n    const data = yfm(content);\n    const output = ctx.render.getOutput(path);\n\n    data.source = path;\n    //rawæ˜¯è¯»å–çš„åŸå§‹æ•°æ®\n    data.raw = content;\n\n    data.date = toDate(data.date);\n    //ä¸€ç³»åˆ—å¤„ç†\n    //...\n    //å­˜å…¥æ•°æ®åº“ä¸­\n    return Page.insert(data);\n  });\n}\n```\n## filter\n`process()`å‡½æ•°å·²ç»å®Œæˆï¼Œæ­¤æ—¶å›åˆ°`load()`å‡½æ•°ä¸­ï¼š\nå¼€å§‹æ‰§è¡Œ`_generate()`å‡½æ•°\n```js\nload(callback) {\n  //æ£€æŸ¥æ˜¯å¦åœ¨æ ¹ç›®å½•ä¸‹å­˜åœ¨`db.json`æ•°æ®åº“æ–‡ä»¶ï¼Œå¦‚æœæœ‰åˆ™è¿›è¡Œè¯»å–ï¼Œå¦åˆ™ç›´æ¥è¿”å›\n  return loadDatabase(this).then(() => {\n    this.log.info('Start processing');\n    //è¿›è¡Œé¢„å¤„ç†ï¼Œå°†æ–‡ä»¶è¯»å…¥æ•°æ®åº“ä¸­\n    return Promise.all([\n      this.source.process(),\n      this.theme.process()\n    ]);\n  }).then(() => {\n    //èåˆé…ç½®æ–‡ä»¶\n    mergeCtxThemeConfig(this);\n    //æ‰§è¡Œç”Ÿæˆå‰å’Œç”Ÿæˆåçš„è¿‡æ»¤å™¨ï¼ˆfilterï¼‰\n    return this._generate({ cache: false });\n  }).asCallback(callback);\n}\n```\næŸ¥çœ‹åŒç›®å½•ä¸‹çš„`_generate()`å‡½æ•°ï¼š\nåŸºæœ¬ä¸Šå°±æ˜¯å…ˆè¿è¡Œ`before_generate`è¿‡æ»¤å™¨ï¼Œæ¥ç€è¿è¡Œ`_runGenerators`è°ƒç”¨ç”Ÿæˆå™¨è¿›è¡Œç”Ÿæˆï¼Œæœ€åè¿è¡Œ`after_generate`è¿‡æ»¤å™¨\n```js\n_generate(options = {}) {\n  //...\n\n  this.emit('generateBefore');\n\n  //è¿è¡Œbefore_generateè¿‡æ»¤å™¨\n  return this.execFilter('before_generate', this.locals.get('data'), { context: this })\n  //è¿è¡Œ_runGeneratorsè°ƒç”¨ç”Ÿæˆå™¨è¿›è¡Œç”Ÿæˆ\n    .then(() => this._routerReflesh(this._runGenerators(), useCache)).then(() => {\n    this.emit('generateAfter');\n\n    //è¿è¡Œafter_generateè¿‡æ»¤å™¨\n    return this.execFilter('after_generate', null, { context: this });\n    }).finally(() => {\n    this._isGenerating = false;\n    });\n}\n```\né—®é¢˜å‡ºç°åœ¨`before_generate`è¿‡æ»¤å™¨ä¹‹ä¸­ï¼ŒæŸ¥çœ‹`hexo/lib/plugins/filter/before_generate/render_post.js`ï¼š\nåœ¨è¯¥è¿‡æ»¤å™¨ä¸­ï¼Œå¯¹äº`Post`æ¨¡å‹å’Œ`Page`æ¨¡å‹åˆ†åˆ«è°ƒç”¨`render()`å‡½æ•°å¯¹postè¿›è¡Œå¤„ç†(å¦‚è½¬ä¹‰)\n```js\nfunction renderPostFilter(data) {\n  const renderPosts = model => {\n    //è·å¾—æ‰€æœ‰contentä¸ºç©ºçš„post\n    const posts = model.toArray().filter(post => post.content == null);\n\n    return Promise.map(posts, post => {\n      //å…ˆèµ‹å€¼ä¸º_content\n      post.content = post._content;\n      post.site = {data};\n      //è°ƒç”¨render()å‡½æ•°å¯¹postè¿›è¡Œå¤„ç†(å¦‚è½¬ä¹‰)\n      return this.post.render(post.full_source, post).then(() => \n      //ä¿å­˜å›æ•°æ®åº“\n      post.save());\n    });\n  };\n\n  return Promise.all([\n  renderPosts(this.model('Post')),\n  renderPosts(this.model('Page'))\n  ]);\n}\n```\næŸ¥çœ‹`hexo/lib/hexo/post.js`ä¸­çš„`render()`å‡½æ•°ï¼š\nåœ¨è¯¥å‡½æ•°ä¸­ï¼Œé¦–å…ˆè¿è¡Œ`before_post_render`è¿‡æ»¤å™¨ï¼Œæ¥ç€åœ¨å¯¹æ–‡ä»¶è¿›è¡Œè½¬ä¹‰æ“ä½œåä½¿ç”¨æ¸²æŸ“å™¨å¯¹markdownç­‰è¿›è¡Œæ¸²æŸ“ï¼Œæœ€åè¿è¡Œ`after_post_render`è¿‡æ»¤å™¨\né—®é¢˜å°±å‡ºåœ¨`escapeAllSwigTags()`å‡½æ•°ä¸­ã€‚ç”±äºå‹ç¼©è¿‡çš„CSSä¸­å¯èƒ½å‡ºç°è¯¸å¦‚{% raw %}{#main{% endraw %}è¿™æ ·çš„è¯­å¥ï¼Œè€Œè¿™æ ·çš„è¯­å¥ä¼šåœ¨è¿™ä¸ªå‡½æ•°ä¸­è¢«å½“æˆswigæ¨¡æ¿è¿›è¡Œå¤„ç†ï¼Œå¯¼è‡´æ–‡ä»¶ä¸¢å¤±éƒ¨åˆ†ä»£ç \n```js\nrender(source, data = {}, callback) {\n  const ctx = this.context;\n  const { config } = ctx;\n  const { tag } = ctx.extend;\n  const ext = data.engine || (source ? extname(source) : '');\n\n  let promise;\n  \n  //...\n\n  return promise.then(content => {\n    data.content = content;\n    //è¿è¡Œbefore_post_renderè¿‡æ»¤å™¨\n    return ctx.execFilter('before_post_render', data, { context: ctx });\n  }).then(() => {\n    data.content = cacheObj.escapeCodeBlocks(data.content);\n    // Escape all Nunjucks/Swig tags\n    if (disableNunjucks === false) {\n      //é—®é¢˜å‡ºåœ¨è¿™å¥è¯\n      //CSSä¸éœ€è¦è½¬ä¹‰swigæ¨¡æ¿!!!\n      data.content = cacheObj.escapeAllSwigTags(data.content);\n    }\n\n    // ä½¿ç”¨æ¸²æŸ“å™¨å¯¹markdownç­‰è¿›è¡Œæ¸²æŸ“\n    //...\n  }).then(content => {\n    data.content = cacheObj.restoreCodeBlocks(content);\n\n    //è¿è¡Œafter_post_renderè¿‡æ»¤å™¨\n    return ctx.execFilter('after_post_render', data, { context: ctx });\n  }).asCallback(callback);\n}\n```","tags":["Hexo"],"categories":["è®¡è½¯æ‚è°ˆ","hexo"]},{"title":"hexo-minecraft-skin-vieweræ’ä»¶Demo","url":"/20220902/hexo-mcskin-demo/","content":"A hexo plugin to display minecraft skin by skinview3d.\nä½¿ç”¨skinview3då±•ç¤ºminecraftçš®è‚¤3Dæ¨¡å‹\n## Install \n\n```bash\n$ npm install hexo-minecraft-skin-viewer --save\n```\n\n## Usage\n```text\n{% raw %}\n{% mcskin name ATouuuu true true 100 200 %}\n{% mcskin url https://mineskin.eu/skin/D_Sketon true true %}\n{% endraw %}\n```\n\nç¬¬ä¸€ä¸ªå‚æ•°ä»£è¡¨é€‰æ‹©MINECRAFTç”¨æˆ·åè¿˜æ˜¯çš®è‚¤åœ°å€\nå‚æ•°èŒƒå›´ï¼šname/urlï¼ˆå¿…å¡«ï¼‰\nThe 1st parameter represents whether to select MINECRAFT username or skin url\nparameter range: name/url (required)\n\nç¬¬äºŒä¸ªå‚æ•°ä»£è¡¨MINECRAFTç”¨æˆ·åæˆ–çš®è‚¤åœ°å€ï¼ˆå¿…å¡«ï¼‰\nThe 2nd parameter represents MINECRAFT username or skin url (required)\n\nç¬¬ä¸‰ä¸ªå‚æ•°ä»£è¡¨æ˜¯å¦å¼€å¯è‡ªåŠ¨æ—‹è½¬ï¼ˆé€‰å¡«ï¼Œé»˜è®¤trueï¼‰\nThe 3rd parameter represents whether to turn on automatic rotation (optional,default true)\n\nç¬¬å››ä¸ªå‚æ•°ä»£è¡¨æ˜¯å¦å¼€å¯æ¨¡å‹åŠ¨ç”»ï¼ˆé€‰å¡«ï¼Œé»˜è®¤falseï¼‰\nThe 4th parameter represents whether to turn on model animation (optional,default false)\n\nç¬¬äº”ä¸ªå‚æ•°ä»£è¡¨æ¨¡å‹å®½åº¦ï¼ˆé€‰å¡«ï¼Œé»˜è®¤300ï¼‰\nThe 5th parameter represents the width of the model (optional,default 300)\n\nç¬¬äº”ä¸ªå‚æ•°ä»£è¡¨æ¨¡å‹é«˜åº¦ï¼ˆé€‰å¡«ï¼Œé»˜è®¤400ï¼‰\nThe 6th parameter represents the height of the model (optional,default 400)\n\n## Example\n```text\n{% raw %}\n{% mcskin name ATouuuu true true 100 200 %}\n{% endraw %}\n```\n{% mcskin name ATouuuu true true 100 200 %}\n```text\n{% raw %}\n{% mcskin url https://mineskin.eu/skin/D_Sketon true true %}\n{% endraw %}\n```\n{% mcskin url https://mineskin.eu/skin/D_Sketon true true %}","tags":["hexo"],"categories":["è®¡è½¯æ‚è°ˆ"]},{"title":"æ•°æ®åº“ç³»ç»Ÿæ¦‚å¿µ å­¦ä¹ ç¬”è®°","url":"/20220816/db-book-note/","content":"## å¼•è¨€\n\n### æ•°æ®åº“-DataBase\n\n- ä¸€ä¸ªäº’ç›¸å…³è”çš„æ•°æ®çš„é›†åˆ\n- å¤§å¤šæ•°è®¡ç®—æœºåº”ç”¨ç¨‹åºçš„æ ¸å¿ƒç»„ä»¶\n\n### æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ-DBMSï¼ˆDataBase Management Systemï¼‰\n\n- ä¸€ä¸ªäº’ç›¸å…³è”çš„æ•°æ®é›†åˆ\n- è®¿é—®è¿™äº›æ•°æ®çš„ä¸€ç»„ç¨‹åº\n- æä¾›äº†ä¸€ç§æ—¢æ–¹ä¾¿åˆé«˜æ•ˆçš„å­˜å‚¨å’Œæ£€ç´¢æ•°æ®åº“ä¿¡æ¯çš„æ–¹æ³•\n- ç”±å¤šä¸ªç”¨æˆ·å’Œåº”ç”¨ç¨‹åºè®¿é—®\n\n### æ•°æ®æ¨¡å‹\n\n- å…³ç³»æ¨¡å‹\n    - ç”¨è¡¨çš„é›†åˆæ¥è¡¨è¿°æ•°æ®å’Œæ•°æ®é—´çš„è”ç³»\n- å®ä½“-è”ç³»ï¼ˆE-Rï¼‰æ¨¡å‹\n    - ä½¿ç”¨ç§°ä½œå®ä½“çš„åŸºæœ¬å¯¹è±¡çš„é›†åˆï¼Œä»¥åŠè¿™äº›å¯¹è±¡é—´çš„å…³ç³»\n- åŠç»“æ„åŒ–æ•°æ®æ¨¡å‹\n    - å…è®¸åœ¨å…¶æ•°æ®å®šä¹‰ä¸­æŸäº›ç›¸åŒç±»å‹çš„æ•°æ®é¡¹å«æœ‰ä¸åŒçš„å±æ€§é›†\n- åŸºäºå¯¹è±¡çš„æ•°æ®æ¨¡å‹\n    - å¯¹å…³ç³»æ¨¡å‹è¿›è¡Œæ‰©å±•ï¼Œå¢åŠ äº†å°è£…ã€æ–¹æ³•å’Œå¯¹è±¡æ ‡è¯†ç¬¦ç­‰æ¦‚å¿µ\n- é”®å€¼å¯¹æ¨¡å‹ï¼Œå›¾æ¨¡å‹ï¼Œæ–‡ä»¶æ¨¡å‹ç­‰ç­‰......\n\n### æ•°æ®æŠ½è±¡\n\n- ç‰©ç†å±‚\n    - æè¿°æ•°æ®æ˜¯æ€æ ·**å­˜å‚¨**çš„\n- é€»è¾‘å±‚\n    - æè¿°æ•°æ®åº“ä¸­å­˜å‚¨**ä»€ä¹ˆ**æ•°æ®ä»¥åŠè¿™äº›æ•°æ®å»ºå­˜åœ¨ä»€ä¹ˆè”ç³»\n    - é€šè¿‡å°‘é‡ç›¸å¯¹**ç®€å•**çš„ç»“æ„æè¿°äº†æ•´ä¸ªæ•°æ®åº“\n- è§†å›¾å±‚\n    - åªæè¿°æ•´ä¸ªæ•°æ®åº“çš„**æŸä¸ªéƒ¨åˆ†**\n\n### å®ä¾‹ï¼ˆinstanceï¼‰å’Œæ¨¡å¼ï¼ˆschemaï¼‰\n\nç±»ä¼¼äºç¼–ç¨‹è¯­è¨€ä¸­çš„ç±»å‹å’Œå˜é‡\n\n- é€»è¾‘æ¨¡å¼\n    - æ•°æ®åº“çš„æ•´ä½“é€»è¾‘ç»“æ„\n    - ç±»ä¼¼äºç¨‹åºä¸­å˜é‡çš„ç±»å‹ä¿¡æ¯\n- ç‰©ç†æ¨¡å¼\n    - æ•°æ®åº“çš„æ•´ä½“ç‰©ç†ç»“æ„\n- å®ä¾‹\n    - æ•°æ®åº“çš„å®é™…å†…å®¹\n    - ç±»ä¼¼äºå˜é‡çš„å€¼\n\n### æ•°æ®åº“è¯­è¨€\n\n#### æ•°æ®å®šä¹‰è¯­è¨€ï¼ˆDDLï¼‰\n\nç”¨äºå®šä¹‰æ•°æ®åº“æ¨¡å¼çš„å®ç°ç»†èŠ‚\n- **æ•°æ®å­—å…¸ï¼ˆdata dictionaryï¼‰** åŒ…å«å…ƒæ•°æ®\n    - æ•°æ®åº“æ¨¡å¼\n    - å®Œæ•´æ€§çº¦æŸ\n    - æˆæƒ\n\n#### æ•°æ®æ“çºµè¯­è¨€ï¼ˆDMLï¼‰\n\nè®¿é—®å’Œæ›´æ–°æ•°æ®çš„è¯­è¨€ï¼ˆ**æŸ¥è¯¢è¯­è¨€**ï¼‰\n- è¿‡ç¨‹åŒ–çš„ DML\n    - è¦æ±‚ç”¨æˆ·æŒ‡å®šéœ€è¦ä»€ä¹ˆæ•°æ®ä»¥åŠ**å¦‚ä½•**è·å¾—è¿™äº›æ•°æ®\n        - å…³ç³»ä»£æ•°ï¼ˆrelational algebraï¼‰\n- å£°æ˜å¼çš„ï¼ˆéè¿‡ç¨‹åŒ–çš„ï¼‰DML\n    - è¦æ±‚ç”¨æˆ·æŒ‡å®šéœ€è¦**ä»€ä¹ˆ**æ•°æ®ï¼Œè€Œä¸å¿…æŒ‡æ˜å¦‚ä½•è·å¾—è¿™äº›æ•°æ®\nç±»ä¼¼äºç¼–ç¨‹è¯­è¨€ä¸­çš„ç±»å‹å’Œå˜é‡\n        - å…³ç³»æ¼”ç®—ï¼ˆrelational calculusï¼‰\n        - SQL\n\n### SQL æŸ¥è¯¢è¯­è¨€\n\n- SQL æŸ¥è¯¢è¯­è¨€æ˜¯éè¿‡ç¨‹åŒ–çš„\n- SQL ä¸æ˜¯å›¾çµå®Œå¤‡çš„\n- é€šå¸¸åµŒå…¥åœ¨ä¸€äº›é«˜çº§è¯­è¨€ä¸­\n- åº”ç”¨ç¨‹åºé€šå¸¸é€šè¿‡ä»¥ä¸‹æ–¹å¼è®¿é—®æ•°æ®åº“ï¼š\n    - å…è®¸åµŒå…¥å¼ SQL çš„è¯­è¨€æ‰©å±•\n    - å…è®¸å°† SQL æŸ¥è¯¢å‘é€åˆ°æ•°æ®åº“çš„åº”ç”¨ç¨‹åºæ¥å£ï¼ˆä¾‹å¦‚ ODBC/JDBCï¼‰\n\n### æ•°æ®åº“è®¾è®¡\n\n- é€»è¾‘è®¾è®¡ \\- å†³å®šæ•°æ®åº“æ¨¡å¼\n    - æ‰¾åˆ°â€œå¥½â€çš„æ¨¡å¼\n    - ä¸šåŠ¡å†³ç­–â€”åº”è¯¥åœ¨æ•°æ®åº“ä¸­è®°å½•å“ªäº›å±æ€§\n    - è®¡ç®—æœºç§‘å­¦å†³ç­–â€”â€”åº”è¯¥æ‹¥æœ‰å“ªäº›å…³ç³»æ¨¡å¼ä»¥åŠå±æ€§åº”è¯¥å¦‚ä½•åœ¨å„ç§å…³ç³»æ¨¡å¼ä¹‹é—´åˆ†å¸ƒ\n- ç‰©ç†è®¾è®¡ \\- å†³å®šæ•°æ®åº“çš„ç‰©ç†å¸ƒå±€\n\n### æ•°æ®åº“å¼•æ“\n\n- æ•°æ®åº“ç³»ç»Ÿè¢«åˆ’åˆ†ä¸ºå¤šä¸ªæ¨¡å—ï¼Œæ¯ä¸ªæ¨¡å—å®Œæˆæ•´ä¸ªç³»ç»Ÿçš„ä¸€ä¸ªåŠŸèƒ½\n- æ•°æ®åº“ç³»ç»Ÿçš„ä¸»è¦ç»„æˆéƒ¨åˆ†\n    - å­˜å‚¨ç®¡ç†å™¨\n    - æŸ¥è¯¢å¤„ç†å™¨\n    - äº‹åŠ¡ç®¡ç†\n\n### å­˜å‚¨ç®¡ç†å™¨\n\n- ä¸ OS æ–‡ä»¶ç®¡ç†å™¨è¿›è¡Œäº¤äº’\n- è´Ÿè´£æ•°æ®åº“ä¸­æ•°æ®çš„å­˜å‚¨ã€æ£€ç´¢å’Œæ›´æ–°\n- å­˜å‚¨ç®¡ç†å™¨éƒ¨ä»¶åŒ…æ‹¬ï¼š\n    - æƒé™å’Œå®Œæ•´æ€§ç®¡ç†å™¨\n           - æ£€æµ‹æ—¶å€™æ»¡è¶³å®Œæ•´æ€§çº¦æŸï¼Œå¹¶æ£€æŸ¥è¯•å›¾è®¿é—®æ•°æ®çš„ç”¨æˆ·æƒé™\n    - äº‹åŠ¡ç®¡ç†å™¨\n        - ä¿è¯å³ä½¿ç³»ç»Ÿå‘ç”Ÿäº†æ•…éšœï¼Œæ•°æ®åº“ä¹Ÿä¿æŒåœ¨ä¸€è‡´çš„çŠ¶æ€\n    - æ–‡ä»¶ç®¡ç†å™¨\n        - ç®¡ç†ç£ç›˜å­˜å‚¨ç©ºé—´çš„åˆ†é…å’Œç”¨äºè¡¨ç¤ºç£ç›˜ä¸Šæ‰€å­˜å‚¨ä¿¡æ¯çš„æ•°æ®ç»“æ„\n    - ç¼“å†²åŒºç®¡ç†å™¨\n        - è´Ÿè´£å°†æ•°æ®ä»ç£ç›˜ä¸Šæ¸ é“å†…å­˜ä¸­ï¼Œå¹¶å†³å®šå“ªäº›æ•°æ®åº”è¢«ç¼“å†²åœ¨å†…å­˜ä¸­\n- å­˜å‚¨ç®¡ç†å™¨å®ç°äº†å‡ ç§æ•°æ®ç»“æ„\n    - æ•°æ®æ–‡ä»¶\n        - å­˜å‚¨æ•°æ®åº“è‡ªèº«\n    - æ•°æ®å­—å…¸\n        - å­˜å‚¨å…³äºæ•°æ®åº“ç»“æ„çš„å…ƒæ•°æ®\n    - ç´¢å¼•\n        - æä¾›å¯¹äºæ•°æ®é¡¹çš„å¿«é€Ÿè®¿é—®\n\n### æŸ¥è¯¢å¤„ç†å™¨\n æŸ¥è¯¢å¤„ç†å™¨ç»„ä»¶åŒ…æ‹¬ï¼š\n- DDLè§£é‡Šå™¨\n    - è§£é‡ŠDDLè¯­å¥å¹¶å°†è¿™äº›å®šä¹‰è®°å½•åœ¨æ•°æ®å­—å…¸ä¸­ \n- DMLç¼–è¯‘å™¨\n    - å°†æŸ¥è¯¢è¯­è¨€ä¸­çš„DMLè¯­å¥ç¿»è¯‘ä¸ºåŒ…æ‹¬ä¸€ç³»åˆ—æŸ¥è¯¢æ‰§è¡Œå¼•æ“èƒ½ç†è§£çš„ä½çº§æŒ‡ä»¤çš„æ‰§è¡Œæ–¹æ¡ˆ \n- æŸ¥è¯¢æ‰§è¡Œå¼•æ“\n    - æ‰§è¡Œç”±DMLç¼–è¯‘å™¨äº§ç”Ÿçš„ä½çº§æŒ‡ä»¤\n\n### äº‹åŠ¡ç®¡ç†\n\n- **äº‹åŠ¡**æ˜¯æ•°æ®åº“åº”ç”¨ä¸­å®Œæˆå•ä¸€é€»è¾‘åŠŸèƒ½çš„æ“ä½œé›†åˆ\n\n## å…³ç³»æ¨¡å‹ä»‹ç»\n\n### å…³ç³»æ¨¡å‹\n\n- å…³ç³»ï¼ˆrelationï¼‰æ˜¯**æ— åº**é›†åˆï¼ŒåŒ…å«è¡¨ç¤ºå®ä½“çš„å±æ€§ä¹‹é—´çš„å…³ç³»\n- åŸŸï¼ˆdomainï¼‰æ˜¯å…³ç³»çš„æ¯ä¸ªå±æ€§çš„å…è®¸å–å€¼çš„é›†åˆ\n- å…ƒç»„ï¼ˆtupleï¼‰æ˜¯å…³ç³»ä¸­çš„ä¸€ç»„å±æ€§å€¼\n    - å€¼ï¼ˆé€šå¸¸ï¼‰æ˜¯åŸå­/æ ‡é‡\n        - åŸå­ï¼šä¸€ä¸ªåŸŸä¸­çš„å…ƒç´ è¢«è®¤ä¸ºæ˜¯ä¸å¯å†åˆ†çš„å•ä½\n    - ç©ºå€¼æ˜¯æ¯ä¸ªåŸŸçš„æˆå‘˜\n\n### æ•°æ®åº“æ¨¡å¼ï¼ˆdatabase schemaï¼‰\n\n- A1, A2, ..., An æ˜¯å±æ€§\n- R = (A1, A2, ..., An ) æ˜¯ä¸€ä¸ªå…³ç³»æ¨¡å¼ï¼ˆrelation schemaï¼‰\n- ä¾‹ï¼š\n    - instructor = (ID, name, dept_name, salary)\n    - åœ¨æ¨¡å¼ R ä¸Šå®šä¹‰çš„å…³ç³»å®ä¾‹ r ç”¨ r(R) è¡¨ç¤º\n    - å…³ç³»çš„å½“å‰å€¼ç”±è¡¨æŒ‡å®š\n    - å…³ç³» r çš„å…ƒç´  t ç§°ä¸ºå…ƒç»„ï¼Œç”±è¡¨ä¸­çš„ä¸€è¡Œè¡¨ç¤º\n\n### é”®\n\n- è¶…é”®ï¼ˆsuperkeyï¼‰\n    - ä¸€ä¸ªæˆ–å¤šä¸ªå±æ€§çš„é›†åˆ\n    - å°†è¿™äº›å±æ€§ç»„åˆåœ¨ä¸€èµ·å¯ä»¥åœ¨ä¸€ä¸ªå…³ç³»ä¸­å”¯ä¸€åœ°æ ‡è¯†å‡ºä¸€ä¸ªå…ƒç»„\n- å€™é€‰é”®ï¼ˆcandidate keyï¼‰\n    - æœ€å°è¶…é”®\n    - å…¶ä»»æ„çœŸå­é›†éƒ½ä¸æ˜¯è¶…é”®\n- ä¸»é”®ï¼ˆprimary keyï¼‰\n    - è¢«æ•°æ®åº“è®¾è®¡è€…é€‰ä¸­æ¥ä½œä¸ºåœ¨ä¸€ä¸ªå…³ç³»ä¸­åŒºåˆ†ä¸åŒå…ƒç»„çš„ä¸»è¦æ–¹å¼çš„å€™é€‰é”®\n    - å¦‚æœè¡¨æ²¡æœ‰å®šä¹‰ä¸€ä¸ªä¸»é”®ï¼Œä¸€äº› DBMS ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªå†…éƒ¨ä¸»é”®\n        - SEQUENCE (SQL:2003)\n        - AUTO_INCREMENT (MySQL)\n- å¤–é”®çº¦æŸï¼ˆforeign-key constraintï¼‰\n    - ä¸€ä¸ªå…³ç³»ä¸­çš„å€¼å¿…é¡»å‡ºç°åœ¨å¦ä¸€ä¸ªå…³ç³»ä¸­\n        - å¼•ç”¨å…³ç³»ï¼ˆreferencing relationï¼‰\n        - è¢«å¼•ç”¨å…³ç³»ï¼ˆreferenced relationï¼‰\n    - è¢«å¼•ç”¨å±æ€§ï¼ˆé›†ï¼‰å¿…é¡»æ˜¯è¢«å¼•ç”¨å…³ç³»çš„**ä¸»é”®**\n    - æ˜¯å¼•ç”¨å®Œæ•´æ€§çº¦æŸçš„ä¸€ç§**ç‰¹ä¾‹**\n- å¼•ç”¨å®Œæ•´æ€§çº¦æŸï¼ˆreferential integrity constraintï¼‰\n    - å¼•ç”¨å…³ç³»ä¸­çš„ä»»æ„å…ƒç»„åœ¨æŒ‡å®šå±æ€§ä¸Šå‡ºç°çš„å–å€¼ä¹Ÿå¿…ç„¶å‡ºç°åœ¨è¢«å¼•ç”¨å…³ç³»ä¸­è‡³å°‘ä¸€ä¸ªå…ƒç»„çš„æŒ‡å®šå±æ€§ä¸Š\n\n### å…³ç³»ä»£æ•°ï¼ˆrelational algebraï¼‰\n\n- æ£€ç´¢å’Œæ“ä½œå…³ç³»ä¸­çš„å…ƒç»„çš„åŸºæœ¬æ“ä½œ\n    - åŸºäºé›†åˆä»£æ•°\n- æ¯ä¸ªç®—å­å°†ä¸€ä¸ªæˆ–å¤šä¸ªå…³ç³»ä½œä¸ºå…¶è¾“å…¥å¹¶è¾“å‡ºä¸€ä¸ªæ–°å…³ç³»\n    - å¯ä»¥å°†è¿ç®—ç¬¦é“¾æ¥åœ¨ä¸€èµ·ä»¥åˆ›å»ºæ›´å¤æ‚çš„è¿ç®—\n\n#### é€‰æ‹©è¿ç®—ï¼ˆselectï¼‰\n\nä»æ»¡è¶³é€‰æ‹©è°“è¯çš„å…³ç³»ä¸­é€‰æ‹©å…ƒç»„çš„å­é›†\n$\\sigma_{dept\\_name=\"Physics\"}(instructor)$\n$\\sigma_{dept\\_name=\"Physics\" \\lor salary>90000}(instructor)$\n\n#### æŠ•å½±è¿ç®—ï¼ˆprojectionï¼‰\n\nä½¿ç”¨ä»…åŒ…å«æŒ‡å®šå±æ€§çš„å…ƒç»„ç”Ÿæˆå…³ç³»\n$\\Pi_{ID,salary/12}(instructor)$\n\n#### ç¬›å¡å°”ç§¯è¿ç®—ï¼ˆproductï¼‰\n\nä»è¾“å…¥å…³ç³»ç”Ÿæˆä¸€ä¸ªåŒ…å«æ‰€æœ‰å¯èƒ½çš„å…ƒç»„ç»„åˆçš„å…³ç³»\n$instructor \\times tearches$\n\n#### è¿æ¥è¿ç®—ï¼ˆjoinï¼‰\nç”ŸæˆåŒ…å«æ‰€æœ‰å…ƒç»„çš„å…³ç³»ï¼Œè¿™äº›å…ƒç»„æ˜¯ä¸¤ä¸ªå…ƒç»„ï¼ˆæ¯ä¸ªè¾“å…¥å…³ç³»ä¸­çš„ä¸€ä¸ªï¼‰ä¸ä¸€ä¸ªæˆ–å¤šä¸ªå±æ€§çš„å…¬å…±å€¼çš„ç»„åˆ\n$r\\Join_{\\theta} s=\\sigma_{\\theta}(r\\times s)$\n$instructor\\Join_{instructor.ID=teaches.ID}teaches$\n\n#### é›†åˆè¿ç®—\n\n##### äº¤ï¼ˆintersectionï¼‰\nç”ŸæˆåŒ…å«ä»…å‡ºç°åœ¨ä¸€ä¸ªæˆ–ä¸¤ä¸ªè¾“å…¥å…³ç³»ä¸­çš„æ‰€æœ‰å…ƒç»„çš„å…³ç³»\n$r\\cap s$\n\n##### å¹¶ï¼ˆunionï¼‰\nç”Ÿæˆä¸€ä¸ªåªåŒ…å«å‡ºç°åœ¨ä¸¤ä¸ªè¾“å…¥å…³ç³»ä¸­çš„å…ƒç»„çš„å…³ç³»\n$r\\cup s$\n\n##### å·®ï¼ˆdifferenceï¼‰\nç”Ÿæˆä¸€ä¸ªåªåŒ…å«å‡ºç°åœ¨ç¬¬ä¸€ä¸ªè€Œä¸æ˜¯ç¬¬äºŒä¸ªè¾“å…¥å…³ç³»ä¸­çš„å…ƒç»„çš„å…³ç³»\n$r-s$\n\n#### æ›´åè¿ç®—ï¼ˆrenameï¼‰\nä¸ºå…³ç³»ä»£æ•°è¡¨è¾¾å¼çš„ç»“æœæä¾›åç§°\n$\\rho_{i}(instructor)$\n$\\rho_{i(A_1,A_2,...)}(instructor)$\n\n#### èµ‹å€¼è¿ç®—ï¼ˆassignmentï¼‰\nå°†å…³ç³»ä»£æ•°è¡¨è¾¾å¼åˆ†é…ç»™ä¸´æ—¶å…³ç³»å˜é‡\næŸ¥è¯¢å¯ä»¥å†™æˆç”±ä¸€ç³»åˆ—èµ‹å€¼ç»„æˆçš„é¡ºåºç¨‹åº\n$Physics \\leftarrow \\sigma_{dept\\_name=\"Physics\"}(instructor)$\n\n#### èšåˆè¿ç®—ï¼ˆaggregationï¼‰\n\nå…è®¸åœ¨æŸ¥è¯¢è¿”å›çš„ä¸€ç»„å€¼ä¸Šè®¡ç®—å‡½æ•°\n- average, sum, min, max, count, â€¦\n \n$a\\_id \\gamma min(b\\_id),sum(b\\_id)(r)$\n\n#### ç­‰ä»·æŸ¥è¯¢\nåœ¨å…³ç³»ä»£æ•°ä¸­ç¼–å†™æŸ¥è¯¢çš„æ–¹æ³•ä¸æ­¢ä¸€ç§\n$\\sigma_{dept\\_name=\"Physics\"\\land salary>90000}(instructor)$\n$\\sigma_{dept\\_name=\"Physics\"}(\\sigma_{salary>9000}(instructor))$\n## SQLä»‹ç»\n\n### SQLç»„æˆ\n\n- æ•°æ®æ“ä½œè¯­è¨€ (DML)\n- æ•°æ®å®šä¹‰è¯­è¨€ (DDL)\n    - å®Œæ•´æ€§çº¦æŸ\n    - è§†å›¾å®šä¹‰\n    - æˆæƒ\n- æ•°æ®æ§åˆ¶è¯­è¨€ (DCL)\n    - äº‹åŠ¡æ§åˆ¶\n    - åµŒå…¥å¼ SQL å’ŒåŠ¨æ€ SQL\n\n### æ•°æ®å®šä¹‰\n\n- char(n)ï¼šå…·æœ‰æŒ‡å®šé•¿åº¦nçš„å›ºå®šé•¿åº¦çš„å­—ç¬¦ä¸²\n- varchar(n)ï¼šå…·æœ‰æœ€å¤§é•¿åº¦nçš„å¯å˜é•¿åº¦çš„å­—ç¬¦ä¸²\n- intï¼šæ•´æ•°\n- smallintï¼šå°æ•´æ•°\n- numeric(p,d)ï¼šå…·æœ‰æŒ‡å®šç²¾åº¦çš„å®šç‚¹æ•°ï¼Œè¿™ä¸ªæ•°æœ‰pä½æ•°å­—ï¼ˆåŠ ä¸Šä¸€ä¸ªç¬¦å·ä½ï¼‰ï¼Œä¸”å°æ•°ç‚¹å³è¾¹æœ‰pä½ä¸­çš„dä½æ•°å­—\n- real, double precisionï¼šæµ®ç‚¹æ•°ä¸åŒç²¾åº¦æµ®ç‚¹æ•°\n- float(n)ï¼šç²¾åº¦è‡³å°‘ä¸ºnä¸ºæ•°å­—çš„æµ®ç‚¹æ•°\n\n### å»ºè¡¨\n\n```sql\nCREATE TABLE relation_name \n    (Attribute1 Domain1, \n    Attribute2 Domain2,\n     ..., \n     Attributen Domainn,\n     (integrity-constraint1),\n     ...,\n     (integrity-constraintk)\n    );\n```\n\nä¾‹ï¼š\n\n```sql\ncreate table instructor\n    (ID        varchar(5),\n     name        varchar(20) not null,\n     dept_name     varchar(20),\n     salary        numeric(8,2),\n     primary key(ID),\n     foreign key(dept_name) references department\n    );\n```\n\n### æ›´æ–°è¡¨\n\n```sql\n-- æ’å…¥æ•°æ®\nINSERT INTO instructor(ID, name, dept_name, salary) VALUES('10211', 'Smith', 'Biology', 66000);\n-- åˆ é™¤æ•°æ®ï¼Œä½†ä¸åˆ é™¤è¡¨\nDELETE FROM instructor WHERE ID= '10211';\n-- æ›´æ–°æ•°æ®\nUPDATE instructor SET name='Tom', salary=55000 WHERE ID= '10211';\n-- åˆ é™¤è¡¨\nDROP TABLE instructor;\n-- æ”¹å˜è¡¨ç»“æ„\nALTER TABLE instructor ADD address varchar(20);\nALTER TABLE instructor DROP address;\n```\n\n### æŸ¥è¯¢è¯­å¥\n\n**SELECT FROM**\n\n```sql\n-- æ˜Ÿå·æŸ¥è¯¢æ‰€æœ‰çš„å±æ€§\nSELECT * FROM instructor;\n-- ä½¿ç”¨DISTINCTå…³é”®å­—å»é‡\nSELECT DISTINCT name FROM instructor;\n-- ä½¿ç”¨ASå…³é”®å­—ä¸ºå±æ€§åˆ«å\nSELECT id, name, salary*1.1 AS new_salary FROM instructor;\n-- å¸¸é‡çš„ä½¿ç”¨\nSELECT id, name, salary*1.1 new_salary,'Good' FROM instructor;\n-- å‡½æ•°çš„ä½¿ç”¨\nSELECT id, name, now() FROM instructor;\n-- ä¼ªè¡¨çš„ä½¿ç”¨\nSELECT now() FROM DUAL;\n-- ä¼ªè¡¨çš„çœç•¥\nSELECT now();\n-- å¤šè¡¨è”åˆæŸ¥è¯¢\nSELECT * FROM instructor, section;\n-- ä½¿ç”¨ASå…³é”®å­—ä¸ºè¡¨åˆ›å»ºåˆ«å\nSELECT * FROM instructor AS t1, instructor t2;\n-- ä¸ºåµŒå¥—å­æŸ¥è¯¢è¡¨åˆ›å»ºåˆ«å\nSELECT * FROM (select id, name from instructor) t;\n-- ä½¿ç”¨NATURAL JOINè¿›è¡Œè‡ªç„¶è¿æ¥\nSELECT * FROM instructor NATURAL JOIN teaches;\n```\n\n**SELECT FROM WHERE**\n\n```sql\n-- WHEREå…³é”®å­—åŸºæœ¬ä½¿ç”¨\nSELECT * FROM instructor WHERE salary>50000;\n-- ä½¿ç”¨é€»è¾‘è¿æ¥è¯ ä½¿ç”¨LIKEå…³é”®å­—æ¨¡ç³ŠæŸ¥è¯¢ï¼Œ%è¡¨ç¤ºåŒ¹é…ä»»æ„å­ä¸²ï¼Œ_è¡¨ç¤ºåŒ¹é…ä»»æ„å•ä¸ªå­—ç¬¦\nSELECT * FROM instructor WHERE salary>50000 AND name LIKE '%d_r%';\n-- ä½¿ç”¨ESCAPEæ”¹å˜è½¬ä¹‰ç¬¦å·\nSELECT * FROM instructor WHERE salary>50000 AND name LIKE '%100\\%'\nESCAPE '\\ ';\n-- ä½¿ç”¨å­—ç¬¦ä¸²è¿ç®—å‡½æ•°\nSELECT * FROM instructor WHERE length(name)>5;\n-- ä½¿ç”¨||ç®¡é“ç¬¦å·è¿æ¥å­—ç¬¦ä¸²\nSELECT * FROM instructor WHERE name='Go'||'ld';\n-- ä½¿ç”¨BETWEEN ANDå…³é”®å­—\nSELECT * FROM instructor WHERE salary BETWEEN 90000 AND 100000;\n-- ä½¿ç”¨å…ƒç»„ç¬¦å·è¿›è¡Œæ¯”è¾ƒ\nSELECT name, course_id FROM instructor, teaches WHERE (instructor.id, dept_name) = (teaches.id, 'Biology');\n```\n\n**SELECT FROM GROUP BY HAVING**\n\n```sql\n-- ä½¿ç”¨èšé›†å‡½æ•°max,min,count,avg,sum\nSELECT avg(salary) FROM instructor;\n-- ä½¿ç”¨èšé›†å‡½æ•°å†…åµŒå¥—DISTINCTå…³é”®å­—å»é‡\nSELECT count(DISTINCT id) FROM teaches;\n-- ä½¿ç”¨GROUP BYå…³é”®å­—åˆ†ç»„èšé›†\nSELECT dept_name, avg(salary) FROM instructor GROUP BY dept_name;\n-- é”™è¯¯å†™æ³•ï¼idæ—¢æ²¡å‡ºç°åœ¨èšé›†å‡½æ•°ä¸­ï¼Œä¹Ÿæ²¡å‡ºç°åœ¨GROUP BYä¸­\nSELECT id, dept_name, avg(salary) FROM instructor GROUP BY dept_name;\n-- åœ¨HAVINGå…³é”®å­—ä¸­å¯ä»¥ä½¿ç”¨èšé›†å‡½æ•°\n-- ä¸SELECTå…³é”®å­—ç›¸åŒï¼Œå‡ºç°åœ¨HAVINGå­å¥ä¸­çš„å±æ€§å¿…é¡»è¦ä¹ˆè¢«èšé›†ï¼Œè¦ä¹ˆå‡ºç°åœ¨GROUP BYå­å¥ä¸­\nSELECT dept_name, avg(salary) FROM instructor GROUP BY dept_name\nHAVING avg(salary)>42000;\n```\n\n**SELECT FROM ORDER BY**\n\n```sql\n-- ä½¿ç”¨ORDER BYå…³é”®å­—å¯¹ç»“æœé›†æ’åº\nSELECT * FROM instructor ORDER BY name;\n-- ä½¿ç”¨DESC,ASCå…³é”®å­—è¿›è¡Œé™/å‡æ’åº\nSELECT * FROM instructor ORDER BY name DESC, salary ASC;\n-- ä½¿ç”¨å±æ€§åˆ«åè¿›è¡Œæ’åº\nSELECT id, name, salary*1.1 AS new_salary FROM instructor ORDER BY new_salary;\n-- ä½¿ç”¨å±æ€§ä¸‹æ ‡è¿›è¡Œæ’åº\nSELECT id, name, salary*1.1 AS new_salary FROM instructor ORDER BY 3;\n```\n\n### é›†åˆè¿ç®—\n\n```sql\n-- é›†åˆè¿ç®—å‡è‡ªåŠ¨å»é‡ï¼Œå¦‚æœéœ€è¦ä¿ç•™é‡å¤é¡¹ï¼Œéœ€è¦æ·»åŠ ALLå…³é”®å­—\n-- å¹¶è¿ç®—\n(SELECT course_id  FROM section WHERE sem = 'FALL' AND year = 2017) \nUNION\n(SELECT course_id FROM section WHERE sem = 'Spring' AND year = 2018)\n-- äº¤è¿ç®—ï¼Œä½¿ç”¨ALLå…³é”®å­—\n(SELECT course_id FROM section WHERE sem = 'Fall' AND year = 2017)\nINTERSECT ALL\n(SELECT course_id FROM section WHERE sem = 'Spring' AND year = 2018)\n-- å·®è¿ç®—\n(SELECT course_id FROM section WHERE sem = 'Fall' AND year = 2017)\nEXCEPT\n(SELECT course_id FROM section WHERE sem = 'Spring' AND year = 2018)\n```\n\n### ç©ºå€¼\n\n- ä»»ä½•æ¶‰åŠ null çš„ç®—æœ¯è¡¨è¾¾å¼çš„ç»“æœéƒ½æ˜¯ null\n    - 5 + null returns null\n- ä»»ä½•æ¶‰åŠnullçš„æ¯”è¾ƒçš„ç»“æœéƒ½æ˜¯unknown\n    - 5 &lt; null or null <&gt; null or null = null\n- unknownæœ‰å…³çš„å¸ƒå°”è¿ç®—\n    - (true AND unknown) = unknwon\n    - (false AND unknown) = false\n    - (unknown AND unknown) = unknown\n    - (true OR unknown) = true\n    - (false OR unknown) = unknown\n    - (unknown OR unknown) = unknown\n    - (NOT unknown) = unknown\n- å¦‚æœ where å­å¥è°“è¯çš„ç»“æœä¸º unknownï¼Œåˆ™å®ƒçš„ç»“æœè¢«è§†ä¸º false\n- è°“è¯IS NULL/IS NOT NULLå¯ç”¨äºæ£€æŸ¥ç©ºå€¼\n- è°“è¯IS UNKNOWN/IS NOT UNKNOWNå¯ç”¨äºæ£€æµ‹unknownï¼ˆåŒºåˆ«äºtrueå’Œfalseï¼‰\n\n```sql\nSELECT name FROM instructor WHERE salary IS NULL;\n```\n\n#### èšé›†å‡½æ•°å’Œç©ºå€¼\n\n- é™¤äº†count(\\*)ä¹‹å¤–çš„æ‰€æœ‰èšé›†å‡½æ•°éƒ½å¿½ç•¥å…¶è¾“å…¥é›†åˆçš„ç©ºå€¼\n- ç©ºé›†çš„countè¿ç®—å€¼ä¸º0\n\n### å­æŸ¥è¯¢\nå­æŸ¥è¯¢æ˜¯åµŒå¥—åœ¨å¦ä¸€ä¸ªæŸ¥è¯¢ä¸­çš„select-from-whereè¡¨è¾¾å¼\n\n#### é›†åˆæˆå‘˜èµ„æ ¼\n\n```sql\n-- INå…³é”®å­—æµ‹è¯•æˆå‘˜èµ„æ ¼\nSELECT DISTINCT course_id FROM section \nWHERE semester = 'Fall' AND year= 2017 AND course_id IN \n(select course_id from section where semester = 'Spring' and year= 2018);\n\n-- NOT INå…³é”®å­—æµ‹è¯•æˆå‘˜èµ„æ ¼çš„ç¼ºå¤±\nSELECT DISTINCT course_id FROM section \nWHERE semester = 'Fall' AND year= 2017 AND course_id NOT IN \n(select course_id from section where semester = 'Spring' and year= 2018);\n\n-- ç”¨äºæšä¸¾é›†åˆ\nSELECT DISTINCT name FROM instructor WHERE name NOT IN ('Mozart', 'Einstein');\n\n-- ç”¨äºå¤šå±æ€§æµ‹è¯•æˆå‘˜èµ„æ ¼\nSELECT count (DISTINCT ID) from takes \nWHERE (course_id, sec_id, semester, year) IN \n(SELECT course_id, sec_id, semester, year FROM teaches where teaches.ID= 10101);\n```\n\n#### é›†åˆæ¯”è¾ƒ\n\n```sql\n-- >,<,>=,<=,<>,= SOMEå…³é”®å­—ç”¨äºè¡¨è¾¾è‡³å°‘æ¯”æŸä¸€ä¸ªå¤§/å°/ç›¸ç­‰\nSELECT name FROM instructor WHERE salary > SOME \n(select salary from instructor  where dept name = 'Biology');\n\n-- >,<,>=,<=,<>,= ALLå…³é”®å­—ç”¨äºè¡¨è¾¾æ¯”æ‰€æœ‰çš„å¤§/å°/ç›¸ç­‰\nSELECT name FROM instructor WHERE salary > ALL \n(select salary from instructor  where dept name = 'Biology');\n```\n \n#### ç©ºå…³ç³»æµ‹è¯•\n\n```sql\n-- EXISTSä½œä¸ºåœ¨å‚æ•°çš„å­æŸ¥è¯¢éç©ºæ—¶è¿”å›trueå€¼\n-- NOT EXISTSåœ¨ä½œä¸ºå‚æ•°çš„å­æŸ¥è¯¢ä¸ºç©ºæ—¶è¿”å›trueå€¼\n-- æ¥è‡ªå¤–å±‚æŸ¥è¯¢çš„ç›¸å…³åç§°å¯ä»¥ç”¨åœ¨WHEREå­å¥çš„æŸ¥è¯¢ä¸­ï¼Œæ­¤æ—¶è¯¥å­æŸ¥è¯¢è¢«ç§°ä¸ºç›¸å…³å­æŸ¥è¯¢ï¼ˆcorrelated subqueryï¼‰\n-- å…³ç³»AåŒ…å«å…³ç³»Bå¯ä»¥å†™æˆnot exists(B except A)\nSELECT course_id \nFROM section AS S\nWHERE semester = 'Fall' AND year = 2017 AND \nEXISTS (select * \n        from section as T \n        where semester = 'Spring' and year= 2018 and S.course_id = T.course_id);\n```\n\n#### é‡å¤å…ƒç»„å­˜åœ¨æ€§æµ‹è¯•\n\n```sql\n-- UNIQUEåœ¨ä½œä¸ºå‚æ•°çš„å­æŸ¥è¯¢æ²¡æœ‰é‡å¤çš„å…ƒç»„æ—¶è¿”å›trueå€¼\n-- NOT UNIQUEåœ¨ä½œä¸ºå‚æ•°çš„å­æŸ¥è¯¢æœ‰é‡å¤çš„å…ƒç»„æ—¶è¿”å›trueå€¼\nSELECT t.course_id FROM course t \nWHERE UNIQUE (select r.course_id from section r \n              where t.course_id= r.course_id and r.year = 2017);\n```\n\n#### FROMå­å¥çš„å­æŸ¥è¯¢\n\n```sql\n-- ä½¿ç”¨ASå…³é”®å­—ä¸ºå­æŸ¥è¯¢ç»“æœèµ·åˆ«åï¼Œå¹¶å¯¹å±æ€§è¿›è¡Œé‡å‘½å\nSELECT dept_name, avg_salary FROM ( \n    select dept_name, avg (salary) \n    from instructor\n    group by dept_name\n    ) AS dept_avg (dept_name, avg_salary)\nWHERE avg_salary > 42000;\n-- ä½¿ç”¨LATERALå…³é”®å­—è®¿é—®åŒä¸€ä¸ªFROMå­å¥ä¸­åœ¨å®ƒå‰é¢çš„è¡¨æˆ–å­æŸ¥è¯¢çš„å±æ€§\nSELECT name, salary, avg_salary\nFROM instructor I1, LATERAL (select avg(salary) as avg_salary\n                             from instructor I2\n                             where I2.dept_name = I1.dept_name);\n```\n\n#### WITHå­å¥\n\n```sql\n-- ä½¿ç”¨WITHå…³é”®å­—å®šä¹‰ä¸´æ—¶å…³ç³»\nWITH max_budget (value) AS (select max(budget) from department)\nSELECT department.name FROM department, max_budget\nWHERE department.budget = max_budget.value;\n```\n\n#### æ ‡é‡å­æŸ¥è¯¢ï¼ˆscalar subqueryï¼‰\n\n- SQLå…è®¸å­æŸ¥è¯¢å‡ºç°åœ¨è¿”å›å•ä¸ªå€¼çš„è¡¨è¾¾å¼èƒ½å¤Ÿå‡ºç°çš„ä»»ä½•åœ°æ–¹ï¼Œåªè¦è¯¥å­æŸ¥è¯¢**åªè¿”å›ä¸€ä¸ªåŒ…å«å•ä¸ªå±æ€§çš„å…ƒç»„**\n- æ ‡é‡å­æŸ¥è¯¢å¯ä»¥å‡ºç°åœ¨selectï¼Œwhereå’Œhavingå­å¥ä¸­\n\n```sql\nSELECT dept_name,\n    (select count(*) from instructor i\n    where d.dept_name = i.dept_name)\n    AS num_instructors\nfrom department d;\n```\n\n### åˆ é™¤è¯­å¥\n\n```sql\n-- æ³¨æ„è¿è¡Œé¡ºåºï¼Œé¦–å…ˆæ‰§è¡Œavg(salary)å¹¶æŸ¥è¯¢åˆ°æ‰€æœ‰çš„å…ƒç»„åå†æ‰§è¡Œåˆ é™¤\nDELETE FROM instructor WHERE \n salary < (select avg (salary) from instructor);\n```\n\n### æ’å…¥è¯­å¥\n\n```sql\n-- å¯ä»¥åœ¨æŸ¥è¯¢ç»“æœçš„åŸºç¡€ä¸Šæ’å…¥å…ƒç»„\nINSERT INTO instructor\n    select ID, name, dept_name, 18000 \n    from student\n    where dept_name = 'Music' and total_cred > 144;\n    \n-- å¦ä¸€ç§æ’å…¥æ–¹å¼\nSELECT  ID, name, dept_name, 18000\nINTO instructor\nFROM student\nWHERE dept_name = 'Music' AND total_cred > 144;    \n```\n\n### ä¿®æ”¹è¯­å¥\n\n```sql\n-- ä½¿ç”¨CASEä»¥é¿å…æ›´æ–°æ¬¡åºå¼•å‘é—®é¢˜\nUPDATE instructor  \n    SET salary = CASE\n        WHEN salary <= 100000 THEN salary * 1.05\n        ELSE salary * 1.03\n    END\n-- ä½¿ç”¨æ ‡é‡å­æŸ¥è¯¢\nUPDATE student\n    SET tot_cred = (\n        select sum(credits)\n        from takes, course\n        where student.ID = takes.ID and\n            takes.course_id = course.course_id and\n            takes.grade <> 'F' and\n            takes.grade is not null);\n```\n\n## ä¸­çº§SQL\n\n### è¿æ¥è¡¨è¾¾å¼\n\n#### å†…è¿æ¥ï¼ˆinner joinï¼‰\n\n- ä¸ä¿ç•™æœªåŒ¹é…å…ƒç»„\n\n#### å¤–è¿æ¥ï¼ˆouter joinï¼‰\n\n- å·¦å¤–è¿æ¥ï¼ˆleft outer joinï¼‰\n    - åªä¿ç•™å‡ºç°åœ¨å·¦å¤–è¿æ¥è¿ç®—ä¹‹å‰ï¼ˆå·¦è¾¹ï¼‰çš„å…³ç³»ä¸­çš„å…ƒç»„\n- å³å¤–è¿æ¥ï¼ˆright outer joinï¼‰\n    - åªä¿ç•™å‡ºç°åœ¨å³å¤–è¿æ¥è¿ç®—ä¹‹åï¼ˆå³è¾¹ï¼‰çš„å…³ç³»ä¸­çš„å…ƒç»„\n- å…¨å¤–è¿æ¥ï¼ˆfull outer joinï¼‰\n    - ä¿ç•™å‡ºç°åœ¨ä¸¤ä¸ªå…³ç³»ä¸­çš„å…ƒç»„\n\n#### è¿æ¥æ¡ä»¶\n\n- natural\n    - è‡ªç„¶è¿æ¥\n- on&lt;predicate&gt;\n    - å…è®¸åœ¨å‚ä¸è¿æ¥çš„å…³ç³»ä¸Šè®¾ç½®é€šç”¨çš„è°“è¯\n- using(A1,A2...An)\n    - è®¾å®šæŒ‡å®šå±æ€§ä¸Šçš„å–å€¼ç›¸åŒ¹é…\n\n### è§†å›¾\n\n```sql\n-- ä½¿ç”¨VIEWå…³é”®å­—åˆ›å»ºè§†å›¾\nCREATE VIEW faculty AS \n    select ID, name, dept_name from instructor;\n-- ä½¿ç”¨è§†å›¾\nSELECT name FROM faculty WHERE dept_name = 'Biology';\n-- è§†å›¾åµŒå¥—è§†å›¾\nCREATE VIEW physics_fall_2017 AS\n    select course.course_id, sec_id, building, room_number\n    from course c, section s\n    where c.course_id = s.course_id and c.dept_name = 'Physics'\n        and s.semester = 'Fall' and s.year = '2017';\nCREATE VIEW physics_fall_2017_watson AS\n    select course_id, room_number  from physics_fall_2017\n    where building= 'Watson';\n```\n\n#### è§†å›¾æ›´æ–°\n\nä»…å…è®¸å¯¹ç®€å•è§†å›¾è¿›è¡Œæ›´æ–°ï¼ˆupdateã€insertã€deleteï¼‰\n\n- from å­å¥åªæœ‰ä¸€ä¸ªæ•°æ®åº“å…³ç³»\n- select å­å¥ä»…åŒ…å«å…³ç³»çš„å±æ€§åï¼Œä¸åŒ…å«ä»»ä½•è¡¨è¾¾å¼ã€èšé›†æˆ–distinctå£°æ˜\n- ä»»ä½•æœªåœ¨ select å­å¥ä¸­åˆ—å‡ºçš„å±æ€§éƒ½å¯ä»¥å– null å€¼\n- æŸ¥è¯¢æ²¡æœ‰ group by æˆ– having å­å¥\n\nå¯ä»¥é€šè¿‡åœ¨è§†å›¾å®šä¹‰çš„æœ«å°¾æ’å…¥with check optionå­å¥æ¥é˜²æ­¢æ›´æ–°ä¸æ»¡è¶³è§†å›¾çš„å®šä¹‰\n\n### äº‹åŠ¡\n\n- æäº¤äº‹åŠ¡ï¼ˆcommit workï¼‰\n- å›æ»šäº‹åŠ¡ï¼ˆrollback workï¼‰\n\n### å®Œæ•´æ€§çº¦æŸ\n- not null\n    - éç©ºçº¦æŸï¼Œä¸å…è®¸å­˜åœ¨ç©ºå€¼\n- primary key(A1,A2,...,Am)\n    - ä¸»é”®çº¦æŸï¼Œå±æ€§A1,A2,...,Amå½¢æˆä¸»é”®\n- unique( A1, A2, â€¦, Am)\n    - å”¯ä¸€æ€§çº¦æŸï¼Œå±æ€§A1,A2,...,Amå½¢æˆè¶…é”®ï¼ˆå¯ä»¥ä¸ºç©ºï¼‰\n- check (P)\n    - æŒ‡å®šä¸€ä¸ªè°“è¯Pï¼Œå…³ç³»ä¸­çš„æ¯ä¸ªå…ƒç»„éƒ½å¿…é¡»æ»¡è¶³è°“è¯P\n- foreign key (â€¦) references t(â€¦)\n    - å¤–é”®çº¦æŸï¼Œè¢«æŒ‡å®šçš„å±æ€§åˆ—è¡¨å¿…é¡»å£°æ˜ä¸ºè¢«å¼•ç”¨å…³ç³»çš„è¶…é”®ï¼Œå³ä¸»é”®çº¦æŸæˆ–å”¯ä¸€æ€§çº¦æŸ\n\n```sql\nFOREIGN KEY (dept_name) REFERENCES department\nON DELETE CASCADE     -- çº§è”åˆ é™¤\nON UPDATE CASCADE    -- çº§è”æ›´æ–°\nON DELETE SET NULL    -- çº§è”ç½®ç©º\nON DELETE SET DEFAULT    -- çº§è”ç½®é»˜è®¤å€¼\nON DELETE RESTRICT    -- ç¦æ­¢çº§è”\n```\n\n- assertion\n    - æ–­è¨€ï¼Œå³è°“è¯\n\n```sql\nCREATE ASSERTION credits CHECK\n(NOT EXISTS(SELECT ID FROM student))\n```\n\n### SQLå›ºæœ‰å±æ€§\n\n- dateï¼šæ—¥å†æ—¥æœŸï¼ŒåŒ…æ‹¬å¹´ï¼ˆå››ä½ï¼‰ã€æœˆå’Œæ—¥\n\n```sql\ndate '2005-7-27'\n```\n\n- timeï¼šä¸€å¤©ä¸­çš„æ—¶é—´ï¼Œç”¨æ—¶åˆ†ç§’æ¥è¡¨ç¤º\n\n```sql\ntime '09:00:30'\n```\n\n- timestampï¼šdateå’Œtimeçš„ç»“åˆ\n\n```sql\ntimestamp  '2005-7-27 09:00:30.75'\n```\n\n- intervalï¼šåŒºé—´ï¼Œå…è®¸åœ¨æ—¥æœŸã€æ—¶é—´å’Œæ—¶é—´åŒºé—´ä¸Šè¿›è¡Œè®¡ç®—\n\n```sql\ninterval '1' day\n```\n\n- blob/clobï¼šäºŒè¿›åˆ¶/å­—ç¬¦å¤§å¯¹è±¡\n\n```sql\nbook_review clob(10KB)\nimage blob(10MB)\n```\n\n### ç±»å‹è½¬æ¢&ç¼ºçœå€¼\n\n```sql\n-- ä½¿ç”¨CASTå‡½æ•°å°†varcharç±»å‹çš„IDå¼ºåˆ¶è½¬æ¢ä¸ºnumeric\nSELECT CAST(ID AS numeric(5))AS inst_id\nFROM instructor\n\n-- ä½¿ç”¨COALESCEå‡½æ•°æ”¹å˜ç©ºå€¼æ˜¾ç¤ºæ–¹å¼\n-- COALESCEå‡½æ•°è¦æ±‚æ‰€æœ‰å‚æ•°å¿…é¡»æ˜¯ç›¸åŒçš„ç±»å‹\nSELECT ID,COALESCE(salary,0)AS salary\nFROM instructor\n\n-- ä½¿ç”¨DEFAULTå®šä¹‰ç¼ºçœå€¼\nCREATE TABLE student\n(tot_credit NUMERIC(3,0) DEFAULT 0);\n```\n\n### ç”¨æˆ·è‡ªå®šä¹‰ç±»å‹ï¼ˆUDTï¼‰&åŸŸ\n\n```sql\n-- ä½¿ç”¨TYPEå…³é”®å­—è‡ªå®šä¹‰ç±»å‹\nCREATE TYPE Dollars AS numeric (12,2) FINAL;\n-- ä½¿ç”¨è‡ªå®šä¹‰ç±»å‹\nCREATE TABLE dept(name varchar (20),building varchar(15),budget Dollars);\n\n-- ä½¿ç”¨DOMAINå…³é”®å­—è‡ªå®šä¹‰åŸŸï¼Œå…è®¸æ·»åŠ å®Œæ•´æ€§çº¦æŸ\nCREATE DOMAIN person_name char(20) NOT NULL;\n-- åŸŸå…è®¸ä½¿ç”¨CONSTRAINTå…³é”®å­—æ·»åŠ çº¦æŸ\nCREATE DOMAIN degree_level varchar(10) \n    CONSTRAINT degree_level_test\n        CHECK (value in ('Bachelors', 'Masters', 'Doctorate'));\n```\n\n### ç´¢å¼•\n\n```sql\n-- åŸºç¡€å»ºè¡¨ï¼ŒIDä¸ºä¸»é”®\nCREATE TABLE student (ID varchar (5), \n                      name varchar (20) not null,\n                      dept_name varchar (20),\n                      tot_cred numeric (3,0) default 0,\n                      primary key (ID));\n-- UNIQUE INDEXä½¿ç”¨å€™é€‰é”®ä½œä¸ºç´¢å¼•\nCREATE UNIQUE INDEX studentName_index ON student(name);\n-- INDEXåˆ›å»ºä¸€èˆ¬ç´¢å¼•\nCREATE INDEX studentDept_index ON student(dept_name);\n-- æ˜¾ç¤ºç´¢å¼•\nSHOW INDEX ON student;\n-- åˆ é™¤ç´¢å¼•\nDROP INDEX studentName_index;\n```\n\n### æˆæƒ\n\n#### æƒé™æˆäºˆä¸æ”¶å›\n\n```sql\n-- æˆäºˆæƒé™\n-- GRANT <æƒé™åˆ—è¡¨> ON <å…³ç³»åæˆ–è§†å›¾å> TO <ç”¨æˆ·/è§’è‰²åˆ—è¡¨>;\n-- WITH GRANT OPTIONè¡¨ç¤ºè¯¥ç”¨æˆ·å¯ä»¥å°†è‡ªå·±æ‹¥æœ‰çš„æƒé™æˆæƒç»™åˆ«äºº\nGRANT select/insert/delete/update/all privilege ON instructor TO U1, U2, U3/public WITH GRANT OPTION;\n-- è¡¨ç¤ºä»…å¯æ›´æ–°budgetå±æ€§\nGRANT update(budget) ON department TO U1;\n\n-- å›æ”¶æƒé™\n-- REVOKE <æƒé™åˆ—è¡¨> ON <å…³ç³»åæˆ–è§†å›¾å> FROM <ç”¨æˆ·/è§’è‰²åˆ—è¡¨>;\n-- CASCADEè¡¨ç¤ºçº§è”æ”¶æƒï¼ŒRESTRICTè¡¨ç¤ºç¦æ­¢çº§è”æ”¶æƒ\nREVOKE select ON student FROM U1, U2, U3 CASCADE/RESTRICT;\n```\n\n#### è§’è‰²\n\n```sql\n-- åˆ›å»ºè§’è‰²\nCREATE ROLE teaching_assistant;\nCREATE ROLE instructor;\n\n-- è§’è‰²è¢«æˆäºˆæƒé™\nGRANT select ON takes TO teaching_assistant;\n-- è§’è‰²æˆäºˆè§’è‰²\nGRANT teaching_assistant TO instructor;\n-- è§’è‰²æˆäºˆç”¨æˆ·\nGRANT instructor TO Satoshi;\n```\n\n## é«˜çº§SQL\n\n### ä½¿ç”¨ç¨‹åºè®¾è®¡è¯­è¨€è®¿é—®SQL\n\n- ä½¿ç”¨ä¸€ç»„å‡½æ•°è¿æ¥åˆ°æ•°æ®åº“æœåŠ¡å™¨è¿›è¡Œé€šä¿¡\n    - **JDBC**\n    - ODBC\n    - æœ¬åœ°åº“\n- åµŒå…¥å¼ SQL\n    - SQLJ\n\nä¾‹ï¼š\n```java\nimport java.sql.*;\n\npublic class jdbcSelect {\n    public static void main(String[] args) {\n        Connection c = null;\n        Statement stmt = null;\n        try {\n            Class.forName(\"org.postgresql.Driver\");\n            //Open a connection\n            c = DriverManager.getConnection(\"jdbc:postgresql://d-sketon.top:15432/newdb\", \"root\", \"root\");\n            c.setAutoCommit(false);\n            System.out.println(\"Connect to database gaussdb successfully !\");\n            //Create a statement object\n            stmt = c.createStatement();\n            //Execute the statement\n            ResultSet rs = stmt.executeQuery(\"SELECT * FROM employee;\");\n            while (rs.next()) {\n                //Process the result set\n                int id = rs.getInt(\"id\");\n                String name = rs.getString(\"name\");\n                int age = rs.getInt(\"age\");\n                String address = rs.getString(\"address\");\n                float salary = rs.getFloat(\"salary\");\n                System.out.println(\"ID = \" + id);\n                System.out.println(\"NAME = \" + name);\n                System.out.println(\"AGE = \" + age);\n                System.out.println(\"ADDRESS = \" + address);\n                System.out.println(\"SALARY = \" + salary);\n                System.out.println();\n            }\n            rs.close();\n            stmt.close();\n            c.close();\n        } catch (Exception e) {\n            //Exception mechanism\n            System.err.println(e.getClass().getName() + \": \" + e.getMessage());\n            System.exit(0);\n        }\n        System.out.println(\"Operation done successfully !\");\n    }\n}\n```\n\n### å‡½æ•°å’Œè¿‡ç¨‹\n\n```sql\n-- SQLä¸­å®šä¹‰çš„å‡½æ•°\nCREATE FUNCTION dept_count(dept_name varchar(20))\n    RETURN INTEGER\n    BEGIN\n    DECLARE d_count INTEGER;\n        SELECT COUNT(*) INTO d_count\n        FROM instructor\n        WHERE instructor.dept_name = dept_name\n    RETURN d_count;\n    END\n-- ä½¿ç”¨å‡½æ•°\nSELECT dept_name,budget\nFROM department\nWHERE dept_count(dept_name)>12;\n\n-- SQLä¸­çš„è¡¨å‡½æ•°\nCREATE FUNCTION instructor_of(dept_name varchar(20))\n    RETURNS TABLE(\n        ID VARCHAR(5),\n        name VARCHAR(20)\n    )\nRETURN TABLE\n    (SELECT ID,name\n    FROM instructor\n    where instructor.dept_name=dept_name);\n-- ä½¿ç”¨å‡½æ•°\nSELECT * FROM TABLE(instructor_of('Finance'));\n\n-- SQLä¸­çš„è¿‡ç¨‹å®šä¹‰\nCREATE PROCEDURE dept_count_proc(IN dept_name VARCHAR(20),out d_count INTEGER)\nBEGIN\n    SELECT COUNT(*) INTO d_count\n    FROM instructor\n    WHERE instructor.dept_name=dept_name\nEND\n-- ä½¿ç”¨è¿‡ç¨‹\nDECLARE d_count INTEGER;\nCALL dept_count_proc( 'Physics', d_count);\n```\n\n#### ç”¨äºè¿‡ç¨‹å’Œå‡½æ•°çš„è¯­è¨€ç»“æ„\n\n```sql\n-- åŸºç¡€å¤åˆè¯­å¥\nBEGIN\n...\nEND\n-- å…¶ä¸­åŒ…å«çš„æ‰€æœ‰è¯­å¥ä½œä¸ºå•ä¸ªäº‹åŠ¡æ¥æ‰§è¡Œ\nBEGIN ATOMIC\n...\nEND\n\n-- whileè¯­å¥\nWHILE å¸ƒå°”è¡¨è¾¾å¼ DO\n    è¯­å¥åºåˆ—;\nEND WHILE\n\n-- forè¯­å¥\nFOR å¸ƒå°”è¡¨è¾¾å¼ DO\n    è¯­å¥åºåˆ—;\nEND FOR\n\n-- repeatè¯­å¥\nREPEAT\n    è¯­å¥åºåˆ—;\nUNTIL å¸ƒå°”è¡¨è¾¾å¼\nEND REPEAT\n\n-- if-then-elseè¯­å¥\nIF å¸ƒå°”è¡¨è¾¾å¼\n    THEN è¯­å¥æˆ–å¤åˆè¯­å¥\nELSEIF å¸ƒå°”è¡¨è¾¾å¼\n    THEN è¯­å¥æˆ–å¤åˆè¯­å¥\nELSE è¯­å¥æˆ–å¤åˆè¯­å¥\nEND IF\n```\n\n### è§¦å‘å™¨\n\n```sql\n-- æ“ä½œä¹‹åè§¦å‘update/insert/delete/select\nCREATE TRIGGER credits_earned AFTER UPDATE grade ON takes\n-- æ“ä½œä¹‹å‰è§¦å‘update/insert/delete/select\nCREATE TRIGGER credits_earned BEFORE UPDATE grade ON takes\n\n-- è¿‡æ¸¡è¡Œ\nREFERENCING NEW ROW AS nrow\nREFERENCING OLD ROW AS orow\n-- è¿‡æ¸¡è¡¨ï¼ˆä¸èƒ½ç”¨äºbeforeè§¦å‘å™¨ï¼‰\nREFERENCING NEW TABLE AS ntable\nREFERENCING OLD TABLE AS otable\n\n-- é’ˆå¯¹æ¯ä¸ªå—å½±å“çš„è¡Œæ‰§è¡Œä¸€ä¸ªæ“ä½œ\nFOR EACH ROW\n-- æ­£å¯¹æ•´æ¡SQLè¯­å¥æ‰§è¡Œå•ä¸ªæ“ä½œ\nFOR EACH STATEMENT\n\nWHEN nrow.grade <> 'F' AND nrow.grade IS NOT NULL AND (orow.grade = 'F' OR orow.grade IS NULL)\nBEGIN ATOMIC\n    UPDATE student\n        SET tot_cred=tot_cred+\n        (SELECT credits\n        FROM course\n        WHEN course.course_id=nrow.course_id)\n    WHEN student.id=nrow.id;\nEND;\n```\n\n### é€’å½’æŸ¥è¯¢\n\n```sql\n-- ä½¿ç”¨WITH RECURSIVEå»ºç«‹é€’å½’è§†å›¾\nWITH RECURSIVE rec_prereq(course_id, prereq_id) as (\n    select course_id, prereq_id from prereq\n    union\n    select rpr.course_id, pr.prereq_id,\n    from rec_prereq rpr, prereq pr where rpr.prereq_id = pr.course_id\n)\nSELECT âˆ— FROM rec_prereq;\n```\n\n### æ’å\n\n```sql\n-- ä½¿ç”¨rankå‡½æ•°è¿›è¡Œæ’å\nSELECT ID, rank() over (order by GPA desc) AS s_rank FROM grades;\n-- dense_rankå‡½æ•°ä¸ä¼šäº§ç”Ÿç©ºæ¡£\nSELECT ID, dense_rank() over (order by GPA desc) AS s_rank \nFROM grades;\n-- nulls last/nulls firstæŒ‡å®šç©ºå€¼åœ¨æ’åä¸­çš„ä½ç½®\nSELECT ID, dense_rank() over (order by GPA desc nulls last) AS s_rank \nFROM grades;\n-- ä½¿ç”¨partition byå…³é”®å­—é€‰æ‹©åœ¨ä¸åŒçš„åˆ†åŒºé‡Œè¿›è¡Œæ’å\nSELECT ID, dept_name,\n    rank() over(partition by dept_name order by GPA desc) as dept_rank\nFROM grades\nORDER BY dept_name, dept_rank;\n\n```\n\n### åˆ†çª—\n\n```sql\n-- å‰ä¸€ä¸ªåˆ°åä¸€ä¸ªä¹‹é—´åˆ†çª—\nSELECT date, sum(value) over \n    (order by date rows between 1 preceding and 1 following)\nFROM sales\n-- å«å½“å‰è¡Œ\nSELECT date, sum(value) over \n    (order by date rows bewtween 1 preceding and current row)\nFROM sales\n-- ä½¿ç”¨partition byå…³é”®å­—é€‰æ‹©åœ¨ä¸åŒçš„åˆ†åŒºé‡Œåˆ†çª—\n-- unbounded precedingä»£è¡¨å‰é¢æ‰€æœ‰æ•°æ®åˆ†çª—\nselect account, date, sum(value) over\n    (partition by account order by date rows unbounded preceding) as bal\nFROM transaction ORDER BY account, date\n```\n## ä½¿ç”¨E-Ræ¨¡å‹çš„æ•°æ®åº“è®¾è®¡\n### å®ä½“-è”ç³»æ¨¡å‹\n#### å®ä½“é›†\n- æ˜¯å…±äº«ç›¸åŒæ€§è´¨æˆ–å±æ€§çš„ã€å…·æœ‰ç›¸åŒç±»å‹çš„å®ä½“çš„é›†åˆ\n- é€šè¿‡ä¸€ç»„å±æ€§ï¼ˆattributeï¼‰æ¥è¡¨ç¤º\n- åœ¨E-Rå›¾ä¸­ç”¨**çŸ©å½¢**æ¥è¡¨ç¤º\n![1](https://d-sketon.top/img/db-book/1.png)\n#### è”ç³»é›†\n- æ˜¯åœ¨n&ge;2ä¸ªï¼ˆå¯èƒ½ç›¸åŒçš„ï¼‰å®ä½“é›†ä¸Šçš„æ•°å­¦å…³ç³»\n- åœ¨E-Rå›¾ä¸­ç”¨**è±å½¢**æ¥è¡¨ç¤º\n![2](https://d-sketon.top/img/db-book/2.png)\n- è”ç³»é›†å¯ä»¥é€’å½’è¿›è¡Œ\n![3](https://d-sketon.top/img/db-book/3.png)\n- è”ç³»å¯ä»¥å…·æœ‰è¢«ç§°ä½œ**æè¿°æ€§å±æ€§**çš„å±æ€§\n- è”ç³»é›†çš„å±æ€§åœ¨E-Rå›¾ä¸­é€šè¿‡**æœªåˆ†å‰²çš„çŸ©å½¢**æ¥è¡¨ç¤º\n![4](https://d-sketon.top/img/db-book/4.png)\n#### å¤æ‚å±æ€§\n- å±æ€§ç±»å‹\n- **ç®€å•**å’Œ**å¤åˆ**å±æ€§\n    - ç®€å•å±æ€§ä¸èƒ½è¢«åˆ’åˆ†ä¸ºå­éƒ¨åˆ†ï¼Œè€Œå¤åˆå±æ€§å¯ä»¥è¢«åˆ’åˆ†ä¸ºå­éƒ¨åˆ†\n- **å•å€¼**å’Œ**å¤šå€¼**å±æ€§\n    - å•å€¼å±æ€§å¯¹äºä¸€ä¸ªç‰¹å®šå®ä½“éƒ½åªæœ‰å•ç‹¬çš„ä¸€ä¸ªå€¼\n- **æ´¾ç”Ÿå±æ€§**\n    - è¿™ç±»å±æ€§çš„å€¼å¯ä»¥ä»å…¶ä»–ç›¸å…³å±æ€§æˆ–å®ä½“çš„å€¼æ´¾ç”Ÿå‡ºæ¥\n\n![5](https://d-sketon.top/img/db-book/5.png)\n#### æ˜ å°„åŸºæ•°\nè¡¨ç¤ºä¸€ä¸ªå®ä½“èƒ½é€šè¿‡ä¸€ä¸ªè”ç³»é›†å…³è”çš„å¦ä¸€äº›å®ä½“çš„æ•°é‡\n- **ä¸€å¯¹ä¸€**ï¼šAä¸­çš„ä¸€ä¸ªå®ä½“**è‡³å¤š**ä¸Bä¸­çš„ä¸€ä¸ªå®ä½“ç›¸å…³è”ï¼Œå¹¶ä¸”Bä¸­çš„ä¸€ä¸ªå®ä½“ä¹Ÿ**è‡³å¤š**ä¸Aä¸­çš„ä¸€ä¸ªå®ä½“ç›¸å…³è”\n- **ä¸€å¯¹å¤š**ï¼šAä¸­çš„ä¸€ä¸ªå®ä½“å¯ä»¥ä¸Bä¸­**ä»»æ„æ•°é‡**çš„å®ä½“ç›¸å…³è”ï¼Œè€ŒBä¸­çš„ä¸€ä¸ªå®ä½“**è‡³å¤š**ä¸Aä¸­çš„ä¸€ä¸ªå®ä½“ç›¸å…³è”\n- **å¤šå¯¹ä¸€**ï¼šAä¸­çš„ä¸€ä¸ªå®ä½“**è‡³å¤š**ä¸Bä¸­çš„ä¸€ä¸ªå®ä½“ç›¸å…³è”ï¼Œè€ŒBä¸­çš„ä¸€ä¸ªå®ä½“å¯ä»¥ä¸Aä¸­**ä»»æ„æ•°é‡**çš„å®ä½“ç›¸å…³è”\n- **å¤šå¯¹å¤š**ï¼šAä¸­çš„ä¸€ä¸ªå®ä½“å¯ä»¥ä¸Bä¸­**ä»»æ„æ•°é‡**çš„å®ä½“ç›¸å…³è”ï¼Œå¹¶ä¸”Bä¸­çš„ä¸€ä¸ªå®ä½“ä¹Ÿå¯ä»¥ä¸Aä¸­**ä»»æ„æ•°é‡**çš„å®ä½“ç›¸å…³è”\n\n![6](https://d-sketon.top/img/db-book/6.png)\n\nE-Rå›¾ä¸­çš„è¡¨ç¤ºæ–¹æ³•ï¼š\n![7](https://d-sketon.top/img/db-book/7.png)\n\nç”¨åŒçº¿è¡¨ç¤ºä¸€ä¸ªå®ä½“åœ¨è”ç³»é›†ä¸­çš„å…¨éƒ¨å‚ä¸ï¼š\n\n![8](https://d-sketon.top/img/db-book/8.png)\n\nçº¿æ®µä¸Šå¯ä»¥æœ‰ä¸€ä¸ªå…³è”çš„æœ€å°å’Œæœ€å¤§åŸºæ•°ï¼Œç”¨l..hçš„å½¢å¼è¡¨ç¤º\n\n![9](https://d-sketon.top/img/db-book/9.png)\n### ä¸»é”®\n#### å®ä½“é›†\n- ä¸€ä¸ªå®ä½“çš„å±æ€§å–å€¼å¿…é¡»å¯ä»¥å”¯ä¸€è¡¨ç¤ºè¯¥å®ä½“\n- é”®ï¼ˆkeyï¼‰çš„æ¦‚å¿µç›´æ¥é€‚ç”¨äºå®ä½“é›†\n#### è”ç³»é›†\nå±æ€§é›†åˆ\n$primary-key(E_1)\\cup primary-key(E_2) \\cup ... \\cup primary-key(E_n)$\næ„æˆäº†è”ç³»é›†çš„ä¸€ä¸ªè¶…é”®\n- äºŒå…ƒè”ç³»é›†ä¸»é”®çš„é€‰æ‹©å–å†³äºè”ç³»é›†çš„æ˜ å°„åŸºæ•°\n    - å¯¹äºå¤šå¯¹å¤šå…³ç³»ï¼Œå‰è¿°ä¸»é”®çš„å¹¶é›†æ˜¯æœ€å°çš„è¶…é”®ï¼Œå¹¶è¢«é€‰ä½œä¸»é”®\n    - å¯¹äºå¤šå¯¹ä¸€å’Œä¸€å¯¹å¤šå…³ç³»ï¼Œâ€œå¤šâ€æ–¹çš„ä¸»é”®æ˜¯æœ€å°çš„è¶…é”®ï¼Œå¹¶è¢«é€‰ä½œä¸»é”®\n    - å¯¹äºä¸€å¯¹ä¸€å…³ç³»ï¼Œä»»æ„å‚ä¸å®ä½“é›†çš„ä¸»é”®éƒ½æ„æˆæœ€å°è¶…é”®ï¼Œå¹¶å¯è¢«é€‰ä½œä¸»é”®\n#### å¼±å®ä½“é›† \nå¼±å®ä½“é›†çš„å­˜åœ¨ä¾èµ–äºå¦ä¸€ä¸ªå®ä½“é›†ï¼Œç§°å…¶ä¸º**æ ‡è¯†æ€§å®ä½“é›†**\nä½¿ç”¨æ ‡è¯†æ€§å®ä½“é›†çš„ä¸»é”®ä»¥åŠç§°ä¸º**åˆ†è¾¨ç¬¦å±æ€§**çš„é¢å¤–å±æ€§æ¥å”¯ä¸€åœ°æ ‡è¯†å¼±å®ä½“\n- E-Rå›¾ä¸­ï¼Œé€šè¿‡åŒè¾¹æ¡†çš„çŸ©å½¢æè¿°å¼±å®ä½“é›†ï¼Œå…¶åˆ†è¾¨ç¬¦è¢«åŠ ä¸Šéœ€çš„ä¸‹åˆ’çº¿\n- å…³è”å¼±å®ä½“é›†å’Œæ ‡è¯†æ€§å¼ºå®ä½“é›†çš„è”ç³»é›†ä»¥åŒè¾¹æ¡†çš„è±å½¢è¡¨ç¤º\n- é€šå¸¸ï¼Œå¼±å®ä½“é›†å¿…é¡»å…¨éƒ¨å‚ä¸å…¶æ ‡è¯†æ€§è”ç³»é›†ï¼Œå¹¶ä¸”è¯¥è”ç³»æ˜¯åˆ°æ ‡è¯†æ€§å®ä½“é›†çš„å¤šå¯¹ä¸€è”ç³»\n\n![10](https://d-sketon.top/img/db-book/10.png)\n### æ‰©å±•çš„E-Rç‰¹æ€§\n#### ç‰¹åŒ–ï¼ˆSpecializationï¼‰/æ¦‚åŒ–ï¼ˆGeneralizationï¼‰\n- åœ¨ä¸€ä¸ªé«˜å±‚å®ä½“é›†ä¸ä¸€ä¸ªæˆ–å¤šä¸ªä½å±‚å®ä½“é›†ä¹‹é—´å­˜åœ¨çš„åŒ…å«å…³ç³»\n- é‡å ç‰¹åŒ–ï¼šå…è®¸ä¸€ä¸ªå®ä½“å±äºå¤šä¸ªç‰¹åŒ–å®ä½“é›†ï¼ˆä½¿ç”¨ä¸¤ä¸ªå•ç‹¬çš„ç®­å¤´ï¼‰\n- ä¸ç›¸äº¤ç‰¹åŒ–ï¼šå…è®¸ä¸€ä¸ªå®ä½“è‡³å¤šå±äºä¸€ä¸ªç‰¹åŒ–å®ä½“é›†ï¼ˆä½¿ç”¨å•ä¸ªç®­å¤´ï¼‰\n\n![11](https://d-sketon.top/img/db-book/11.png)\n\n- å…¨éƒ¨ç‰¹åŒ–/æ¦‚åŒ–ï¼šæ¯ä¸ªé«˜å±‚å®ä½“å¿…é¡»å±äºä¸€ä¸ªä½å±‚å®ä½“é›†\n- éƒ¨åˆ†ç‰¹åŒ–/æ¦‚åŒ–ï¼šä¸€äº›é«˜å±‚å®ä½“å¯ä»¥ä¸å±äºä¸€ä¸ªä½å±‚å®ä½“é›†ï¼ˆé»˜è®¤ï¼‰\n#### èšé›†ï¼ˆAggregationï¼‰\n- ä¸€ç§æŠ½è±¡ï¼Œé€šè¿‡è¿™ç§æŠ½è±¡ï¼Œè”ç³»è¢«è§†ä¸ºé«˜å±‚å®ä½“\n\n![12](https://d-sketon.top/img/db-book/12.png)\n### å°†E-Rå›¾è½¬æ¢ä¸ºå…³ç³»æ¨¡å¼\n#### å¼ºå®ä½“é›†çš„è¡¨ç¤º\nå¼ºå®ä½“é›†çš„ä¸»é”®å°±ä½œä¸ºæ‰€å¾—åˆ°çš„æ¨¡å¼çš„ä¸»é”®\n#### å…·æœ‰å¤æ‚å±æ€§çš„å¼ºå®ä½“é›†çš„è¡¨ç¤º\n- å¤åˆå±æ€§\n    - ä¸ä¸ºå¤åˆå±æ€§è‡ªèº«åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„å±æ€§\n- å¤šå€¼å±æ€§\n    - ä¸ºå¤šå€¼å±æ€§æ„å»ºä¸€ä¸ªæ–°çš„å…³ç³»æ¨¡å¼\n- æ´¾ç”Ÿå±æ€§\n    - ä¸åœ¨å…³ç³»æ•°æ®æ¨¡å‹ä¸­æ˜¾å¼åœ°è¡¨ç¤ºå‡ºæ¥\n#### å¼±å®ä½“é›†çš„è¡¨ç¤º\nå¯¹äºä»å¼±å®ä½“é›†è½¬æ¢è€Œæ¥çš„æ¨¡å¼ï¼Œè¯¥æ¨¡å¼çš„ä¸»é”®ç”±å…¶å¼ºå®ä½“é›†çš„ä¸»é”®ä¸å¼±å®ä½“é›†çš„åˆ†è¾¨ç¬¦ç»„åˆè€Œæˆã€‚é™¤äº†åˆ›å»ºä¸»é”®ä¹‹å¤–ï¼Œè¿˜éœ€è¦åœ¨å…³ç³»ä¸Šå»ºç«‹å¤–é”®çº¦æŸï¼Œä»¥ä¿è¯å¯¹äºè¡¨ç¤ºå¼±å®ä½“çš„æ¯ä¸ªå…ƒç»„ï¼Œéƒ½æœ‰ä¸€ä¸ªè¡¨ç¤ºç›¸åº”å¼ºå®ä½“çš„å…ƒç»„ä¸ä¹‹å¯¹åº”\n#### è”ç³»é›†çš„è¡¨ç¤º\nè”ç³»é›†çš„ä¸»é”®å±æ€§ä¹Ÿè¢«ç”¨ä½œå…³ç³»æ¨¡å¼çš„ä¸»é”®å±æ€§\n#### æ¨¡å¼çš„å†—ä½™\nè¿æ¥å¼±å®ä½“é›†ä¸ä¹‹å¯¹åº”çš„å¼ºå®ä½“é›†çš„è”ç³»é›†çš„æ¨¡å¼æ˜¯å†—ä½™çš„ \n#### æ¨¡å¼çš„åˆå¹¶\n- å¯¹äºå¤šå¯¹ä¸€è”ç³»é›†ï¼Œè”ç³»é›†çš„å…³ç³»æ¨¡å¼å¯ä»¥å’Œâ€œå¤šâ€æ–¹çš„æ¨¡å¼è¿›è¡Œåˆå¹¶\n- å¯¹äºä¸€å¯¹ä¸€è”ç³»é›†ï¼Œè”ç³»é›†çš„å…³ç³»æ¨¡å¼å¯ä»¥å’Œå‚ä¸è”ç³»çš„ä»»ä½•ä¸€ä¸ªå®ä½“é›†çš„æ¨¡å¼è¿›è¡Œåˆå¹¶\n### å®ä½“-è”ç³»è®¾è®¡é—®é¢˜\n#### E-Rå›¾ä¸­çš„åˆ›å»ºé”™è¯¯\n- ä½¿ç”¨ä¸€ä¸ªå®ä½“é›†çš„ä¸»é”®ä½œä¸ºå¦ä¸€ä¸ªå®ä½“é›†çš„å±æ€§\n- å°†ç›¸å…³å®ä½“é›†çš„ä¸»é”®å±æ€§ä½œä¸ºè”ç³»é›†çš„å±æ€§\n- åœ¨éœ€è¦å¤šå€¼å±æ€§çš„æƒ…å†µä¸‹ä½¿ç”¨å…·æœ‰å•å€¼å±æ€§çš„è”ç³»\n#### ä½¿ç”¨å®ä½“é›†è¿˜æ˜¯å±æ€§ï¼Ÿ\nå¯¹äºè¿™ä¸€é—®é¢˜å¹¶æ— ç®€å•çš„ç­”æ¡ˆã€‚åŒºåˆ†å®ƒä»¬ä¸»è¦ä¾èµ–äºè¢«å»ºæ¨¡çš„æ˜¾ç¤ºä¼ä¸šçš„ç»“æ„ï¼Œä»¥åŠä¸è¢«è®¨è®ºçš„å±æ€§ç›¸å…³çš„è¯­ä¹‰\n#### ä½¿ç”¨å®ä½“é›†è¿˜æ˜¯è”ç³»é›†ï¼Ÿ\nå½“æè¿°å‘ç”Ÿåœ¨å®ä½“é—´çš„è¡Œä¸ºæ—¶å»ºè®®é‡‡ç”¨è”ç³»é›†\n#### äºŒå…ƒè¿˜æ˜¯nå…ƒè”ç³»é›†ï¼Ÿ\nä¸€ä¸ªéäºŒå…ƒçš„è”ç³»é›†æ€»å¯ä»¥ç”¨ä¸€ç»„ä¸åŒçš„äºŒå…ƒè”ç³»é›†æ¥æ›¿ä»£\n## å…³ç³»æ•°æ®åº“è®¾è®¡\n### åˆ†è§£\n- é¿å…æ¨¡å¼ä¸­å­˜åœ¨ä¿¡æ¯é‡å¤é—®é¢˜çš„å”¯ä¸€æ–¹å¼æ˜¯å°†å…¶åˆ†è§£ä¸ºå¤šä¸ªæ¨¡å¼\n- å¹¶éæ‰€æœ‰çš„æ¨¡å¼åˆ†è§£éƒ½æ˜¯æœ‰ç›Šçš„\n- åˆ†è§£è¿‡ç¨‹ä¸­å­˜åœ¨ä¿¡æ¯ä¸¢å¤±çš„ç§°ä¸º**æœ‰æŸåˆ†è§£**ï¼Œè€Œæ²¡æœ‰ä¿¡æ¯ä¸¢å¤±çš„ç§°ä¸º**æ— æŸåˆ†è§£**\n#### æ— æŸåˆ†è§£\nä»¤Rä¸ºå…³ç³»æ¨¡å¼ï¼Œå¹¶ä»¤R1å’ŒR2æ„æˆRçš„åˆ†è§£\nè‹¥$\\Pi_{R_1}(r) \\Join \\Pi_{R_2}(r) = r$ï¼Œåˆ™è¯´æ˜åˆ†è§£æ˜¯æ— æŸçš„\nè‹¥$r \\subset \\Pi_{R_1}(r) \\Join \\Pi_{R_2}(r)$ï¼Œåˆ™è¯´æ˜åˆ†è§£æ˜¯æœ‰æŸçš„\n#### è§„èŒƒåŒ–ç†è®º\n- ç¡®å®šä¸€ä¸ªç»™å®šçš„å…³ç³»æ¨¡å¼æ˜¯å¦ä¸ºâ€œè‰¯æ„çš„â€\n- å¦‚æœä¸€ä¸ªç»™å®šçš„å…³ç³»æ¨¡å¼ä¸æ˜¯â€œè‰¯æ„çš„â€ï¼Œåˆ™éœ€è¦å°†å…¶åˆ†è§£ä¸ºè®¸å¤šè¾ƒå°çš„å…³ç³»æ¨¡å¼ï¼Œä½¿å¾—æ¯ä¸ªæ¨¡å¼éƒ½æ»¡è¶³é€‚å½“çš„èŒƒå¼ã€‚ä¸”åˆ†è§£å¿…é¡»æ˜¯æ— æŸåˆ†è§£\n### ä½¿ç”¨å‡½æ•°ä¾èµ–è¿›è¡Œåˆ†è§£\n#### ç¬¦å·æƒ¯ä¾‹\n- ä½¿ç”¨å¸Œè…Šå­—æ¯ï¼ˆä¾‹å¦‚$\\alpha$ï¼‰æ¥è¡¨ç¤ºå±æ€§é›†\n- ä½¿ç”¨å¤§å†™çš„ç½—é©¬å­—æ¯ï¼ˆä¾‹å¦‚Rï¼‰æ¥è¡¨ç¤ºå…³ç³»æ¨¡å¼\n- ä½¿ç”¨Kæ¥è¡¨ç¤ºå±æ€§é›†çš„ä¸€ä¸ªè¶…é”®\n- ç¬¦å·r(R)è¡¨ç¤ºå…·æœ‰æ¨¡å¼Rçš„å…³ç³»r\n#### é”®å’Œå‡½æ•°ä¾èµ–\nè€ƒè™‘ä¸€ä¸ªå…³ç³»æ¨¡å¼r(R)ï¼Œå¹¶ä¸”ä»¤$\\alpha \\subseteq R \\land \\beta \\subseteq R$\n- ç»™r(R)çš„ä¸€ä¸ªå®ä¾‹ï¼Œå¦‚æœå¯¹äºè¯¥å®ä¾‹ä¸­çš„æ‰€æœ‰å…ƒç»„å¯¹$t_1$å’Œ$t_2$ï¼Œä½¿å¾—è‹¥$t_1[\\alpha]=t_2[\\alpha]$ï¼Œåˆ™$t_1[\\beta]=t_2[\\beta]$ä¹Ÿæˆç«‹ï¼Œé‚£ä¹ˆå®ä¾‹æ»¡è¶³**å‡½æ•°ä¾èµ–**$\\alpha \\rightarrow \\beta$\n- å¦‚æœr(R)çš„æ¯ä¸ªåˆæ³•å®ä¾‹éƒ½æ»¡è¶³å‡½æ•°ä¾èµ–$\\alpha \\rightarrow \\beta$ï¼Œåˆ™å‡½æ•°ä¾èµ–åœ¨æ¨¡å¼r(R)ä¸Š**æˆç«‹**\n##### é”®å’Œå‡½æ•°ä¾èµ–\n- å¦‚æœå‡½æ•°ä¾èµ–$K \\rightarrow R$åœ¨r(R)ä¸Šæˆç«‹ï¼Œåˆ™Kæ˜¯r(R)çš„ä¸€ä¸ªè¶…é”®\n- å¦‚æœå‡½æ•°ä¾èµ–$K \\rightarrow R$åœ¨r(R)ä¸Šæˆç«‹ï¼Œå¹¶ä¸”ä¸å­˜åœ¨$\\alpha \\subset K,\\alpha \\rightarrow R$ï¼Œåˆ™Kæ˜¯r(R)çš„ä¸€ä¸ªå€™é€‰é”®\n##### å¹³å‡¡å‡½æ•°ä¾èµ–\nå¦‚æœ$\\beta \\subseteq \\alpha$ï¼Œåˆ™å½¢å¦‚$\\alpha \\rightarrow \\beta$çš„å‡½æ•°ä¾èµ–æ˜¯å¹³å‡¡çš„ï¼ˆtrivialï¼‰\n##### ä¼ é€’ä¾èµ–\nä»¤$\\alpha$å’Œ$\\beta$ä¸ºå±æ€§é›†ï¼Œä½¿å¾—$\\alpha \\rightarrow \\beta$æˆç«‹ä½†$\\beta \\rightarrow \\alpha$ä¸æˆç«‹ã€‚å¯¹äº$A \\in R,A \\notin \\alpha, A \\notin \\beta$ï¼Œå¦‚æœ$\\beta \\rightarrow A$ï¼Œåˆ™Aä¼ é€’ä¾èµ–äº$\\alpha$\n##### éƒ¨åˆ†ä¾èµ–\nå­˜åœ¨$\\alpha$çš„ä¸€ä¸ªçœŸå­é›†$\\gamma$ä½¿å¾—$\\gamma \\rightarrow \\beta$ï¼Œåˆ™$\\beta$éƒ¨åˆ†ä¾èµ–$\\alpha$\n#### å‡½æ•°ä¾èµ–é›†çš„é—­åŒ…\n$F$ï¼šå‡½æ•°ä¾èµ–é›†\n$F^+$ï¼šèƒ½å¤Ÿä»é›†åˆ$F$ä¸­æ¨å¯¼å‡ºçš„æ‰€æœ‰å‡½æ•°ä¾èµ–çš„é›†åˆ\né˜¿å§†æ–¯ç‰¹æœ—å…¬ç†ï¼š\n- **è‡ªåå¾‹**ï¼šè‹¥$\\alpha$ä¸ºä¸€ä¸ªå±æ€§é›†ä¸”$\\beta \\subseteq \\alpha$ï¼Œåˆ™$\\alpha \\rightarrow \\beta$æˆç«‹\n- **å¢è¡¥å¾‹**ï¼šè‹¥$\\alpha \\rightarrow \\beta$æˆç«‹ä¸”$\\gamma$ä¸ºä¸€ä¸ªå±æ€§é›†ï¼Œåˆ™$\\gamma\\alpha \\rightarrow \\gamma\\beta$æˆç«‹\n- **ä¼ é€’å¾‹**ï¼šè‹¥$\\alpha \\rightarrow \\beta$æˆç«‹ä¸”$\\beta \\rightarrow \\gamma$æˆç«‹ï¼Œåˆ™$\\alpha \\rightarrow \\gamma$æˆç«‹\n\né™„åŠ è§„åˆ™ï¼š\n- **åˆå¹¶å¾‹**ï¼šè‹¥$\\alpha \\rightarrow \\beta$æˆç«‹ä¸”$\\alpha \\rightarrow \\gamma$æˆç«‹ï¼Œåˆ™$\\alpha \\rightarrow \\beta\\gamma$æˆç«‹\n- **åˆ†è§£å¾‹**ï¼šè‹¥$\\alpha \\rightarrow \\beta\\gamma$æˆç«‹ï¼Œåˆ™$\\alpha \\rightarrow \\beta$æˆç«‹ä¸”$\\alpha \\rightarrow \\gamma$æˆç«‹\n- **ä¼ªä¼ é€’å¾‹**ï¼š$\\alpha \\rightarrow \\beta$æˆç«‹ä¸”$\\gamma\\beta \\rightarrow \\delta$æˆç«‹ï¼Œåˆ™$\\alpha\\gamma \\rightarrow \\delta$æˆç«‹\n\nè®¡ç®—$F^+$çš„è¿‡ç¨‹ï¼š\n```text\nF+ = F\nåº”ç”¨è‡ªåå¾‹ç”Ÿæˆæ‰€æœ‰çš„å¹³å‡¡ä¾èµ–\nrepeat\n    for each F+ä¸­çš„å‡½æ•°ä¾èµ–f\n        åœ¨fä¸Šåº”ç”¨å¢è¡¥å¾‹\n        å°†å‡½æ•°ä¾èµ–çš„ç»“æœåŠ å…¥F+ä¸­\n    for each F+ä¸­çš„ä¸€å¯¹å‡½ä¾èµ–f1å’Œf2\n        if f1å’Œf2å¯ä»¥ä½¿ç”¨ä¼ é€’å¾‹è¿›è¡Œç»“åˆ\n            å°†å‡½æ•°ä¾èµ–çš„ç»“æœåŠ å…¥F+ä¸­\nuntil F+ä¸å†å‘ç”Ÿå˜åŒ–\n```\n#### å±æ€§é›†çš„é—­åŒ…\n$\\alpha$ï¼šå±æ€§é›†\n$\\alpha^+$ï¼š$F$ä¸‹$\\alpha$çš„é—­åŒ…ï¼Œ$F$ä¸‹è¢«$\\alpha$å†³å®šçš„å±æ€§é›†\n\n\nè®¡ç®—$F$ä¸‹$\\alpha^+$çš„è¿‡ç¨‹ï¼š\n```text\nresult := Î±;\nrepeat\n    for each å‡½æ•°ä¾èµ–Î²â†’Î³ in F do\n        begin\n            if Î²âŠ† result then result := resultâˆªÎ³;\n        end\nuntil(resultä¸å†å‘ç”Ÿæ”¹å˜)\n```\n\nå±æ€§é—­åŒ…ç®—æ³•çš„ç”¨é€”ï¼š\n- æµ‹è¯•$\\alpha$æ˜¯å¦ä¸ºè¶…é”®ï¼Œå¯ä»¥è®¡ç®—$\\alpha^+$ï¼Œå¹¶æ£€æŸ¥$\\alpha^+$æ˜¯å¦åŒ…å«$R$ä¸­çš„æ‰€æœ‰å±æ€§\n- é€šè¿‡æ£€æŸ¥$\\beta \\subseteq \\alpha^+$ï¼Œå¯ä»¥æ£€æŸ¥ä¸€ä¸ªå‡½æ•°ä¾èµ–$\\alpha \\rightarrow \\beta$æ˜¯å¦æˆç«‹\n- å¦ä¸€ç§$F^+$çš„å¯æ›¿ä»£æ–¹æ³•\n\n#### ä¿æŒä¾èµ–\néªŒè¯ä¿æŒä¾èµ–çš„æ–¹å¼ï¼Œè¯¥æ–¹å¼å¯¹$F$ä¸­çš„æ¯ä¸ª$\\alpha \\rightarrow \\beta$éƒ½ä½¿ç”¨ä¸‹é¢çš„è¿‡ç¨‹ï¼š\n```text\nresult = Î±ï¡\nrepeat \n    for each åˆ†è§£åçš„Ri\n        t = (resultâˆ©Ri)+ âˆ© Ri\n        result = result âˆª t\nuntil(resultæ²¡æœ‰å˜åŒ–)\n```\nå¦‚æœresultåŒ…å«äº†$\\beta$çš„æ‰€æœ‰å±æ€§ï¼Œåˆ™å‡½æ•°ä¾èµ–$\\alpha \\rightarrow \\beta$è¢«ä¿æŒ\n\n#### æ­£åˆ™è¦†ç›–\n- ä»ä¸€ä¸ªå‡½æ•°ä¾èµ–çš„å·¦ä¾§åˆ é™¤ä¸€ä¸ªå±æ€§å¯ä»¥ä½¿å…¶æˆä¸ºæ›´å¼ºçš„çº¦æŸ\n- ä»ä¸€ä¸ªå‡½æ•°ä¾èµ–çš„å³ä¾§åˆ é™¤ä¸€ä¸ªå±æ€§å¯ä»¥ä½¿å…¶æˆä¸ºæ›´å¼±çš„çº¦æŸ\n##### æ— å…³å±æ€§\nè€ƒè™‘ä¸€ä¸ªå‡½æ•°ä¾èµ–é›†$F$ä»¥åŠ$F$ä¸­çš„å‡½æ•°ä¾èµ–$\\alpha \\rightarrow \\beta$\n- **ä»å·¦ä¾§ç§»é™¤**ï¼šå¦‚æœ$A \\in \\alpha$å¹¶ä¸”$F$é€»è¾‘è•´å«$(F-\\{\\alpha \\rightarrow \\beta\\}) \\cup \\{(\\alpha -A)\\rightarrow \\beta\\}$ï¼Œåˆ™å±æ€§$A$åœ¨$\\alpha$ä¸­æ˜¯æ— å…³çš„\n- **ä»å³ä¾§ç§»é™¤**ï¼šå¦‚æœ$A \\in \\beta$å¹¶ä¸”å‡½æ•°ä¾èµ–é›†$(F-\\{\\alpha \\rightarrow \\beta\\}) \\cup \\{\\alpha \\rightarrow (\\beta - A)\\}$é€»è¾‘è•´å«$F$ï¼Œåˆ™å±æ€§$A$åœ¨$\\beta$ä¸­æ˜¯æ— å…³çš„\n##### æ­£åˆ™è¦†ç›–\n$F$çš„æ­£åˆ™è¦†ç›–é›†$F_c$æ˜¯è¿™æ ·çš„ä¸€ä¸ªä¾èµ–é›†ï¼š\n- $F$é€»è¾‘è•´å«$F_c$çš„æ‰€æœ‰ä¾èµ–\n- $F_c$é€»è¾‘è•´å«$F$çš„æ‰€æœ‰ä¾èµ–\n- $F_c$ä¸­ä»»ä½•å‡½æ•°ä¾èµ–éƒ½ä¸åŒ…å«æ— å…³å±æ€§\n- $F_c$ä¸­æ¯ä¸ªå‡½æ•°ä¾èµ–çš„å·¦ä¾§éƒ½æ˜¯å”¯ä¸€çš„\n\n```text\nFc=F\nrepeat\n    ä½¿ç”¨åˆå¹¶å¾‹å°†Fcä¸­ä»»ä½•å½¢å¦‚Î±1â†’Î²1å’ŒÎ±1â†’Î²2çš„ä¾èµ–æ›¿æ¢ä¸ºÎ±1â†’Î²1Î²2\n    åœ¨Fcä¸­å¯»æ‰¾ä¸€ä¸ªå‡½æ•°ä¾èµ–Î±â†’Î²ï¼Œå®ƒè¦ä¹ˆåœ¨Î±ä¸­è¦ä¹ˆåœ¨Î²ä¸­å…·æœ‰ä¸€ä¸ªæ— å…³å±æ€§\n    /*ä½¿ç”¨Fcè€ŒéFæ¥æ£€éªŒæ— å…³å±æ€§*/\n    å¦‚æœæ‰¾åˆ°ä¸€ä¸ªæ— å…³å±æ€§ï¼Œåˆ™å°†å®ƒä»Fcä¸­çš„Î±â†’Î²ä¸­åˆ é™¤\nuntil(Fcä¸å†æ”¹å˜)\n```\n#### æ— æŸåˆ†è§£å’Œå‡½æ•°ä¾èµ–\n\n$R_1$å’Œ$R_2$æ„æˆ$R$çš„ä¸€ä¸ªæ— æŸåˆ†è§£çš„æ¡ä»¶æ˜¯ï¼Œä»¥ä¸‹å‡½æ•°ä¾èµ–ä¸­è‡³å°‘æœ‰ä¸€ä¸ªåœ¨$F^+$ä¸­ï¼š\n- $R_1 \\cap R_2 \\rightarrow R_1$\n- $R_1 \\cap R_2 \\rightarrow R_2$\n\nå³ï¼Œå¦‚æœ$R_1 \\cap R_2$è¦ä¹ˆæ„æˆ$R_1$çš„è¶…é”®è¦ä¹ˆæ„æˆ$R_2$çš„è¶…é”®ï¼Œåˆ™$R$çš„åˆ†è§£å°±æ˜¯ä¸€ä¸ªæ— æŸåˆ†è§£\n### èŒƒå¼\n#### BCNFèŒƒå¼\nå¯¹äº$F^+$ä¸­æ‰€æœ‰å½¢å¦‚$\\alpha \\rightarrow \\beta$çš„å‡½æ•°ä¾èµ–ï¼ˆå…¶ä¸­$\\alpha \\subseteq R$ä¸”$\\beta \\subseteq R$ï¼‰ï¼Œä¸‹é¢è‡³å°‘æœ‰ä¸€é¡¹æˆç«‹ï¼š\n- $\\alpha \\rightarrow \\beta$æ˜¯å¹³å‡¡å‡½æ•°ä¾èµ–\n- $\\alpha$æ˜¯æ¨¡å¼$R$çš„ä¸€ä¸ªè¶…é”®\n\nå¯¹äºä¸å±äºBCNFçš„æ¨¡å¼è¿›è¡Œåˆ†è§£çš„é€šç”¨è§„åˆ™ï¼š\nè‹¥å­˜åœ¨éå¹³å‡¡å‡½æ•°ä¾èµ–$\\alpha \\rightarrow \\beta$ï¼Œä½¿å¾—$\\alpha$ä¸æ˜¯æ¨¡å¼$R$çš„ä¸€ä¸ªè¶…é”®ï¼Œåˆ™ä½¿ç”¨ä»¥ä¸‹ä¸¤ä¸ªæ¨¡å¼å–ä»£$R$\n- $(\\alpha \\cup \\beta)$\n- $(R-(\\beta-\\alpha))$\n##### BCNFçš„æ£€æµ‹\n- ä¸ºäº†æ£€æŸ¥ä¸€ä¸ªéå¹³å‡¡çš„ä¾èµ–$\\alpha \\rightarrow \\beta$æ˜¯å¦è¿åBCNFï¼Œå¯ä»¥è®¡ç®—$a^+$ï¼Œå¹¶ä¸”éªŒè¯å®ƒæ˜¯å¦åŒ…å«äº†$R$ä¸­çš„æ‰€æœ‰å±æ€§ï¼Œå³éªŒè¯å…¶æ˜¯å¦æ˜¯$R$çš„ä¸€ä¸ªè¶…é”®\n- ä¸ºäº†æ£€æŸ¥ä¸€ä¸ªå…³ç³»æ¨¡å¼$R$æ˜¯å¦å±äºBCNFï¼Œä»…éœ€æ£€æŸ¥ç»™å®šé›†åˆ$F$ä¸­çš„ä¾èµ–æ˜¯å¦è¿åBCNFå°±è¶³å¤Ÿäº†ï¼Œè€Œä¸å¿…æ£€æŸ¥$F^+$ä¸­çš„æ‰€æœ‰ä¾èµ–\n- ä¸ºäº†æ£€æŸ¥$R$åˆ†è§£åçš„ä¸€ä¸ªå…³ç³»æ¨¡å¼$R_i$æ˜¯å¦å±äºBCNFï¼Œå¯¹äº$R_i$ä¸­å±æ€§çš„æ¯ä¸ªå­é›†$\\alpha$ï¼Œæ£€æŸ¥$a^+$è¦ä¹ˆ\n    - ä¸åŒ…å«$R_i-\\alpha$çš„ä»»ä½•å±æ€§\n    - åŒ…å«$R_i$çš„æ‰€æœ‰å±æ€§\n##### BCNFåˆ†è§£ç®—æ³•\nè¯¥ç®—æ³•æ‰€äº§ç”Ÿçš„åˆ†è§£ä¸ä»…æ»¡è¶³BCNFï¼Œè€Œä¸”è¿˜æ˜¯æ— æŸåˆ†è§£ï¼š\n```text\nresult :={R};\ndone := false;\nwhile (not done) do\n    if (åœ¨resultä¸­å­˜åœ¨ä¸€ä¸ªæ¨¡å¼Riä¸å±äºBCNF) then\n        begin\n            ä»¤Î±â†’Î²ä¸ºåœ¨Riä¸Šæˆç«‹çš„ä¸€ä¸ªéå¹³å‡¡å‡½æ•°ä¾èµ–ï¼Œä½¿å¾—Î±+å¹¶ä¸åŒ…å«Riï¼Œä¸”Î±âˆ©Î²=âˆ…\n            result :=(result-Ri)âˆª(Ri-Î²)âˆª(Î±,Î²);\n        end\n    else done := true; \n\n```\n#### 3NFèŒƒå¼\nå¯¹äº$F^+$ä¸­æ‰€æœ‰å½¢å¦‚$\\alpha \\rightarrow \\beta$çš„å‡½æ•°ä¾èµ–ï¼ˆå…¶ä¸­$\\alpha \\subseteq R$ä¸”$\\beta \\subseteq R$ï¼‰ï¼Œä¸‹é¢è‡³å°‘æœ‰ä¸€é¡¹æˆç«‹ï¼š\n- $\\alpha \\rightarrow \\beta$æ˜¯å¹³å‡¡å‡½æ•°ä¾èµ–\n- $\\alpha$æ˜¯æ¨¡å¼$R$çš„ä¸€ä¸ªè¶…é”®\n- $\\beta-\\alpha$ä¸­çš„æ¯ä¸ªå±æ€§$A$éƒ½è¢«åŒ…å«äº$R$çš„ä¸€ä¸ªå€™é€‰ç ä¸­ï¼ˆå¯èƒ½åœ¨ä¸åŒçš„å€™é€‰ç ä¹‹ä¸­ï¼‰\n\n**ä»»ä½•æ»¡è¶³BCNFçš„æ¨¡å¼ä¹Ÿæ»¡è¶³3NF**\n##### 3NFåˆ†è§£\n```text\nä»¤Fcä¸ºFçš„ä¸€ä¸ªæ­£åˆ™è¦†ç›–;\ni := 0;\nfor each Fcä¸­çš„å‡½æ•°ä¾èµ–Î±â†’Î²\n    i := i+1;\n    Ri:=Î±Î²;\nif æ²¡æœ‰ä¸€ä¸ªæ¨¡å¼Rj(j=1,2,...,i)åŒ…å«Rçš„ä¸€ä¸ªå€™é€‰ç \n    then\n        i :=i+1;\n        Ri:=Rçš„ä»»ä¸€å€™é€‰ç ;\n/*å¯é€‰åœ°åˆ é™¤å†—ä½™å…³ç³»*/\nrepeat\n    if ä»»æ„æ¨¡å¼RjåŒ…å«ä¸å¦ä¸€ä¸ªæ¨¡å¼Rkä¸­\n        then\n        /*åˆ é™¤Rj*/\n        Rj:=Ri;\n        i :=i-1;\nuntil ä¸å†æœ‰å¯ä»¥è¢«åˆ é™¤çš„Rj\nreturn (R1,R2,...Ri)\n```\n#### 1NFèŒƒå¼\nå…³ç³»æ¨¡å¼$R$çš„æ‰€æœ‰å±æ€§çš„åŸŸéƒ½æ˜¯åŸå­çš„\n## æ•°æ®å­˜å‚¨ç»“æ„\n### æ–‡ä»¶ç»„ç»‡\n- ä¸€ä¸ªæ•°æ®åº“è¢«æ˜ å°„ä¸ºå¤šä¸ªä¸åŒçš„æ–‡ä»¶\n- æ¯ä¸ªæ–‡ä»¶ä»é€»è¾‘ä¸Šè¢«åˆ†ä¸ºå®šé•¿çš„å­˜å‚¨å•å…ƒï¼Œç§°ä¸º**å—**\n- å—æ˜¯å­˜å‚¨åˆ†é…å’Œæ•°æ®ä¼ è¾“çš„å•ä½\n- å‡å®šï¼š\n    - æ²¡æœ‰æ¯”å—æ›´å¤§çš„è®°å½•\n    - æ¯æ¡è®°å½•è¢«å®Œå…¨åŒ…å«åœ¨å•ä¸ªå—ä¸­\n#### å®šé•¿è®°å½•\n- åœ¨ä¸€ä¸ªå—ä¸­åªåˆ†é…å®ƒèƒ½å®Œæ•´å®¹çº³çš„æœ€å¤šè®°å½•çš„æ•°ç›®\n- å½“ä¸€æ¡è®°å½•è¢«åˆ é™¤æ—¶ï¼Œå¯ä»¥é€‰æ‹©æŠŠç´§è·Ÿå…¶åçš„è®°å½•ç§»åŠ¨åˆ°è¢«åˆ è®°å½•å…ˆå‰å æ®çš„ç©ºé—´ä¸­ï¼Œä½†è¿™æ ·éœ€è¦é¢å¤–çš„å—è®¿é—®\n- åœ¨æ–‡ä»¶çš„å¼€å¤´åˆ†é…ç‰¹å®šæ•°é‡çš„å­—èŠ‚ä½œä¸º**æ–‡ä»¶å¤´**ï¼Œå¯ä»¥åœ¨æ–‡ä»¶å¤´ä¸­å­˜å‚¨å†…å®¹è¢«åˆ é™¤çš„ç¬¬ä¸€æ¡è®°å½•çš„åœ°å€ä½œä¸ºé“¾è¡¨çš„å¤´ç»“ç‚¹ï¼Œè¯¥é“¾è¡¨é€šå¸¸è¢«ç§°ä¸º**è‡ªç”±é“¾è¡¨**\n    - åœ¨æ’å…¥ä¸€æ¡æ–°çºªå½•æ—¶ï¼Œä½¿ç”¨æ–‡ä»¶å¤´æ‰€æŒ‡å‘çš„è®°å½•ï¼Œå¹¶æ”¹å˜æ–‡ä»¶å¤´çš„æŒ‡é’ˆä»¥æŒ‡å‘ä¸‹ä¸€æ¡å¯ç”¨è®°å½•\n    - å¦‚æœæ²¡æœ‰å¯ç”¨çš„ç©ºé—´ï¼Œå°±æŠŠæ–°çºªå½•åŠ åˆ°æ–‡ä»¶æœ«å°¾\n#### å˜é•¿è®°å½•\n- å…·æœ‰å˜é•¿å±æ€§çš„è®°å½•çš„è¡¨ç¤ºé€šå¸¸åŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼š\n    - å¸¦æœ‰å®šé•¿ä¿¡æ¯çš„åˆå§‹éƒ¨åˆ†\n        - å›ºå®šé•¿åº¦çš„å±æ€§è¢«åˆ†é…å­˜å‚¨å®ƒä»¬çš„å€¼æ‰€éœ€çš„å­—èŠ‚æ•°\n        - å˜é•¿å±æ€§åœ¨åˆå§‹éƒ¨åˆ†ä¸­è¢«è¡¨ç¤ºä¸ºä¸€ä¸ªï¼ˆåç§»é‡ï¼Œé•¿åº¦ï¼‰å¯¹ï¼Œå…¶åç§»é‡è¡¨ç¤ºåœ¨è®°å½•ä¸­è¯¥å±æ€§çš„æ•°æ®å¼€å§‹çš„ä½ç½®ï¼Œè€Œé•¿åº¦è¡¨ç¤ºå˜é•¿å±æ€§çš„å­—èŠ‚é•¿åº¦\n    - å˜é•¿å±æ€§çš„å†…å®¹ï¼Œè¿ç»­å­˜å‚¨\n- ç©ºä½å›¾è¡¨ç¤ºè®°å½•çš„å“ªä¸ªå±æ€§æ˜¯ç©ºå€¼\n\n![13](https://d-sketon.top/img/db-book/13.png)\n##### åˆ†æ§½çš„é¡µç»“æ„\næ¯ä¸ªå—çš„å¼€å§‹å¤„æœ‰ä¸€ä¸ªå—å¤´ï¼Œå…¶åŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼š\n- å—å¤´ä¸­è®°å½•é¡¹çš„æ•°é‡\n- å—ä¸­è‡ªç”±ç©ºé—´çš„æœ«å°¾å¤„\n- ä¸€ä¸ªç”±åŒ…å«æ¯æ¡è®°å½•çš„ä½ç½®å’Œå¤§å°çš„é¡¹ç»„æˆçš„æ•°ç»„\n\nåˆ†é…æ–¹å¼ï¼š \n+ è®°å½•ä»å—çš„æœ«å°¾å¤„å¼€å§‹åœ¨å—ä¸­è¿ç»­åˆ†é…ç©ºé—´\n+ å—ä¸­çš„è‡ªç”±ç©ºé—´æ˜¯è¿ç»­çš„\n+ å¦‚æœä¸€æ¡è®°å½•è¢«åˆ é™¤ï¼Œå®ƒæ‰€å ç”¨çš„ç©ºé—´è¢«é‡Šæ”¾ï¼Œå¹¶ä¸”å®ƒçš„é¡¹è¢«ç½®ä¸ºdeletedã€‚æ­¤å¤–ï¼Œå—ä¸­ä½äºè¢«åˆ é™¤è®°å½•ä¹‹å‰çš„è®°å½•è¢«ç§»åŠ¨ï¼Œä½¿å¾—åˆ é™¤äº§ç”Ÿçš„è‡ªç”±ç©ºé—´èƒ½è¢«é‡æ–°ä½¿ç”¨\n\n![14](https://d-sketon.top/img/db-book/14.png)\n#### å¤§å¯¹è±¡å­˜å‚¨\nå¤§å¯¹è±¡å¯ä»¥ä»¥æ–‡ä»¶å½¢å¼å­˜å‚¨åœ¨è¢«æ•°æ®åº“ç®¡ç†çš„ä¸€ä¸ªæ–‡ä»¶ç³»ç»ŸåŒºåŸŸä¸­ï¼Œæˆ–è€…ä½œä¸ºæ–‡ä»¶ç»“æ„å­˜å‚¨åœ¨æ•°æ®åº“ä¸­å¹¶è¢«æ•°æ®åº“ç®¡ç†\n### æ–‡ä»¶ä¸­è®°å½•çš„ç»„ç»‡\n#### å †æ–‡ä»¶ç»„ç»‡\nè®°å½•å¯å­˜å‚¨åœ¨å¯¹åº”äºä¸€ä¸ªå…³ç³»çš„æ–‡ä»¶ä¸­çš„ä»»ä½•ä½ç½®ã€‚è®°å½•ä¸€æ—¦è¢«æ”¾åœ¨ç‰¹å®šä½ç½®ï¼Œé€šå¸¸ä¸ä¼šè¢«ç§»åŠ¨\n##### è‡ªç”±ç©ºé—´å›¾\nç”¨äºè·Ÿè¸ªå…·æœ‰è‡ªç”±ç©ºé—´æ¥å­˜å‚¨è®°å½•çš„å—\n- é€šå¸¸è¢«è¡¨ç¤ºæˆä¸€ä¸ªæ•°ç»„ï¼Œå¯¹å…³ç³»çš„æ¯ä¸ªå—ï¼Œè¯¥æ•°ç»„éƒ½åŒ…å«ä¸€ä¸ªé¡¹\n- æ¯ä¸ªé¡¹è¡¨ç¤ºä¸€ä¸ªæ¯”ä¾‹fï¼Œå³åœ¨å—ä¸­è‡³å°‘æœ‰æ¯”ä¾‹fçš„ç©ºé—´æ˜¯è‡ªç”±çš„\n- ä¸ºäº†åŠ é€Ÿå®šä½å…·æœ‰è‡ªç”±ç©ºé—´çš„å—çš„äººç‰©ï¼Œå¯ä»¥åˆ›å»º**äºŒçº§è‡ªç”±ç©ºé—´å›¾**\n- äºŒçº§è‡ªç”±ç©ºé—´å›¾çš„é¡¹å­˜å‚¨äº†ä¸»è‡ªç”±ç©ºé—´å›¾ä¸­ç›¸åº”é¡¹çš„æœ€å¤§å€¼\n#### é¡ºåºæ–‡ä»¶ç»„ç»‡\nä¸ºäº†é«˜æ•ˆå¤„ç†æŒ‰æŸä¸ªæœç´¢ç ï¼ˆä»»æ„æ˜¯å±æ€§æˆ–å±æ€§çš„é›†åˆï¼Œæ— éœ€ä¸»é”®æˆ–è¶…é”®ï¼‰çš„é¡ºåºæ’åºçš„è®°å½•è€Œè®¾è®¡\n- é€šè¿‡æŒ‡é’ˆæŠŠè®°å½•é“¾æ¥èµ·æ¥ï¼Œæ¯æ¡è®°å½•çš„æŒ‡é’ˆæŒ‡å‘æŒ‰æœç´¢ç é¡ºåºæ’åˆ—çš„ä¸‹ä¸€æ¡è®°å½•\n- æŒ‰æœç´¢ç çš„é¡ºåºï¼Œæˆ–å°½å¯èƒ½æ¥è¿‘æœç´¢ç çš„é¡ºåºç‰©ç†å­˜å‚¨è®°å½•\n- å…è®¸è®°å½•æŒ‰æ’åˆ—çš„é¡ºåºè¯»å–\n\næ’å…¥æ“ä½œï¼š\n- åœ¨æ–‡ä»¶ä¸­å®šä½æŒ‰æœç´¢ç çš„é¡ºåºä½äºå¾…æ’å…¥è®°å½•ä¹‹å‰çš„é‚£æ¡è®°å½•\n- å¦‚æœåœ¨è¿™æ¡è®°å½•æ‰€åœ¨å—ä¸­æœ‰ä¸€æ¡è‡ªç”±çš„è®°å½•ï¼Œå°±åœ¨è¿™é‡Œæ’å…¥æ–°çš„è®°å½•ã€‚å¦åˆ™ï¼Œå°†æ–°çºªå½•æ’å…¥ä¸€ä¸ª**æº¢å‡ºå—**ä¹‹ä¸­\n- æ— è®ºå“ªç§æƒ…å†µéƒ½è¦è°ƒæ•´æŒ‡é’ˆï¼Œä½¿å…¶èƒ½æŒ‰æœç´¢ç é¡ºåºå§è®°å½•é“¾æ¥åœ¨ä¸€èµ·\n- æ¯éš”ä¸€æ®µæ—¶é—´åï¼Œæ–‡ä»¶åº”å½“è¢«**é‡ç»„**ï¼Œä½¿å…¶å†æ¬¡åœ¨ç‰©ç†ä¸ŠæŒ‰é¡ºåºå­˜æ”¾\n#### å¤šè¡¨èšç°‡æ–‡ä»¶ç»„ç»‡\nå¤šä¸ªä¸åŒå…³ç³»çš„è®°å½•è¢«å­˜å‚¨åœ¨ç›¸åŒçš„æ–‡ä»¶ä¹‹ä¸­ï¼Œä»¥ä¾¿å‡å°‘ç‰¹å®šè¿æ¥æ“ä½œçš„ä»£ä»·\n- **èšç°‡ç **å®šä¹‰äº†å“ªäº›è®°å½•è¢«å­˜å‚¨åœ¨ä¸€èµ·\n#### B+æ ‘æ–‡ä»¶ç»„ç»‡\nå’ŒB+æ•°ç´¢å¼•ç»“æ„æœ‰å…³ï¼Œå¯ä»¥æä¾›å¯¹è®°å½•çš„é«˜æ•ˆé¡ºåºè®¿é—®ã€å³ä½¿å­˜åœ¨å¤§é‡æ’å…¥ï¼Œåˆ é™¤æˆ–æ›´æ–°æ“ä½œ\n#### å“ˆå¸Œæ–‡ä»¶ç»„ç»‡\nåœ¨æ¯æ¡è®°å½•çš„æŸäº›å±æ€§ä¸Šè®¡ç®—ä¸€ä¸ªæ•£åˆ—å‡½æ•°ã€‚å‡½æ•°çš„ç»“æœç¡®å®šäº†è®°å½•å­˜å…¥æ–‡ä»¶çš„å“ªä¸ªå—ä¸­\n#### åˆ’åˆ†\nè®¸å¤šæ•°æ®åº“å…è®¸å°†ä¸€ä¸ªå…³ç³»ä¸­çš„è®°å½•åˆ’åˆ†ä¸ºæ›´å°çš„å…³ç³»ï¼Œè¿™äº›å…³ç³»åˆ†åˆ«è¿›è¡Œå­˜å‚¨\n### æ•°æ®å­—å…¸å­˜å‚¨\nå…³ç³»æ¨¡å¼å’Œå…³äºå…³ç³»çš„å…¶ä»–å…ƒæ•°æ®å­˜å‚¨åœ¨**æ•°æ®å­—å…¸**æˆ–**ç³»ç»Ÿç›®å½•**ä¸­\nå…¶ä¸­å¿…é¡»å­˜å‚¨çš„ä¿¡æ¯ç±»å‹æœ‰ï¼š\n- å…³ç³»çš„åç§°\n- æ¯ä¸ªå…³ç³»ä¸­å±æ€§çš„åç§°\n- å±æ€§çš„åŸŸå’Œé•¿åº¦\n- åœ¨æ•°æ®åº“ä¸Šå®šä¹‰çš„è§†å›¾çš„åç§°ï¼Œä»¥åŠè§†å›¾çš„å®šä¹‰\n- å®Œæ•´æ€§çº¦æŸ\n\nå¯ä»¥ä¸ºç”¨æˆ·ä¿å­˜ä¸‹åˆ—ä¿¡æ¯ï¼š\n- ç”¨æˆ·çš„åç§°ã€ç¼ºçœæ¨¡å¼ã€å¯†ç æˆ–å…¶ä»–ä¿¡æ¯\n- å…³äºæ¯ä¸ªç”¨æˆ·çš„æˆæƒä¿¡æ¯\n\nå¯èƒ½è®°å½•å…³ç³»çš„å­˜å‚¨ç»„ç»‡åŠæ¯ä¸ªå…³ç³»çš„å­˜å‚¨ä½ç½®ï¼š\n- è‹¥å…³ç³»è¢«å­˜åœ¨æ“ä½œç³»ç»Ÿæ–‡ä»¶ä¹‹ä¸­ï¼Œæ•°æ®å­—å…¸å°†ä¼šè®°å½•æ¯ä¸ªå…³ç³»çš„å•ä¸ªæ–‡ä»¶ï¼ˆæˆ–å¤šä¸ªæ–‡ä»¶ï¼‰çš„åç§°\n- è‹¥å…³ç³»è¢«å­˜åœ¨å•ä¸ªæ–‡ä»¶ä¸­ï¼Œæ•°æ®å­—å…¸å¯èƒ½å°†åŒ…å«æ¯ä¸ªå…³ç³»çš„è®°å½•çš„å—è®°å½•åœ¨è¯¸å¦‚é“¾è¡¨é‚£æ ·çš„æ•°æ®ç»“æ„ä¸­\n\nå­˜å‚¨æ¯ä¸ªå…³ç³»çš„æ¯ä¸ªç´¢å¼•çš„ä¿¡æ¯ï¼š\n- ç´¢å¼•çš„åç§°\n- è¢«ç´¢å¼•çš„å…³ç³»çš„åç§°\n- åœ¨å™¨ä¸Šå®šä¹‰ç´¢å¼•çš„æ•°å­¦\n- æ„é€ çš„ç´¢å¼•çš„ç±»å‹\n### æ•°æ®åº“ç¼“å†²åŒº\n- **ç¼“å†²åŒº**æ˜¯ä¸»å­˜ä¸­ç”¨äºå­˜å‚¨ç£ç›˜å¿«é€’æ‹·è´çš„é‚£éƒ¨åˆ†\n- æ¯ä¸ªå—æ€»æœ‰ä¸€ä»½æ‹·è´å­˜æ”¾åœ¨ç£ç›˜ä¸Šï¼Œä½†æ˜¯ç£ç›˜ä¸Šçš„æ‹·è´å¯èƒ½æ¯”ç¼“å†²åŒºçš„ç‰ˆæœ¬æ—§\n- è´Ÿè´£ç¼“å†²åŒºç©ºé—´åˆ†é…çš„å­ç³»ç»Ÿç§°ä¸º**ç¼“å†²åŒºç®¡ç†å™¨**\n#### ç¼“å†²åŒºç®¡ç†å™¨\nç¼“å†²åŒºç®¡ç†å™¨å’Œæ“ä½œç³»ç»Ÿè™šæ‹Ÿå­˜å‚¨ç®¡ç†å™¨ç±»ä¼¼\n##### è¢«é’‰ä½çš„å—\n- åœ¨ä¸€ä¸ªè¿›ç¨‹ä»ç¼“å†²å—ä¸­è¯»å–æ•°æ®ä¹‹å‰ï¼Œè¿›ç¨‹åœ¨è¯¥å—ä¸Šæ‰§è¡Œé’‰ä½æ“ä½œ\n- ç¼“å†²åŒºç®¡ç†å™¨ä¸ä¼šæº¢å‡ºä¸€ä¸ªè¢«é’‰ä½çš„å—\n##### ç¼“å†²åŒºä¸Šçš„å…±äº«æ’å®ƒé”\næ•°æ®åº“ç¼“å†²åŒºç®¡ç†å™¨å…è®¸è¿›ç¨‹è·å–ç¼“å†²åŒºä¸Šçš„å…±äº«æ’å®ƒé”\nå°é”è§„åˆ™ï¼š\n- ä»»æ„æ•°é‡çš„è¿›ç¨‹å¯ä»¥åœ¨ä¸€ä¸ªå—ä¸ŠåŒæ—¶æ‹¥æœ‰å…±äº«é”\n- æ¯æ¬¡åªå…è®¸ä¸€ä¸ªè¿›ç¨‹è·å¾—æ’å®ƒé”ï¼Œå¹¶ä¸”å½“ä¸€ä¸ªè¿›ç¨‹æ‹¥æœ‰æ’ä»–é”æ—¶ï¼Œå…¶ä»–è¿›ç¨‹ä¸èƒ½æ‹¥æœ‰æ­¤å—ä¸Šçš„å…±äº«é”ã€‚\n- å¦‚æœä¸€ä¸ªè¿›ç¨‹è¯·æ±‚å—ä¸Šçš„æ’å®ƒé”ï¼Œä½†æ­¤å—å·²ç»ä»¥å…±äº«æˆ–è€…æ’ä»–æ¨¡å¼è¢«å°é”ï¼Œé‚£ä¹ˆåœ¨æ—©æœŸå°é”è¢«é‡Šæ”¾ä¹‹å‰ï¼Œè¯¥è¯·æ±‚ä¸€ç›´å¤„äºç­‰å¾…çŠ¶æ€\n- å¦‚æœä¸€ä¸ªè¿›ç¨‹è¯·æ±‚å—ä¸Šçš„å…±äº«é”ï¼Œè€Œä¸”æ­¤å—æ²¡æœ‰è¢«å°é”æˆ–è€…å·²ç»è¢«å…±äº«é”å°é”ï¼Œåˆ™æ­¤é”å¯ä»¥è¢«æˆäºˆï¼›ä½†æ˜¯ï¼Œå¦‚æœå¦ä¸€ä¸ªè¿›ç¨‹æŒæœ‰è¯¥å—çš„æ’å®ƒé”ï¼Œåˆ™å…±äº«é”åªæœ‰åœ¨æ’ä»–é”è¢«é‡Šæ”¾åæ‰èƒ½æˆäºˆ\n\nè·å¾—é‡Šæ”¾å°é”è§„åˆ™ï¼š\n- åœ¨ä¸€ä¸ªå—ä¸Šæ‰§è¡Œä»»ä½•æ“ä½œä¹‹å‰ï¼Œè¿›ç¨‹å¿…é¡»é’‰ä½è¿™ä¸ªå—ã€‚éšåè·å¾—å°é”ï¼Œä¸”å¿…é¡»åœ¨å¯¹å—è§£é™¤é’‰ä½ä¹‹å‰é‡Šæ”¾å°é”\n- åœ¨ä»ç¼“å†²å—è¯»æ•°æ®ä¹‹å‰ï¼Œè¿›ç¨‹å¿…é¡»è·å–æ­¤å—ä¸Šçš„å…±äº«é”ã€‚å½“å®Œæˆæ•°æ®è¯»å–æ—¶ï¼Œè¿›ç¨‹å¿…é¡»é‡Šæ”¾æ­¤é”\n- åœ¨æ›´æ–°ç¼“å­˜å—å†…å®¹ä¹‹å‰ï¼Œè¿›ç¨‹å¿…é¡»è·å¾—æ­¤å—ä¸Šçš„æ’å®ƒé”ï¼›è¯¥é”å¿…é¡»åœ¨æ›´æ–°å®Œæˆåé‡Šæ”¾\n#### ç¼“å†²åŒºæ›¿æ¢ç­–ç•¥\nç»å¤§å¤šæ•°æ•°æ®åº“éƒ½ä½¿ç”¨äº†LRUç­–ç•¥\n## ç´¢å¼•\n### é¡ºåºç´¢å¼•\né¡ºåºç´¢å¼•æŒ‰ç…§æ’å¥½çš„é¡ºåºå­˜å‚¨æœç´¢ç çš„å€¼ï¼Œå¹¶å°†æ¯ä¸ªæœç´¢ç ä¸åŒ…å«è¯¥æœç´¢ç çš„è®°å½•å…³è”èµ·æ¥\n- **èšé›†ç´¢å¼•ï¼ˆä¸»ç´¢å¼•ï¼‰**\n    - åŒ…å«è®°å½•çš„æ–‡ä»¶æŒ‰é¡ºåºæ’åˆ—\n    - æœç´¢ç å®šä¹‰äº†æ–‡ä»¶çš„æ’åˆ—æ¬¡åº\n- **éèšé›†ç´¢å¼•ï¼ˆè¾…åŠ©ç´¢å¼•ï¼‰**\n    - æœç´¢ç æŒ‡å®šçš„æ¬¡åºä¸æ–‡ä»¶çš„æ’åˆ—æ¬¡åºä¸åŒ\n#### ç¨ å¯†ç´¢å¼•\nå¯¹äºæ–‡ä»¶ä¸­çš„æ¯ä¸ªæœç´¢ç å€¼éƒ½æœ‰ä¸€ä¸ªç´¢å¼•é¡¹ \n- **ç¨ å¯†èšé›†ç´¢å¼•**\n    - ç´¢å¼•è®°å½•åŒ…æ‹¬æœç´¢ç å€¼ä»¥åŠæŒ‡å‘å…·æœ‰è¯¥æœç´¢ç å€¼çš„ç¬¬ä¸€æ¡æ•°æ®è®°å½•çš„æŒ‡é’ˆ\n    - å…·æœ‰ç›¸åŒæœç´¢ç å€¼çš„å…¶ä½™è®°å½•ä¼šé¡ºåºiå­˜å‚¨åœ¨ç¬¬ä¸€æ¡è®°å½•ä¹‹å\n- **ç¨ å¯†éèšé›†ç´¢å¼•**\n    - ç´¢å¼•å¿…é¡»å­˜å‚¨æŒ‡å‘å…·æœ‰ç›¸åŒæœç´¢ç å€¼çš„æ‰€æœ‰è®°å½•çš„æŒ‡é’ˆåˆ—è¡¨\n#### ç¨€ç–ç´¢å¼•\nåªä¸ºæŸäº›æœç´¢ç å€¼å»ºç«‹ç´¢å¼•é¡¹\n- åªæœ‰å½“å…³ç³»æŒ‰æœç´¢ç æ’åˆ—æ¬¡åºå­˜å‚¨æ—¶æ‰èƒ½ä½¿ç”¨ç¨€ç–ç´¢å¼•\n- ç´¢å¼•è®°å½•åŒ…æ‹¬æœç´¢ç å€¼ä»¥åŠæŒ‡å‘å…·æœ‰è¯¥æœç´¢ç å€¼çš„ç¬¬ä¸€æ¡æ•°æ®è®°å½•çš„æŒ‡é’ˆ\n#### å¤šçº§ç´¢å¼•\n-  ä½¿ç”¨å¤šçº§ç´¢å¼•æå‡æœç´¢æ•ˆç‡\n- åœ¨åŸå§‹ç´¢å¼•ä¸Šæ„é€ ä¸€ä¸ªç¨€ç–çš„å¤–å±‚ç´¢å¼•\n#### ç´¢å¼•æ›´æ–°\n##### æ’å…¥\n- ç¨ å¯†ç´¢å¼•\n    - å¦‚æœæœç´¢ç å€¼ä¸åœ¨ç´¢å¼•ä¸­ï¼Œåˆ™åœ¨é€‚å½“ä½ç½®æ’å…¥è¯¥æœç´¢ç å€¼çš„ç´¢å¼•\n    -  å¦‚æœç´¢å¼•é¡¹å­˜å‚¨æ‰€æœ‰è®°å½•çš„æŒ‡é’ˆï¼Œåˆ™åœ¨ç´¢å¼•é¡¹ä¸­å¢åŠ ä¸€æ¡æŒ‡å‘æ–°è®°å½•çš„æŒ‡é’ˆ\n    -  å¦‚æœæ‰€æœ‰å‘å­˜å‚¨ç¬¬ä¸€æ¡è®°å½•çš„æŒ‡é’ˆï¼Œåˆ™å°†å¾…æ’å…¥çš„è®°å½•æ”¾åˆ°ç›¸åŒæœç´¢ç å€¼çš„å…¶ä»–è®°å½•ä¹‹å\n- ç¨€ç–ç´¢å¼•\n    -  å¦‚æœæ’å…¥çš„è®°å½•å…·æœ‰å®ƒæ‰€åœ¨å—çš„æœ€å°æœç´¢ç å€¼ï¼Œåˆ™æ›´æ–°æŒ‡å‘è¯¥å—çš„ç´¢å¼•\n##### åˆ é™¤\n- ç¨ å¯†ç´¢å¼•\n    - å¦‚æœå¾…åˆ é™¤çš„è®°å½•æ˜¯è¯¥ç‰¹å®šæœç´¢ç å€¼çš„å”¯ä¸€è®°å½•ï¼Œåˆ™ç›´æ¥åˆ é™¤è¯¥ç´¢å¼•é¡¹\n    -  å¦‚æœç´¢å¼•é¡¹å­˜å‚¨æ‰€æœ‰è®°å½•çš„æŒ‡é’ˆï¼Œåˆ™åœ¨ç´¢å¼•é¡¹ä¸­åˆ é™¤ä¸€æ¡æŒ‡å‘æ–°è®°å½•çš„æŒ‡é’ˆ\n    -  å¦‚æœæ‰€æœ‰å‘å­˜å‚¨ç¬¬ä¸€æ¡è®°å½•çš„æŒ‡é’ˆï¼Œä¸”å¾…åˆ é™¤è®°å½•æ˜¯è¯¥æœç´¢ç å€¼çš„ç¬¬ä¸€æ¡ï¼Œåˆ™æ›´æ–°ç´¢å¼•é¡¹ï¼Œä½¿å…¶æŒ‡å‘ä¸‹ä¸€æ¡è®°å½•\n- ç¨€ç–ç´¢å¼•\n    - å¦‚æœå¾…åˆ é™¤çš„è®°å½•æ˜¯è¯¥ç‰¹å®šæœç´¢ç å€¼çš„å”¯ä¸€è®°å½•ï¼Œåˆ™ç³»ç»Ÿç”¨ä¸‹ä¸€ä¸ªæœç´¢ç å€¼çš„ç´¢å¼•è®°å½•ä»£æ›¿ï¼›å¦‚æœä¸‹ä¸€ä¸ªæœç´¢ç å€¼å·²ç»æœ‰äº†ç´¢å¼•é¡¹ï¼Œåˆ™åˆ é™¤è¯¥è¯¥ç´¢å¼•é¡¹\n    - å¦åˆ™ï¼Œå¦‚æœè¯¥æœç´¢ç å€¼çš„ç´¢å¼•é¡¹æŒ‡å‘å¾…åˆ é™¤çš„è®°å½•ï¼Œåˆ™æ›´æ–°ç´¢å¼•é¡¹ï¼Œä½¿å…¶æŒ‡å‘å…·æœ‰ç›¸åŒæœç´¢ç å€¼çš„ä¸‹ä¸€æ¡è®°å½•\n#### è¾…åŠ©ç´¢å¼•\nè¾…åŠ©ç´¢å¼•å¿…é¡»æ˜¯ç¨ å¯†çš„ï¼Œå¯¹æ¯ä¸ªæœç´¢ç å€¼éƒ½æœ‰ä¸€ä¸ªç´¢å¼•é¡¹ï¼Œå¹¶ä¸”å¯¹æ–‡ä»¶ä¸­çš„æ¯æ¡è®°å½•éƒ½æœ‰ä¸€ä¸ªæŒ‡é’ˆ\n### B+æ ‘ç´¢å¼•\nB+æ ‘ç´¢å¼•é‡‡ç”¨å¹³è¡¡æ ‘ç»“æ„\n- ä»æ ‘æ ¹åˆ°æ ‘å¶çš„æ¯æ¡è·¯å¾„çš„é•¿åº¦éƒ½æ˜¯ç›¸åŒçš„\n- æ ‘ä¸­æ¯ä¸ªéå¶èŠ‚ç‚¹ï¼ˆé™¤æ ¹èŠ‚ç‚¹ï¼‰æœ‰âŒˆn/2âŒ‰åˆ°nä¸ªå­©å­\n- æ ¹èŠ‚ç‚¹æœ‰2åˆ°nä¸ªå­©å­\n#### B+æ ‘ç»“æ„\n- å…¸å‹çš„B+æ ‘èŠ‚ç‚¹æœ€å¤šåŒ…å«n-1ä¸ªæœç´¢ç å€¼K1,K2,...Kn-1ï¼Œä»¥åŠnä¸ªæŒ‡é’ˆP1,P2,..,Pn\n- ä¸€ä¸ªèŠ‚ç‚¹å†…çš„æœç´¢ç å€¼æ˜¯æœ‰åºå­˜æ”¾çš„ \n##### å¶èŠ‚ç‚¹\n- å¯¹i=1,2,...,n-1ï¼ŒæŒ‡é’ˆPiæŒ‡å‘å…·æœ‰æœç´¢ç å€¼Kiçš„ä¸€æ¡æ–‡ä»¶è®°å½•\n- æŒ‡é’ˆPnæŒ‡å‘ä¸‹ä¸€ä¸ªå¶èŠ‚ç‚¹ï¼Œç”¨äºé«˜æ•ˆçš„é¡ºåºå¤„ç†\n- æ¯ä¸ªå¶èŠ‚ç‚¹æœ€å¤šæœ‰n-1ä¸ªå€¼ï¼Œæœ€å°‘æœ‰âŒˆ(n-1)/2âŒ‰ä¸ªå€¼  \n- å¦‚æœLiå’ŒLjæ˜¯å¶èŠ‚ç‚¹ä¸”i\\<jï¼Œåˆ™Liä¸­çš„æ¯ä¸ªæœç´¢ç å€¼viå‡å°äºLjä¸­çš„æ¯ä¸ªæœç´¢ç å€¼vj\n- å¦‚æœB+æ ‘ç´¢å¼•æ¯”ç”¨ä½œç¨ å¯†ç´¢å¼•ï¼Œæ¯ä¸ªæœç´¢ç å€¼éƒ½å¿…é¡»å‡ºç°åœ¨æŸä¸ªå¶èŠ‚ç‚¹ä¸­ \n\n![15](https://d-sketon.top/img/db-book/15.png)\n#### B+æ ‘çš„æŸ¥è¯¢\nB+æ ‘çš„æŸ¥è¯¢ï¼š\n```text\nfunction find(v)\n    C = æ ¹èŠ‚ç‚¹\n    while (Cä¸æ˜¯å¶èŠ‚ç‚¹) begin\n        ä»¤i = æ»¡è¶³ v <=C.Kiçš„æœ€å°å€¼\n        if æ²¡æœ‰è¿™æ ·çš„i then begin\n            ä»¤Pm = è¯¥èŠ‚ç‚¹ä¸­æœ€åä¸€ä¸ªéç©ºæŒ‡é’ˆ\n            ç½®C=C.Pm\n        end\n        else if (v = C.Ki)  then ç½®C = C.Pi+1  \n        else ç½®C = C.Pi\n    end\n    if æœ‰æŸä¸ªi,æ»¡è¶³ Ki = v  \n        then return Pi\n    else \n        return null\n```\n#### B+æ ‘çš„æ’å…¥\nåœ¨B+æ ‘ä¸­æ’å…¥é¡¹ï¼š\n```text\nprocedure insert(value K, pointer P)\n    if (æ ‘ä¸ºç©º) åˆ›å»ºä¸€ä¸ªç©ºçš„å¶èŠ‚ç‚¹Lï¼ŒåŒæ—¶å®ƒä¹Ÿæ˜¯æ ¹èŠ‚ç‚¹\n    else æ‰¾åˆ°åº”è¯¥åŒ…å«ç å€¼Kçš„å¶èŠ‚ç‚¹L\n    if (L å…·æœ‰ä¸åˆ°n-1ä¸ªç å€¼)\n        then insert_in_leaf (L, K, P)\n        else begin  /* æ‹†åˆ†L */\n        åˆ›å»ºèŠ‚ç‚¹ L'\n        æŠŠ L.P1 â€¦ L.Kn-1 å¤åˆ¶åˆ°å¯ä»¥å®¹çº³nä¸ªï¼ˆæŒ‡é’ˆï¼Œç å€¼ï¼‰å¯¹çš„å†…å­˜å—Tä¸­\n        insert_in_leaf (T, K, P)\n        ä»¤ L'.Pn = L.Pn\n        ä»¤ L.Pn = L'\n        ä»Lä¸­åˆ é™¤L.P1 åˆ° L.Kn-1\n        æŠŠ T.P1 åˆ° T.KâŒˆnâˆ•2âŒ‰ ä» T å¤åˆ¶åˆ° L ä¸­ï¼ŒL ä»¥ L.P1 ä½œä¸ºå¼€å§‹\n        æŠŠ T.PâŒˆnâˆ•2âŒ‰+1 åˆ° T.Kn ä» T å¤åˆ¶åˆ° L'ä¸­ï¼ŒL'ä»¥ L'.P1 ä½œä¸ºå¼€å§‹\n        ä»¤ K'ä¸º L'ä¸­çš„æœ€å°ç å€¼\n        insert_in_parent(L, K', L')\n    end\n```\nç”¨äºå¾€B+æ ‘ä¸­æ’å…¥é¡¹çš„è¾…åŠ©è¿‡ç¨‹ï¼š\n```text\nprocedure insert_in_leaf (node L, value K, pointer P)\n    if (K < L.K1) then æŠŠPã€Kæ’å…¥Lä¸­ï¼Œç´§æ¥åœ¨L.P1å‰é¢\n    else begin\n            ä»¤ Ki è¡¨ç¤º L ä¸­å°äºæˆ–ç­‰äº K çš„æœ€å¤§å€¼\n            æŠŠPã€Kæ’å…¥Lä¸­ï¼Œç´§æ¥åœ¨L.Kiå‰é¢\n    end\n    \nprocedure insert_in_parent(node N, value K', node N')\n    if (N æ˜¯æ ‘çš„æ ¹ç»“ç‚¹)\n        then begin\n       åˆ›å»ºä¸€ä¸ªæ–°çš„ï¼ŒåŒ…å«Nã€K'ã€N'çš„èŠ‚ç‚¹R\n       ä»¤Rä¸ºæ ‘çš„æ ¹èŠ‚ç‚¹\n       return\n        end\n    ä»¤ P = parent (N)\n    if (Pæœ‰ä¸åˆ°nä¸ªæŒ‡é’ˆ) then å°† (K', N')æ’å…¥ P ä¸­ï¼Œç´§è·Ÿåœ¨ N åé¢\n    else begin   /* æ‹†åˆ† P */\n        å°† P å¤åˆ¶åˆ°å¯ä»¥å®¹çº³ P å’Œ (K', N') çš„å†…å­˜å— T ä¸­\n        å°† (K', N') æ’å…¥ T ä¸­ï¼Œç´§è·Ÿåœ¨ N åé¢\n        åˆ é™¤ P ä¸­æ‰€æœ‰é¡¹ \n        åˆ›å»ºèŠ‚ç‚¹ P'\n        æŠŠ T.P1â€¦T.PâŒˆ(n+1)âˆ•2âŒ‰ å¤åˆ¶åˆ° P\n        ä»¤ K'' = T.KâŒˆ(n+1)âˆ•2âŒ‰\n        æŠŠ T.PâŒˆ(n+1)âˆ•2âŒ‰+1â€¦T.Pn+1 å¤åˆ¶åˆ° P'\n        Insert_in_parent(P, K'', P')\n    end\n```\n#### B+æ ‘çš„åˆ é™¤\n```text\nprocedure delete(value K, pointer P)\n    æ‰¾åˆ°åŒ…å«(K, P)çš„å¶èŠ‚ç‚¹ L\n    delete_entry(L, K, P)\n    \nprocedure delete_entry(node N, value K, pointer P)\n    ä» N ä¸­åˆ é™¤ (K, P)\n    if (N æ˜¯æ ¹èŠ‚ç‚¹ and N åªå‰©ä¸‹ä¸€ä¸ªå­èŠ‚ç‚¹)\n    then ä½¿ N çš„å­èŠ‚ç‚¹æˆä¸ºè¯¥æ ‘çš„æ–°çš„æ ¹èŠ‚ç‚¹å¹¶åˆ é™¤ N\n    else if (N æœ‰å¤ªå°‘çš„å€¼/æŒ‡é’ˆ) then begin\n        ä»¤ N' ä¸º parent(N) çš„å‰ä¸€ä¸ªæˆ–åä¸€ä¸ªå­©å­èŠ‚ç‚¹\n        ä»¤ K' ä¸º parent(N) ä¸­æŒ‡é’ˆ N å’Œ N' ä¹‹é—´çš„å€¼\n        if (N å’Œ N' ä¸­çš„é¡¹èƒ½æ”¾å…¥å•ä¸ªèŠ‚ç‚¹ä¸­)\n            then begin /*åˆå¹¶èŠ‚ç‚¹*/\n                if (N æ˜¯ N'çš„å‰ä¸€ä¸ªèŠ‚ç‚¹) then swap_variables(N, N')\n                if (N ä¸æ˜¯å¶èŠ‚ç‚¹)\n                    then å°† K'ä»¥åŠ N ä¸­æ‰€æœ‰çš„æŒ‡é’ˆå’Œå€¼é™„åŠ åˆ° N'ä¸­\n                    else å°† N ä¸­æ‰€æœ‰ (Ki, Pi) å¯¹é™„åŠ åˆ° N' ä¸­\n                    ä»¤ N'.Pn = N.Pn\n                    delete_entry(parent(N), K', N);åˆ é™¤èŠ‚ç‚¹ N\n                end\n        else begin/*é‡æ–°åˆ†é…ï¼Œä» N' å€Ÿæ¥ä¸€ä¸ªé¡¹*/\n            if (N' æ˜¯ N çš„å‰ä¸€ä¸ªèŠ‚ç‚¹) then begin\n                if (N æ˜¯éå¶èŠ‚ç‚¹) then begin\n                    ä»¤ m æ»¡è¶³ï¼šN'.Pm æ˜¯ N' ä¸­çš„æœ€åä¸€ä¸ªæŒ‡é’ˆ\n                    ä» N' ä¸­å»é™¤ (N'.Km-1, N'.Pm)\n                    æ’å…¥ (N'.Pm, K') å¹¶é€šè¿‡å°†å…¶å®ƒæŒ‡é’ˆå’Œå€¼å³ç§»ä½¿ä¹‹æˆä¸º N ä¸­çš„ç¬¬ä¸€ä¸ªæŒ‡é’ˆå’Œå€¼\n                    ç”¨ N'.Km-1 æ›¿æ¢ parent(N) ä¸­çš„ K'\n                end\n                else begin\n                    ä»¤ m æ»¡è¶³ (N'.Pm, N'.Km) æ˜¯ N' ä¸­çš„æœ€åä¸€ä¸ªæŒ‡é’ˆ/å€¼å¯¹\n                    ä» N' ä¸­å»é™¤ (N'.Pm, N'.Km)\n                    æ’å…¥ (N'.Pm, N'.Km) å¹¶é€šè¿‡å°†å…¶å®ƒæŒ‡é’ˆå’Œå€¼å³ç§»ä½¿ä¹‹æˆä¸º N ä¸­çš„ç¬¬ä¸€ä¸ªæŒ‡é’ˆå’Œå€¼\n                    ç”¨ N'.Km æ›¿æ¢ parent(N) ä¸­çš„ K'\n                end\n            end\n            else ...ä¸thençš„æƒ…å†µå¯¹ç§°...\n        end\n    end\n```\n#### éå”¯ä¸€æ€§æœç´¢ç \n- æ¯ä¸ªç åªåœ¨æ ‘ä¸­å­˜å‚¨ä¸€æ¬¡ï¼Œå¹¶ç»´æŠ¤ä¸€ä¸ªå¸¦æœ‰æœç´¢ç å€¼çš„è®°å½•æŒ‡é’ˆçš„æ¡¶ï¼Œä½†ä¼šäº§ç”Ÿå¤æ‚é—®é¢˜\n- æ¯æ¡è®°å½•å­˜å‚¨ä¸€æ¬¡æœç´¢ç çš„å€¼ï¼Œä½†ä¹Ÿä¼šäº§ç”Ÿå¤æ‚é—®é¢˜\n- ç”±äºä»¥ä¸Šä¸¤ä¸ªæ–¹æ³•åˆ é™¤æ•ˆç‡åº•ä¸‹ï¼Œæ‰€ä»¥å¤§å¤šæ•°æ•°æ®åº“ç³»ç»Ÿä¸­çš„B+æ ‘éƒ½åªå¤„ç†å”¯ä¸€æ€§æœç´¢ç ï¼Œå¹¶è‡ªåŠ¨æ·»åŠ è®°å½•IDæˆ–å…¶ä»–å±æ€§ä»¥ä½¿éå”¯ä¸€æ€§æœç´¢ç å˜å¾—å”¯ä¸€\n### B+æ ‘æ‰©å±•\n#### B+æ ‘æ–‡ä»¶ç»„ç»‡\n- ä¸ä»…æŠŠB+æ ‘ç»“æ„ä½œä¸ºç´¢å¼•æ¥ä½¿ç”¨ï¼Œè€Œä¸”æŠŠå®ƒä½œä¸ºä¸€ç§æ–‡ä»¶ä¸­è®°å½•çš„ç»„ç»‡æ–¹å¼æ¥ä½¿ç”¨\n- æ ‘çš„å¶èŠ‚ç‚¹å­˜å‚¨çš„æ˜¯è®°å½•è€Œä¸æ˜¯æŒ‡å‘è®°å½•çš„æŒ‡é’ˆ\n- B+æ ‘æ–‡ä»¶ç»„ç»‡å¯ç”¨äºå­˜å‚¨å¤§å‹å¯¹è±¡ï¼Œå¯å°†å¤§å‹å¯¹è±¡æ‹†åˆ†æˆæ›´å°çš„è®°å½•åºåˆ—å¹¶ç»„ç»‡æˆB+æ ‘æ–‡ä»¶ç»„ç»‡çš„å½¢å¼è¿›è¡Œå­˜å‚¨\n#### è¾…åŠ©ç´¢å¼•å’Œè®°å½•é‡åˆ†é…\n- å¦‚æœè®°å½•çš„ä½ç½®å‘ç”Ÿäº†æ”¹å˜ï¼Œå­˜å‚¨äº†æŒ‡å‘è¢«é‡æ–°åˆ†é…è¿‡çš„è®°å½•çš„æŒ‡é’ˆçš„æ‰€æœ‰èµ‹å€¼ç´¢å¼•éƒ½å¿…é¡»è¢«æ›´æ–°\n- B+æ ‘æ–‡ä»¶ç»„ç»‡ä¸­èŠ‚ç‚¹æ‹†åˆ†çš„ä»£ä»·åŠå…¶é«˜æ˜‚\n- è§£å†³æ–¹æ³•ï¼šåœ¨è¾…åŠ©ç´¢å¼•ä¸­å­˜å‚¨ä¸»ç´¢å¼•æœç´¢ç å±æ€§çš„å€¼\n- è¯¥æ–¹æ³•å¤§å¤§é™ä½äº†ç”±æ–‡ä»¶é‡ç»„å¯¼è‡´çš„ç´¢å¼•æ›´æ–°çš„ä»£ä»·ï¼Œä½†ä¹Ÿå¢åŠ äº†ä½¿ç”¨è¾…åŠ©ç´¢å¼•è®¿é—®æ•°æ®çš„ä»£ä»·\n#### å¯¹å­—ç¬¦ä¸²çš„ç´¢å¼•\n- å¯å˜å­—ç¬¦ä¸²ä¼šå¯¼è‡´ä¸åŒçš„æ‰‡å‡º\n- èŠ‚ç‚¹çš„åˆå¹¶æˆ–è€…é¡¹çš„é‡æ–°åˆ†é…å–å†³äºèŠ‚ç‚¹ä¸­æ‰€ä½¿ç”¨ç©ºé—´çš„æ¯”ä¾‹ï¼Œè€Œä¸æ˜¯æ ¹æ®èŠ‚ç‚¹æ‰€èƒ½å®¹çº³çš„æœ€å¤§é¡¹æ•°\n- ä½¿ç”¨**å‰ç¼€å‹ç¼©**çš„æŠ€æœ¯å¯ä»¥å¢åŠ èŠ‚ç‚¹çš„æ‰‡å‡º\n    - åœ¨éå¶èŠ‚ç‚¹ä¸Šå­˜å‚¨æ¯ä¸ªæœç´¢ç å€¼çš„ä¸€ä¸ªå‰ç¼€\n#### Bæ ‘æ–‡ä»¶ç´¢å¼•\n- Bæ ‘åªå…è®¸æœç´¢ç å€¼å‡ºç°ä¸€æ¬¡ï¼ˆå¦‚æœå®ƒä»¬æ˜¯å”¯ä¸€çš„ï¼‰\n- å¯ä»¥æ¯”ç›¸åº”çš„B+æ ‘ç´¢å¼•ä½¿ç”¨æ›´å°‘çš„èŠ‚ç‚¹\n- éœ€è¦åœ¨éå¶èŠ‚ç‚¹ä¸­ä¸ºæ¯ä¸ªæœç´¢ç åŒ…å«ä¸€ä¸ªé¢å¤–çš„æŒ‡é’ˆåŸŸ\n### æ•£åˆ—ç´¢å¼•\n- **æ¡¶**ï¼šå¯ä»¥å­˜å‚¨ä¸€æ¡æˆ–å¤šæ¡è®°å½•çš„å­˜å‚¨å•å…ƒ\n    - å¯¹äºå†…å­˜ä¸­çš„æ•£åˆ—ç´¢å¼•ï¼Œæ¡¶å¯ä»¥æ˜¯ç´¢å¼•é¡¹æˆ–è®°å½•çš„é“¾è¡¨\n    - å¯¹äºåŸºäºç£ç›˜çš„ç´¢å¼•ï¼Œæ¡¶å¯ä»¥æ˜¯ç£ç›˜å—çš„é“¾è¡¨\n    - åœ¨æ•£åˆ—æ–‡ä»¶ç»„ç»‡ä¸­ï¼Œæ¡¶å­˜å‚¨å®é™…çš„è®°å½•\n- **æ•£åˆ—å‡½æ•°**ï¼šä»æ‰€æœ‰æœç´¢ç å€¼çš„é›†åˆKåˆ°æ‰€æœ‰æ¡¶åœ°å€çš„é›†åˆBçš„å‡½æ•°\n    - ä½¿ç”¨**æº¢å‡ºé“¾**çš„æ•£åˆ—ç´¢å¼•ä¹Ÿç§°ä¸º**é—­å¯»å€** \n\næ•£åˆ—ç´¢å¼•èƒ½é«˜æ•ˆåœ°æ”¯æŒæœç´¢ç ä¸Šçš„ç›¸ç­‰æŸ¥è¯¢ï¼Œä½†ä¸æ”¯æŒèŒƒå›´æŸ¥è¯¢\n### ä½å›¾ç´¢å¼•\n- ä¸ºå¤šç ä¸Šçš„ç®€å•æŸ¥è¯¢è®¾è®¡çš„ä¸€ç§ç‰¹æ®Šç±»å‹çš„ç´¢å¼•\n- rå…³ç³»åœ¨Aå±æ€§ä¸Šçš„ä½å›¾ç´¢å¼•æ˜¯ç”±Aèƒ½å–çš„æ¯ä¸ªå€¼æ‰€å¯¹åº”çš„ä½å›¾æ„æˆ\n- æ¯ä¸ªä½å›¾éƒ½æœ‰å’Œå…³ç³»ä¸­çš„è®°å½•æ•°ç›¸ç­‰æ•°é‡çš„ä½\n- å¦‚æœç¼–å·ä¸ºiçš„è®°å½•åœ¨Açš„å±æ€§ä¸ºvjï¼Œåˆ™å€¼ä¸ºvjçš„ä½å›¾ä¸­ç¬¬iä½ä¸º1ï¼Œå…¶ä»–æ‰€æœ‰ä½ä¸º0\n## æŸ¥è¯¢å¤„ç†\næŸ¥è¯¢å¤„ç†çš„åŸºæœ¬æ­¥éª¤ï¼š\n- è¯­æ³•åˆ†æä¸ç¿»è¯‘\n- ä¼˜åŒ–\n- æ‰§è¡Œ\n\nåŸºæœ¬æ¦‚å¿µï¼š\n- å¸¦æœ‰â€œå¦‚ä½•æ‰§è¡Œâ€æ³¨é‡Šçš„å…³ç³»ä»£æ•°è¿ç®—ç§°ä¸º**æ‰§è¡ŒåŸè¯­**\n- ç”¨äºæ‰§è¡Œä¸€ä¸ªæŸ¥è¯¢çš„åŸè¯­æ“ä½œåºåˆ—ç§°ä¸º**æŸ¥è¯¢æ‰§è¡Œè®¡åˆ’**\n- **æŸ¥è¯¢æ‰§è¡Œå¼•æ“**æ¥æ”¶ä¸€ä¸ªæŸ¥è¯¢æ‰§è¡Œè®¡åˆ’ï¼Œæ‰§è¡Œè¯¥è®¡åˆ’å¹¶æŠŠç»“æœè¿”å›ç»™æŸ¥è¯¢\n### æŸ¥è¯¢ä»£ä»·çš„åº¦é‡\n- å¯¹äºé©»ç•™åœ¨ç£ç›˜ä¸Šçš„å¤§å‹æ•°æ®åº“ï¼Œä»ç£ç›˜è®¿é—®æ•°æ®I/Oä»£ä»·é€šå¸¸æ˜¯æœ€ä¸»è¦çš„çš„ä»£ä»·\n- å½“æ•°æ®é©»ç•™åœ¨å†…å­˜æˆ–SSDä¸Šæ—¶ï¼ŒI/Oå¹¶ä¸æ˜¯ä¸»è¦ä»£ä»·ï¼ŒCPUä»£ä»·ä¹Ÿå¿…é¡»è€ƒè™‘\n- æˆ‘ä»¬ä½¿ç”¨ä»å­˜å‚¨ä¸­**ä¼ è¾“çš„å—æ•°**ä»¥åŠ**éšæœºI/Oè®¿é—®æ•°**ä½œä¸ºä¼°è®¡æŸ¥è¯¢æ‰§è¡Œè®¡åˆ’çš„ä»£ä»·çš„ä¸¤ä¸ªé‡è¦å› ç´ \n### é€‰æ‹©è¿ç®—\n| |ç®—æ³•|ä»£ä»·|åŸå› |\n|-|-|-|-|\n|A1|çº¿æ€§æœç´¢|ts+br\\*tT|ä¸€æ¬¡åˆå§‹æœç´¢åŠ ä¸Šbræ¬¡å—ä¼ è¾“ï¼Œå…¶ä¸­brè¡¨ç¤ºæ–‡ä»¶ä¸­çš„å—æ•°é‡|\n|A1|çº¿æ€§æœç´¢ï¼Œç ä¸Šçš„ç­‰å€¼æ¯”è¾ƒ|å¹³å‡æƒ…å†µts+(br/2)\\*tT|å› ä¸ºæœ€å¤šæœ‰ä¸€æ¡è®°å½•æ»¡è¶³æ¡ä»¶ï¼Œæ‰€ä»¥ä¸€æ—¦æ‰¾åˆ°æ‰€éœ€çš„è®°å½•ï¼Œæ‰«æå°±å¯ä»¥ç»ˆæ­¢|\n|A2|B+æ ‘èšé›†ç´¢å¼•ï¼Œç ä¸Šçš„ç­‰å€¼æ¯”è¾ƒ|(hi+1)\\*(tT+ts)|ï¼ˆhiè¡¨ç¤ºç´¢å¼•çš„é«˜åº¦ï¼‰ç´¢å¼•æœç´¢éå†æ ‘çš„é«˜åº¦ï¼Œå†åŠ ä¸Šä¸€æ¬¡I/Oæ¥è·å–è®°å½•ï¼›æ¯ä¸ªè¿™æ ·çš„I/Oæ“ä½œéœ€è¦ä¸€æ¬¡å¯»é“å’Œä¸€æ¬¡å—ä¼ è¾“|\n|A3|B+æ ‘èšé›†ç´¢å¼•ï¼Œéç ä¸Šçš„ç­‰å€¼æ¯”è¾ƒ|hi\\*(tT+ts)+ts+b\\*tT|æ ‘çš„æ¯ä¸€å±‚æœ‰ä¸€æ¬¡å¯»é“ï¼Œç¬¬ä¸€ä¸ªå—æœ‰ä¸€æ¬¡å¯»é“ã€‚è¿™é‡Œbæ˜¯åŒ…å«å…·æœ‰æŒ‡å®šæœç´¢ç è®°å½•çš„å—æ•°ï¼Œæ‰€æœ‰è¿™äº›è®°å½•éƒ½æ˜¯è¦è¯»å–çš„ã€‚å‡å®šè¿™äº›å—æ˜¯é¡ºåºå­˜å‚¨ï¼ˆå› ä¸ºæ˜¯èšé›†ç´¢å¼•ï¼‰çš„å¶å­å—å¹¶ä¸”ä¸éœ€è¦é¢å¤–çš„å¯»é“|\n|A4|B+æ ‘è¾…åŠ©ç´¢å¼•ï¼Œç ä¸Šçš„ç­‰å€¼æ¯”è¾ƒ|(hi+1)\\*(tT+ts)|å’Œèšé›†ç´¢å¼•ç±»ä¼¼|\n|A4|B+æ ‘è¾…åŠ©ç´¢å¼•ï¼Œéç ä¸Šçš„ç­‰å€¼æ¯”è¾ƒ|(hi+n)\\*(ts+tT)|ï¼ˆå…¶ä¸­næ˜¯æ‰€è·å–è®°å½•çš„æ•°é‡ï¼‰åœ¨è¿™é‡Œï¼Œç´¢å¼•éå†çš„ä»£ä»·å’ŒA3ä¸€æ ·ï¼Œä½†æ˜¯æ¯æ¡è®°å½•å­˜å‚¨åœ¨ä¸åŒçš„å—ä¸Šï¼Œéœ€è¦å¯¹æ¯æ¡è®°å½•è¿›è¡Œä¸€æ¬¡å¯»é“ã€‚å¦‚æœnå€¼æ¯”è¾ƒå¤§ï¼Œä»£ä»·å¯èƒ½éå¸¸æ˜‚è´µ|\n|A5|B+æ ‘èšé›†ç´¢å¼•ï¼Œæ¯”è¾ƒ|hi\\*(tT+ts)+ts+b\\*tT|å’ŒA3ã€éç ä¸Šçš„ç­‰å€¼æ¯”è¾ƒçš„æƒ…å†µä¸€æ ·|\n|A6|B+æ ‘è¾…åŠ©ç´¢å¼•ï¼Œæ¯”è¾ƒ|(hi+n)\\*(ts+tT)|å’ŒA4ã€éç ä¸Šçš„ç­‰å€¼æ¯”è¾ƒçš„æƒ…å†µä¸€æ ·|\n- A7ï¼ˆä½¿ç”¨ä¸€ä¸ªç´¢å¼•çš„åˆå–é€‰æ‹©ï¼‰\n    - ç”¨A2-A6çš„ä¸€ç§ç®—æ³•æ£€ç´¢æ»¡è¶³å…¶ä¸­ä¸€ä¸ªç®€å•æ¡ä»¶çš„è®°å½•ã€‚ç„¶ååœ¨å†…å­˜ç¼“å†²åŒºä¸­æµ‹è¯•æ˜¯å¦æ»¡è¶³å…¶ä½™ç®€å•æ¡ä»¶\n- A8ï¼ˆä½¿ç”¨ç»„åˆç´¢å¼•çš„åˆå–é€‰æ‹©ï¼‰\n    - å¦‚æœé€‰æ‹©æŒ‡å®šçš„æ˜¯ä¸¤ä¸ªæˆ–å¤šä¸ªå±æ€§ä¸Šçš„ç­‰å€¼æ¡ä»¶ï¼Œå¹¶ä¸”åœ¨è¿™äº›å±æ€§å­—æ®µçš„ç»„åˆä¸Šå­˜åœ¨ç»„åˆç´¢å¼•ï¼Œåˆ™å¯ä»¥ç›´æ¥æœç´¢è¯¥ç´¢å¼• \n- A9ï¼ˆä½¿ç”¨æ ‡è¯†äº¤é›†çš„åˆå–é€‰æ‹©ï¼‰\n    - è¦æ±‚åœ¨å„ä¸ªæ¡ä»¶æ‰€æ¶‰åŠçš„å­—æ®µä¸Šéƒ½æœ‰å¸¦è®°å½•æŒ‡é’ˆçš„ç´¢å¼•\n    - å¯¹æ¯ä¸ªç´¢å¼•è¿›è¡Œæ‰«æï¼Œä»¥è·å–é‚£äº›æŒ‡å‘æ»¡è¶³å•ä¸ªæ¡ä»¶çš„å…ƒç»„çš„æŒ‡é’ˆ\n    - æ‰€æœ‰æ£€ç´¢åˆ°çš„æŒ‡é’ˆçš„äº¤é›†å°±æ˜¯æ»¡è¶³åˆå–æ¡ä»¶çš„å…ƒç»„çš„æŒ‡é’ˆé›†åˆ\n- A10ï¼ˆä½¿ç”¨æ ‡è¯†å¹¶é›†çš„æå–é€‰æ‹©ï¼‰\n    - æ‰«ææ¯ä¸ªç´¢å¼•ä»¥è·å–æ»¡è¶³å•ä¸ªæ¡ä»¶çš„å…ƒç»„çš„æŒ‡é’ˆ\n    - æ£€ç´¢åˆ°çš„æ‰€æœ‰æŒ‡é’ˆçš„å¹¶é›†å°±äº§ç”Ÿå‡ºæŒ‡å‘æ»¡è¶³æå–æ¡ä»¶çš„æ‰€æœ‰å…ƒç»„çš„æŒ‡é’ˆçš„é›†åˆ\n### æ’åº\nç‰¹æŒ‡åœ¨ç‰©ç†ä¸Šå¯¹è®°å½•è¿›è¡Œæ’åº\n#### å¤–æ’åº-å½’å¹¶ç®—æ³•\n- å¯¹ä¸èƒ½å…¨éƒ¨æ”¾å…¥å†…å­˜ä¸­çš„å…³ç³»è¿›è¡Œçš„æ’åºç§°ä¸º**å¤–æ’åº**\n- å¯¹äºå¤–æ’åºæœ€å¸¸ç”¨çš„æŠ€æœ¯æ˜¯**å¤–æ’åº-å½’å¹¶**ç®—æ³•\n- ç¬¬ä¸€é˜¶æ®µï¼Œåˆ›å»ºå¤šä¸ªæ’å¥½åºçš„å½’å¹¶æ®µ\n```text\ni = 0;\nrepeat\n    è¯»å…¥å…³ç³»çš„Mä¸ªå—æˆ–è€…å…³ç³»çš„å‰©ä½™éƒ¨åˆ†ï¼Œä»¥è¾ƒå°è€…ä¸ºå‡†\n    å¯¹å…³ç³»åœ¨å†…å­˜ä¸­çš„éƒ¨åˆ†è¿›è¡Œæ’åº\n    å°†æ’å¥½åºçš„æ•°æ®å†™åˆ°å½’å¹¶æ®µæ–‡ä»¶Riä¸­\n    i= i+1\nuntil åˆ°è¾¾å…³ç³»æœ«å°¾\n```\n- ç¬¬äºŒé˜¶æ®µï¼Œå¯¹å½’å¹¶æ®µè¿›è¡Œå½’å¹¶\n```text\nä¸ºNä¸ªå½’å¹¶æ®µæ–‡ä»¶Riå„è¯»å…¥ä¸€ä¸ªå—åˆ°å†…å­˜ç¼“å†²å—ä¸­\nrepeat\n    ä»æ‰€æœ‰ç¼“å†²å—ä¸­ï¼ˆæŒ‰åºï¼‰æŒ‘é€‰ç¬¬ä¸€ä¸ªå…ƒç»„\n    æŠŠè¯¥é™¢è¶³åå€’æ•°åˆä¸­ï¼Œå¹¶å°†å…¶ä»ç¼“å†²å—ä¸­åˆ é™¤\n    if ä»»ä½•ä¸€ä¸ªå½’å¹¶æ®µRiçš„ç¼“å†²å—ä¸ºç©º and not åˆ°è¾¾ Ri çš„æœ«å°¾\n        then å°† Ri çš„ä¸‹ä¸€å—è¯»å…¥ç¼“å†²å—\nuntil æ‰€æœ‰çš„è¾“å…¥ç¼“å†²å—å‡ä¸ºç©º\n```\n #### å¤–æ’åº-å½’å¹¶çš„ä»£ä»·è®¡ç®—\n æ€»å…±éœ€è¦çš„å½’å¹¶è¶Ÿæ•°ä¸º$\\lceil log_{\\lfloor M/b_b\\rfloor-1}(b_r / M) \\rceil$\n å…³ç³»å¤–æ’åºçš„å—ä¼ è¾“çš„æ€»æ•°ä¸º$b_r (2 \\lceil log_{\\lfloor M/b_b\\rfloor-1}(b_r / M) \\rceil + 1)$\n å¯»é“ç£ç›˜çš„ä»£ä»·ä¸º$2\\lceil b_r / M \\rceil + \\lceil b_r / b_b \\rceil (2 \\lceil log_{\\lfloor M/b_b\\rfloor-1}(b_r / M) \\rceil - 1)$\n ### è¿æ¥è¿ç®—\n #### åµŒå¥—-å¾ªç¯è¿æ¥\n```text\nfor each å…ƒç»„ tr in r do begin\n    for each å…ƒç»„ ts in s do begin\n        æµ‹è¯•å…ƒç»„å¯¹(tr, ts) æ˜¯å¦æ»¡è¶³è¿æ¥æ¡ä»¶\n        å¦‚æœæ»¡è¶³ï¼ŒæŠŠtrÂ·tsåŠ åˆ°ç»“æœä¸­\n    end\nend\n```\n- åµŒå¥—-å¾ªç¯è¿æ¥ç®—æ³•çš„ä»£ä»·æ˜‚è´µ\n- å¦‚æœå…¶ä¸­ä¸€ä¸ªå…³ç³»èƒ½å®Œå…¨æ”¾å…¥ä¸»å­˜ä¸­ï¼Œåˆ™åº”è¯¥æŠŠè¿™ä¸ªå…³ç³»ä½œä¸ºå†…å±‚å…³ç³»\n#### å—åµŒå¥—-å¾ªç¯è¿æ¥\n```text\nfor each å—Br of r do begin\n    for each å—Bs of s do begin\n        for each å…ƒç»„ tr in Br do begin\n            for each å…ƒç»„ ts in Bs do begin\n                æµ‹è¯•å…ƒç»„å¯¹(tr, ts) æ˜¯å¦æ»¡è¶³è¿æ¥æ¡ä»¶\n                å¦‚æœæ»¡è¶³ï¼ŒæŠŠtrÂ·tsåŠ åˆ°ç»“æœä¸­\n            end\n        end\n    end\nend\n```\n- åœ¨æœ€åçš„æƒ…å†µä¸‹ï¼Œå¯¹äºå¤–å±‚å…³ç³»ä¸­çš„æ¯ä¸ªå—ï¼Œå†…å±‚å…³ç³»sçš„æ¯ä¸ªå—åªéœ€è¯»ä¸€æ¬¡\n#### ç´¢å¼•åµŒå¥—-å¾ªç¯è¿æ¥\n- è‹¥åœ¨å†…å±‚å¾ªç¯çš„è¿æ¥å±æ€§ä¸Šæœ‰ç´¢å¼•å¯ç”¨ï¼Œåˆ™å¯ä»¥ç”¨ç´¢å¼•æŸ¥æ‰¾æ¥ä»£æ›¿æ–‡ä»¶æ‰«æ\n- ä»£ä»·å…¬å¼è¡¨æ˜ï¼šå¦‚æœä¸¤ä¸ªå…³ç³»ä¸Šå‡æœ‰ç´¢å¼•å¯ç”¨ï¼Œé€šå¸¸ä½¿ç”¨å…ƒç»„è¾ƒå°‘çš„å…³ç³»ä½œä¸ºå¤–å±‚å…³ç³»æœ€ä¸ºé«˜æ•ˆ\n#### å½’å¹¶-è¿æ¥\n- ç”¨äºè®¡ç®—è‡ªç„¶è¿æ¥å’Œç­‰å€¼è¿æ¥\n- ä¸¤ä¸ªå…³ç³»å¿…é¡»å‡æŒ‰å…¬å…±å±æ€§æ’åº\n- æ’åºåè¿æ¥é€šè¿‡ä¸æ’åº-å½’å¹¶ç®—æ³•ä¸­çš„å½’å¹¶é˜¶æ®µéå¸¸ç›¸ä¼¼çš„å¤„ç†è¿‡ç¨‹æ¥è®¡ç®—\n##### ä»£ä»·åˆ†æ\n- æ‰€éœ€çš„å—ä¼ è¾“æ¬¡æ•°ç­‰äºä¸¤ä¸ªæ–‡ä»¶çš„å—æ•°ä¹‹å’Œ$b_r+b_s$ï¼ˆå‡è®¾æ‰€æœ‰Ssé›†åˆå‡å¯è£…å…¥å†…å­˜ï¼‰\n- å‡è®¾æ¯ä¸ªå…³ç³»åˆ†é…$b_b$ä¸ªç¼“å†²å—ï¼Œåˆ™æ‰€éœ€çš„ç£ç›˜å¯»é“æ¬¡æ•°ä¸º$\\lceil b_r / b_b \\rceil + \\lceil b_s / b_b \\rceil$\n#### æ··åˆå½’å¹¶-è¿æ¥\n- æŠŠå·²æ’åºå…³ç³»ä¸B+æ ‘è¾…åŠ©ç´¢å¼•çš„å¶å­é¡¹è¿›è¡Œå½’å¹¶\n- æ‰€å¾—åˆ°çš„ç»“æœæ–‡ä»¶åŒ…å«å·²æ’åºå…³ç³»çš„å…ƒç»„å’Œæœªæ’åºå…³ç³»çš„å…ƒç»„åœ°å€\n- å°†ç»“æœæ–‡ä»¶æŒ‰æœªæ’åºå…³ç³»çš„å…ƒç»„åœ°å€è¿›è¡Œæ’åºï¼Œä»è€Œèƒ½å¯¹ç›¸å…³å…ƒç»„æŒ‰ç‰©ç†å­˜å‚¨é¡ºåºè¿›è¡Œé«˜æ•ˆçš„æ£€ç´¢\n#### æ•£åˆ—-è¿æ¥\n- ç”¨äºè®¡ç®—è‡ªç„¶è¿æ¥å’Œç­‰å€¼è¿æ¥\n- ç›¸æ¯”äºå½’å¹¶-è¿æ¥ç®—æ³•ï¼Œå°†æ’åºæ”¹ä¸ºäº†ä½¿ç”¨æ•£åˆ—å‡½æ•°\n    - ä½¿ç”¨æ•£åˆ—å‡½æ•°ï¼Œè·å¾—ä¸¤ä¸ªå…³ç³»å¯¹åº”çš„æ•£åˆ—åˆ†åŒº\n    - åœ¨å…¶ä¸­ä¸€ä¸ªåˆ†åŒºä¸Šæ„é€ å†…å­˜æ•£åˆ—ç´¢å¼•ï¼Œå¹¶ä½¿ç”¨ç´¢å¼•åµŒå¥—-å¾ªç¯è¿æ¥å®šä½å‡ºæ‰€æœ‰éœ€è¦è¿æ¥çš„å…ƒç»„\n    - è¿›è¡Œè¿æ¥\n##### ä»£ä»·åˆ†æ\n- ä¸è€ƒè™‘é€’å½’åˆ†åŒº\n    - æ‰€éœ€å—ä¼ è¾“æ¬¡æ•°$3(b_r+b_s)+4n_h$ï¼Œé€šå¸¸$4n_h$å¯ä»¥è¢«å¿½ç•¥\n    - æ‰€éœ€çš„ç£ç›˜å¯»é“æ¬¡æ•°ä¸º$2(\\lceil b_r / b_b \\rceil + \\lceil b_s / b_b \\rceil)+2n_h$æ¬¡å¯»é“\n- è€ƒè™‘é€’å½’åˆ†åŒº\n    - æ‰€éœ€å—ä¼ è¾“æ¬¡æ•°$2(b_r+b_s)\\lceil log_{\\lfloor M/b_b \\rfloor -1}(b_s /M) \\rceil +b_r + b_s$\n    - æ‰€éœ€çš„ç£ç›˜å¯»é“æ¬¡æ•°ä¸º$2(\\lceil b_r / b_b \\rceil + \\lceil b_s / b_b \\rceil) \\lceil log_{\\lfloor M/b_b \\rfloor -1}(b_s /M) \\rceil$æ¬¡å¯»é“\n### å…¶ä»–è¿ç®—\n#### å»é‡\nå¯ä»¥é€šè¿‡æ’åºå’Œæ•£åˆ—æ¥å®ç°å»é‡\n#### æŠ•å½±\né¦–å…ˆå¯¹æ¯ä¸ªå…ƒç»„æ‰§è¡ŒæŠ•å½±ï¼Œç„¶åå»é™¤é‡å¤è®°å½•\n#### é›†åˆè¿ç®—\n- é¦–å…ˆå¯¹ä¸¤ä¸ªå…³ç³»è¿›è¡Œæ’åºï¼Œç„¶åå¯¹æ¯ä¸ªå·²æ’åºçš„å…³ç³»æ‰«æä¸€æ¬¡ä»¥äº§ç”Ÿç»“æœ\n- ä¹Ÿå¯ä»¥é€‰æ‹©ä½¿ç”¨æ•£åˆ—ï¼Œç„¶åå¯¹æ¯ä¸ªåˆ†åŒºæ‰«æä¸€æ¬¡ä»¥äº§ç”Ÿç»“æœ\n#### å¤–è¿æ¥\n- 1. è®¡ç®—ç›¸åº”çš„è¿æ¥ï¼Œç„¶åå°†é€‚å½“çš„å…ƒç»„åŠ å…¥è¿æ¥ç»“æœä¸­ä»¥å¾—åˆ°å¤–è¿æ¥ç»“æœ\n- 2. å¯¹è¿æ¥ç®—æ³•åŠ ä»¥ä¿®æ”¹\n#### èšé›†\nä½¿ç”¨ä¸å»é‡ç›¸åŒçš„æ–¹æ³•æ¥å®ç°\n### è¡¨è¾¾å¼æ‰§è¡Œ\n#### ç‰©åŒ–\n- æ¯æ¬¡å°†æ‰§è¡Œçš„ç»“æœç‰©åŒ–åˆ°ä¸€ä¸ªä¸´æ—¶å…³ç³»ä¸­\n- **åŒç¼“å†²**é€šè¿‡å¹¶è¡Œæ‰§è¡ŒCPUæ´»åŠ¨ä¸I/Oæ´»åŠ¨ï¼Œå…è®¸ç®—æ³•æ‰§è¡Œå¾—æ›´å¿«\n#### æµæ°´çº¿\né€šè¿‡å°†å¤šä¸ªå…³ç³»è¿ç®—ç»„æˆä¸€ä¸ªè¿ç®—çš„æµæ°´çº¿æ¥å‡å°‘ä¸´æ—¶æ–‡ä»¶æ•°ï¼Œå…¶ä¸­ä¸€ä¸ªè¿ç®—çš„ç»“æœå°†ä¼ é€åˆ°æµæ°´çº¿ä¸­çš„ä¸‹ä¸€ä¸ªè¿ç®—\næµæ°´çº¿å¸¦æ¥çš„å¥½å¤„ï¼š\n- æ¶ˆé™¤äº†è¯»å’Œå†™ä¸´æ—¶å…³ç³»çš„ä»£ä»·ï¼Œä»è€Œå‡å°‘äº†æŸ¥è¯¢æ‰§è¡Œä»£ä»·\n- å¦‚æœä¸€ä¸ªæŸ¥è¯¢æ‰§è¡Œè®¡åˆ’çš„æ ¹ç®—å­åŠå…¶è¾“å…¥è¢«åˆå¹¶åœ¨æµæ°´çº¿ä¸­ï¼Œé‚£ä¹ˆå°±å¯ä»¥è¿…é€Ÿå¼€å§‹äº§ç”ŸæŸ¥è¯¢ç»“æœ\n##### æµæ°´çº¿çš„å®ç°\n- éœ€æ±‚é©±åŠ¨æµæ°´çº¿\n    - ç³»ç»Ÿä¸åœåœ°å‘ä½äºæµæ°´çº¿é¡¶ç«¯çš„è¿ç®—å‘å‡ºéœ€è¦å…ƒç»„çš„è¯·æ±‚\n    - æ¯å½“ä¸€ä¸ªè¿ç®—æ”¶åˆ°éœ€è¦å…ƒç»„çš„è¯·æ±‚æ—¶ï¼Œå®ƒå°±è®¡ç®—å¾…è¿”å›çš„ä¸‹ä¸€ä¸ªå…ƒç»„å¹¶è¿”å›è¿™äº›å…ƒç»„\n    - éœ€æ±‚é©±åŠ¨æµæ°´çº¿ä¸­çš„æ¯ä¸ªè¿ç®—éƒ½å¯ä»¥ä½œä¸ºè¿­ä»£ç®—å­æ¥å®ç°ï¼Œè¯¥è¿­ä»£ç®—å­æä¾›ä»¥ä¸‹å‡½æ•°\n        - open()\n        - next()ï¼šæ¯æ¬¡è°ƒç”¨è¿”å›è¿ç®—çš„ä¸‹ä¸€ä¸ªè¾“å‡ºå…ƒç»„\n        - close()ï¼šå‘ŠçŸ¥è¿­ä»£ç®—å­ä¸éœ€è¦å…ƒç»„äº†\n- ç”Ÿäº§è€…é©±åŠ¨æµæ°´çº¿\n    - å„è¿ç®—å¹¶ä¸ç­‰å¾…äº§ç”Ÿå…ƒç»„çš„è¯·æ±‚ï¼Œè€Œæ˜¯ç§¯æåœ°ç”Ÿäº§å…ƒç»„\n    - å¯¹äºç”Ÿäº§è€…é©±åŠ¨æµæ°´çº¿ä¸­çš„æ¯ä¸€å¯¹ç›¸é‚»çš„è¿ç®—ï¼Œç³»ç»Ÿä¼šåˆ›å»ºä¸€ä¸ªç¼“å†²åŒºæ¥ä¿å­˜ä»ä¸€ä¸ªè¿ç®—ä¼ é€’ç»™ä¸‹ä¸€ä¸ªè¿ç®—çš„å…ƒç»„\n## äº‹åŠ¡\näº‹åŠ¡æ˜¯è®¿é—®å¹¶å¯èƒ½æ›´æ–°å„ç§æ•°æ®é¡¹çš„ä¸€ä¸ªç¨‹åºæ‰§è¡Œå•å…ƒ\næ•°æ®åº“ç³»ç»Ÿéœ€è¦ç»´æŠ¤ä»¥ä¸‹ç‰¹æ€§ï¼š\n- åŸå­æ€§ï¼šäº‹åŠ¡çš„æ‰€æœ‰æ“ä½œåœ¨æ•°æ®åº“ä¸­è¦ä¹ˆå…¨éƒ¨æ­£ç¡®åæ˜ å‡ºæ¥ï¼Œè¦ä¹ˆå®Œå…¨ä¸åæ˜ \n- ä¸€è‡´æ€§ï¼šä»¥éš”ç¦»çš„æ–¹å¼æ‰§è¡Œäº‹åŠ¡ï¼ˆæ²¡æœ‰å…¶ä»–äº‹åŠ¡çš„å¹¶å‘æ‰§è¡Œï¼‰ä»¥ä¿æŒæ•°æ®åº“çš„ä¸€è‡´æ€§\n- éš”ç¦»æ€§ï¼šå°½ç®¡å¤šä¸ªäº‹åŠ¡å¯èƒ½å¹¶å‘æ‰§è¡Œï¼Œä½†ç³»ç»Ÿä¿è¯æ¯ä¸ªäº‹åŠ¡éƒ½æ„Ÿè§‰ä¸åˆ°ç³»ç»Ÿä¸­æœ‰å…¶ä»–äº‹åŠ¡æ­£åœ¨å¹¶å‘æ‰§è¡Œ\n- æŒä¹…æ€§ï¼šåœ¨ä¸€ä¸ªäº‹åŠ¡æˆåŠŸå®Œæˆåï¼Œå®ƒå¯¹æ•°æ®åº“çš„æ”¹å˜å¿…é¡»æ˜¯æ°¸ä¹…çš„ï¼Œå³ä½¿å‡ºç°ç³»ç»Ÿæ•…éšœ\n### ä¸€ä¸ªç®€å•çš„äº‹åŠ¡æ¨¡å‹\nå¿½ç•¥æ’å…¥å’Œåˆ é™¤æ“ä½œï¼Œé‡‡ç”¨ä»¥ä¸‹ä¸¤ç§æ“ä½œæ¥è®¿é—®æ•°æ®ï¼š\n- read(X)ï¼šä»æ•°æ®åº“æŠŠæ•°æ®é¡¹Xä¼ é€ç»™ä¸€ä¸ªä¹Ÿç§°ä¸ºXçš„å˜é‡ï¼ŒXä½äºå±äºæ‰§è¡Œreadæ“ä½œçš„äº‹åŠ¡çš„ä¸»ç¼“å†²åŒºä¸­\n- write(X)ï¼šä»æ‰§è¡Œwriteçš„äº‹åŠ¡çš„ä¸»ç¼“å†²åŒºä¸­æŠŠå˜é‡Xçš„å€¼ä¼ é€ç»™æ•°æ®åº“ä¸­çš„æ•°æ®é¡¹X\n### äº‹åŠ¡çš„åŸå­æ€§å’ŒæŒä¹…æ€§\näº‹åŠ¡å¿…é¡»å¤„äºä»¥ä¸‹çŠ¶æ€ä¹‹ä¸€ï¼š\n- **æ´»è·ƒ**çŠ¶æ€ï¼šä¸ºåˆå§‹çŠ¶æ€ï¼Œå½“äº‹åŠ¡æ‰§è¡Œæ—¶å°±å¤„äºè¿™ç§çŠ¶æ€\n- **éƒ¨åˆ†æäº¤**çŠ¶æ€ï¼šåœ¨æœ€åä¸€æ¡è¯­å¥è¢«æ‰§è¡Œä¹‹å\n- **å¤±æ•ˆ**çŠ¶æ€ï¼šåœ¨å‘ç°æ­£å¸¸æ‰§è¡Œä¸èƒ½å†ç»§ç»­ä¹‹å\n- **ä¸­æ­¢**çŠ¶æ€ï¼šåœ¨äº‹åŠ¡å·²å›æ»šå¹¶ä¸”æ•°æ®åº“å·²è¢«æ¢å¤åˆ°å®ƒåœ¨äº‹åŠ¡å¼€å§‹å‰çš„çŠ¶æ€ä¹‹å\n- **æäº¤**çŠ¶æ€ï¼šåœ¨æˆåŠŸå®Œæˆä¹‹å\n\näº‹åŠ¡ç›¸åº”çš„çŠ¶æ€å›¾ï¼š\n![16](https://d-sketon.top/img/db-book/16.png)\n\n- æˆåŠŸå®Œæˆå…¶æ‰§è¡Œçš„äº‹åŠ¡è¢«ç§°ä¸º**å·²æäº¤**\n- ä¸€æ—¦äº‹åŠ¡å·²ç»æäº¤ï¼Œæ’¤é”€å·²æäº¤äº‹åŠ¡æ‰€é€ æˆçš„å½±å“çš„å”¯ä¸€æ–¹å¼æ˜¯æ‰§è¡Œä¸€ä¸ª**è¡¥å¿äº‹åŠ¡**\n- å¦‚æœä¸€ä¸ªäº‹åŠ¡è¦ä¹ˆæ˜¯æäº¤çš„è¦ä¹ˆæ˜¯ä¸­æ­¢çš„ï¼Œå®ƒå°±è¢«ç§°ä¸ºæ˜¯å·²ç»**ç»ˆæ­¢**çš„\n- ä¸€æ—¦äº‹åŠ¡è¿›å…¥äº†ä¸­æ­¢çŠ¶æ€ï¼Œç³»ç»Ÿå¯ä»¥**é‡å¯**äº‹åŠ¡æˆ–**æ€æ­»**äº‹åŠ¡\n\n### äº‹åŠ¡çš„éš”ç¦»æ€§\nå…è®¸å¹¶å‘çš„ä¼˜ç‚¹ï¼š\n- æé«˜ååé‡å’Œèµ„æºåˆ©ç”¨ç‡\n- å‡å°‘ç­‰å¾…æ—¶é—´\n\nåœ¨å¹¶å‘æ‰§è¡Œçš„æƒ…å†µä¸‹ï¼Œè°ƒåº¦åº”è¯¥åœ¨æŸç§æ„ä¹‰ä¸Šç­‰ä»·äºä¸€ä¸ªä¸²è¡Œè°ƒåº¦ï¼Œè¿™ç§è°ƒåº¦è¢«ç§°ä¸º**å¯ä¸²è¡ŒåŒ–**çš„è°ƒåº¦\n### å¯ä¸²è¡ŒåŒ–\n- å¦‚æœIä¸Jæ˜¯ç”±ä¸åŒäº‹åŠ¡åœ¨ç›¸åŒæ•°æ®é¡¹ä¸Šæ‰§è¡Œçš„æ“ä½œï¼Œå¹¶ä¸”å…¶ä¸­è‡³å°‘æœ‰ä¸€æ¡æŒ‡ä»¤æ˜¯writeæ“ä½œï¼Œé‚£ä¹ˆIä¸Jæ˜¯**å†²çª**çš„\n- å¦‚æœè°ƒåº¦Så¯ä»¥ç»è¿‡ä¸€ç³»åˆ—éå†²çªæŒ‡ä»¤çš„äº¤æ¢è€Œè½¬æ¢æˆè°ƒåº¦S'ï¼Œåˆ™ç§°S'å’ŒSæ˜¯**å†²çªç­‰ä»·**çš„\n- è‹¥ä¸€ä¸ªè°ƒåº¦Sä¸ä¸€ä¸ªä¸²è¡Œè°ƒåº¦æ˜¯å†²çªç­‰ä»·çš„ï¼Œåˆ™ç§°è°ƒåº¦Sæ˜¯**å†²çªå¯ä¸²è¡ŒåŒ–**çš„\n- å¦‚æœå…³äºSçš„ä¼˜å…ˆå›¾ä¸­**æœ‰ç¯**ï¼Œåˆ™è°ƒåº¦Sæ˜¯éå†²çªå¯ä¸²è¡ŒåŒ–çš„ï¼›åä¹‹åˆ™æ˜¯å¯å†²çªä¸²è¡ŒåŒ–çš„\n### äº‹åŠ¡çš„éš”ç¦»æ€§å’ŒåŸå­æ€§\n#### å¯æ¢å¤è°ƒåº¦\nå¯¹äºæ¯å¯¹äº‹åŠ¡Tiå’ŒTjï¼Œå¦‚æœTjè¯»å–äº†ç”±Tiä¹‹å‰æ‰€å†™è¿‡çš„æ•°æ®é¡¹ï¼Œåˆ™Tiçš„æäº¤æ“ä½œåº”å‡ºç°åœ¨Tjçš„æäº¤æ“ä½œä¹‹å‰\n#### æ— çº§è”è°ƒåº¦\n- **çº§è”å›æ»š**\n  - å› å•ä¸ªäº‹åŠ¡å¤±æ•ˆè€Œå¯¼è‡´ä¸€ç³»åˆ—äº‹åŠ¡å›æ»šçš„ç°è±¡ç§°ä¸º\n- **æ— çº§è”è°ƒåº¦**\n  - å¯¹äºæ¯å¯¹äº‹åŠ¡Tiå’ŒTjéƒ½æ»¡è¶³å¦‚æœTjè¯»å–äº†å…ˆå‰ç”±Tiæ‰€å†™çš„ä¸€ä¸ªæ•°æ®é¡¹ï¼Œåˆ™Tiçš„æäº¤æ“ä½œå¿…é¡»å‡ºç°åœ¨Tjçš„è¿™ä¸€è¯»æ“ä½œä¹‹å‰ \n### äº‹åŠ¡çš„éš”ç¦»æ€§çº§åˆ«\n- **å¯ä¸²è¡ŒåŒ–**ï¼šé€šå¸¸ä¿è¯å¯ä¸²è¡ŒåŒ–çš„æ‰§è¡Œ\n- **å¯é‡å¤è¯»**ï¼šåªå…è®¸è¯»å–å·²æäº¤çš„æ•°æ®ï¼Œå¹¶è¿›ä¸€æ­¥è¦æ±‚åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸¤æ¬¡è¯»å–ä¸€ä¸ªæ•°æ®é¡¹æœŸé—´ï¼Œå…¶ä»–äº‹åŠ¡ä¸å¾—æ›´æ–°è¯¥æ•°æ®é¡¹\n- **å·²æäº¤è¯»**ï¼šåªå…è®¸è¯»å–å·²æäº¤çš„æ•°æ®ï¼Œä½†å¹¶ä¸è¦æ±‚å¯é‡å¤è¯»\n- **æœªæäº¤è¯»**ï¼šå…è®¸è¯»å–æœªæäº¤æ•°æ®ï¼Œæœ€ä½éš”ç¦»æ€§çº§åˆ«\n\nä»¥ä¸Šæ‰€æœ‰çš„éš”ç¦»æ€§çº§åˆ«å‡ä¸å…è®¸**è„å†™**ï¼Œå³å¦‚æœä¸€ä¸ªæ•°æ®é¡¹å·²è¢«å¦å¤–å°šæœªæäº¤æˆ–ä¸­æ­¢çš„äº‹åŠ¡å†™è¿‡ï¼Œåˆ™ä¸å…è®¸å†æ‰§è¡Œå†™æ“ä½œ\n## å¹¶å‘æ§åˆ¶\n### åŸºäºé”çš„åè®®\n#### é”\n- å…±äº«æ¨¡å¼é”ï¼ˆSï¼‰ï¼šå¯ä»¥è¯»ä½†ä¸èƒ½å†™\n- æ’ä»–æ¨¡å¼é”ï¼ˆXï¼‰ï¼šæ—¢å¯ä»¥è¯»åˆèƒ½å†™\n  \nç›¸å®¹å‡½æ•°ï¼š\n| |S|X|\n|-|-|-|\n|S|true|false|\n|X|false|false|\n\n- äº‹åŠ¡é€šè¿‡lock-S(Q)æŒ‡ä»¤æ¥ç”³è¯·æ•°æ®é¡¹Qä¸Šçš„å…±äº«é”\n- äº‹åŠ¡é€šè¿‡lock-X(Q)æŒ‡ä»¤æ¥ç”³è¯·æ•°æ®é¡¹Qä¸Šçš„æ’å®ƒé”\n- äº‹åŠ¡é€šè¿‡unlock(Q)æŒ‡ä»¤æ¥å¯¹æ•°æ®é¡¹Qè§£é”\n#### ä¸¤é˜¶æ®µå°é”åè®®\nè¯¥åè®®è¦æ±‚æ¯ä¸ªäº‹åŠ¡åˆ†ä¸¤ä¸ªé˜¶æ®µæå‡ºåŠ é”å’Œè§£é”è¯·æ±‚ï¼š\n- **å¢é•¿é˜¶æ®µ**ï¼šä¸€ä¸ªäº‹åŠ¡å¯ä»¥è·å¾—é”ï¼Œä½†ä¸èƒ½é‡Šæ”¾ä»»ä½•é”\n- **ç¼©å‡é˜¶æ®µ**ï¼šä¸€ä¸ªäº‹åŠ¡å¯ä»¥é‡Šæ”¾é”ï¼Œä½†ä¸èƒ½è·å¾—ä»»ä½•æ–°é”\n\nä¸¤é˜¶æ®µå°é”å¹¶ä¸ä¿è¯ä¸ä¼šå‘ç”Ÿæ­»é”ï¼Œä¸”çº§è”å›æ»šæ˜¯å¯èƒ½å‘ç”Ÿçš„\n- **ä¸¥æ ¼ä¸¤é˜¶æ®µå°é”åè®®**ï¼šè¦æ±‚äº‹åŠ¡æ‰€æŒæœ‰çš„æ‰€æœ‰æ’ä»–æ¨¡å¼é”å¿…é¡»åœ¨äº‹åŠ¡æäº¤åæ–¹å¯é‡Šæ”¾ï¼ˆå¯é˜²æ­¢çº§è”å›æ»šï¼‰\n- **å¼ºä¸¤é˜¶æ®µå°é”åè®®**ï¼šè¦æ±‚åœ¨äº‹åŠ¡æäº¤ä¹‹å‰ä¿ç•™æ‰€æœ‰çš„é¡¹\n- **é”è½¬æ¢**\n  - å‡çº§ï¼šä»å…±äº«é”åˆ°æ’å®ƒé”\n  - é™çº§ï¼šä»æ’å®ƒé”åˆ°å…±äº«é”\n#### å°é”çš„å®ç°\n- **é”ç®¡ç†å™¨**ç»´æŠ¤ä¸€ä¸ªç§°ä¸º**é”è¡¨**çš„å†…å­˜æ•°æ®ç»“æ„ï¼Œç”¨äºè®°å½•å·²æˆäºˆçš„é”å’Œç­‰å¾…çš„è¯·æ±‚\n  - äº‹åŠ¡å¯ä»¥å‘é”ç®¡ç†å™¨å‘å‡ºé”è¯·æ±‚å’Œè§£é”çš„è¯·æ±‚\n  - é”ç®¡ç†å™¨é’ˆå¯¹å°é”è¯·æ±‚æ¶ˆæ¯é‡‡ç”¨é”æˆäºˆçš„æ¶ˆæ¯ï¼Œæˆ–é‡‡ç”¨è¦æ±‚äº‹åŠ¡å›æ»šçš„æ¶ˆæ¯æ¥è¿›è¡Œåº”ç­”\n##### åŸºäºå›¾çš„åè®®\n- ä¸¤é˜¶æ®µå°é”çš„æ›¿ä»£æ–¹æ¡ˆ\n- åœ¨æ•°æ®é¡¹çš„é›†åˆä¸Šå®æ–½ä¸€ç§ååº$\\rightarrow$\n- æ ‘å‹åè®®æ˜¯ä¸€ç§ç®€å•çš„å›¾åè®®\n    - ç¡®ä¿å†²çªå¯ä¸²è¡ŒåŒ–ä»¥åŠæ— æ­»é”\n    - å¯ä»¥åœ¨è¾ƒæ—©çš„æ—¶å€™é‡Šæ”¾é”\n    - ä¸ä¿è¯å¯æ¢å¤æ€§å’Œæ— çº§è”æ€§\n        - éœ€è¦å¼•å…¥æäº¤ä¾èµ–\n    - ä¸€ä¸ªäº‹åŠ¡å¯èƒ½å¿…é¡»ç»™å®ƒæ›´æ–°ä¸è®¿é—®çš„æ•°æ®é¡¹åŠ é”\n### æ­»é”å¤„ç†\n#### æ­»é”é¢„é˜²\n- #1.æ¯ä¸ªäº‹åŠ¡åœ¨å¼€å§‹æ‰§è¡Œä¹‹å‰å°é”å®ƒçš„æ‰€æœ‰æ•°æ®é¡¹\n- #2.å¯¹æ‰€æœ‰æ•°æ®é¡¹æ–½åŠ ä¸€ç§æ¬¡åºï¼ŒåŒæ—¶è¦æ±‚äº‹åŠ¡åªèƒ½æŒ‰ç…§æ¬¡åºè§„å®šçš„é¡ºåºå°é”æ•°æ®é¡¹\n- #3.ä½¿ç”¨æŠ¢å ä¸äº‹åŠ¡å›æ»š\n  - ç­‰å¾…-æ­»äº¡æœºåˆ¶ï¼šéæŠ¢å æŠ€æœ¯ï¼Œå½“Tiç”³è¯·çš„æ•°æ®é¡¹è¢«TjæŒæœ‰ï¼Œä»…å½“Tiæ—¶é—´æˆ³å°äºTjçš„æ—¶é—´æˆ³ï¼Œæ‰å…è®¸Tiç­‰å¾…\n  - ä¼¤å®³-ç­‰å¾…æœºåˆ¶ï¼šæŠ¢å æŠ€æœ¯ï¼Œå½“Tiç”³è¯·çš„æ•°æ®é¡¹è¢«TjæŒæœ‰ï¼Œä»…å½“Tiæ—¶é—´æˆ³å¤§äºTjçš„æ—¶é—´æˆ³ï¼Œæ‰å…è®¸Tiç­‰å¾…\n- #4.åŸºäºé”è¶…æ—¶ï¼Œç”³è¯·é”çš„äº‹åŠ¡è‡³å¤šç­‰å¾…ä¸€æ®µæŒ‡å®šæ—¶é—´ï¼Œå¦åˆ™è¶…æ—¶å¹¶å›æ»š\n#### æ­»é”æ£€æµ‹\nä½¿ç”¨ä¸€ç§ç§°ä¸º**ç­‰å¾…å›¾**çš„æœ‰å‘å›¾æ¥æè¿°\n- é¡¶ç‚¹é›†ç”±ç³»ç»Ÿä¸­çš„æ‰€æœ‰äº‹åŠ¡ç»„æˆ\n- $T_i \\rightarrow T_j$çš„æœ‰å‘è¾¹è¡¨ç¤ºäº‹åŠ¡$T_i$æ­£ç­‰å¾…äº‹åŠ¡$T_j$é‡Šæ”¾ä¸€ä¸ª$T_i$æ‰€éœ€çš„æ•°æ®é¡¹\n- å½“ä¸”ä»…å½“ç­‰å¾…å›¾ä¸­åŒ…å«ç¯è·¯æ—¶ï¼Œç³»ç»Ÿä¸­å­˜åœ¨æ­»é”\n#### æ­»é”æ¢å¤\nè§£é™¤æ­»é”æœ€å¸¸ç”¨çš„æ–¹æ³•æ˜¯å›æ»šä¸€ä¸ªæˆ–å¤šä¸ªäº‹åŠ¡\n- é€‰æ‹©ç‰ºç‰²è€…\n  - å›æ»šäº§ç”Ÿæœ€ä½ä»£ä»·çš„äº‹åŠ¡\n- å›æ»š\n  - å®Œå…¨å›æ»šï¼šä¸­æ­¢äº‹åŠ¡å¹¶é‡æ–°å¯åŠ¨\n  - éƒ¨åˆ†å›æ»šï¼šå°†äº‹åŠ¡å›æ»šåˆ°å¯ä»¥æ¥è§¦æ­»é”çš„åœ°æ–¹\n- é¥¿æ­»\n  - å¿…é¡»ä¿è¯ä¸€ä¸ªäº‹åŠ¡è¢«é€‰ä¸ºç‰ºç‰²è€…çš„æ¬¡æ•°æœ‰é™\n### å¤šç²’åº¦\n- å¦‚æœä¸€ä¸ªèŠ‚ç‚¹åŠ ä¸Šäº†æ„å‘æ¨¡å¼é”ï¼Œåˆ™æ„å‘³ç€åœ¨æ ‘çš„è¾ƒä½å±‚è¿›è¡Œæ˜¾å¼åŠ é”\n- åœ¨ä¸€ä¸ªèŠ‚ç‚¹è¢«æ˜¾å¼åŠ é”ä¹‹å‰ï¼Œè¯¥èŠ‚ç‚¹çš„å…¨éƒ¨ç¥–å…ˆèŠ‚ç‚¹å‡è¦åŠ ä¸Šæ„å‘é”\n- å°é”æŒ‰è‡ªé¡¶å‘ä¸‹çš„æ¬¡åºï¼Œè€Œé”çš„é‡Šæ”¾æŒ‰è‡ªåº•å‘ä¸Šçš„æ¬¡åº\n  \n| |IS|IX|S|SIX|X|\n|-|-|-|-|-|-|\n|IS|true|true|true|true|false|\n|IX|true|true|false|false|false|\n|S|true|false|true|false|false|\n|SIX|true|false|false|false|false|\n|X|false|false|false|false|false|\n- å¦‚æœä¸€ä¸ªèŠ‚ç‚¹è¢«åŠ ä¸Šäº†æ„å‘å…±äº«æ¨¡å¼é”ï¼ˆISï¼‰ï¼Œé‚£ä¹ˆåªèƒ½åœ¨æ ‘çš„è¾ƒä½å±‚æ˜¾å¼åŠ å…±äº«æ¨¡å¼é”\n- å¦‚æœä¸€ä¸ªèŠ‚ç‚¹è¢«åŠ ä¸Šäº†æ„å‘æ’ä»–æ¨¡å¼é”ï¼ˆIXï¼‰ï¼Œé‚£ä¹ˆåªèƒ½åœ¨æ ‘çš„è¾ƒä½å±‚æ˜¾å¼åŠ å…±äº«æˆ–æ’ä»–æ¨¡å¼é”\n- å¦‚æœä¸€ä¸ªèŠ‚ç‚¹è¢«åŠ ä¸Šäº†å…±äº«æ„å‘æ’ä»–æ¨¡å¼é”ï¼ˆSIXï¼‰ï¼Œåˆ™ä»¥è¯¥èŠ‚ç‚¹ä¸ºæ›´çš„å­æ ‘ä»¥å…±äº«æ¨¡å¼è¢«æ˜¾å¼å°é”ï¼Œå¹¶ä¸”åœ¨æ ‘çš„æ›´ä½å±‚æ˜¾å¼åŠ æ’ä»–æ¨¡å¼é”\n### åŸºäºæ—¶é—´æˆ³çš„åè®®\n#### æ—¶é—´æˆ³\n- å¯¹ç³»ç»Ÿä¸­çš„æ¯ä¸ªäº‹åŠ¡ï¼Œä½¿ç”¨ä¸€ä¸ªå”¯ä¸€çš„ã€å›ºå®šçš„æ—¶é—´æˆ³å’Œå®ƒå…³è”èµ·æ¥\n- æ—¶é—´æˆ³åœ¨äº‹åŠ¡å¼€å§‹æ‰§è¡Œä¹‹å‰ç”±æ•°æ®åº“ç³»ç»Ÿæ‰€èµ‹äºˆï¼Œå…¶å†³å®šäº†å¯ä¸²è¡ŒåŒ–çš„æ¬¡åº\n  - ç³»ç»Ÿæ—¶é’Ÿ\n  - é€»è¾‘è®¡æ•°å™¨\n#### æ—¶é—´æˆ³æ’åºåè®®\nå…¶ä¿è¯ä»»ä½•æœ‰å†²çªçš„readå’Œwriteæ“ä½œæŒ‰æ—¶é—´æˆ³çš„æ¬¡åºæ‰§è¡Œ\n\n> æ¯ä¸ªæ•°æ®é¡¹Qä¸ä¸¤ä¸ªæ—¶é—´æˆ³ç›¸å…³è”\n> W-timestamp(Q)è¡¨ç¤ºæˆåŠŸæ‰§è¡Œwrite(Q)çš„ä»»æ„äº‹åŠ¡çš„æœ€å¤§æ—¶é—´æˆ³\n> R-timestamp(Q)è¡¨ç¤ºæˆåŠŸæ‰§è¡Œread(Q)çš„ä»»æ„äº‹åŠ¡çš„æœ€å¤§æ—¶é—´æˆ³\n\n- å‡è®¾äº‹åŠ¡Tå‘å‡ºread(Q)\n  - è‹¥TS(T) \\< W-timestamp(Q)ï¼Œåˆ™Téœ€è¦è¯»å–çš„Qå€¼å·²è¢«è¦†ç›–ã€‚Tå›æ»š\n  - è‹¥TS(T) \\>= W-timestamp(Q)ï¼Œåˆ™æ‰§è¡Œreadæ“ä½œï¼Œä¸”R-timestamp(Q)=max(R-timestamp(Q),TS(T))\n- å‡è®¾äº‹åŠ¡Tå‘å‡ºwrite(Q)\n  - è‹¥TS(T) \\< R-timestamp(Q)ï¼Œåˆ™Täº§ç”Ÿçš„Qå€¼æ˜¯å…ˆå‰æ‰€éœ€è¦çš„ï¼Œä¸”å‡å®šè¯¥å€¼æ°¸è¿œä¸ä¼šäº§ç”Ÿäº†ã€‚Tå›æ»š\n  - è‹¥TS(T) \\< W-timestamp(Q)ï¼Œåˆ™Tè¯•å›¾å†™å…¥çš„Qå€¼æ˜¯è¿‡æ—¶çš„ã€‚Tå›æ»š\n  - å…¶ä»–æƒ…å†µï¼Œæ‰§è¡Œwriteæ“ä½œï¼Œä¸”W-timestamp(Q)=TS(T)\n  \n- äº‹åŠ¡å¦‚æœè§¦å‘äº†å›æ»šï¼Œç³»ç»Ÿä¼šèµ‹äºˆå®ƒä¸€ä¸ªæ–°çš„æ—¶é—´æˆ³å¹¶é‡æ–°å¯åŠ¨å®ƒ\n- è¯¥åè®®ä¿è¯å†²çªå¯ä¸²è¡ŒåŒ–å’Œæ— æ­»é”\n- å¯èƒ½å­˜åœ¨é•¿äº‹åŠ¡é¥¿æ­»çš„ç°è±¡\n- å¯èƒ½äº§ç”Ÿä¸å¯æ¢å¤çš„è°ƒåº¦\n  - é€šè¿‡åœ¨äº‹åŠ¡æœ«å°¾ä¸€èµ·æ‰§è¡Œæ‰€æœ‰å†™æ“ä½œå¯ä»¥ä¿è¯å¯æ¢å¤æ€§å’Œæ— çº§è”æ€§\n#### Thomaså†™è§„åˆ™\n- å‡è®¾äº‹åŠ¡Tå‘å‡ºwrite(Q)\n  - è‹¥TS(T) \\< R-timestamp(Q)ï¼Œåˆ™Täº§ç”Ÿçš„Qå€¼æ˜¯å…ˆå‰æ‰€éœ€è¦çš„ï¼Œä¸”å‡å®šè¯¥å€¼æ°¸è¿œä¸ä¼šäº§ç”Ÿäº†ã€‚Tå›æ»š\n  - è‹¥TS(T) \\< W-timestamp(Q)ï¼Œåˆ™Tè¯•å›¾å†™å…¥çš„Qå€¼æ˜¯è¿‡æ—¶çš„ã€‚**writeæ“ä½œè¢«å¿½ç•¥**\n  - å…¶ä»–æƒ…å†µï¼Œæ‰§è¡Œwriteæ“ä½œï¼Œä¸”W-timestamp(Q)=TS(T)\n### åŸºäºæœ‰æ•ˆæ€§æ£€æŸ¥çš„åè®®\næœ‰æ•ˆæ€§æ£€æŸ¥åè®®è¦æ±‚æ¯ä¸ªäº‹åŠ¡åœ¨ç”Ÿå‘½å‘¨æœŸä¸­æŒ‰ä¸¤ä¸ªæˆ–ä¸‰ä¸ªä¸åŒçš„é˜¶æ®µæ‰§è¡Œ\n- è¯»é˜¶æ®µï¼šç³»ç»Ÿæ‰§è¡Œäº‹åŠ¡Tï¼ŒTçš„æ‰€æœ‰writeæ“ä½œæ˜¯å¯¹å±€éƒ¨çš„ä¸´æ—¶å˜é‡è¿›è¡Œçš„ï¼Œä½†å¹¶ä¸å¯¹æ•°æ®åº“è¿›è¡ŒçœŸæ­£çš„æ›´æ–°\n- æœ‰æ•ˆæ€§æ£€æŸ¥é˜¶æ®µï¼šå¯¹äº‹ç‰©Tè¿›è¡Œæœ‰æ•ˆæ€§æ£€æŸ¥çš„æµ‹è¯•ï¼Œå¦‚æœæµ‹è¯•å¤±è´¥åˆ™ç»ˆæ­¢è¯¥äº‹åŠ¡\n- å†™é˜¶æ®µï¼šå¦‚æœé€šè¿‡äº†æœ‰æ•ˆæ€§æ£€æŸ¥ï¼Œåˆ™ä¿å­˜Tæ‰€æ‰§è¡Œçš„ä»»ä½•writeæ“ä½œç»“æœçš„ä¸´æ—¶å±€éƒ¨å˜é‡è¢«æ‹·è´å…¥æ•°æ®åº“\n\n> StartTS(Ti)ï¼šäº‹åŠ¡Tiå¼€å§‹æ‰§è¡Œçš„æ—¶é—´\n> ValidationTS(Ti)ï¼šäº‹åŠ¡Tiå®Œæˆå…¶è¯»é˜¶æ®µå¹¶å¼€å§‹å…¶æœ‰æ•ˆæ€§æ£€æŸ¥é˜¶æ®µçš„æ—¶é—´\n> FinishTS(Ti)ï¼šäº‹åŠ¡Tiå®Œæˆå…¶å†™é˜¶æ®µçš„æ—¶é—´\n\näº‹åŠ¡Tçš„æœ‰æ•ˆæ€§æ£€æŸ¥æµ‹è¯•è¦æ±‚æ»¡è¶³TS(Tk)\\<TS(Ti)çš„æ‰€æœ‰äº‹åŠ¡Tkå¿…é¡»æ»¡è¶³ä¸‹é¢ä¸¤ä¸ªæ¡ä»¶ä¹‹ä¸€ï¼š\n- FinishTS(Tk)\\<StartTS(Ti)\n- Tkæ‰€å†™çš„æ•°æ®é¡¹é›†åˆå’ŒTiæ‰€è¯»çš„æ•°æ®é¡¹é›†åˆä¸ç›¸äº¤ï¼Œä¸”Tiå¼€å§‹å…¶æœ‰æ•ˆæ€§æ£€æŸ¥é˜¶æ®µä¹‹å‰ï¼ŒTkå°±å®Œæˆäº†å…¶å†™é˜¶æ®µ(StartTS(Ti)\\<FinishTS(Tk)\\<ValidationTS(Ti)) \n### å¤šç‰ˆæœ¬æœºåˆ¶\n#### å¤šç‰ˆæœ¬æ—¶é—´æˆ³æ’åº\nå¯¹äºæ¯ä¸ªæ•°æ®é¡¹Qï¼Œå­˜åœ¨ä¸€ä¸ªç‰ˆæœ¬åºåˆ—\\<Q1,Q2,...,Qm\\>ä¸ä¹‹å…³è”ï¼Œæ¯ä¸ªQkåŒ…å«ä¸‰ä¸ªæ•°æ®å­—æ®µ\n- Contentï¼šQkç‰ˆæœ¬çš„å€¼\n- W-timeStamp(Q)ï¼šåˆ›å»ºQkç‰ˆæœ¬çš„äº‹åŠ¡çš„æ—¶é—´æˆ³\n- R-timeStamp(Q)ï¼šæ‰€æœ‰æˆåŠŸè¯»å–è¿‡Qkç‰ˆæœ¬çš„ä»»æ„äº‹åŠ¡çš„æœ€å¤§æ—¶é—´æˆ³\n\nå¤šç‰ˆæœ¬æ—¶é—´æˆ³æ’åºæœºåˆ¶ï¼šï¼ˆQkæ˜¯Qçš„å¦‚ä¸‹ç‰ˆæœ¬ï¼šå†™æ—¶é—´æˆ³æ˜¯å°äºæˆ–ç­‰äºTS(Ti)çš„æœ€å¤§å†™æ—¶é—´æˆ³ï¼‰\n- read(Q)ï¼šè¿”å›Qkç‰ˆæœ¬çš„å€¼\n- write(Q)ï¼š\n  - è‹¥TS(Ti)<R-timeStamp(Qk)ï¼Œç³»ç»Ÿå›æ»šäº‹åŠ¡\n  - è‹¥TS(Ti)=R-timeStamp(Qk)ï¼Œç³»ç»Ÿè¦†ç›–Qkçš„å†…å®¹\n  - è‹¥TS(Ti)>R-timeStamp(Qk)ï¼Œåˆ›å»ºQçš„ä¸€ä¸ªæ–°ç‰ˆæœ¬\n\nä¸ä¿è¯å¯æ¢å¤æ€§å’Œæ— çº§è”æ€§\n#### å¤šç‰ˆæœ¬ä¸¤é˜¶æ®µå°é”\n- ç»“åˆå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶å’Œä¸¤é˜¶æ®µå°é”\n- åªåœ¨åªè¯»äº‹åŠ¡ä¸æ›´æ–°äº‹åŠ¡ä¹‹é—´è¿›è¡ŒåŒºåˆ†\n- æ›´æ–°äº‹åŠ¡æ‰§è¡Œå¼ºä¸¤é˜¶æ®µå°é”\n### å¿«ç…§éš”ç¦»\n- äº‹åŠ¡è¢«ç»™äºˆä¸¤ä¸ªæ—¶é—´æˆ³\n  - StartTS(Ti)ï¼šäº‹åŠ¡Tiå¼€å§‹çš„æ—¶é—´\n  - CommitTS(Ti)ï¼šäº‹åŠ¡Tiè¯·æ±‚æœ‰æ•ˆæ€§æ£€æŸ¥çš„æ—¶é—´\n#### æ›´æ–°äº‹åŠ¡çš„æœ‰æ•ˆæ€§æ£€æŸ¥æ­¥éª¤\nä¸ºäº†é˜²æ­¢æ›´æ–°ä¸¢å¤±ï¼Œå¿«ç…§éš”ç¦»æœ‰ä¸¤ä¸ªå˜ç§\n- å…ˆæäº¤è€…èƒœï¼šç¬¬ä¸€ä¸ªè¿›è¡Œæ£€æŸ¥çš„äº‹åŠ¡èƒ½æˆåŠŸå†™å‡ºæ›´æ–°\n- å…ˆæ›´æ–°è€…èƒœï¼šç¬¬ä¸€ä¸ªè·å¾—é”çš„äº‹åŠ¡è¢«è¿è¡Œæäº¤å¹¶æ‰§è¡Œæ›´æ–°\n## æ¢å¤ç³»ç»Ÿ\n### æ•…éšœåˆ†ç±»\n- äº‹åŠ¡æ•…éšœ\n  - é€»è¾‘é”™è¯¯ï¼šäº‹åŠ¡ç”±äºæŸäº›å†…éƒ¨æƒ…å†µè€Œæ— æ³•ç»§ç»­æ­£å¸¸æ‰§è¡Œ\n  - ç³»ç»Ÿé”™è¯¯ï¼šç³»ç»Ÿè¿›å…¥ä¸€ç§ä¸è‰¯çŠ¶æ€\n- ç³»ç»Ÿå´©æºƒï¼šç¡¬ä»¶æ•…éšœï¼Œæˆ–æ•°æ®åº“æˆ–æ“ä½œç³»ç»Ÿå­˜åœ¨æ¼æ´\n- ç£ç›˜æ•…éšœï¼šç”±äºç£å¤´æŸåæˆ–æ•…éšœé€ æˆç£ç›˜å—ä¸Šå†…å®¹ä¸¢å¤±\n### æ¢å¤ä¸åŸå­æ€§\n#### æ—¥å¿—è®°å½•\n- æ›´æ–°æ—¥å¿—è®°å½•\\<Ti,Xj,V1,V2\\>\n  - äº‹åŠ¡æ ‡è¯†\n  - æ•°æ®é¡¹æ ‡è¯†\n  - æ—§å€¼\n  - æ–°å€¼\n- äº‹åŠ¡å¼€å§‹\\<Ti start\\>\n- äº‹åŠ¡æäº¤\\<Ti commit\\>\n- äº‹åŠ¡ä¸­æ­¢\\<Ti abort\\>\n#### æ•°æ®åº“ä¿®æ”¹\n- å»¶è¿Ÿä¿®æ”¹ï¼šä¸€ä¸ªäº‹åŠ¡ç›´è‡³æäº¤æ—¶éƒ½æ²¡æœ‰ä¿®æ”¹æ•°æ®åº“\n- ç«‹å³ä¿®æ”¹ï¼šäº‹åŠ¡ä»ç„¶æ´»è·ƒæ—¶å°±å‘ç”Ÿæ•°æ®åº“ä¿®æ”¹\n- æ’¤é”€æ“ä½œï¼šä½¿ç”¨ä¸€æ¡æ—¥å¿—è®°å½•ï¼Œå°†è¯¥æ—¥å¿—ä¸­æŒ‡å®šæ•°æ®é¡¹ç½®ä¸ºæ—¥å¿—è®°å½•ä¸­åŒ…å«çš„**æ—§å€¼**\n- é‡åšæ“ä½œï¼šä½¿ç”¨ä¸€æ¡æ—¥å¿—è®°å½•ï¼Œå°†è¯¥æ—¥å¿—ä¸­æŒ‡å®šæ•°æ®é¡¹ç½®ä¸ºæ—¥å¿—è®°å½•ä¸­åŒ…å«çš„**æ–°å€¼**\n#### é‡åšå’Œæ’¤é”€\n- redo(Ti)\n  - å°†äº‹åŠ¡Tiæ›´æ–°è¿‡æ‰€æœ‰æ•°æ®é¡¹çš„å€¼éƒ½ç½®ä¸ºæ–°å€¼\n  - é‡åšçš„æ‰§è¡Œé¡ºåºå¾ˆé‡è¦ \n- undo(Ti)\n  - å°†äº‹åŠ¡Tiæ›´æ–°è¿‡çš„æ‰€æœ‰æ•°æ®é¡¹çš„å€¼éƒ½ç½®ä¸ºæ—§å€¼\n  - éœ€è¦å†™æ—¥å¿—è®°å½•æ¥è®°ä¸‹æ‰€æ‰§è¡Œçš„æ›´æ–°ï¼ˆread-onlyæ—¥å¿—è®°å½•ï¼‰\n  - æ’¤é”€çš„æ‰§è¡Œé¡ºåºå¾ˆé‡è¦\n  - æ’¤é”€æ“ä½œå®Œæˆåï¼Œéœ€è¦å†™ä¸€æ¡\\<Ti abort\\>æ—¥å¿— \n\n- å¦‚æœæ—¥å¿—ä¸­åŒ…æ‹¬\\<Ti start\\>ï¼Œä½†æ—¢ä¸åŒ…æ‹¬\\<Ti commit\\>ï¼Œä¹Ÿä¸åŒ…æ‹¬\\<Ti abort\\>ï¼Œéœ€è¦æ’¤é”€\n- å¦‚æœæ—¥å¿—ä¸­åŒ…æ‹¬\\<Ti start\\>ï¼ŒåŒæ—¶åŒ…æ‹¬\\<Ti commit\\>æˆ–\\<Ti abort\\>ï¼Œéœ€è¦é‡åš\n#### æ£€æŸ¥ç‚¹\n- æ£€æŸ¥ç‚¹çš„æ‰§è¡Œè¿‡ç¨‹ï¼š\n  - å°†å½“å‰ä½äºä¸»å­˜çš„æ‰€æœ‰æ—¥å¿—è®°å½•è¾“å‡ºåˆ°ç¨³å®šå­˜å‚¨å™¨\n  - å°†æ‰€æœ‰ä¿®æ”¹è¿‡çš„ç¼“å†²å—è¾“å‡ºåˆ°ç£ç›˜\n  - å°†ä¸€æ¡å½¢å¦‚\\<checkpoint L\\>çš„æ—¥å¿—è®°å½•è¾“å‡ºåˆ°ç¨³å®šå­˜å‚¨å™¨ï¼Œå…¶ä¸­Læ˜¯æ‰§è¡Œæ£€æŸ¥ç‚¹æ—¶æ­£æ´»è·ƒçš„äº‹åŠ¡çš„åˆ—è¡¨\n- åœ¨ç³»ç»Ÿå´©æºƒåï¼Œç³»ç»Ÿæ£€æŸ¥æ—¥å¿—ä»¥æ‰¾åˆ°æœ€åä¸€æ¡\\<checkpoint L\\>è®°å½•\n- åªéœ€å¯¹Lä¸­çš„äº‹åŠ¡ï¼Œä»¥åŠ\\<checkpoint L\\>è®°å½•å†™åˆ°æ—¥å¿—ä¸­ä¹‹åæ‰å¼€å§‹æ‰§è¡Œçš„æ‰€æœ‰äº‹åŠ¡è¿›è¡Œredoå’Œundo\n### æ¢å¤ç®—æ³•\n#### äº‹åŠ¡å›æ»š\n- ä»åå¾€å‰æ‰«ææ—¥å¿—ï¼Œå¯¹äºæ‰€å‘ç°çš„Tiçš„æ¯æ¡å½¢å¦‚\\<Ti,Xj,V1,V2\\>çš„æ—¥å¿—è®°å½•\n  - å°†å€¼V1å†™åˆ°æ•°æ®é¡¹Xj\n  - å¾€æ—¥å¿—ä¸­å†™ä¸€æ¡ç‰¹æ®Šçš„read-onlyæ—¥å¿—è®°å½•\\<Ti,Xj,V1\\>ï¼Œå…¶ä¸­V1æ˜¯åœ¨æœ¬æ¬¡å›æ»šä¸­æ•°æ®é¡¹è¢«æ¢å¤çš„å€¼\n- ä¸€æ—¦å‘ç°äº†\\<Ti start\\>æ—¥å¿—è®°å½•ï¼Œå°±åœæ­¢åå‘æ‰«æï¼Œå¹¶å¾€æ—¥å¿—ä¸­å†™ä¸€æ¡\\<Ti abort\\>æ—¥å¿—è®°å½•\n#### ç³»ç»Ÿå´©æºƒåçš„æ¢å¤\n- é‡åšé˜¶æ®µ\n  - å°†å¾…å›æ»šäº‹åŠ¡çš„åˆ—è¡¨undo-liståˆå§‹åŒ–è®¾å®šä¸º\\<checkpoint L\\>æ—¥å¿—è®°å½•ä¸­çš„L\n  - ä¸€æ—¦å‘ç°å½¢å¦‚\\<Ti,Xj,V1,V2\\>æˆ–\\<Ti,Xj,V2\\>çš„æ—¥å¿—è®°å½•ï¼Œå°±æ‰§è¡Œé‡åš\n  - ä¸€æ—¦å‘ç°å½¢å¦‚\\<Ti start\\>çš„æ—¥å¿—è®°å½•ï¼Œå°±æŠŠTiåŠ åˆ°undo-listä¸­\n  - ä¸€æ—¦å‘ç°å½¢å¦‚\\<Ti abort\\>æˆ–\\<Ti commit\\>çš„æ—¥å¿—è®°å½•ï¼Œå°±æŠŠTiä»undo-listä¸­å»é™¤\n  - åœ¨é‡åšé˜¶æ®µçš„æœ«å°¾ï¼Œundo-listä¸­åŒ…æ‹¬äº†åœ¨ç³»ç»Ÿå´©æºƒä¹‹å‰å°šæœªå®Œæˆçš„æ‰€æœ‰äº‹åŠ¡\n- æ’¤é”€é˜¶æ®µ\n  - ä¸€æ—¦å‘ç°å±äºundo-listä¸­äº‹åŠ¡çš„è®°å½•ï¼Œå°±æ‰§è¡Œæ’¤é”€\n  - å½“ç³»ç»Ÿå‘ç°undo-listä¸­äº‹åŠ¡Tiçš„\\<Ti start\\>æ—¥å¿—è®°å½•ï¼Œå°±å¾€æ—¥å¿—ä¸­å†™ä¸€æ¡\\<Ti abort\\>æ—¥å¿—è®°å½•ï¼Œå¹¶æŠŠTiä»undo-listä¸­å»é™¤\n  - ä¸€æ—¦å‘ç°undo-listå˜ä¸ºç©ºï¼Œåˆ™æ’¤é”€é˜¶æ®µç»“æŸ\n#### æäº¤å¤„ç†çš„ä¼˜åŒ–\nä½¿ç”¨**ç»„æäº¤**æŠ€æœ¯å¯ä»¥æé«˜äº‹åŠ¡æäº¤çš„é€Ÿç‡\n### ç¼“å†²åŒºç®¡ç†\n- å°†æ—¥å¿—è®°å½•å†™åˆ°ä¸»å­˜çš„æ—¥å¿—ç¼“å†²åŒºä¸­\n- å¯¹æ¢å¤æŠ€æœ¯å¢åŠ  ä¸€äº›é¢å¤–çš„è¦æ±‚ä»¥ä¿æŒäº‹åŠ¡çš„åŸå­æ€§ï¼š\n  - åœ¨æ—¥å¿—è®°å½•\\<Ti commit\\>è¾“å‡ºåˆ°ç¨³å®šå­˜å‚¨å™¨åï¼Œäº‹åŠ¡Tiè¿›å…¥æäº¤çŠ¶æ€\n  - åœ¨æ—¥å¿—è®°å½•\\<Ti commit\\>è¾“å‡ºåˆ°ç¨³å®šå­˜å‚¨å™¨å‰ï¼Œä¸äº‹åŠ¡Tiæœ‰å…³çš„æ‰€æœ‰æ—¥å¿—è®°å½•å¿…é¡»å·²ç»è¾“å‡ºåˆ°ç¨³å®šå­˜å‚¨å™¨ \n  - åœ¨ä¸»å­˜ä¸­çš„æ•°æ®å—è¾“å‡ºåˆ°æ•°æ®åº“ï¼ˆéæ˜“å¤±æ€§å­˜å‚¨å™¨ï¼‰å‰ï¼Œä¸è¯¥å—ä¸­æ•°æ®æœ‰å…³çš„æ‰€æœ‰æ—¥å¿—è®°å½•å¿…é¡»å·²ç»è¾“å‡ºåˆ°ç¨³å®šå­˜å‚¨å™¨\n    - è¿™ä¸€æ¡è§„åˆ™è¢«ç§°ä¸º**å…ˆå†™æ—¥å¿—**ï¼ˆWALï¼‰ \n- å°†ç¼“å†²çš„æ—¥å¿—å†™åˆ°ç£ç›˜æœ‰æ—¶è¢«ç§°ä¸º**å¼ºåˆ¶æ—¥å¿—**\n### ARIES\n- ä½¿ç”¨**æ—¥å¿—åºåˆ—å·**(LSN)æ¥ä¾¿æ˜¯æ—¥å¿—è®°å½•ï¼Œå¹¶å°†LSNå­˜å‚¨åœ¨æ•°æ®åº“é¡µä¸­\n- æ”¯æŒ**ç‰©ç†é€»è¾‘é‡åš**\n- ä½¿ç”¨**è„é¡µè¡¨**æ¥å‡å°‘æ¢å¤æ—¶ä¸å¿…è¦çš„é‡åš\n- è§†åŒæ¨¡ç³Šæ£€æŸ¥ç‚¹æœºåˆ¶\n#### æ•°æ®ç»“æ„\n- æ—¥å¿—åºåˆ—å·(LSN)\n  - å”¯ä¸€æ ‡è¯†è¯¥è®°å½• \n  - æ—¥å¿—è®°å½•äº§ç”Ÿçº¦æ™šï¼Œæ ‡å·çš„å€¼è¶Šå¤§\n- æ—¥å¿—é¡µåºåˆ—å·(PageLSN)\n  - æ¯å½“åœ¨é¡µé¢ä¸Šæ‰§è¡Œæ›´æ–°æ“ä½œæ—¶ï¼Œè¯¥æ“ä½œå°†å…¶æ—¥å¿—è®°å½•çš„LSNå­˜å‚¨åœ¨è¯¥é¡µçš„PageLSNå­—æ®µä¸­\n  - åœ¨æ¢å¤çš„é‡åšé˜¶æ®µï¼ŒLSNå€¼å°äºç­‰äºè¯¥é¡µçš„PageLSNå€¼çš„ä»»ä½•æ—¥å¿—è®°å½•å°†ä¸åœ¨è¯¥é¡µä¸Šæ‰§è¡Œ\n- PrevLSN\n  - æ¯æ¡æ—¥å¿—è®°å½•ä¹ŸåŒ…å«åŒä¸€äº‹åŠ¡çš„å‰ä¸€æ¡æ—¥å¿—è®°å½•çš„LSN\n- è¡¥å¿æ—¥å¿—è®°å½•(CLR)\n  - ä¸read-onlyæ—¥å¿—è®°å½•çš„ä½œç”¨ç›¸åŒ  \n  - åŒæ—¶èµ·åˆ°operation-abortæ—¥å¿—è®°å½•çš„ä½œç”¨\n- è„é¡µè¡¨\n  - åŒ…å«ä¸€ä¸ªåœ¨æ•°æ®åº“ç¼“å†²åŒºä¸­å·²æ›´æ–°è¿‡çš„é¡µé¢çš„åˆ—è¡¨\n  - ä¸ºæ¯ä¸€é¡µä¿å­˜å…¶PageLSNå’ŒRecLSNï¼ˆæœ‰åŠ©äºæ ‡è¯†å·²ç»å®æ–½äºè¯¥é¡µåœ¨ç£ç›˜ä¸Šçš„ç‰ˆæœ¬çš„æ—¥å¿—è®°å½•ï¼‰\n  - RecLSNååº”å‡ºå½“å‰é¡µé¢è¢«åŠ åˆ°è„é¡µè¡¨ä¸­æ—¶æ—¥å¿—æœ«ç«¯çš„LSNï¼Œå…¶åº”è¯¥å¤§äºæˆ–ç­‰äºç¨³å®šå­˜å‚¨å™¨ä¸Šè¯¥é¡µçš„PageLSN\n- æ£€æŸ¥ç‚¹æ—¥å¿—è®°å½•\n  - åŒ…å«è„é¡µè¡¨å’Œæ´»è·ƒäº‹åŠ¡çš„åˆ—è¡¨\n  - ä¸ºæ¯ä¸ªäº‹åŠ¡è®°å½•å…¶LastLSNï¼ˆè¯¥äº‹åŠ¡æ‰€å†™çš„æœ€åä¸€æ¡æ—¥å¿—è®°å½•çš„LSNï¼‰ \n#### æ¢å¤ç®—æ³•\n##### åˆ†æé˜¶æ®µ\n- åˆ†æé˜¶æ®µæ‰¾åˆ°æœ€åã€å·²å®Œæˆçš„æ£€æŸ¥ç‚¹æ—¥å¿—è®°å½•ï¼Œå¹¶å°†è¯¥è®°å½•è¯»å…¥è„é¡µè¡¨\n- å°†RedoLSNè®¾ç½®ä¸ºè„é¡µè¡¨ä¸­é‚£äº›é¡µçš„RecLSNçš„æœ€å°å€¼\n  - å¦‚æœæ²¡æœ‰è„é¡µï¼Œå°±å°†RedoLSNè®¾ç½®ä¸ºæ£€æŸ¥ç‚¹æ—¥å¿—è®°å½•çš„LSN\n- ä»RedoLSNå¼€å§‹æ‰«ææ—¥å¿—ï¼Œå°†undo-liståˆå§‹è®¾ç½®ä¸ºæ£€æŸ¥ç‚¹æ—¥å¿—è®°å½•ä¸­çš„äº‹åŠ¡åˆ—è¡¨\n  - åªè¦æ‰¾åˆ°ä¸€æ¡ä¸åœ¨undo-listä¸­çš„äº‹åŠ¡çš„æ—¥å¿—è®°å½•ï¼Œå°±æŠŠè¯¥äº‹åŠ¡æ·»åŠ åˆ°undo-list\n  - åªè¦æ‰¾åˆ°ä¸€ä¸ªäº‹åŠ¡çš„endè®°å½•ï¼Œå°±æŠŠè¯¥äº‹åŠ¡ä»undo-listä¸­åˆ é™¤\n##### é‡åšé˜¶æ®µ\nä»RedoLSNå¼€å§‹æ­£å‘æ‰«ææ—¥å¿—ï¼Œåªè¦æ‰¾åˆ°ä¸€æ¡æ›´æ–°è®°å½•ï¼Œå°±ï¼š\n- å¦‚æœè¯¥é¡µä¸åœ¨è„é¡µè¡¨ä¸­ï¼Œæˆ–è¯¥æ›´æ–°æ—¥å¿—çš„LSNå°äºè„é¡µè¡¨ä¸­è¯¥é¡µçš„RecLSNï¼Œåˆ™è·³è¿‡è¯¥è®°å½•\n- å¦åˆ™ï¼Œä»ç£ç›˜è°ƒå‡ºè¯¥é¡µï¼Œå¦‚æœå…¶PageLSNå°äºè¯¥æ—¥å¿—è®°å½•çš„LSNï¼Œå°±é‡åšè¯¥è®°å½•\n##### æ’¤é”€é˜¶æ®µ\nå¯¹æ—¥å¿—è¿›è¡Œåå‘æ‰«æï¼Œå¯¹undo-listä¸­çš„æ‰€æœ‰äº‹åŠ¡è¿›è¡Œæ’¤é”€\n- æ’¤é”€é˜¶æ®µäº§ç”Ÿä¸€ä¸ªåŒ…å«æ’¤é”€æ‰§è¡ŒåŠ¨ä½œçš„CLRï¼Œå¹¶å°†è¯¥CLRçš„UndoNextLSNè®¾å®šä¸ºè¯¥æ›´æ–°æ—¥å¿—è®°å½•çš„PrevLSN\n#### å…¶ä»–ç‰¹æ€§\n- åµŒå¥—çš„é¡¶å±‚åŠ¨ä½œ\n- æ¢å¤ç‹¬ç«‹æ€§\n- ä¿å­˜ç‚¹\n- ç»†ç²’åº¦å°é”\n- æ¢å¤æœ€ä¼˜åŒ–","tags":["æ•°æ®åº“"],"categories":["è®¡è½¯æ‚è°ˆ","å­¦ä¹ ç¬”è®°"]},{"title":"ä¸ªäººåšå®¢æ— ç”¨å’Œæ¶æ„çˆ¬è™«æ•´ç†","url":"/20220712/spider-collection/","content":"> æ•°æ®æ¥æºäº2022/6/27-2022/7/11 æœ¬äººCDNæ—¥å¿—\n## æ— ç”¨çˆ¬è™«\n> ä»¥ä¸‹ä¿¡æ¯å‡æ¥æºäºå„è‡ªçˆ¬è™«çš„å®˜ç½‘ï¼Œå¦‚éœ€çŸ¥é“è¯¦ç»†ä¿¡æ¯è¯·è¿›å…¥UAä¸­çš„å®˜ç½‘æŸ¥çœ‹\n### AhrefsBot\nAhrefs Bot ä¸º Ahrefs åœ¨çº¿è¥é”€å·¥å…·é›†çš„æ•°æ®åº“æä¾›æ”¯æŒã€‚Ahrefs ä½œä¸ºå›½å¤–çš„ SEO å·¥å…·ï¼Œé€šå¸¸è¢«ç”¨åœ¨ SEO å…³é”®å­—è°ƒç ”ã€ç‹¬ç«‹ç«™å¤–é“¾å»ºè®¾ã€ç«äº‰å¯¹æ‰‹å¤–é“¾åæŸ¥ä¸Šã€‚è€Œå¯¹äºé¢å‘å›½å†…ä¸ªäººåšå®¢çš„ç½‘ç«™åˆ™æ²¡ä»€ä¹ˆæ˜æ˜¾ç”¨é€”ã€‚\n\nUA\n```text\nMozilla/5.0 (compatible; AhrefsBot/7.0; +http://ahrefs.com/robot/)\n```\nrobot.txt\n```text\nUser-agent: AhrefsBot\nDisallow: /\n```\nçˆ¬è™«IPèŒƒå›´\n```text\n54.36.148.0/24\n54.36.149.0/24\n195.154.122.0/24\n195.154.123.0/24\n195.154.126.0/24\n195.154.127.0/24\n51.222.253.0/26\n168.119.64.245\n168.119.64.246\n168.119.64.247\n168.119.64.248\n168.119.64.249\n168.119.64.250\n168.119.64.251\n168.119.64.252\n168.119.64.253\n168.119.64.254\n168.119.65.107\n168.119.65.108\n168.119.65.109\n168.119.65.110\n168.119.65.111\n168.119.65.112\n168.119.65.113\n168.119.65.114\n168.119.65.115\n168.119.65.116\n168.119.65.117\n168.119.65.118\n168.119.65.119\n168.119.65.120\n168.119.65.121\n168.119.65.122\n168.119.65.123\n168.119.65.124\n168.119.65.125\n168.119.65.126\n168.119.65.43\n168.119.65.44\n168.119.65.45\n168.119.65.46\n168.119.65.47\n168.119.65.48\n168.119.65.49\n168.119.65.50\n168.119.65.51\n168.119.65.52\n168.119.65.53\n168.119.65.54\n168.119.65.55\n168.119.65.56\n168.119.65.57\n168.119.65.58\n168.119.65.59\n168.119.65.60\n168.119.65.61\n168.119.65.62\n168.119.68.117\n168.119.68.118\n168.119.68.119\n168.119.68.120\n168.119.68.121\n168.119.68.122\n168.119.68.123\n168.119.68.124\n168.119.68.125\n168.119.68.126\n168.119.68.171\n168.119.68.172\n168.119.68.173\n168.119.68.174\n168.119.68.175\n168.119.68.176\n168.119.68.177\n168.119.68.178\n168.119.68.179\n168.119.68.180\n168.119.68.181\n168.119.68.182\n168.119.68.183\n168.119.68.184\n168.119.68.185\n168.119.68.186\n168.119.68.187\n168.119.68.188\n168.119.68.189\n168.119.68.190\n168.119.68.235\n168.119.68.236\n168.119.68.237\n168.119.68.238\n168.119.68.239\n168.119.68.240\n168.119.68.241\n168.119.68.242\n168.119.68.243\n168.119.68.244\n168.119.68.245\n168.119.68.246\n168.119.68.247\n168.119.68.248\n168.119.68.249\n168.119.68.250\n168.119.68.251\n168.119.68.252\n168.119.68.253\n168.119.68.254\n```\n### SemrushBot\nSemrushBot ä¸º Semrush å‘ç°å’Œæ”¶é›†æ–°çš„å’Œæ›´æ–°çš„ Web æ•°æ®ã€‚SemrushBot æ”¶é›†çš„æ•°æ®ä¸»è¦ç”¨äºåˆ†æé¡µé¢ SEOã€å¤–é“¾æœç´¢ç­‰ã€‚åŒæ ·å¯¹äºé¢å‘å›½å†…ä¸ªäººåšå®¢çš„ç½‘ç«™æ²¡ä»€ä¹ˆæ˜æ˜¾ç”¨é€”ã€‚\n\nUA\n```text\nMozilla/5.0 (compatible; SemrushBot/7~bl; +http://www.semrush.com/bot.html)\n```\nrobot.txt\n```text\nUser-agent: SemrushBot\nDisallow: /\nUser-agent: SiteAuditBot\nDisallow: /\nUser-agent: SemrushBot-BA\nDisallow: /\nUser-agent: SemrushBot-SI\nDisallow: /\nUser-agent: SemrushBot-SWA\nDisallow: /\nUser-agent: SemrushBot-CT\nDisallow: /\nUser-agent: SemrushBot-BM\nDisallow: /\nUser-agent: SplitSignalBot\nDisallow: /\nUser-agent: SemrushBot-COUB\nDisallow: /\n```\næ— å›ºå®šIPèŒƒå›´\n### Barkrowler\nBarkrowler çˆ¬è™«ä¸º Babbar.tech æä¾›åœ¨çº¿è¥é”€å’ŒSEO å‚è€ƒå·¥å…·ã€‚å…¶å¯¹äºé¢å‘å›½å†…ä¸ªäººåšå®¢çš„ç½‘ç«™æ²¡ä»€ä¹ˆæ˜æ˜¾ç”¨é€”ã€‚\n\nUA\n```text\nMozilla/5.0 (compatible; Barkrowler/0.9; +https://babbar.tech/crawler)\n```\nrobot.txt\n```text\nUser-agent: barkrowler\nDisallow: /\n```\næ— å›ºå®šIPèŒƒå›´\n### PetalBot\nPetalBot æ˜¯ Petal æœç´¢å¼•æ“çš„çˆ¬è™«ã€‚è¯¥æœç´¢å¼•æ“è™½ç„¶æ˜¯åä¸ºå‡ºå“ï¼Œä½†å®é™…ä¸Šå›½å†…å¹¶ä¸èƒ½æ­£å¸¸è®¿é—®ï¼Œæ‰€ä»¥å¯ä»¥è€ƒè™‘å°†å…¶å±è”½ã€‚\n\nUA\n```text\nMozilla/5.0 (compatible;PetalBot;+https://webmaster.petalsearch.com/site/petalbot)\nMozilla/5.0 (Linux; Android 7.0;) AppleWebKit/537.36 (KHTML, like Gecko) Mobile Safari/537.36 (compatible; PetalBot;+https://webmaster.petalsearch.com/site/petalbot)\n```\nrobot.txt\n```text\nUser-agent: PetalBot\nDisallow: /\n```\næœªæ˜ç¡®æåŠIPèŒƒå›´\n### coccocbot-web\ncoccocbotæ˜¯ Coc Coc æœç´¢å¼•æ“çš„çˆ¬è™«ã€‚è¯¥æœç´¢å¼•æ“æ¥è‡ªè¶Šå—ï¼Œæ‰€ä»¥å¯¹å›½å†…ç½‘ç«™æ²¡æœ‰ä»»ä½•å¸®åŠ©ã€‚\n\nUA\n```text\nMozilla/5.0 (compatible; coccocbot-web/1.0; +http://help.coccoc.com/searchengine)\n```\nrobot.txt\n```text\nUser-agent: coccocbot-web\nDisallow: /\n```\næœªæ˜ç¡®æåŠIPèŒƒå›´\n### CensysInspect\nCensyså¹³å°å¸®åŠ©ä¿¡æ¯å®‰å…¨ä»ä¸šäººå‘˜å‘ç°ã€ç›‘æ§å’Œåˆ†æç½‘ç»œè®¾å¤‡ã€‚å¯¹äºä¸ªäººç½‘ç«™ä¹Ÿæ²¡æœ‰ä»€ä¹ˆå®é™…ç”¨é€”ã€‚\n\nUA\n```text\nMozilla/5.0 (compatible; CensysInspect/1.1; +https://about.censys.io/)\n```\nrobot.txt\n```text\nUser-agent: CensysInspect\nDisallow: /\n```\nçˆ¬è™«IPèŒƒå›´\n```text\n162.142.125.0/24\n167.94.138.0/24\n167.94.145.0/24\n167.94.146.0/24\n167.248.133.0/24\n2602:80d:1000:b0cc:e::/80\n2620:96:e000:b0cc:e::/80\n```\n### BLEXBot\nBLEXBot å¸®åŠ©äº’è”ç½‘è¥é”€äººå‘˜è·å–æœ‰å…³ç½‘ç«™é“¾æ¥ç»“æ„åŠå…¶åœ¨ç½‘ç»œä¸Šçš„ç›¸äº’é“¾æ¥çš„ä¿¡æ¯ï¼Œä»¥é¿å…ä»»ä½•æŠ€æœ¯å’Œå¯èƒ½çš„æ³•å¾‹é—®é¢˜ï¼Œå¹¶æ”¹å–„æ•´ä½“åœ¨çº¿ä½“éªŒã€‚å…¶å¯¹äºé¢å‘å›½å†…ä¸ªäººåšå®¢çš„ç½‘ç«™æ²¡ä»€ä¹ˆæ˜æ˜¾ç”¨é€”ã€‚\n\nUA\n```text\nMozilla/5.0 (compatible; BLEXBot/1.0; +http://webmeup-crawler.com/)\n```\nrobot.txt\n```text\nUser-agent: BLEXBot\nDisallow: /\n```\næœªæ˜ç¡®æåŠIPèŒƒå›´\n### SeznamBot\nSeznamBot æ˜¯ Seznam æœç´¢å¼•æ“çš„çˆ¬è™«ã€‚è¯¥æœç´¢å¼•æ“æ¥è‡ªæ·å…‹ï¼Œæ‰€ä»¥å¯¹å›½å†…ç½‘ç«™æ²¡æœ‰ä»»ä½•å¸®åŠ©ã€‚\n\nUAï¼š\n```text\nMozilla/5.0 (compatible; SeznamBot/3.2; +http://napoveda.seznam.cz/en/seznambot-intro/)\nMozilla/5.0 (compatible; SeznamBot/3.2-test4; +http://napoveda.seznam.cz/en/seznambot-intro/)\nMozilla/5.0 PhantomJS (compatible; Seznam screenshot-generator 2.1; +http://fulltext.sblog.cz/screenshot/)\nMozilla/5.0 (compatible; Seznam screenshot-generator 2.0; +http://fulltext.sblog.cz/screenshot/)\nMozilla/5.0 (compatible; Seznam screenshot-generator 2.1; +http://fulltext.sblog.cz/screenshot/)\nMozilla/5.0 (Linux; U; Android 4.1.2; cs-cz; Seznam screenshot-generator Build/Q3) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30\n```\nrobot.txt\n```text\nUser-agent: SeznamBot\nDisallow: /\n```\nçˆ¬è™«IPèŒƒå›´\n```text\nSeznamBot\n77.75.76.x\n77.75.77.x      \n77.75.78.x\n77.75.79.x\n2a02:598:aaaa:2::x\n2a02:598:bbbb:2::x\nFreshBot\n77.75.77.31\n77.75.79.31\nTest version\n77.75.73.26\nscreenshot-generator\n77.75.77.123\n77.75.77.174\n77.75.77.200\n77.75.79.123\n77.75.79.200\n2a02:598:2::1123\n2a02:598:2::1200\n```\n### DataForSeoBot\nDataForSEO Link Bot ç¡®ä¿ SEO ç¤¾åŒºçš„æ¯ä¸ªæˆå‘˜éƒ½èƒ½æ¥è§¦åˆ° Google æ’åç®—æ³•çš„æ ¸å¿ƒå…ƒç´ å…³é”®ã€‚å…¶å¯¹äºé¢å‘å›½å†…ä¸ªäººåšå®¢çš„ç½‘ç«™æ²¡ä»€ä¹ˆæ˜æ˜¾ç”¨é€”ã€‚\n\nUA\n```text\nMozilla/5.0 (compatible; DataForSeoBot/1.0; +https://dataforseo.com/dataforseo-bot)\n```\nrobot.txt\n```text\nUser-agent: DataForSeoBot\nDisallow: /\n```\næœªæ˜ç¡®æåŠIPèŒƒå›´\n## æ¶æ„çˆ¬è™«\n### çˆ¬å–wp-login.php\nwp-login.phpä¸ºWordPressç«™ç‚¹ç™»å½•é¡µé¢ï¼Œä¸æ³•åˆ†å­å¯ä»¥é€šè¿‡æœºå™¨æ‰«æè¯¥æ–‡ä»¶æ¥å°è¯•çˆ†ç ´æ”»å‡»ä½ çš„ç½‘ç«™ã€‚å¦‚æœé‡‡ç”¨WordPresså»ºç«™çš„éœ€è¦è€ƒè™‘é‡‡ç”¨ä¿æŠ¤æªæ–½ï¼Œå¦‚ä¿®æ”¹ç™»å½•æ–‡ä»¶åï¼Œæˆ–é€šè¿‡nginxç¦æ­¢è®¿é—®è¯·æ±‚ã€‚\næœ¬æ¬¡é‡‡ç”¨çš„Hexoé™æ€å»ºç«™ï¼Œæ‰€ä»¥å¹¶ä¸å­˜åœ¨è¯¥æ–‡ä»¶ï¼Œä½†ä»ç„¶åœ¨æ—¥å¿—ä¸­æ‰¾åˆ°äº†å¤§é‡IPå°è¯•å¯»æ‰¾è¯¥æ–‡ä»¶ï¼Œè¯·æ³¨æ„æé˜²ã€‚\n### æœåŠ¡å™¨æ”»å‡»\né€šè¿‡æ”»å‡»å‘½ä»¤å¯»æ‰¾æœåŠ¡å™¨æ¼æ´ï¼Œå¹¶è¿›è¡Œæ”»å‡»ï¼Œå¤šä½¿ç”¨getshellæ¼æ´æˆ–è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚\nåœ¨æ—¥å¿—ä¸­äº†è§£åˆ°å·²çŸ¥çš„æ”»å‡»å‘½ä»¤åŒ…å«æ¼æ´ï¼š\n- Ueditorç¼–è¾‘å™¨ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´\n- DedeCMS 5.7è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´\n- FCKeditorç¼–è¾‘å™¨ä¸Šä¼ æ¼æ´\n- ECSHOPè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´\n- SiteServer CMSæ¼æ´\n- PHPCMSä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´\n- TPshopæ¼æ´\n- thinkPHPè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´\n- ç‹®å­é±¼ç¤¾åŒºå›¢è´­ç³»ç»ŸCMSä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´\n\næ”»å‡»å‘½ä»¤ä¸ä¾¿å±•ç¤ºï¼Œè¯·æ³¨æ„ä»¥ä¸Šæ¼æ´å¹¶åŠæ—¶ä¿®å¤ï¼\n\n### è™šå‡çˆ¬è™«\næœ¬äººåœ¨ç¿»çœ‹CDNæ—¥å¿—æ—¶å‘ç°äº†ç™¾åº¦çˆ¬è™«å¤§é‡çˆ¬å–æœ¬äººçš„ç½‘ç«™ï¼Œå…¶UAéå¸¸æ­£å¸¸\n```text\nMozilla/5.0 (compatible; Baiduspider/2.0; +http://www.baidu.com/search/spider.html)\n```\nä½†é€šè¿‡ç™¾åº¦ç«™é•¿åå°å¯ä»¥çŸ¥é“ç™¾åº¦çˆ¬è™«æ ¹æœ¬å°±æ²¡æœ‰çˆ¬å–ï¼ˆæ³ªç›®ï¼‰ã€‚\nwindowsä¸‹å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ¥æŸ¥è¯¢çˆ¬è™«\n```bash\nnslookup [çˆ¬è™«çš„IPåœ°å€]\n```\nå¦‚æœæ˜¯å®˜æ–¹çš„çˆ¬è™«åˆ™ä¼šæ˜¾ç¤ºIPçš„DNSè®°å½•ï¼Œå¹¶è¯¥è®°å½•ä¸å®˜æ–¹æ‰€æä¾›çš„ç›¸ç¬¦\n```text\nåç§°:    baiduspider-220-181-108-91.crawl.baidu.com\nAddress:  220.181.108.91\n```\nè™šå‡çˆ¬è™«ä¼šæ˜¾ç¤ºæ‰¾ä¸åˆ°ï¼Œæˆ–ä¸ä¸å®˜æ–¹æ‰€æä¾›çš„ä¸ç¬¦ï¼Œæ³¨æ„å±è”½\n```text\n*** æ‰¾ä¸åˆ° [IPåœ°å€]: Non-existent domain\n```\n## ä¸ªäººçˆ¬è™«\nä¸ªäººçˆ¬è™«å¦‚æœæ²¡æœ‰æŒ‡å®šUAçš„è¯ï¼Œé»˜è®¤å¯èƒ½ä¼šæ˜¾ç¤ºå¦‚ä¸‹çš„UAï¼Œè¯·æ³¨æ„å±è”½\n```text\nlibcurl-agent\npython-requests\nJakarta Commons-HttpClient\ncurl\nJava\nfeedfinder2\n```","tags":["çˆ¬è™«"],"categories":["è®¡è½¯æ‚è°ˆ"]},{"title":"ã€Šå¤§å®¶çš„æ—¥è¯­ã€‹æ–‡æ³•æ•´ç†","url":"/20220709/nihongo-bunpou/","content":"æœ¬ç¬”è®°ä»…æ•´ç†æ¥è‡ªäºã€Šå¤§å®¶çš„æ—¥è¯­ã€‹ï¼ˆã¿ã¾ã›ã‚“ã®æ—¥æœ¬èªï¼‰1-22è¯¾å†…çš„æ–‡æ³•éƒ¨åˆ†ï¼Œå¯èƒ½ä¼šæœ‰ç–æ¼çš„éƒ¨åˆ†ï¼Œæ•¬è¯·è°…è§£\n\n<!-- more -->\n\n## åŠ©è¯å½’çº³\n### ã¯\nè¡¨ç¤ºå…¶å‰é¢çš„åè¯æ˜¯å¥å­çš„ä¸»é¢˜ï¼ˆ1.1ï¼‰\n- ç§**ã¯**ä¼šç¤¾å“¡ã§ã™ã€‚\n### ã‚‚\nç”¨äºå°†ç›¸åŒçš„äº‹ç‰©ä½œä¸ºå‰æåŠ ä»¥é™ˆè¿°æ—¶ï¼ˆ1.4ï¼‰\n- ç§ã¯ä¼šç¤¾å“¡ã§ã™ã€‚ãƒŸãƒ©ãƒ¼ã•ã‚“**ã‚‚**ä¼šç¤¾å“¡ã§ã™ã€‚\n\nç”¨äºå¯¹ç–‘é—®è¯æ‰€é—®èŒƒç•´çš„ä¸€åˆ‡å…¨éƒ¨åŠ ä»¥å¦å®šæ—¶ï¼ŒåŠ¨è¯ä½¿ç”¨å¦å®šï¼ˆ5.2ï¼‰\n- ã©ã“**ã‚‚**è¡Œãã¾ã›ã‚“ã€‚\n### ã®\nå½“åè¯1è¡¨ç¤ºåè¯2çš„å±æ€§æ—¶ï¼Œç”¨æ¥è¿æ¥è¿™ä¸¤ä¸ªåè¯ï¼ˆ1.5ï¼‰\n- ãƒŸãƒ©ãƒ¼ã•ã‚“ã¯IMC**ã®**ç¤¾å“¡ã§ã™ã€‚\n\nå½“åè¯1ç”¨æ¥è¯´æ˜åè¯2ä¸ä»€ä¹ˆäº‹ç‰©æœ‰å…³ç³»æ—¶ï¼Œç”¨æ¥è¿æ¥è¿™ä¸¤ä¸ªåè¯ï¼ˆ2.5ï¼‰\n- ã“ã‚Œã¯ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼**ã®**æœ¬ã§ã™ã€‚\n\nå½“åè¯1è¡¨ç¤ºåè¯2çš„æ‰€å±ï¼ˆ2.5ï¼‰\n- ã“ã‚Œã¯ç§**ã®**æœ¬ã§ã™ã€‚\n\nç­”è¯­ä¸­ï¼Œä»£æ›¿é—®å¥ä¸­å‡ºç°çš„åè¯ï¼Œä¸èƒ½ä»£æ›¿äººï¼ˆ2.6ï¼‰\n- ã“ã®ã‹ã°ã‚“ã¯ã‚ãªãŸã®ã§ã™ã‹ã€‚Â·Â·Â·Â·Â·Â·ã„ã„ãˆã€ã‚ãŸã—**ã®**ã˜ã‚ƒã‚ã‚Šã¾ã›ã‚“ã€‚\n\nè¡¨ç¤ºæ–¹å‘å’Œä½ç½®ï¼ˆ10.4ï¼‰\n- æœº**ã®**ä¸Šã«å†™çœŸãŒã‚ã‚Šã¾ã™ã€‚\n### ã‹\nè¡¨ç¤ºè¯´è¯äººä¸è‚¯å®šæˆ–ç–‘é—®çš„è¯­æ°”ï¼Œæ„æˆç–‘é—®å¥ï¼ˆ1.3ï¼‰\n- ãƒŸãƒ©ãƒ¼ã•ã‚“ã¯ä¼šç¤¾å“¡ã§ã™**ã‹**ã€‚\n\nç”¨äºä¸¤ä¸ªåŠä¸¤ä¸ªä»¥ä¸Šçš„å¹¶åˆ—ç–‘é—®å¥è¿›è¡Œé€‰æ‹©å›ç­”çš„é€‰æ‹©ç–‘é—®å¥ï¼Œå¯ç¿»è¯‘ä¸ºâ€œæˆ–è€…ï¼Œè¿˜æ˜¯â€ï¼ˆ2.4ï¼‰\n- ã“ã‚Œã¯ã€Œ9ã€ã§ã™**ã‹**ã€ã€Œ7ã€ã§ã™**ã‹**ã€‚\n\nè¡¨ç¤ºé‚€è¯·äººä¸€èµ·æ¥åšæŸäº‹ï¼ˆ6.6ï¼‰\n- ã„ã£ã—ã‚‡ã†ã«äº¬éƒ½ã¸è¡Œã**ã¾ã›ã‚“ã‹**ã€‚\n\nè¯´è¯äººåœ¨å¾—åˆ°è‡ªå·±æ‰€ä¸çŸ¥é“çš„æ–°ä¿¡æ¯ä¹‹åè¡¨ç¤ºè®¤å¯ã€ç†è§£ï¼ˆ6.8ï¼‰\n- æ—¥æ›œæ—¥äº¬éƒ½ã¸è¡Œãã¾ã—ãŸã€‚Â·Â·Â·Â·Â·Â·äº¬éƒ½ã§ã™**ã‹**ã€‚ã„ã„ã§ã™ã­ã€‚\n### ã«\nè¡¨ç¤ºåŠ¨ä½œè¿›è¡Œçš„æ—¶é—´ï¼ˆ4.3ï¼‰\n- 6æ™‚åŠ**ã«**èµ·ãã¾ã™ã€‚\n\n\n> å…·ä½“æ—¶é—´åéœ€è¦åŠ ï¼Œå¦‚6æ™‚åŠã€7æœˆ2æ—¥\n>ã€Œ~æ›œæ—¥ã€ã€ã€Œæœã€ã€ã€Œæ˜¼ã€ã€ã€Œæ™©ã€ã€ã€Œå¤œã€åå¯åŠ å¯ä¸åŠ \n\n\nè¡¨ç¤ºæˆå—åŠ¨è¯æ¥å—/æä¾›äº‹ç‰©ã€ä¿¡æ¯çš„å¯¹è±¡ï¼ˆéå…¬å¸ã€å­¦æ ¡ç­‰ç»„ç»‡ï¼‰ï¼ˆ7.3/7.4ï¼‰\n- ã‚¤ãƒ¼ã•ã‚“**ã«**æœ¬ã‚’è²¸ã—ã¾ã—ãŸã€‚\n- ã‚¤ãƒ¼ã•ã‚“**ã«**æœ¬ã‚’å€Ÿã‚Šã¾ã—ãŸã€‚\n\nè¡¨ç¤ºç‰©å’Œäººå­˜åœ¨çš„åœºæ‰€ï¼ˆ10.2ï¼‰\n- ç§ã®éƒ¨å±‹**ã«**æœºãŒã‚ã‚Šã¾ã™ã€‚\n- æœºã¯ç§ã®éƒ¨å±‹**ã«**ã‚ã‚Šã¾ã™ã€‚\n\nè¡¨ç¤ºé¢‘åº¦ï¼ˆ11.3ï¼‰\n- 1ã‹æœˆ**ã«**2å›æ˜ ç”»ã‚’è¦‹ã¾ã™ã€‚\n\nè¡¨ç¤ºç›®çš„ï¼ˆ13.3ï¼‰\n- æ˜æ—¥äº¬éƒ½ã®ãŠç¥­ã‚Š**ã«**è¡Œãã¾ã™ã€‚\n\nè¡¨ç¤ºä¸»è¯­å› æŸä¸€åŠ¨ä½œçš„ç»“æœè€Œå­˜åœ¨äºæŸä¸€åœºæ‰€ï¼ˆ15.4ï¼‰\n- ã“ã“**ã«**å…¥ã£ã¦ã¯ã„ã‘ã¾ã›ã‚“ã€‚\n\nè¡¨ç¤ºåŠ¨ä½œçš„ç»“æœæˆ–åè¯å­˜åœ¨çš„åœºæ‰€ï¼ˆ15.5ï¼‰\n- ã“ã“**ã«**è»Šã‚’æ­¢ã‚ã¦ãã ã•ã„ã€‚\n\nè¡¨ç¤ºå˜åŒ–çš„ç»“æœï¼ˆ19.4ï¼‰\n- å…ƒæ°—**ã«**ãªã‚Šã¾ã™ã€‚\n### ã‹ã‚‰\nè¡¨ç¤ºèµ·ç‚¹ï¼ˆæ—¶é—´ã€åœºæ‰€ï¼‰ï¼ˆ4.4ï¼‰\n- 9æ™‚**ã‹ã‚‰**åƒãã¾ã™ã€‚\n\nè¡¨ç¤ºæˆå—åŠ¨è¯æ¥å—/æä¾›äº‹ç‰©ã€ä¿¡æ¯çš„å¯¹è±¡ï¼ˆå…¬å¸ã€å­¦æ ¡ç­‰ç»„ç»‡å¿…é¡»ç”¨è¯¥åŠ©è¯ï¼‰ï¼ˆ7.4ï¼‰\n- éŠ€è¡Œ**ã‹ã‚‰**ãŠé‡‘ã‚’å€Ÿã‚Šã¾ã—ãŸã€‚\n\nè¡¨ç¤ºåŸå› ï¼ˆ9.4ï¼‰\n- æ™‚é–“ãŒã‚ã‚Šã¾ã›ã‚“**ã‹ã‚‰**ã€æ–°èã‚’èª­ã¿ã¾ã›ã‚“ã€‚\n\nè¡¨ç¤ºåŠ¨ä½œç›¸ç»§è¿›è¡Œï¼ˆåŠ¨è¯ã¦å½¢ï¼‰ï¼ˆ16.2ï¼‰\n- ã“ã®ä»•äº‹ãŒçµ‚ã‚ã£ã¦**ã‹ã‚‰**ã€é£Ÿã¹ã¾ã™ã€‚\n### ã¾ã§\nè¡¨ç¤ºç»ˆç‚¹ï¼ˆæ—¶é—´ã€åœºæ‰€ï¼‰ï¼ˆ4.4ï¼‰\n- 9æ™‚ã‹ã‚‰5æ™‚**ã¾ã§**å‹‰å¼·ã—ã¾ã™ã€‚\n### ã¨\nè¡¨ç¤ºåè¯å¹¶åˆ—ï¼Œå¯ç¿»è¯‘ä¸ºâ€œå’Œâ€ï¼ˆ4.5ï¼‰\n- éŠ€è¡Œã®ä¼‘ã¿ã¯åœŸæ›œæ—¥**ã¨**æ—¥æ›œæ—¥ã§ã™ã€‚\n\nè¡¨ç¤ºä¸è‡ªå·±ä¸€èµ·è¡ŒåŠ¨çš„äººæˆ–åŠ¨ç‰©ï¼ˆ5.4ï¼‰\n- å®¶æ—**ã¨**æ—¥æœ¬ã¸æ¥ã¾ã—ãŸã€‚\n\nè¡¨ç¤ºæ¯”è¾ƒçš„å¯¹è±¡ï¼ˆ12.4ï¼‰\n- æ˜¥**ã¨**ç§‹**ã¨**ã©ã¡ã‚‰ãŒå¥½ãã§ã™ã‹ã€‚\n\nè¡¨ç¤ºæ€è€ƒã€åˆ¤æ–­ã€å‘è¨€çš„å†…å®¹ï¼ˆ21.1/21.2ï¼‰\n- æ˜æ—¥é›¨ãŒé™ã‚‹**ã¨**æ€ã„ã¾ã™ã€‚\n- å¯ã‚‹å‰ã«ã€ã€ŒãŠã‚„ã™ã¿ãªã•ã„ã€**ã¨**è¨€ã„ã¾ã™ã€‚\n### ã­\næ¥åœ¨å¥å°¾ï¼Œè¡¨ç¤ºè¯´è¯äººå¸Œæœ›å¾—åˆ°å¬è¯äººçš„åŒæ„æˆ–è¯´è¯äººå¯¹æŸä¸€äº‹ç‰©åŠ ä»¥ç¡®è®¤ã€å®å˜±çš„è¯­æ°”ï¼ˆ4.6ï¼‰\n- æ¯æ—¥10æ™‚ã¾ã§å‹‰å¼·ã—ã¾ã™ã€‚Â·Â·Â·Â·Â·Â·å¤§å¤‰ã§ã™**ã­**ã€‚\n### ã¸\nè¡¨ç¤ºç§»åŠ¨çš„æ–¹å‘ï¼ˆ5.1ï¼‰\n- æ—¥æœ¬**ã¸**æ¥ã¾ã—ãŸã€‚\n### ã¦\nç”¨äºè¿æ¥ä¸¤ä¸ªåŠä»¥ä¸Šè¿ç»­å‘ç”Ÿçš„åŠ¨ä½œï¼ˆ16.1ï¼‰\n- æœã‚¸ãƒ§ã‚®ãƒ³ã‚°ã‚’ã—**ã¦**ã€ä¼šç¤¾ã¸è¡Œãã¾ã™ã€‚\n\nç”¨äºè¿æ¥ä¸¤ä¸ªä»¥ä¸Šå¥å­ï¼Œå¥æœ«ä¸ºã„å½¢å®¹è¯ï¼Œå¯ç¿»è¯‘ä¸ºâ€œå¹¶ä¸”â€ï¼ˆ16.1ï¼‰\n- æ˜¨æ—¥ã¯å¤©æ°—ãŒè‰¯ã**ã¦**ã€æš‘ã‹ã£ãŸã§ã™ã€‚\n### ã§\nè¡¨ç¤ºæ‰‹æ®µã€æ–¹æ³•ï¼ˆ7.1ï¼‰\nï¼ã¯ã—**ã§**é£Ÿã¹ã¾ã™ã€‚\n\nè¡¨ç¤ºäº¤é€šæ‰‹æ®µï¼ˆ5.3ï¼‰\n- é›»è»Š**ã§**è¡Œãã¾ã™ã€‚\n\n> å¾’æ­¥è¡Œèµ°æ—¶ï¼Œç”¨æ­©ã„ã¦ï¼Œä¸”ä¸æ¥ã§\n> - é§…ã‹ã‚‰**æ­©ã„ã¦**å¸°ã‚Šã¾ã—ãŸã€‚\n\nè¡¨ç¤ºåŠ¨ä½œå‘ç”Ÿçš„åœºæ‰€ï¼ˆ6.5ï¼‰\n- é§…**ã§**æ–°èã‚’è²·ã„ã¾ã™ã€‚\n\nè¡¨ç¤ºèŒƒå›´ï¼ˆ12.5ï¼‰\n- æ—¥æœ¬æ–™ç†**ã§**ä½•ãŒä¸€ç•ªç¾å‘³ã—ã„ã§ã™ã‹ã€‚\n\nç”¨äºè¿æ¥ä¸¤ä¸ªä»¥ä¸Šå¥å­ï¼Œå¥æœ«ä¸ºãªå½¢å®¹è¯ï¼Œå¯ç¿»è¯‘ä¸ºâ€œå¹¶ä¸”â€ï¼ˆ16.1ï¼‰\n- ä¸Šæµ·ã¯è³‘ã‚„ã‹**ã§**ã€ãã‚Œã„ãªç”ºã§ã™ã€‚\n\nç”¨äºè¿æ¥ä¸¤ä¸ªä»¥ä¸Šå¥å­ï¼Œå¥æœ«ä¸ºåè¯ï¼ˆ16.1ï¼‰\n- ç§ã¯ä¸­å›½äºº**ã§**ã€å­¦ç”Ÿã§ã™ã€‚\n### ã‚ˆ\næ¥åœ¨å¥å°¾ï¼Œç”¨äºå°†å¯¹æ–¹ä¸çŸ¥é“çš„äº‹æƒ…æˆ–è¯´è¯äººè‡ªå·±çš„åˆ¤æ–­ã€æ„è§ç­‰å‘Šè¯‰å¯¹æ–¹ï¼ˆ5.6ï¼‰\n- ã“ã®é›»è»Šã¯äº¬éƒ½ã¸è¡Œãã¾ã™ã‹ã€‚Â·Â·Â·Â·Â·Â·ã„ã„ãˆã€è¡Œãã¾ã›ã‚“ã€‚æ¬¡ã®ã€Œæ™®é€šã€ã§ã™**ã‚ˆ**ã€‚\n### ã‚’\nè¡¨ç¤ºä»–åŠ¨è¯çš„å®¾è¯­ï¼ˆ6.1ï¼‰\n- ã‚¸ãƒ¥ãƒ¼ã‚¹**ã‚’**é£²ã¿ã¾ã™ã€‚\n\nè¡¨ç¤ºèµ·ç‚¹ã€å‡ºå‘ç‚¹ï¼ˆ16.4ï¼‰\n- 7æ™‚ã«å®¶**ã‚’**å‡ºã¾ã™ã€‚\n### ãŒ\nè¡¨ç¤ºè½¬æŠ˜ï¼ˆ8.4ï¼‰\n- æ—¥æœ¬ã®é£Ÿã¹ç‰©ã¯ç¾å‘³ã—ã„ã§ã™**ãŒ**ã€é«˜ã„ã§ã™ã€‚\n\nè¡¨ç¤ºå½¢å®¹è¯å’ŒçŠ¶æ€åŠ¨è¯çš„å®¾è¯­ï¼ˆ9.1ï¼‰\n- ç§ã¯æ—¥æœ¬èª**ãŒ**ã‚ã‹ã‚Šã¾ã™ã€‚\n- ç§ã¯æ—¥æœ¬èª**ãŒ**å¥½ãã§ã™ã€‚\n- ç§ã¯å‹é”**ãŒ**æ¬²ã—ã„ã§ã™ã€‚\n\nè¡¨ç¤ºä½œä¸ºå­˜åœ¨ä¸»ä½“çš„åè¯ï¼ˆ10.1ï¼‰\n- æ¡œ**ãŒ**ã‚ã‚Šã¾ã™ã€‚\n- çŠ¬**ãŒ**ã„ã¾ã™ã€‚\n\nè¡¨ç¤ºäº”å®˜æ‰€æ„Ÿçš„æŸç§ç°è±¡æˆ–å®¢è§‚åœ°ä¼ è¾¾æŸä»¶äº‹æƒ…ï¼ˆ14.6ï¼‰\n- é›¨**ãŒ**é™ã£ã¦ã„ã¾ã™ã€‚\n- ãƒŸãƒ©ãƒ¼ã•ã‚“**ãŒ**ã„ã¾ã›ã‚“ã­ã€‚\n\nè¡¨ç¤ºå¥å­çš„ä¸»é¢˜å…·æœ‰çš„æ€§è´¨ï¼ˆ16.3ï¼‰\n- å¤§é˜ªã¯é£Ÿã¹ç‰©**ãŒ**ç¾å‘³ã—ã„ã§ã™ã€‚\n\nä¿®é¥°åè¯çš„å¥èŠ‚ä¸­çš„ä¸»è¯­ï¼ˆ22.1ï¼‰\n- ã“ã‚Œã¯ãƒŸãƒ©ãƒ¼ã•ã‚“**ãŒ**ä½œã£ãŸã‚±ãƒ¼ã‚­ã§ã™ã€‚\n### ã‚„\nç”¨äºé€‰æ‹©ä¸¤ä¸ªä»¥ä¸Šå…·æœ‰ä»£è¡¨æ€§çš„åè¯åŠ ä»¥åˆ—ä¸¾ï¼ˆ10.5ï¼‰\n- ç®±ã®ä¸­ã«æ‰‹ç´™**ã‚„**å†™çœŸãŒã‚ã‚Šã¾ã™ã€‚\n### ãªã©\nè¡¨ç¤ºé™¤äº†åˆ—ä¸¾å‡ºçš„ä»¥å¤–è¿˜æœ‰å…¶ä»–åè¯ï¼Œå¯ç¿»è¯‘ä¸ºâ€œç­‰ç­‰â€ï¼ˆ10.5ï¼‰\n- ç®±ã®ä¸­ã«æ‰‹ç´™ã‚„å†™çœŸ**ãªã©**ãŒã‚ã‚Šã¾ã™ã€‚\n### ã ã‘\næ¥åœ¨æ•°é‡è¯æˆ–åè¯åï¼Œè¡¨ç¤ºåªæœ‰è¿™äº›ï¼Œä¸ä¼šå†æœ‰è¶…è¿‡äºæ­¤ï¼Œå¯ç¿»è¯‘ä¸ºâ€œåªæœ‰â€ï¼ˆ11.4ï¼‰\n- ä¼‘ã¿ã¯æ—¥æ›œæ—¥**ã ã‘**ã§ã™ã€‚\n### ã‚ˆã‚Š\nè¡¨ç¤ºæ¯”è¾ƒï¼ˆ12.3ï¼‰\n- ã“ã®è»Šã¯ã‚ã®è»Š**ã‚ˆã‚Š**å¤§ãã„ã¾ã™ã€‚\n### ãã‚‰ã„\næ¥åœ¨æ•°é‡è¯ä¹‹åè¡¨ç¤ºå¤§æ¦‚çš„æ•°é‡ï¼Œå¯ç¿»è¯‘ä¸ºâ€œå¤§çº¦â€ï¼ˆ11.2ï¼‰\n- 15åˆ†**ãã‚‰ã„**ã‹ã‹ã‚Šã¾ã™ã€‚\n### ã§ã‚‚\nåœ¨åŠè¯±æˆ–å»ºè®®æŸä»¶äº‹æ—¶ï¼Œæå‡ºæŸä¸€ç¤ºä¾‹ä½†å¹¶ä¸é™å®šäºæ­¤ä¸€é¡¹ï¼ˆ21.6ï¼‰\n- ã¡ã‚‡ã£ã¨ãƒ“ãƒ¼ãƒ«**ã§ã‚‚**é£²ã¿ã¾ã›ã‚“ã‹ã€‚\n## è¡¨æ ¼å½’çº³\n### æŒ‡ç¤ºä»£è¯ä¸€è§ˆè¡¨ï¼ˆ3.5ï¼‰\n\n>ã€Œã“ã€ç”¨äºç¦»è¯´è¯äººè¿‘\n>ã€Œãã€ç”¨äºç¦»å¬è¯äººè¿‘\n>ã€Œã‚ã€ç”¨äºé‡Œè¯´è¯äººå’Œå¬è¯äººéƒ½æ¯”è¾ƒè¿œ\n>ã€Œã©ã€ç”¨äºç–‘é—®\n\n||ã“ç³»åˆ—|ãç³»åˆ—|ã‚ç³»åˆ—|ã©ç³»åˆ—|\n|-|-|-|-|-|\nç‰©ä½“|ã“ã‚Œ|ãã‚Œ|ã‚ã‚Œ|ã©ã‚Œ|\nç‰©ã€äºº|ã“ã®åè¯|ãã®åè¯|ã‚ã®åè¯|ã©ã®åè¯|\nåœºæ‰€|ã“ã“|ãã“|ã‚ãã“|ã©ã“|\næ–¹å‘ã€åœºæ‰€ï¼ˆéƒ‘é‡ï¼‰|ã“ã¡ã‚‰|ãã¡ã‚‰|ã‚ã¡ã“|ã©ã¡ã‚‰|\n### ã¾ã™å½¢æ—¶æ€ï¼ˆ4.2ï¼‰\n\n> ã¾ã™å½¢ç”¨äºå™è¿°ç°åœ¨çš„ä¹ æƒ¯ã€çœŸç†æˆ–å°†æ¥ä¼šå‘ç”Ÿçš„äº‹æƒ…ã€è¡ŒåŠ¨\n\n||éè¿‡å»ï¼ˆç°åœ¨ã€æœªæ¥ï¼‰|è¿‡å»|\n|-|-|-|\n|è‚¯å®š|èµ·ãã¾ã™|èµ·ãã¾ã—ãŸ\n|å¦å®š|èµ·ãã¾ã›ã‚“|èµ·ãã¾ã›ã‚“ã§ã—ãŸ\n### å‰¯è¯ï¼ˆ9.3ï¼‰\n{% raw %}\n<table>\n<tr>\n  <th></th>\n  <th colspan=\"2\">è¡¨ç¤ºç¨‹åº¦çš„å‰¯è¯</th>\n  <th colspan=\"2\">è¡¨ç¤ºæ•°é‡çš„å‰¯è¯</th>\n</tr>\n<tr>\n  <td rowspan=\"3\">å’Œè‚¯å®šå½¢ä¸€èµ·ä½¿ç”¨</td>\n  <td>ã‚ˆã</td>\n<td rowspan=\"3\">ã‚ã‹ã‚Šã¾ã™</td>\n<td>ãŸãã•ã‚“</td>\n<td rowspan=\"3\">ã‚ã‚Šã¾ã™</td>\n</tr>\n<tr>\n  <td>ã ã„ãŸã„</td>\n<td>å°‘ã—</td>\n</tr>\n<tr>\n  <td>å°‘ã—</td>\n</tr>\n<tr>\n  <td rowspan=\"2\">å’Œå¦å®šå½¢ä¸€èµ·ä½¿ç”¨</td>\n  <td>ã‚ã¾ã‚Š</td>\n<td rowspan=\"2\">ã‚ã‹ã‚Šã¾ã›ã‚“</td>\n<td>ã‚ã¾ã‚Š</td>\n<td rowspan=\"2\">ã‚ã‚Šã¾ã›ã‚“</td>\n</tr>\n<tr>\n  <td>å…¨ç„¶</td>\n<td>å…¨ç„¶</td>\n</tr>\n</table>\n{% endraw %}\n\n### åè¯å¥ã€ãªå½¢å®¹è¯å¥æ—¶æ€ï¼ˆ12.1ï¼‰\n{% raw %}\n<table>\n<tr>\n  <th></th>\n  <th colspan=\"3\">éè¿‡å»ï¼ˆç°åœ¨ã€æœªæ¥ï¼‰</th>\n  <th colspan=\"3\">è¿‡å»</th>\n</tr>\n<tr>\n  <td rowspan=\"2\">è‚¯å®š</td>\n  <td>åè¯</td>\n<td>é›¨</td>\n<td rowspan=\"2\">ã§ã™</td>\n<td>åè¯</td>\n<td>é›¨</td>\n<td rowspan=\"2\">ã§ã—ãŸ</td>\n</tr>\n<tr>\n  <td>ãªå½¢å®¹è¯</td>\n<td>é™ã‹</td>\n<td>ãªå½¢å®¹è¯</td>\n<td>é™ã‹</td>\n</tr>\n<tr>\n  <td rowspan=\"2\">å¦å®š</td>\n  <td>åè¯</td>\n<td>é›¨</td>\n<td rowspan=\"2\">ã˜ã‚ƒï¼ˆã§ã¯ï¼‰ã‚ã‚Šã¾ã›ã‚“</td>\n<td>åè¯</td>\n<td>é›¨</td>\n<td rowspan=\"2\">ã˜ã‚ƒï¼ˆã§ã¯ï¼‰ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸ</td>\n</tr>\n<tr>\n  <td>ãªå½¢å®¹è¯</td>\n<td>é™ã‹</td>\n<td>ãªå½¢å®¹è¯</td>\n<td>é™ã‹</td>\n</tr>\n</table>\n{% endraw %}\n\n### ã„å½¢å®¹è¯å¥æ—¶æ€ï¼ˆ12.2ï¼‰\n||éè¿‡å»ï¼ˆç°åœ¨ã€æœªæ¥ï¼‰|è¿‡å»|\n|-|-|-|\n|è‚¯å®š|æš‘ã„ã§ã™|æš‘ã‹ã£ãŸã§ã™|\n|å¦å®š|æš‘ããªã„ã§ã™|æš‘ããªã‹ã£ãŸã§ã™|\n\n## åŠ¨è¯å½’çº³\n### åŠ¨è¯ã¦å½¢\n**åŠ¨è¯ã¦å½¢ ãã ã•ã„**    è¯·Â·Â·Â·Â·Â·Â·ï¼ˆ14.3ï¼‰\nç”¨äºæŒ‡ç¤ºã€å§”æ‰˜æˆ–åŠè¯±å¯¹æ–¹åšæŸä»¶äº‹æƒ…\n- ãƒœãƒ¼ãƒ«ãƒšãƒ³ã§åå‰ã‚’æ›¸ã„ã¦ã„ãã¾ã™ã€‚\n\n**åŠ¨è¯ã¦å½¢ ã„ã¾ã™**ï¼ˆ14.4ï¼‰\nè¡¨ç¤ºæŸä¸€åŠ¨ä½œæ­£åœ¨è¿›è¡Œ\n- ã„ã¾ã‚ã‚ãŒãµã£ã¦ã„ã¾ã™ã‹ã€‚\n\n**åŠ¨è¯ã¦å½¢ã‚‚ ã„ã„ã§ã™ã‹**    å¯ä»¥Â·Â·Â·Â·Â·Â·å—ï¼Ÿï¼ˆ15.1ï¼‰\nå¸Œæœ›å¾—åˆ°è®¸å¯æ—¶çš„è¡¨è¾¾æ–¹å¼\nå†™çœŸã‚’æ’®ã£ã¦ã‚‚ã„ã„ã§ã™ã‹ã€‚\n\n**åŠ¨è¯ã¦å½¢ã¯ ã„ã‘ã¾ã›ã‚“**    ä¸å‡†Â·Â·Â·Â·Â·Â·ï¼ˆ15.2ï¼‰\nè¡¨ç¤ºç¦æ­¢\nã“ã“ã§ã‚¿ãƒã‚³ã‚’å¸ã£ã¦ã¯ã„ã‘ã¾ã›ã‚“ã€‚\n\n**åŠ¨è¯ã¦å½¢ ã„ã¾ã™**ï¼ˆ15.3ï¼‰\nè¡¨ç¤ºçŠ¶æ€\n- ç§ã¯çµå©šã—ã¦ã„ã¾ã™ã€‚\n\nè¡¨ç¤ºä¹ æƒ¯æ€§çš„è¡Œä¸ºã€èŒä¸šä»¥åŠèº«ä»½\n- ç§ã¯å¤§å­¦ã§å‹‰å¼·ã—ã¦ã„ã¾ã™ã€‚\n\n**åŠ¨è¯1ã¦å½¢ã‹ã‚‰ã€åŠ¨è¯2**ï¼ˆ16.2ï¼‰\nè¡¨ç¤ºåŠ¨è¯2æ˜¯åœ¨åŠ¨è¯1ä¹‹åè¿›è¡Œçš„åŠ¨ä½œï¼Œæ•´ä¸ªå¥å­çš„æ—¶æ€æ ¹æ®æœ€åä¸€ä¸ªåŠ¨è¯çš„æ—¶æ€è€Œå®š\nãŠé‡‘ã‚’å…¥ã‚Œã¦ã‹ã‚‰ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚\n\n### åŠ¨è¯ãªã„å½¢\n**åŠ¨è¯ãªã„å½¢ãªã„ã§ ãã ã•ã„**    è¯·ä¸è¦ï¼ˆ17.2ï¼‰\nç”¨äºè¯·æ±‚ã€å‘½ä»¤å¯¹æ–¹ä¸è¦åšæŸäº‹\n- ã“ã“ã§å†™çœŸã‚’æ’®ã‚‰ãªã„ã§ãã ã•ã„ã€‚\n\n**åŠ¨è¯ãªã„å½¢ãªã‘ã‚Œã° ãªã‚Šã¾ã›ã‚“**    å¿…é¡»Â·Â·Â·Â·Â·Â·ï¼ˆ17.3ï¼‰\nè¡¨ç¤ºå¿…é¡»è¦åšçš„äº‹æƒ…\n- è–¬ã‚’é£²ã¾ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚\n\n**åŠ¨è¯ãªã„å½¢ãªãã¦ã‚‚ ã„ã„ã§ã™**    ä¸Â·Â·Â·Â·Â·Â·ä¹Ÿè¡Œï¼ˆ17.4ï¼‰\nè¡¨ç¤ºæ²¡æœ‰å¿…è¦åšæŸäº‹\n- æ˜æ—¥æ¥ãªãã¦ã‚‚ã„ã„ã§ã™ã€‚\n### åŠ¨è¯è¾æ›¸å½¢\n**åŠ¨è¯è¾æ›¸å½¢ã“ã¨/åè¯ ãŒã§ãã¾ã™**    èƒ½Â·Â·Â·Â·Â·Â·ã€ä¼šÂ·Â·Â·Â·Â·Â·ï¼ˆ18.2ï¼‰\nè¡¨ç¤ºæŸäººæœ‰èƒ½åŠ›åšæŸäº‹ï¼Œæˆ–æŸç§æƒ…å†µä¸‹å¯ä»¥è¿›è¡ŒæŸç§è¡Œä¸º\n- ç§ã¯æ¼¢å­—ã‚’èª­ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚\n- ç§ã¯æ—¥æœ¬èªãŒã§ãã¾ã™ã€‚\n\n**ç§ã®è¶£å‘³ã¯ åŠ¨è¯è¾æ›¸å½¢ã“ã¨/åè¯ ã§ã™**    æˆ‘çš„çˆ±å¥½æ˜¯Â·Â·Â·Â·Â·Â·ï¼ˆ18.3ï¼‰\n- ç§ã®è¶£å‘³ã¯éŸ³æ¥½ã‚’èãã“ã¨ã§ã™ã€‚\n- ç§ã®è¶£å‘³ã¯éŸ³æ¥½ã§ã™ã€‚\n\n**åŠ¨è¯1è¾æ›¸å½¢/åè¯ã®/æ•°é‡è¯ï¼ˆæœŸé—´ï¼‰ å‰ã«ã€åŠ¨è¯2**    Â·Â·Â·Â·Â·Â·ä¹‹å‰Â·Â·Â·Â·Â·Â·ï¼ˆ18.4ï¼‰\n- æ—¥æœ¬ã¸æ¥ã‚‹å‰ã«ã€æ—¥æœ¬èªã‚’å‹‰å¼·ã—ã¾ã—ãŸã€‚\n- é£Ÿäº‹ã®å‰ã«ã€æ‰‹ã‚’æ´—ã„ã¾ã™ã€‚\n- ç”°ä¸­ã•ã‚“ã¯1æ™‚é–“å‰ã«ã€å‡ºã‹ã‘ã¾ã—ãŸã€‚\n### åŠ¨è¯ãŸå½¢\n**åŠ¨è¯ãŸå½¢ ã“ã¨ãŒ ã‚ã‚Šã¾ã™**    åšè¿‡Â·Â·Â·Â·Â·Â·ï¼ˆ19.2ï¼‰\nè®²è¿°è¿‡å»ç»å†ã€ä½“éªŒè¿‡çš„äº‹æƒ…ï¼Œå¦‚æœä»…å•çº¯è®²è¿°è¿‡å»æŸä¸ªæ—¶é—´åšäº†æŸä»¶äº‹è¿™ä¸€äº‹å®éœ€è¦ä½¿ç”¨è¿‡å»å¼\n- é¦¬ã«ä¹—ã£ãŸã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚\n\n**åŠ¨è¯1ãŸå½¢ã‚Šã€åŠ¨è¯2ãŸå½¢ã‚Š ã—ã¾ã™**    åˆÂ·Â·Â·Â·Â·Â·åˆÂ·Â·Â·Â·Â·Â·ï¼ˆ19.3ï¼‰\né€‰æ‹©å‡ ä¸ªå…·æœ‰ä»£è¡¨æ€§çš„åŠ¨ä½œåŠ ä»¥åˆ—ä¸¾ï¼Œæ•´å¥è¯çš„æ—¶æ€åœ¨å¥æœ«è¡¨ç¤º\n- æ—¥æ›œæ—¥ã¯ãƒ†ãƒ‹ã‚¹ã‚’ã—ãŸã‚Šã€æ˜ ç”»ã‚’è¦‹ãŸã‚Šã—ã¾ã™ã€‚\n### æ™®é€šå½¢\n**æ™®é€šå½¢ã¨æ€ã„ã¾ã™**    æˆ‘æƒ³Â·Â·Â·Â·Â·Â·ï¼ˆ21.1ï¼‰\nè¡¨ç¤ºæ¨æµ‹æˆ–é˜è¿°æ„è§\n- æ˜æ—¥é›¨ãŒé™ã‚‹ã¨æ€ã„ã¾ã™ã€‚\n\n**å¥å­/æ™®é€šå½¢ã¨è¨€ã„ã¾ã™**    è¯´Â·Â·Â·Â·Â·Â·ï¼ˆ21.2ï¼‰\nç›´æ¥å¼•ç”¨æ—¶ï¼Œç›´æ¥å°†å¼•ç”¨çš„è¯æ”¾å…¥ã€Œã€ä¸­\n- å¯ã‚‹å‰ã«ã€ã€ŒãŠã‚„ã™ã¿ãªã•ã„ã€ã¨è¨€ã„ã¾ã™ã€‚\n\né—´æ¥å¼•ç”¨æ—¶ï¼Œåœ¨ã¨çš„å‰é¢ä½¿ç”¨æ™®é€šå½¢\n- ãƒŸãƒ©ãƒ¼ã•ã‚“ã¯æ±äº¬ã¸å‡ºå¼µã™ã‚‹ã¨è¨€ã„ã¾ã—ãŸã€‚\n\n**åŠ¨è¯/å½¢å®¹è¯/åè¯ æ™®é€šå½¢ ã§ã—ã‚‡ã†ï¼Ÿ**    Â·Â·Â·Â·Â·Â·å§ï¼Ÿï¼ˆ21.3ï¼‰\nåœ¨æ¬²æ±‚å¾—å¬è¯äººåŒæ„ã€è¿›è¡Œè¯¢é—®æˆ–ç¡®è®¤æ—¶ä½¿ç”¨\n\n> å¦‚æœæ¥ç»­ãªå½¢å®¹è¯å’Œåè¯æ—¶ï¼Œè¦ä½¿ç”¨å»æ‰ã€Œ~ã ã€çš„å½¢å¼\n\n- æ˜æ—¥ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã«è¡Œãã§ã—ã‚‡ã†ï¼Ÿ\n","tags":["æ—¥è¯­"],"categories":["è®¡è½¯æ‚è°ˆ","å­¦ä¹ ç¬”è®°"]},{"title":"ä¸åŒç‰ˆæœ¬Javaå¯¹äºMinecraftæœåŠ¡ç«¯spigotç«¯çš„æ€§èƒ½å½±å“","url":"/20220702/minecraft-server-comparison/","content":"ä¼—æ‰€å‘¨çŸ¥ï¼ŒBugjumpåœ¨MCé«˜ç‰ˆæœ¬ä¸‹çš„ä¼˜åŒ–ç¨€çƒ‚ï¼Œå¦‚æ­¤è¾£é¸¡çš„ä¼˜åŒ–å¯¹äºæƒ³è¦å¼€æœä½†æ‰‹å¤´ä¸Šå´åªæœ‰1c2gæˆ–æ˜¯2c4gæ¸£æœºçš„æœä¸»æ¥è¯´æ˜¯ä¸€ä¸ªéå¸¸å¤§çš„è´Ÿæ‹…ã€‚\nå¯¹äºspigotï¼Œpaperç­‰éåŸç‰ˆç«¯çš„ä¼˜åŒ–MCBBSä¸Šå·²ç»æœ‰éå¸¸å¤šçš„å¸–å­ï¼Œä¼˜åŒ–çš„æ–¹å¼åŸºæœ¬ä¸Šå¯ä»¥åˆ†ä¸ºä¸‰ç±»ï¼š\n- ä¿®æ”¹bukkit.ymlã€spigot.ymlå’Œpaper.ymlç­‰é…ç½®\n- å¢åŠ åŒºå—å¸è½½å’Œæ¸…ç†æ‰è½ç‰©ç­‰ä¼˜åŒ–æ’ä»¶\n- ä¿®æ”¹Javaå¯åŠ¨å‚æ•°å’ŒJavaç‰ˆæœ¬\n\nä½†å®é™…ä¸Šï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶äº§ç”Ÿçš„æ•ˆæœå¹¶ä¸æ˜æ˜¾ï¼Œä¸”è¿‡åˆ†çš„ä¿®æ”¹å‚æ•°ä¼šå¯¹æ¸¸æˆä½“éªŒäº§ç”Ÿå½±å“ã€‚è€Œæœ‰å…³åŒºå—å¸è½½ã€æ¸…ç†æ‰è½ç‰©ã€ç”Ÿç‰©é™åˆ¶ç­‰ä¼˜åŒ–æ’ä»¶åœ¨é«˜ç‰ˆæœ¬ä¸‹å¯ä»¥è¯´æ˜¯å‡ ä¹æ²¡æœ‰ã€‚\nJavaå¯åŠ¨å‚æ•°å…¶å®å¯¹äºæœåŠ¡å™¨æ¥è¯´éå¸¸é‡è¦ï¼Œä½†ç½‘ç»œä¸Šå¯¹äºå¯åŠ¨å‚æ•°ç½‘ä¸Šçš„è¯´æ³•ä¼—è¯´çº·çº­ã€‚æœ¬äººä¼šåœ¨æœªæ¥å¯¹ä¸åŒçš„å‚æ•°è¿›è¡Œæµ‹è¯•ï¼Œæ•¬è¯·æœŸå¾…ã€‚\næœ¬æ–‡é€šè¿‡ä¸‰ä¸ªæµ‹è¯•æ¥ç²—ç•¥åœ°æ¢ç©¶ä¸€ä¸‹Java8å’ŒJava11ä¸‹Hotspotå’ŒOpenj9è™šæ‹Ÿæœºå¯¹äºMinecrafté«˜ç‰ˆæœ¬æœåŠ¡ç«¯spigotç«¯çš„æ€§èƒ½å½±å“\næœ¬æ¬¡æµ‹è¯•é‡‡ç”¨çš„Minecraftç‰ˆæœ¬ä¸º1.16.5ï¼Œæ‰€ä»¥å¹¶ä¸æ”¯æŒJava17\nSpigotç‰ˆæœ¬ä¸º3096a-Spigot-9fb885e-af1a232\nJavaå¯åŠ¨å‚æ•°é‡‡ç”¨æœ€ç®€å•çš„è®¾ç½®æ–¹å¼ï¼Œä»…ä»…è®¾ç½®åˆå§‹å †å’Œæœ€å¤§å †çš„å¤§å°\n```bash\njava -Xmx2G -Xms1G -jar spigot-1.16.5.jar nogui\n```\nJavaé€‰ç”¨ä»¥ä¸‹å››ä¸ªç‰ˆæœ¬ï¼š\n- Openj9 jre8\n```text\nopenjdk version \"1.8.0_322\"\nIBM Semeru Runtime Open Edition (build 1.8.0_322-b06)\nEclipse OpenJ9 VM (build openj9-0.30.0, JRE 1.8.0 Linux amd64-64-Bit Compressed References 20220128_306 (JIT enabled, AOT enabled)\nOpenJ9   - 9dccbe076\nOMR      - dac962a28\nJCL      - c1d9a7af7c based on jdk8u322-b06)\n```\n- Hotspot jre8\n```text\nopenjdk version \"1.8.0_312\"\nOpenJDK Runtime Environment (build 1.8.0_312-8u312-b07-0ubuntu1~20.04-b07)\nOpenJDK 64-Bit Server VM (build 25.312-b07, mixed mode)\n```\n- Openj9 jre11\n```text\nopenjdk version \"11.0.10\" 2021-01-19\nOpenJDK Runtime Environment AdoptOpenJDK (build 11.0.10+9)\nEclipse OpenJ9 VM AdoptOpenJDK (build openj9-0.24.0, JRE 11 Linux amd64-64-Bit 20210120_821 (JIT enabled, AOT enabled)\nOpenJ9   - 345e1b09e\nOMR      - 741e94ea8\nJCL      - 0a86953833 based on jdk-11.0.10+9\n```\n- Hotspot jre11\n```text\nopenjdk version \"11.0.15\" 2022-04-19\nOpenJDK Runtime Environment Temurin-11.0.15+10 (build 11.0.15+10)\nOpenJDK 64-Bit Server VM Temurin-11.0.15+10 (build 11.0.15+10, mixed mode\n```\nåœ°å›¾ç§å­ï¼š1145141919810\nå¼€æœç³»ç»Ÿï¼šUbuntu20.04\næœåŠ¡å™¨é…ç½®ï¼šè…¾è®¯äº‘2c4g6m\næµ‹è¯•åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š**æ— æ’ä»¶å¼€æœæµ‹è¯•**ï¼Œ**è·‘å›¾æµ‹è¯•**å’Œ**å¤šæ’ä»¶å¼€æœæµ‹è¯•**\n## æ— æ’ä»¶å¼€æœæµ‹è¯•\nè¯´æ˜¯æ— æ’ä»¶å®é™…ä¸Šè¿˜æ˜¯å­˜åœ¨ä¸€ä¸ªæ’ä»¶ï¼šEssentialsX-2.19.0ï¼Œè¯¥æ’ä»¶ä»…ä»…ç”¨äºè¿è¡Œ/gcå‘½ä»¤è·å¾—tpså’ŒAllocated memory\næµ‹è¯•æ–¹æ³•ï¼šåœ¨å­˜æ¡£å·²ç»ç”Ÿæˆåä½¿ç”¨å››ä¸ªä¸åŒçš„Javaç‰ˆæœ¬å¯åŠ¨mcæœåŠ¡å™¨ï¼Œä½¿ç”¨è…¾è®¯äº‘ç›‘æ§é¢æ¿è·å¾—CPUå’Œå†…å­˜å ç”¨æƒ…å†µï¼ŒåŒæ—¶ä½¿ç”¨/gcå‘½ä»¤è·å¾—tpså’Œæ¸¸æˆå†…Allocated memory\n\n> åœ¨æµ‹è¯•çš„è¿‡ç¨‹ä¸­ä¸è¿è¡Œå…¶ä»–ç¨‹åºï¼Œæ­¤æ—¶è…¾è®¯äº‘ç›‘æ§é¢æ¿çš„æ•°æ®å¯ä»¥è¿‘ä¼¼ä¸ºmcæœåŠ¡å™¨ç‹¬å \n\n### CPUå ç”¨ç‡\n{% echarts 95% 400 5.4.3 %}\n{\n  title: {\n    text: 'CPUå ç”¨ç‡'\n  },\n  tooltip: {\n    trigger: 'axis'\n  },\n  legend: {\n    data: ['Openj9 jre8', 'Hotspot jre8', 'Openj9 jre11', 'Hotspot jre11']\n  },\n  grid: {\n    left: '3%',\n    right: '4%',\n    bottom: '3%',\n    containLabel: true\n  },\n  toolbox: {\n    feature: {\n      saveAsImage: {}\n    }\n  },\n  xAxis: {\n    type: 'category',\n    boundaryGap: false,\n    data: ['0s', '10s', '20s', '30s', '40s', '50s', '1min','1min10s','1min20s','1min30s','1min40s','1min50s','2min','2min10s','2min20s','2min30s','2min40s','2min50s','3min',\n          '3min10s','3min20s','3min30s','3min40s','3min50s','4min','4min10s','4min20s','4min30s','4min40s','4min50s','5min']\n  },\n  yAxis: {\n    type: 'value'\n  },\n  series: [\n    {\n      showSymbol: false,\n      name: 'Openj9 jre8',\n      type: 'line',\n      data: [0.9, 10.4, 95.4, 99.5, 99.9, 99.9, 99.9,99.9,99.8,99.7,99.8,99.8,77.6,70.1,66.8,71.1,65,49.1,11.1,10.5,8.6,8.7,9.1,7.8,12.2,9.2,14,8.4,10.4,9.9,9.5,7.9,10.8,7.6,10.7,9.8,8.4,9.7,8.4,48.5,27.2,7.9,9.4,9.9,11.6,10.,8.1,9.4,10,8.6,9,6.9,8.4]\n    },\n    {\n      showSymbol: false,\n      name: 'Hotspot jre8',\n      type: 'line',\n      data: [0.8,30.9,99.2,98.1,99.5,99.6,99.7,88.8,76,73.7,65.6,70,62.3,12.6,9.1,9.3,10.4,10.3,11.1,8.6,8.6,9.4,9.3,8.3,9.5,8.4,7.9,7.5,7.7,12,7.9,8,8,9.4,11.3]\n    },\n    {\n      showSymbol: false,\n      name: 'Openj9 jre11',\n      type: 'line',\n      data: [0.6,66.6,99.5,99.6,99.9,99.9,99.8,99.7,99.7,99.7,99.6,95.1,67.8,72.8,67.5,65.6,67.2,63.1,62.8,25.1,10.1,14.1,8.9,9.6,9.6,8.3,7.8,10.9,15.2,7.6,8.7,10.2,8.3,9.8,19.3]\n    },\n    {\n      showSymbol: false,\n      name: 'Hotspot jre11',\n      type: 'line',\n      data: [1.2,11.4,94.6,89.9,99.5,99.6,99.6,99.6,83.1,74.2,73.3,66,66.2,45,14,14.7,11.4,11.1,13,9.1,11.9,7.3,10,8.8,7.8,9.3,8.2,7.8,8.3,10.6,9.3,9.2,8.6,8.6,8.8,12.6]\n    }\n  ]\n};\n{% endecharts %}\néå¸¸æ˜æ˜¾ï¼ŒHotspotç›¸æ¯”äºOpenj9æ¥è¯´CPUå ç”¨ç‡æ›´ä½ï¼Œè¿™ä¹Ÿååº”åœ¨äº†å¼€æœæ—¶é—´ä¸Šï¼šHotspotå¼€æœå‡åœ¨30-40så·¦å³ï¼Œè€ŒOpenj9å¼€æœæ—¶é—´å‡åœ¨60sä»¥ä¸Šã€‚\næ¨ªå‘å¯¹æ¯”Java8å’ŒJava11ï¼Œåœ¨è™šæ‹Ÿæœºç›¸åŒçš„æƒ…å†µä¸‹ä¸¤è€…å·®è·å¹¶ä¸æ˜æ˜¾ï¼Œä½†è¿˜æ˜¯å¯ä»¥çœ‹å‡º11æ¯”8å ç”¨ç‡è¦é«˜ä¸€äº›ã€‚\n### å†…å­˜å ç”¨\n{% echarts 95% 400 5.4.3 %}\n{\n  title: {\n    text: \"å†…å­˜å ç”¨\"\n  },\n  tooltip: {\n    trigger: \"axis\"\n  },\n  legend: {\n    data: [\"Openj9 jre8\", \"Hotspot jre8\", \"Openj9 jre11\", \"Hotspot jre11\"]\n  },\n  grid: {\n    left: \"3%\",\n    right: \"4%\",\n    bottom: \"3%\",\n    containLabel: true\n  },\n  toolbox: {\n    feature: {\n      saveAsImage: {}\n    }\n  },\n  xAxis: {\n    type: \"category\",\n    boundaryGap: false,\n    data: [\n      \"0s\",\n      \"10s\",\n      \"20s\",\n      \"30s\",\n      \"40s\",\n      \"50s\",\n      \"1min\",\n      \"1min10s\",\n      \"1min20s\",\n      \"1min30s\",\n      \"1min40s\",\n      \"1min50s\",\n      \"2min\",\n      \"2min10s\",\n      \"2min20s\",\n      \"2min30s\",\n      \"2min40s\",\n      \"2min50s\",\n      \"3min\",\n      \"3min10s\",\n      \"3min20s\",\n      \"3min30s\",\n      \"3min40s\",\n      \"3min50s\",\n      \"4min\",\n      \"4min10s\",\n      \"4min20s\",\n      \"4min30s\",\n      \"4min40s\",\n      \"4min50s\",\n      \"5min\"\n    ]\n  },\n  yAxis: {\n    type: \"value\",\n    scale:true\n  },\n  series: [\n    {\n      showSymbol: false,\n      name: \"Openj9 jre8\",\n      type: \"line\",\n      data: [\n        475,\n        475,\n        993,\n        1190,\n        1325,\n        1465,\n        1352,\n        1358,\n        1369,\n        1441,\n        1461,\n        1465,\n        1465,\n        1454,\n        1459,\n        1469,\n        1477,\n        1470,\n        1470,\n        1470,\n        1471,\n        1469,\n        1470,\n        1469,\n        1473,\n        1470,\n        1485,\n        1470,\n        1469,\n        1478,\n        1469,\n        1470,\n        1470,\n        1469,\n        1468,\n        1468,\n        1468,\n        1469,\n        1468,\n        1496,\n        1474,\n        1473,\n        1474,\n        1474\n      ]\n    },\n    {\n      showSymbol: false,\n      name: \"Hotspot jre8\",\n      type: \"line\",\n      data: [\n        474,\n        529,\n        1155,\n        1469,\n        1599,\n        1596,\n        1636,\n        1680,\n        1732,\n        1723,\n        1733,\n        1751,\n        1758,\n        1763,\n        1763,\n        1763,\n        1764,\n        1764,\n        1765,\n        1765,\n        1765,\n        1765,\n        1765,\n        1766,\n        1766,\n        1766,\n        1765,\n        1766,\n        1766,\n        1766,\n        1768,\n        1768,\n        1768,\n        1768,\n        1768,\n        1768,\n        1768,\n        1769,\n        1770,\n        1771,\n        1771,\n        1770,\n        1771,\n        1770,\n        1770,\n        1770,\n        1771,\n        1771,\n        1771,\n        1771,\n        1772\n      ]\n    },\n    {\n      showSymbol: false,\n      name: \"Openj9 jre11\",\n      type: \"line\",\n      data: [\n        473,\n        857,\n        1253,\n        1444,\n        1470,\n        1734,\n        1496,\n        1551,\n        1610,\n        1694,\n        1666,\n        1671,\n        1659,\n        1672,\n        1653,\n        1657,\n        1665,\n        1681,\n        1678,\n        1680,\n        1680,\n        1680,\n        1680,\n        1679,\n        1679,\n        1681,\n        1681,\n        1681,\n        1726,\n        1678,\n        1677,\n        1677,\n        1677,\n        1679,\n        1677,\n        1677,\n        1678,\n        1681,\n        1683,\n        1683,\n        1684,\n        1684,\n        1684,\n        1686,\n        1684\n      ]\n    },\n    {\n      showSymbol: false,\n      name: \"Hotspot jre11\",\n      type: \"line\",\n      data: [\n        474,\n        474,\n        811,\n        1442,\n        1688,\n        1782,\n        1916,\n        1919,\n        1951,\n        1994,\n        1995,\n        1996,\n        1999,\n        2011,\n        2012,\n        2013,\n        2012,\n        2013,\n        2013,\n        2013,\n        2014,\n        2013,\n        2013,\n        2014,\n        2014,\n        2014,\n        2015,\n        2015,\n        2013,\n        2014,\n        2014,\n        2014,\n        2014,\n        2014,\n        2015,\n        2015,\n        2019,\n        2019,\n        2021,\n        2022,\n        2022,\n        2022,\n        2022,\n        2021,\n        2022\n      ]\n    }\n  ]\n};\n{% endecharts %}\néå¸¸æ˜æ˜¾ï¼ŒOpenj9åœ¨å†…å­˜ä¸Šå®Œçˆ†Hotspotï¼Œè¿™ä¹Ÿç¬¦åˆOpenj9çš„å®šä½ï¼šä»¥ç‰ºç‰²ä¸€éƒ¨åˆ†æ€§èƒ½çš„å‰æä¸‹æå¤§é™ä½å†…å­˜å ç”¨ç‡ã€‚\næ­¤å¤–ç›¸åŒè™šæ‹Ÿæœºä¸‹11å†…å­˜å ç”¨ç‡è¦æ¯”8è¦é«˜å‡ºè®¸å¤šã€‚\n### TPS\n{% echarts 95% 400 5.4.3 %}\n{\n  title: {\n    text: \"TPS\"\n  },\n  tooltip: {\n    trigger: \"axis\"\n  },\n  legend: {\n    data: [\"Openj9 jre8\", \"Hotspot jre8\", \"Openj9 jre11\", \"Hotspot jre11\"]\n  },\n  grid: {\n    left: \"3%\",\n    right: \"4%\",\n    bottom: \"3%\",\n    containLabel: true\n  },\n  toolbox: {\n    feature: {\n      saveAsImage: {}\n    }\n  },\n  xAxis: {\n    type: \"category\",\n    boundaryGap: false,\n    data: [\n      \"0s\",\n      \"5s\",\n      \"10s\",\n      \"15s\",\n      \"20s\",\n      \"25s\",\n      \"30s\",\n      \"35s\",\n      \"40s\",\n      \"45s\",\n      \"50s\",\n      \"55s\",\n      \"1min\",\n      \"1min5s\",\n      \"1min10s\",\n      \"1min15s\",\n      \"1min20s\",\n      \"1min25s\",\n      \"1min30s\",\n      \"1min35s\",\n      \"1min40s\",\n      \"1min45s\",\n      \"1min50s\",\n      \"1min55s\",\n      \"2min\",\n      \"2min5s\",\n      \"2min10s\",\n      \"2min15s\",\n      \"2min20s\",\n      \"2min25s\",\n      \"2min30s\",\n      \"2min35s\",\n      \"2min40s\",\n      \"2min45s\",\n      \"2min50s\",\n      \"2min55s\",\n      \"3min\",\n      \"3min5s\",\n      \"3min10s\",\n      \"3min15s\",\n      \"3min20s\",\n      \"3min25s\",\n      \"3min30s\",\n      \"3min35s\",\n      \"3min40s\",\n      \"3min45s\",\n      \"3min50s\",\n      \"3min55s\",\n      \"4min\"]\n  },\n  yAxis: {\n    type: \"value\",\n    scale:true\n  },\n  series: [\n    {\n      showSymbol: false,\n      name: \"Openj9 jre8\",\n      type: \"line\",\n      data: [null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,20,20,20,20,20,20,20,20,20,20,20,13.66,16.2,16.83,17.89,18.1,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20]\n    },\n    {\n      showSymbol: false,\n      name: \"Hotspot jre8\",\n      type: \"line\",\n      data: [null,null,null,null,null,null,null,null,null,null,null,null,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,16.83,17.62,18.1,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20]\n    },\n    {\n      showSymbol: false,\n      name: \"Openj9 jre11\",\n      type: \"line\",\n      data: [null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,20,20,20,20,20,20,20,20,20,20,20,16.83,17.62,18.27,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20]\n    },\n    {\n      showSymbol: false,\n      name: \"Hotspot jre11\",\n      type: \"line\",\n      data: [null,null,null,null,null,null,null,null,null,null,null,null,20,20,20,20,20,20,20,20,20,20,20,15.25,16.83,17.62,18.1,18.27,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20]\n    },\n  ]\n};\n{% endecharts %}\nå¯¹äºTPSï¼Œå››ä¸ªä¸åŒç‰ˆæœ¬å‡åœ¨å¼€æœåˆæœŸå‘ç”Ÿäº†æ˜æ˜¾çš„ä¸‹é™ï¼Œä½†éƒ½èƒ½ä»¥å‡ ä¹ç›¸åŒçš„é€Ÿåº¦æ¢å¤ã€‚\n### Allocated memory\n{% echarts 95% 400 5.4.3 %}\n{\n  title: {\n    text: \"Allocated memory\"\n  },\n  tooltip: {\n    trigger: \"axis\"\n  },\n  legend: {\n    data: [\"Openj9 jre8\", \"Hotspot jre8\", \"Openj9 jre11\", \"Hotspot jre11\"]\n  },\n  grid: {\n    left: \"3%\",\n    right: \"4%\",\n    bottom: \"3%\",\n    containLabel: true\n  },\n  toolbox: {\n    feature: {\n      saveAsImage: {}\n    }\n  },\n  xAxis: {\n    type: \"category\",\n    boundaryGap: false,\n    data: [\n      \"0s\",\n      \"5s\",\n      \"10s\",\n      \"15s\",\n      \"20s\",\n      \"25s\",\n      \"30s\",\n      \"35s\",\n      \"40s\",\n      \"45s\",\n      \"50s\",\n      \"55s\",\n      \"1min\",\n      \"1min5s\",\n      \"1min10s\",\n      \"1min15s\",\n      \"1min20s\",\n      \"1min25s\",\n      \"1min30s\",\n      \"1min35s\",\n      \"1min40s\",\n      \"1min45s\",\n      \"1min50s\",\n      \"1min55s\",\n      \"2min\",\n      \"2min5s\",\n      \"2min10s\",\n      \"2min15s\",\n      \"2min20s\",\n      \"2min25s\",\n      \"2min30s\",\n      \"2min35s\",\n      \"2min40s\",\n      \"2min45s\",\n      \"2min50s\",\n      \"2min55s\",\n      \"3min\",\n      \"3min5s\",\n      \"3min10s\",\n      \"3min15s\",\n      \"3min20s\",\n      \"3min25s\",\n      \"3min30s\",\n      \"3min35s\",\n      \"3min40s\",\n      \"3min45s\",\n      \"3min50s\",\n      \"3min55s\",\n      \"4min\"]\n  },\n  yAxis: {\n    type: \"value\",\n    scale:true\n  },\n  series: [\n    {\n      showSymbol: false,\n      name: \"Openj9 jre8\",\n      type: \"line\",\n      data: [null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1280,1280,1280,1280,1280,1280,1280,1280,1280,1280,1280,1280,1280,1280,1280,1280,1280,1280,1280,1280,1280,1280,1280,1280,1280,1280,1280,1280,1280,1280,1280,1280,1280,1280,1280]\n    },\n    {\n      showSymbol: false,\n      name: \"Hotspot jre8\",\n      type: \"line\",\n      data: [null,null,null,null,null,null,null,null,null,null,null,null,1544,1572,1463,1599,1602,1642,1662,1670,1664,1664,1664,1664,1664,1667,1667,1667,1667,1667,1667,1667,1667,1667,1667,1667,1667,1667,1667,1667,1667,1667,1667,1667,1667,1667,1667,1667,1667,1667]\n    },\n    {\n      showSymbol: false,\n      name: \"Openj9 jre11\",\n      type: \"line\",\n      data: [null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,1280,1280,1280,1280,1280,1280,1280,1280,1274,1274,1274,1274,1269,1269,1269,1269,1269,1269,1269,1269,1269,1269,1269,1269,1269,1269,1269,1269,1269,1269,1269,1269,1269,1269,1269,1269]\n    },\n    {\n      showSymbol: false,\n      name: \"Hotspot jre11\",\n      type: \"line\",\n      data: [null,null,null,null,null,null,null,null,null,null,null,null,1305,1305,1305,1305,1305,1305,1305,1305,1305,1305,1305,1305,1305,1305,1305,1305,1305,1305,1305,1305,1305,1305,1305,1305,1305,1305,1305,1305,1305,1305,1305,1305,1305,1305,1305,1305,1305,1305,1305,1305,1305]\n    },\n  ]\n};\n{% endecharts %}\nè¯¥æ•°æ®æ¥æºäº/gcæŒ‡ä»¤ä¹‹ä¸­ï¼Œä¸ªäººæ„Ÿè§‰è¯¥å‚æ•°è¿˜æ˜¯æ¯”è¾ƒè¿·çš„ï¼Œä»…ä¾›å‚è€ƒã€‚\n## è·‘å›¾æµ‹è¯•\næµ‹è¯•æ–¹æ³•ï¼šåœ¨å¼€æœ5åˆ†é’Ÿåé¦–å…ˆè¿ç»­è·‘å›¾2åˆ†é’Ÿï¼ˆçº¦2600æ ¼ï¼Œåˆ›é€ é£è¡Œï¼‰ï¼Œæ¥ç€æŒ‚æœº13åˆ†é’Ÿ\næ¯æ¬¡é£è¡Œæ–¹å‘å‡ç›¸åŒï¼Œæµ‹è¯•å®Œæˆåä¼šå°†å­˜æ¡£é‡ç½®ä¿è¯æ¯æ¬¡æµ‹è¯•éƒ½ä¼šé‡æ–°ç”Ÿæˆåœ°å½¢\n### å†…å­˜å ç”¨\n{% echarts 95% 400 5.4.3 %}\n{\n  title: {\n    text: \"å†…å­˜å ç”¨\"\n  },\n  tooltip: {\n    trigger: \"axis\"\n  },\n  legend: {\n    data: [\"Openj9 jre8\", \"Hotspot jre8\", \"Openj9 jre11\", \"Hotspot jre11\"]\n  },\n  grid: {\n    left: \"3%\",\n    right: \"4%\",\n    bottom: \"3%\",\n    containLabel: true\n  },\n  toolbox: {\n    feature: {\n      saveAsImage: {}\n    }\n  },\n  xAxis: {\n    type: \"category\",\n    boundaryGap: false,\n    data: ['0s', '10s', '20s', '30s', '40s', '50s', '1min','1min10s','1min20s','1min30s','1min40s','1min50s','2min','2min10s','2min20s','2min30s','2min40s','2min50s','3min',\n          '3min10s','3min20s','3min30s','3min40s','3min50s','4min','4min10s','4min20s','4min30s','4min40s','4min50s','5min','5min10s','5min20s','5min30s','5min40s','5min50s','6min','6min10s','6min20s','6min30s','6min40s','6min50s','7min','7min10s','7min20s','7min30s','7min40s','7min50s','8min','8min10s','8min20s','8min30s','8min40s','8min50s','9min','9min10s','9min20s','9min30s','9min40s','9min50s','10min','10min10s','10min20s','10min30s','10min40s','10min50s','11min','11min10s','11min20s','11min30s','11min40s','11min50s','12min','12min10s','12min20s','12min30s','12min40s','12min50s','13min','13min10s','13min20s','13min30s','13min40s','13min50s','14min','14min10s','14min20s','14min30s','14min40s','14min50s','15min']\n  },\n  yAxis: {\n    type: \"value\",\n    scale:true\n  },\n  series: [\n    {\n      showSymbol: false,\n      name: \"Openj9 jre8\",\n      type: \"line\",\n      data: [\n        1510,\n1529,\n1534,\n1536,\n1551,\n1561,\n1578,\n1571,\n1588,\n1599,\n1599,\n1605,\n1614,\n1612,\n1616,\n1618,\n1616,\n1629,\n1637,\n1640,\n1666,\n1662,\n1665,\n1666,\n1670,\n1668,\n1670,\n1676,\n1673,\n1681,\n1681,\n1682,\n1682,\n1683,\n1683,\n1679,\n1679,\n1680,\n1680,\n1679,\n1678,\n1678,\n1679,\n1679,\n1679,\n1679,\n1679,\n1679,\n1680,\n1682,\n1681,\n1682,\n1682,\n1681,\n1681,\n1681,\n1682,\n1682,\n1682,\n1682,\n1676,\n1675,\n1675,\n1675,\n1676,\n1676,\n1676,\n1676,\n1676,\n1676,\n1676,\n1676,\n1676,\n1676,\n1676,\n1677,\n1676,\n1675,\n1676,\n1677,\n1677,\n1677,\n1677,\n1677,\n1678,\n1677,\n1673,\n1673,\n1673,\n1673,\n1673,\n1673,\n1673,\n1673,\n1674,\n1674,\n1674,\n1674,\n1676,\n1675,\n1674,\n1675,\n1676,\n1675,\n1676,\n1676,\n1676,\n1675,\n1676 ]\n    },\n    {\n      showSymbol: false,\n      name: \"Hotspot jre8\",\n      type: \"line\",\n      data: [1726,\n1731,\n1758,\n1761,\n1768,\n1770,\n1785,\n1789,\n1805,\n1812,\n1827,\n1829,\n1829,\n1847,\n1845,\n1861,\n1862,\n1857,\n1856,\n1856,\n1856,\n1867,\n1866,\n1867,\n1870,\n1871,\n1872,\n1873,\n1876,\n1878,\n1883,\n1943,\n1955,\n1955,\n1955,\n1956,\n1960,\n1961,\n1968,\n1968,\n1973,\n1973,\n1982,\n1984,\n1991,\n1991,\n1998,\n1998,\n1991,\n1983,\n1984,\n1973,\n1971,\n1960,\n1960,\n1947,\n1946,\n1934,\n1920,\n1921,\n1908,\n1895,\n1896,\n1882,\n1868,\n1868,\n1855,\n1854,\n1841,\n1828,\n1828,\n1815,\n1803,\n1803,\n1791,\n1780,\n1779,\n1768,\n1758,\n1759,\n1749,\n1739,\n1738,\n1729,\n1720,\n1712,\n1712,\n1702,\n1695,\n1688,\n1688,\n1688,\n1681,\n1674,\n1668,\n1666,\n1665,\n1665,\n1666,\n1665,\n1665,\n1665,\n1665,\n1664\n]\n    },\n    {\n      showSymbol: false,\n      name: \"Openj9 jre11\",\n      type: \"line\",\n      data: [\n        1701,\n1738,\n1726,\n1742,\n2050,\n2038,\n2278,\n1799,\n1793,\n1810,\n1808,\n1821,\n1825,\n1845,\n1852,\n1890,\n1906,\n1899,\n1897,\n1897,\n1898,\n1898,\n1898,\n1897,\n1898,\n1897,\n1897,\n1897,\n1900,\n1897,\n1897,\n1897,\n1897,\n1896,\n1897,\n1899,\n1897,\n1898,\n1897,\n1897,\n1898,\n1898,\n1897,\n1897,\n1896,\n1894,\n1894,\n1894,\n1895,\n1897,\n1896,\n1896,\n1895,\n1895,\n1895,\n1895,\n1895,\n1895,\n1895,\n1895,\n1895,\n1895,\n1888,\n1889,\n1889,\n1888,\n1888,\n1888,\n1888,\n1888,\n1888,\n1888,\n1889,\n1889,\n1889,\n1889,\n1889,\n1889,\n1889,\n1890,\n1884,\n1884,\n1884,\n1884,\n1884,\n1884,\n1884,\n1884,\n1884,\n1883,\n1882,\n1883,\n1883,\n1883,\n1883]\n    },\n    {\n      showSymbol: false,\n      name: \"Hotspot jre11\",\n      type: \"line\",\n      data: [2025,\n2041,\n2067,\n2064,\n2083,\n2086,\n2087,\n2087,\n2088,\n2088,\n2088,\n2088,\n2088,\n2089,\n2089,\n2096,\n2098,\n2098,\n2098,\n2100,\n2100,\n2100,\n2100,\n2100,\n2100,\n2100,\n2100,\n2100,\n2099,\n2099,\n2099,\n2100,\n2100,\n2100,\n2100,\n2100,\n2101,\n2101,\n2100,\n2100,\n2100,\n2100,\n2101,\n2101,\n2101,\n2101,\n2101,\n2101,\n2101,\n2102,\n2102,\n2102,\n2101,\n2101,\n2100,\n2101,\n2100,\n2100,\n2100,\n2101,\n2100,\n2101,\n2100,\n2100,\n2100,\n2100,\n2101,\n2102,\n2101,\n2101,\n2101,\n2101,\n2101,\n2101,\n2101,\n2101,\n2101,\n2101,\n2103,\n2103,\n2102,\n2103,\n2103,\n2102,\n2102,\n2102,\n2102,\n2103,\n2102,\n2102,\n2101,\n2102,\n2102,\n2102,\n2101,\n2102,\n2102,\n2103\n]\n    },\n  ]\n};\n{% endecharts %}\nOpenj9 jre11åœ¨è¿™é‡Œå‘ç”Ÿäº†æ„å¤–ï¼Œåœ¨è·‘å›¾1åˆ†é’Ÿæ—¶å†…å­˜æé€Ÿé£™å‡ï¼ŒCPUä¹Ÿåˆ°äº†100%ï¼ŒæœåŠ¡å™¨åå°æç¤ºoverloadï¼Œä¸ªäººè®¤ä¸ºè¿™åªæ˜¯ä¸ªåˆ«ç°è±¡ï¼Œä½†è¿™ä¹Ÿè¯´æ˜äº†Openj9å¯èƒ½å‡ºç°çš„ä¸ç¨³å®šæƒ…å†µã€‚\nè·‘å›¾æ—¶çš„å†…å­˜å’Œé™æ€æµ‹è¯•å”¯ä¸€ä¸åŒçš„æ˜¯Hotspot jre8ï¼Œåœ¨è·‘å›¾å®Œæˆåå†…å­˜ä»ç„¶ä¸Šå‡ï¼Œä½†åˆ°äº†2000Måè§¦å‘äº†å†…å­˜å›æ”¶ï¼Œå†…å­˜ä¸‹é™è‡³1680Mä»¥ä¸‹ï¼Œè¿™ç”šè‡³æ¯”å¼€æœåˆæœŸçš„å†…å­˜è¿˜è¦ä½ã€‚ç»è¿‡åå¤æµ‹è¯•åç¡®è®¤äº†è¯¥ç°è±¡å¹¶ä¸æ˜¯å¶ç„¶ã€‚\n### CPUå ç”¨ç‡\n{% echarts 95% 400 5.4.3 %}\n{\n  title: {\n    text: \"CPUå ç”¨ç‡\"\n  },\n  tooltip: {\n    trigger: \"axis\"\n  },\n  legend: {\n    data: [\"Openj9 jre8\", \"Hotspot jre8\", \"Openj9 jre11\", \"Hotspot jre11\"]\n  },\n  grid: {\n    left: \"3%\",\n    right: \"4%\",\n    bottom: \"3%\",\n    containLabel: true\n  },\n  toolbox: {\n    feature: {\n      saveAsImage: {}\n    }\n  },\n  xAxis: {\n    type: \"category\",\n    boundaryGap: false,\n    data: ['0s', '10s', '20s', '30s', '40s', '50s', '1min','1min10s','1min20s','1min30s','1min40s','1min50s','2min','2min10s','2min20s','2min30s','2min40s','2min50s','3min',\n          '3min10s','3min20s','3min30s','3min40s','3min50s','4min','4min10s','4min20s','4min30s','4min40s','4min50s','5min','5min10s','5min20s','5min30s','5min40s','5min50s','6min','6min10s','6min20s','6min30s','6min40s','6min50s','7min','7min10s','7min20s','7min30s','7min40s','7min50s','8min','8min10s','8min20s','8min30s','8min40s','8min50s','9min','9min10s','9min20s','9min30s','9min40s','9min50s','10min','10min10s','10min20s','10min30s','10min40s','10min50s','11min','11min10s','11min20s','11min30s','11min40s','11min50s','12min','12min10s','12min20s','12min30s','12min40s','12min50s','13min','13min10s','13min20s','13min30s','13min40s','13min50s','14min','14min10s','14min20s','14min30s','14min40s','14min50s','15min']\n  },\n  yAxis: {\n    type: \"value\",\n    scale:true\n  },\n  series: [\n    {\n      showSymbol: false,\n      name: \"Openj9 jre8\",\n      type: \"line\",\n      data: [\n35.3,\n18.8, \n86.6, \n31.4, \n20.0, \n29.8, \n80.8, \n93.0, \n84.4, \n89.6, \n91.4, \n83.2, \n82.3, \n79.0, \n81.8, \n78.4, \n80.0, \n76.6, \n73.1, \n49.8, \n15.6, \n16.4, \n14.2, \n12.6, \n13.7, \n11.9, \n14.1, \n12.4, \n16.2, \n10.5, \n24.9, \n13.8, \n13.2, \n11.2, \n12.5, \n12.6, \n13.3, \n12.3, \n11.8, \n11.0, \n12.4, \n11.6, \n11.8, \n11.2, \n11.8, \n11.8, \n14.5, \n10.9, \n13.4, \n14.0, \n11.7, \n13.3, \n13.5, \n11.4, \n13.6, \n12.3,\n17.0, \n14.5, \n15.9, \n14.8, \n20.2, \n11.7,\n13.9, \n12.0, \n13.9, \n10.8, \n11.4, \n13.1, \n12.2, \n10.9, \n13.8, \n10.7, \n10.5, \n11.5, \n9.7, \n12.0, \n12.8, \n10.9, \n10.4, \n10.0, \n13.1, \n13.9, \n9.9, \n9.9, \n9.9, \n10.2, \n9.8,\n9.1,\n9.8, \n9.8, \n14.3, \n11.3, \n11.8, \n12.4, \n14.7, \n10.0\n]\n    },\n    {\n      showSymbol: false,\n      name: \"Hotspot jre8\",\n      type: \"line\",\n      data: [\n        6.8,\n61.7, \n52.3, \n54.8, \n82.9, \n87.1, \n79.2, \n78.7, \n78.8, \n77.8, \n77.1, \n75.8, \n80.2, \n77.1, \n78.3, \n76.0, \n71.8, \n49.3, \n18.0, \n15.2, \n14.0, \n13.5, \n11.7, \n11.4, \n12.3, \n11.8, \n11.2, \n13.2, \n12.1, \n12.8, \n12.4, \n12.5, \n11.6, \n12.2, \n37.7, \n18.0, \n11.5, \n15.2, \n12.8, \n15.1, \n13.6, \n11.6, \n12.1, \n13.9, \n12.6, \n12.8, \n11.6, \n10.8, \n14.4, \n11.2, \n11.6, \n11.9, \n10.1, \n11.6, \n11.4, \n11.1, \n11.2, \n10.5, \n10.2, \n13.0, \n11.0, \n25.2, \n27.9, \n10.3, \n16.0, \n10.8, \n11.7, \n14.4, \n11.6, \n11.8, \n12.2, \n12.8, \n13.4, \n14.5, \n13.6, \n14.4, \n16.0, \n15.9, \n14.9, \n11.6, \n10.3, \n11.2, \n9.7, \n10.8, \n12.9,\n12.1, \n13.0, \n12.3, \n12.1, \n12.3, \n12.2, \n12.1,\n12.7, \n14.6, \n17.2,\n11.9, \n14.4,\n11.4, \n11.0, \n12.3, \n29.9, \n8.9, \n8.3, \n7.4, \n5.7, \n6.3, \n6.7, \n6.1, \n9.1 \n]\n    },\n    {\n      showSymbol: false,\n      name: \"Openj9 jre11\",\n      type: \"line\",\n      data: [\n        7.0,\n74.6,\n29.4,\n90.4,\n61.8, \n100.0, \n99.9,\n99.0,\n78.8, \n79.3, \n78.1, \n78.4, \n81.2, \n80.2, \n81.6, \n79.2, \n76.9, \n81.2, \n26.7, \n16.5, \n15.3, \n15.9, \n13.0, \n12.7, \n16.0, \n18.3, \n18.9, \n14.2, \n15.1, \n18.3, \n13.9, \n14.2, \n13.4, \n12.8, \n13.3, \n14.3, \n12.9, \n15.0, \n13.3, \n12.5, \n14.1, \n14.0, \n13.5, \n12.8, \n12.8, \n14.4, \n14.3, \n22.9, \n12.7, \n13.6, \n12.9, \n12.5, \n12.1, \n12.4, \n12.8, \n13.5, \n15.8, \n12.3, \n11.6, \n13.2, \n12.8, \n16.0, \n13.1, \n13.1, \n13.6, \n13.4, \n12.1, \n13.3, \n11.8, \n13.0, \n14.0, \n13.0, \n13.3, \n13.3, \n14.5, \n13.7, \n13.9, \n18.2,\n13.1,\n12.8, \n14.9, \n13.9, \n12.1, \n11.7, \n12.5, \n11.1, \n11.7, \n12.3, \n11.3, \n13.9, \n11.2, \n13.6, \n13.0, \n11.0, \n11.7 \n]\n    },\n    {\n      showSymbol: false,\n      name: \"Hotspot jre11\",\n      type: \"line\",\n      data: [7.2,\n27.5,\n77,\n87.7,\n99.6,\n95.4,\n91.2,\n91.5,\n82.2,\n81.7,\n80.6,\n76.9,\n79.7,\n79.3,\n75,\n84.6,\n73.9,\n43.1,\n34.7,\n14.3,\n14.4,\n13.4,\n13.2,\n11.8,\n11,\n10.9,\n12.1,\n15.8,\n14.9,\n10.5,\n10.2,\n12.1,\n11.2,\n11,\n10.3,\n10,\n10.9,\n12.8,\n10.8,\n12.8,\n12,\n10.7,\n11.3,\n11.6,\n12.5,\n12.5,\n12.3,\n10,\n16.1,\n10.5,\n10.3,\n12.5,\n11.2,\n13.4,\n10.8,\n11.9,\n14.2,\n11.3,\n17.3,\n15.5,\n10.9,\n11,\n10.8,\n10.5,\n13.4,\n14.1,\n11.8,\n11.9,\n12.7,\n10.6,\n11.9,\n10.8,\n12,\n11.6,\n10.3,\n11.7,\n12.8,\n9.9,\n16.8,\n13.4,\n9.4,\n12.6,\n9.8,\n9.7,\n12.9,\n11.5,\n12,\n10.5,\n9.6,\n13.1,\n13,\n13.4,\n13.8,\n11.4,\n11.4,\n10.7,\n9.9,\n10.2\n]\n    },\n  ]\n};\n{% endecharts %}\næ— æ˜æ˜¾åŒºåˆ«ã€‚\n## å¤šæ’ä»¶å¼€æœæµ‹è¯•\næµ‹è¯•æ–¹æ³•ï¼šå’Œæ— æ’ä»¶å¼€æœæµ‹è¯•ç›¸åŒ\nä½¿ç”¨æ’ä»¶åˆ—è¡¨ï¼š\n- AdvancedNMotd-9.2.0\n- Boom-1.3.3\n- EastLandLog4jFixer-1.0.4\n- EssentialsX-2.19.0-dev+52-7245e84\n- EssentialsXChat-2.19.0-dev+52-7245e84\n- EssentialsXSpawn-2.19.0-dev+52-7245e84\n- HolographicDisplays-2.4.5\n- HolographicPlaceholders-2.1.2 Stable\n- LimitPillagers-3.0.1\n- MiaoBoard-2.6.0\n- MySkin-3.3\n- NekoMaid-0.2.5\n- PlaceholderAPI-2.10.9\n- PlugManX-2.2.9\n- ProtocolLib-4.5.1\n- spark-1.9.23\n- Uniporter-1.3.3\n- Vault-1.7.3\n- VillagerOptimiser-1.1.5\nä½¿ç”¨å­˜æ¡£ä¸ºæœ¬äººæœåŠ¡å™¨å­˜æ¡£ï¼Œå¤§å°çº¦3Gï¼Œå«å¤šä¸ªå¼ºåŠ è½½åŒºå—\n### CPUå ç”¨ç‡\n{% echarts 95% 400 5.4.3 %}\n{\n  title: {\n    text: \"CPUå ç”¨ç‡\"\n  },\n  tooltip: {\n    trigger: \"axis\"\n  },\n  legend: {\n    data: [\"Openj9 jre8\", \"Hotspot jre8\", \"Openj9 jre11\", \"Hotspot jre11\"]\n  },\n  grid: {\n    left: \"3%\",\n    right: \"4%\",\n    bottom: \"3%\",\n    containLabel: true\n  },\n  toolbox: {\n    feature: {\n      saveAsImage: {}\n    }\n  },\n  xAxis: {\n    type: \"category\",\n    boundaryGap: false,\n    data: ['0s', '10s', '20s', '30s', '40s', '50s', '1min','1min10s','1min20s','1min30s','1min40s','1min50s','2min','2min10s','2min20s','2min30s','2min40s','2min50s','3min',\n          '3min10s','3min20s','3min30s','3min40s','3min50s','4min','4min10s','4min20s','4min30s','4min40s','4min50s','5min','5min10s','5min20s','5min30s','5min40s','5min50s','6min','6min10s','6min20s','6min30s','6min40s','6min50s','7min','7min10s','7min20s','7min30s','7min40s','7min50s','8min','8min10s','8min20s','8min30s','8min40s','8min50s','9min','9min10s','9min20s','9min30s','9min40s','9min50s','10min','10min10s','10min20s','10min30s','10min40s','10min50s','11min','11min10s','11min20s','11min30s','11min40s','11min50s','12min','12min10s','12min20s','12min30s','12min40s','12min50s','13min','13min10s','13min20s','13min30s','13min40s','13min50s','14min','14min10s','14min20s','14min30s','14min40s','14min50s','15min']\n  },\n  yAxis: {\n    type: \"value\",\n    scale:true\n  },\n  series: [\n    {\n      showSymbol: false,\n      name: \"Openj9 jre8\",\n      type: \"line\",\n      data: [\n        27.3 ,\n99.1 ,\n99.9 ,\n99.8 ,\n99.9 ,\n97.7 ,\n99.7 ,\n99.7 ,\n99.7 ,\n99.5 ,\n99.6 ,\n84.2 ,\n80.9 ,\n81.7 ,\n81.9 ,\n75.9 ,\n77.5 ,\n20.2 ,\n19.1 ,\n17.0 ,\n18.9 ,\n18.6 ,\n26.0 ,\n19.3 ,\n17.7 ,\n17.0 ,\n70.9 ,\n17.4 ,\n18.1 ,\n17.0 ,\n19.2 ,\n18.0 ,\n17.2 ,\n17.0 ,\n15.7 ,\n15.7 ,\n16.8 ,\n15.3 ,\n18.0 ,\n14.8 ,\n15.5 ,\n18.2 ,\n15.2 ,\n15.6 ,\n14.4 ,\n14.9 ,\n32.3 ,\n14.5 ,\n15.0 ,\n15.2 ,\n15.5 ,\n17.8 ,\n17.4 ,\n16.4 ,\n17.2 ,\n29.3 ,\n16.7 ,\n16.0 ,\n16.2 ,\n14.7 ,\n17.2 ,\n13.6 ,\n14.2 ,\n14.1 ,\n15.1 ,\n14.6 ,\n22.4 ,\n13.7 ,\n14.7 ,\n16.3 ,\n16.2 ,\n17.3 ,\n15.3 ,\n13.6 ,\n16.5 ,\n13.8 ,\n13.9 ,\n14.4 ,\n15.4 ,\n16.5 ,\n15.1 ,\n17.1 ,\n15.0 ,\n15.8 ,\n13.0 ,\n15.2 ,\n18.1 ,\n15.9 ,\n15.1 ,\n15.3 ,\n13.9 ,\n13.3 ,\n13.4 ,\n14.0 ,\n14.9 ,\n18.3 ,\n14.6 ,\n15.2 ,\n14.6 ,\n13.0 \n\n]\n    },\n    {\n      showSymbol: false,\n      name: \"Hotspot jre8\",\n      type: \"line\",\n      data: [\n        0.7 ,\n54.5 ,\n99.2 ,\n98.3 ,\n99.0 ,\n96.4 ,\n97.2 ,\n93.2 ,\n90.0 ,\n82.7 ,\n76.1 ,\n79.7 ,\n76.3 ,\n39.9 ,\n19.0 ,\n18.6 ,\n17.0 ,\n17.6 ,\n16.5 ,\n16.7 ,\n19.3 ,\n15.6 ,\n15.7 ,\n14.3 ,\n18.1 ,\n42.2 ,\n15.7 ,\n15.9 ,\n17.9 ,\n15.3 ,\n15.4 ,\n14.9 ,\n16.6 ,\n20.0 ,\n14.6 ,\n17.7 ,\n17.4 ,\n16.0 ,\n15.6 ,\n16.2 ,\n16.1 ,\n17.6 ,\n19.8 ,\n18.2 ,\n18.8 ,\n21.9 ,\n16.7 ,\n16.3 ,\n13.1 ,\n14.0 ,\n14.6 ,\n13.9 ,\n13.7 ,\n12.8 ,\n13.1 ,\n13.4 ,\n14.3 ,\n14.0 ,\n16.5 ,\n15.8 ,\n15.7 ,\n18.7 ,\n16.5 ,\n18.0 ,\n15.7 ,\n19.0 ,\n14.9 ,\n13.9 ,\n13.0 ,\n15.3 ,\n14.3 ,\n14.1 ,\n15.2 ,\n13.8 ,\n13.0 ,\n13.1 ,\n14.2 ,\n15.7 ,\n14.0 ,\n15.6 ,\n19.3 ,\n16.4 ,\n14.3 ,\n13.7 ,\n12.8 ,\n20.6 ,\n14.4 ,\n14.9 ,\n15.5 ,\n14.2 ,\n14.0 ,\n13.6 \n\n]\n    },\n    {\n      showSymbol: false,\n      name: \"Openj9 jre11\",\n      type: \"line\",\n      data: [\n        0.9 ,\n48.5 ,\n99.3 ,\n99.7 ,\n99.8 ,\n98.4 ,\n78.7 ,\n97.6 ,\n99.9 ,\n99.9 ,\n99.7 ,\n99.1 ,\n99.5 ,\n85.1 ,\n78.7 ,\n81.5 ,\n79.2 ,\n77.1 ,\n89.2 ,\n77.4 ,\n73.7 ,\n74.9 ,\n81.6 ,\n40.2 ,\n20.1 ,\n19.1 ,\n20.5 ,\n61.6 ,\n48.4 ,\n20.5 ,\n18.7 ,\n18.2 ,\n19.2 ,\n20.9 ,\n16.4 ,\n16.3 ,\n15.2 ,\n18.7 ,\n17.9 ,\n15.2 ,\n17.5 ,\n16.8 ,\n16.5 ,\n19.8 ,\n20.7 ,\n17.0 ,\n19.0 ,\n29.9 ,\n15.0 ,\n16.6 ,\n16.1 ,\n15.7 ,\n18.1 ,\n15.9 ,\n18.7 ,\n16.6 ,\n16.1 ,\n16.1 ,\n15.3 ,\n23.4 ,\n17.4 ,\n18.8 ,\n19.0 ,\n15.5 ,\n18.8 ,\n15.9 ,\n31.0 ,\n21.4 ,\n16.0 ,\n15.2 ,\n15.6 ,\n15.3 ,\n16.5 ,\n15.8 ,\n15.8 ,\n15.7 ,\n16.5 ,\n15.2 ,\n15.3 ,\n16.2 ,\n15.8 ,\n17.1 ,\n16.9 ,\n17.3 ,\n15.7 ,\n15.1 ,\n16.9 ,\n19.0 ,\n14.8 ,\n15.0 ,\n14.2 ,\n14.5 ,\n16.4\n]\n    },\n    {\n      showSymbol: false,\n      name: \"Hotspot jre11\",\n      type: \"line\",\n      data: [\n        0.9 ,\n38.4 ,\n98.7 ,\n99.0 ,\n99.5 ,\n98.3 ,\n99.3 ,\n99.2 ,\n97.1 ,\n95.5 ,\n86.5 ,\n83.7 ,\n83.5 ,\n77.5 ,\n51.2 ,\n20.1 ,\n20.0 ,\n18.9 ,\n16.7 ,\n16.6 ,\n15.7 ,\n16.4 ,\n27.8 ,\n18.7 ,\n22.7 ,\n40.2 ,\n18.5 ,\n18.2 ,\n16.3 ,\n17.9 ,\n17.0 ,\n17.0 ,\n20.5 ,\n15.6 ,\n15.6 ,\n14.5 ,\n14.5 ,\n13.1 ,\n15.3 ,\n14.1 ,\n14.9 ,\n13.7 ,\n14.2 ,\n15.0 ,\n16.1 ,\n17.8 ,\n14.9 ,\n14.6 ,\n14.8 ,\n13.5 ,\n13.7 ,\n17.5 ,\n13.7 ,\n13.3 ,\n13.0 ,\n13.9 ,\n14.0 ,\n12.5 ,\n12.9 ,\n12.8 ,\n13.9 ,\n12.0 ,\n15.1 ,\n15.8 ,\n12.0 ,\n16.8 ,\n12.7 ,\n14.7 ,\n14.0 ,\n13.3 ,\n16.0 ,\n14.6 ,\n11.8 ,\n15.2 ,\n16.6 ,\n12.5 ,\n13.3 ,\n12.8 ,\n12.5 ,\n13.5 ,\n15.8 ,\n16.3 ,\n14.5 ,\n15.1 ,\n16.2 ,\n19.7 ,\n13.0 ,\n12.9 ,\n13.3 ,\n13.9 ,\n16.0 ,\n12.7 ,\n12.5 ,\n14.6 ,\n16.6 ,\n14.7 ,\n14.1 ,\n13.8 ,\n14.9 \n]\n    },\n  ]\n};\n{% endecharts %}\nOpenj9 jre11è¡¨ç°ä¸ä½³ï¼Œå…¶ä½™å ç”¨ç‡ç›¸è¿‘ã€‚\n### å†…å­˜å ç”¨\n{% echarts 95% 400 5.4.3 %}\n{\n  title: {\n    text: \"å†…å­˜å ç”¨\"\n  },\n  tooltip: {\n    trigger: \"axis\"\n  },\n  legend: {\n    data: [\"Openj9 jre8\", \"Hotspot jre8\", \"Openj9 jre11\", \"Hotspot jre11\"]\n  },\n  grid: {\n    left: \"3%\",\n    right: \"4%\",\n    bottom: \"3%\",\n    containLabel: true\n  },\n  toolbox: {\n    feature: {\n      saveAsImage: {}\n    }\n  },\n  xAxis: {\n    type: \"category\",\n    boundaryGap: false,\n    data: ['0s', '10s', '20s', '30s', '40s', '50s', '1min','1min10s','1min20s','1min30s','1min40s','1min50s','2min','2min10s','2min20s','2min30s','2min40s','2min50s','3min',\n          '3min10s','3min20s','3min30s','3min40s','3min50s','4min','4min10s','4min20s','4min30s','4min40s','4min50s','5min','5min10s','5min20s','5min30s','5min40s','5min50s','6min','6min10s','6min20s','6min30s','6min40s','6min50s','7min','7min10s','7min20s','7min30s','7min40s','7min50s','8min','8min10s','8min20s','8min30s','8min40s','8min50s','9min','9min10s','9min20s','9min30s','9min40s','9min50s','10min','10min10s','10min20s','10min30s','10min40s','10min50s','11min','11min10s','11min20s','11min30s','11min40s','11min50s','12min','12min10s','12min20s','12min30s','12min40s','12min50s','13min','13min10s','13min20s','13min30s','13min40s','13min50s','14min','14min10s','14min20s','14min30s','14min40s','14min50s','15min']\n  },\n  yAxis: {\n    type: \"value\",\n    scale:true\n  },\n  series: [\n    {\n      showSymbol: false,\n      name: \"Openj9 jre8\",\n      type: \"line\",\n      data: [\n        515,\n1074,\n1235,\n1286,\n1375,\n1433,\n1460,\n1451,\n1454,\n1465,\n1460,\n1463,\n1449,\n1468,\n1456,\n1470,\n1470,\n1466,\n1468,\n1467,\n1470,\n1468,\n1471,\n1470,\n1472,\n1475,\n1494,\n1478,\n1475,\n1474,\n1473,\n1474,\n1475,\n1477,\n1476,\n1475,\n1475,\n1477,\n1477,\n1481,\n1475,\n1471,\n1471,\n1477,\n1472,\n1471,\n1471,\n1472,\n1474,\n1472,\n1472,\n1472,\n1472,\n1466,\n1465,\n1466,\n1466,\n1466,\n1466,\n1466,\n1466,\n1466,\n1467,\n1466,\n1467,\n1469,\n1465,\n1465,\n1466,\n1466,\n1468,\n1468,\n1468,\n1468,\n1468,\n1468,\n1467,\n1468,\n1461,\n1461,\n1461,\n1461,\n1462,\n1461,\n1461,\n1462,\n1465,\n1462,\n1462,\n1462,\n1463,\n1456,\n1457,\n1456,\n1457,\n1457,\n1457,\n1457,\n1465,\n1457\n]\n    },\n    {\n      showSymbol: false,\n      name: \"Hotspot jre8\",\n      type: \"line\",\n      data: [\n        473,\n654,\n1282,\n1453,\n1522,\n1653,\n1649,\n1654,\n1661,\n1689,\n1700,\n1710,\n1712,\n1721,\n1721,\n1722,\n1721,\n1721,\n1721,\n1722,\n1722,\n1724,\n1724,\n1724,\n1725,\n1737,\n1740,\n1740,\n1739,\n1740,\n1740,\n1741,\n1739,\n1740,\n1741,\n1741,\n1741,\n1742,\n1741,\n1742,\n1743,\n1742,\n1743,\n1744,\n1743,\n1745,\n1745,\n1746,\n1746,\n1746,\n1746,\n1746,\n1745,\n1746,\n1746,\n1746,\n1745,\n1745,\n1745,\n1745,\n1746,\n1746,\n1746,\n1746,\n1746,\n1746,\n1747,\n1747,\n1747,\n1747,\n1748,\n1748,\n1748,\n1748,\n1748,\n1748,\n1748,\n1749,\n1748,\n1749,\n1748,\n1749,\n1748,\n1749,\n1749,\n1749,\n1750,\n1749,\n1750,\n1750,\n1750,\n1751\n]\n    },\n    {\n      showSymbol: false,\n      name: \"Openj9 jre11\",\n      type: \"line\",\n      data: [\n        473,\n686,\n1210,\n1319,\n1406,\n1505,\n1575,\n1610,\n1622,\n1643,\n1631,\n1633,\n1638,\n1635,\n1633,\n1633,\n1636,\n1641,\n1640,\n1654,\n1662,\n1659,\n1770,\n1665,\n1664,\n1672,\n1666,\n1720,\n1664,\n1664,\n1665,\n1665,\n1668,\n1683,\n1666,\n1669,\n1660,\n1665,\n1666,\n1659,\n1659,\n1663,\n1659,\n1659,\n1660,\n1656,\n1655,\n1672,\n1657,\n1656,\n1659,\n1659,\n1661,\n1655,\n1688,\n1655,\n1656,\n1656,\n1656,\n1655,\n1656,\n1651,\n1654,\n1654,\n1654,\n1653,\n1652,\n1654,\n1654,\n1648,\n1649,\n1654,\n1648,\n1652,\n1649,\n1648,\n1649,\n1642,\n1642,\n1643,\n1642,\n1642,\n1642,\n1644,\n1638,\n1641,\n1641,\n1641,\n1641,\n1641,\n1641,\n1645,\n1635\n]\n    },\n    {\n      showSymbol: false,\n      name: \"Hotspot jre11\",\n      type: \"line\",\n      data: [\n        472,\n535,\n979,\n1474,\n1708,\n1866,\n1889,\n1893,\n1910,\n1914,\n1917,\n1918,\n1920,\n1923,\n1935,\n1936,\n1937,\n1937,\n1938,\n1938,\n1939,\n1938,\n1943,\n1940,\n1941,\n1942,\n1945,\n1945,\n1946,\n1946,\n1947,\n1948,\n1948,\n1948,\n1950,\n1950,\n1950,\n1950,\n1950,\n1950,\n1951,\n1951,\n1950,\n1951,\n1952,\n1951,\n1953,\n1953,\n1953,\n1953,\n1953,\n1952,\n1952,\n1952,\n1952,\n1952,\n1952,\n1953,\n1953,\n1953,\n1952,\n1953,\n1953,\n1953,\n1954,\n1953,\n1954,\n1954,\n1954,\n1954,\n1955,\n1955,\n1954,\n1954,\n1954,\n1954,\n1954,\n1954,\n1954,\n1954,\n1954,\n1954,\n1955,\n1955,\n1955,\n1954,\n1955,\n1955,\n1955,\n1955,\n1955,\n1955,\n1956,\n1956,\n1956,\n1956,\n1956,\n1956,\n1957\n]\n    },\n  ]\n};\n{% endecharts %}\nå’Œæ— æ’ä»¶å¼€æœæµ‹è¯•ç»“æœç›¸åŒï¼ŒOpenj9çš„å†…å­˜ä¾ç„¶éå¸¸ä½ã€‚\n### TPS\n{% echarts 95% 400 5.4.3 %}\noption = {\n  title: {\n    text: \"TPS\"\n  },\n  tooltip: {\n    trigger: \"axis\"\n  },\n  legend: {\n    data: [\"Openj9 jre8\", \"Hotspot jre8\", \"Openj9 jre11\", \"Hotspot jre11\"]\n  },\n  grid: {\n    left: \"3%\",\n    right: \"4%\",\n    bottom: \"3%\",\n    containLabel: true\n  },\n  toolbox: {\n    feature: {\n      saveAsImage: {}\n    }\n  },\n  xAxis: {\n    type: \"category\",\n    boundaryGap: false,\n    data: [\"0s\",\n      \"5s\",\n      \"10s\",\n      \"15s\",\n      \"20s\",\n      \"25s\",\n      \"30s\",\n      \"35s\",\n      \"40s\",\n      \"45s\",\n      \"50s\",\n      \"55s\",\n      \"1min\",\n      \"1min5s\",\n      \"1min10s\",\n      \"1min15s\",\n      \"1min20s\",\n      \"1min25s\",\n      \"1min30s\",\n      \"1min35s\",\n      \"1min40s\",\n      \"1min45s\",\n      \"1min50s\",\n      \"1min55s\",\n      \"2min\",\n      \"2min5s\",\n      \"2min10s\",\n      \"2min15s\",\n      \"2min20s\",\n      \"2min25s\",\n      \"2min30s\",\n      \"2min35s\",\n      \"2min40s\",\n      \"2min45s\",\n      \"2min50s\",\n      \"2min55s\",\n      \"3min\",\n      \"3min5s\",\n      \"3min10s\",\n      \"3min15s\",\n      \"3min20s\",\n      \"3min25s\",\n      \"3min30s\",\n      \"3min35s\",\n      \"3min40s\",\n      \"3min45s\",\n      \"3min50s\",\n      \"3min55s\",\n      \"4min\",\n      \"4min5s\",\n      \"4min10s\",\n      \"4min15s\",\n      \"4min20s\",\n      \"4min25s\",\n      \"4min30s\",\n      \"4min35s\",\n      \"4min40s\",\n      \"4min45s\",\n      \"4min50s\",\n      \"4min55s\",\n      \"5min\"]\n  },\n  yAxis: {\n    type: \"value\",\n    scale:true\n  },\n  series: [\n    {\n      showSymbol: false,\n      name: \"Openj9 jre8\",\n      type: \"line\",\n      data: [null,null,null,null,null,null,\n      null,null,null,null,null,20,\n      20,20,20,20,20,20,20,\n      20,20,10.43,16.17,17.27,17.61,\n      18.26,18.26,20,20,20,20,\n      20,20,20,20,20,20,\n      20,20,20,20,20,20,20,19.7,19.7,19.7,\n      20,20,20,20,20,19.47,19.47,19.47,19.47,19.47,19.47,20,\n      20,20,20,20,20\n]\n    },\n    {\n      showSymbol: false,\n      name: \"Hotspot jre8\",\n      type: \"line\",\n      data: [null,null,null,null,null,null,\n      null,null,null,null,20,20,\n      20,20,20,20,20,20,\n      15.24,16.19,17.28,18.1,18.27,20,\n      20,20,20,20,20,20,\n      20,20,20,20,20,20,\n      20,20,20,20,20,20,\n      20,20,20,20,20,20,\n      19.91,19.91,19.91,19.91,19.91,19.91,\n      20,20,20,20,20,20,20\n        ]\n    },\n    {\n      showSymbol: false,\n      name: \"Openj9 jre11\",\n      type: \"line\",\n      data: [null,null,null,null,null,null,\n      null,null,null,null,null,null,\n      null,20,20,20,20,20,\n      20,20,20,20,10.44,15.22,\n      16.81,17.61,18.09,18.26,20,20,\n      20,20,20,20,20,20,\n      20,20,20,20,20,20,\n      20,20,20,20,20,20,\n      20,20,20,20,20,19.02,\n      19.11,19.11,19.11,19.11,19.11,20,20\n]\n    },\n    {\n      showSymbol: false,\n      name: \"Hotspot jre11\",\n      type: \"line\",\n      data: [null,null,null,null,null,null,\n      null,null,null,20,20,20,\n      20,20,20,20,20,20,\n      10.49,15.24,16.83,17.62,18.1,18.27,\n      20,20,20,20,20,20,\n      20,20,20,20,20,20,\n      20,20,20,20,20,20,\n      20,20,20,20,20,20,\n      20,19.99,20,20,20,20,\n      20,20,20,20,20,20,20\n]\n    },\n  ]\n};\n{% endecharts %}\nå››ä¸ªç‰ˆæœ¬TPSå‡ä¼šä¸‹é™ï¼Œä½†ç”±äºHotspotå¯åŠ¨é€Ÿåº¦çº¦æ˜¯Openj9ä¸¤å€ï¼Œæ‰€ä»¥TPSä¸‹é™æ—¶é—´ç‚¹ä¹Ÿç•¥å¾®æå‰ã€‚\n## æ€»ç»“\nOpenj9ç›¸æ¯”äºHotspotæ€§èƒ½ä¼šæœ‰ç•¥å¾®çš„æŸå¤±ï¼Œå…·ä½“è¡¨ç°ä¸ºå¼€æœé€Ÿåº¦æ…¢çº¦ä¸¤å€ï¼ŒCPUå ç”¨ç‡ä¼šæ›´é«˜ã€‚ä½†ç”±æ­¤å¸¦æ¥çš„æ˜¯å†…å­˜çš„å¤§é‡é™ä½ã€‚å¦‚æœåœ¨TPSä¸Šå¹¶æ²¡æœ‰è¿‡å¤§çš„å‹åŠ›ä½†æ˜¯å†…å­˜ç´§ä¿çš„æƒ…å†µä¸‹å»ºè®®è¿˜æ˜¯ é‡‡ç”¨Openj9çš„è™šæ‹Ÿæœºã€‚\nå¯¹äº1.16ç‰ˆæœ¬çš„Minecraftï¼Œå¦‚æœæ²¡æœ‰æ’ä»¶çš„ç‰¹æ®Šè¦æ±‚ï¼Œå»ºè®®ä½¿ç”¨java8è€Œéjava11ã€‚\n","tags":["Minecraft","spigot"],"categories":["è®¡è½¯æ‚è°ˆ"]},{"title":"Ubuntuä¸‹å®‰è£…spigotæ­å»ºMinecraftæœåŠ¡å™¨","url":"/20220701/minecraft-server-install/","content":"è‡ªå·±çš„æœåŠ¡å™¨æ­å»ºæ—¶é—´ä¹Ÿæœ‰ä¸€å¹´äº†ï¼Œåœ¨æ­¤è®°å½•ä¸€ä¸‹æ­å»ºçš„è¿‡ç¨‹ï¼Œä»¥é˜²ä¹‹åå¿˜è®°ã€‚\n- æ“ä½œç³»ç»Ÿï¼šUbuntu 16.04 LTS\n- Minecraftç‰ˆæœ¬ï¼š1.16.5\n- Javaç‰ˆæœ¬1.8\n> 1.17ä»¥ä¸Šmcéœ€è¦java17åŠä»¥ä¸Šç‰ˆæœ¬ï¼Œéƒ¨åˆ†1.13-1.16æ’ä»¶å¯¹äºjavaä¹Ÿæœ‰ç‰¹æ®Šè¦æ±‚ï¼Œè¯·è‡ªè¡Œç¡®å®šå®‰è£…ç‰ˆæœ¬\n## å®‰è£…java\nç”±äºMinecrafté«˜ç‰ˆæœ¬ç‰¹æœ‰çš„æ¸£ä¼˜åŒ–ï¼Œæ¸£æœºå»ºè®®ä½¿ç”¨openj9çš„JVMï¼Œèƒ½é™ä½å†…å­˜çš„å ç”¨ï¼Œä½†å…¼å®¹æ€§å’Œç¨³å®šæ€§å¯èƒ½ä¼šå­˜åœ¨ä¸€å®šçš„é—®é¢˜\nå¦‚æœæœåŠ¡å™¨è´¨é‡è¾ƒå¥½ï¼Œåˆ™å»ºè®®é€‰æ‹©hotspotçš„JVMï¼Œèƒ½æä¾›æ›´åŠ ç¨³å®šçš„æœåŠ¡\n### hotspotç‰ˆæœ¬\nç”±äºopenjdké»˜è®¤ä½¿ç”¨hotspotï¼Œæ‰€ä»¥ç›´æ¥è¿›è¡Œå®‰è£…å³å¯\n```bash\nsudo apt install openjdk-8-jdk\n```\n### openj9ç‰ˆæœ¬\nå¯ä»¥å»IBM Semeru Runtimeå®˜ç½‘ä¸‹è½½ç¬¦åˆå¯¹åº”æœºå™¨å’Œç³»ç»Ÿçš„jreæˆ–jdk\nhttps://developer.ibm.com/languages/java/semeru-runtimes/downloads/\nå¦‚æœä¸‹è½½é€Ÿåº¦è¾ƒæ…¢ï¼Œå¯ä»¥é€‰æ‹©æ¸…åé•œåƒè¿›è¡Œä¸‹è½½\nhttps://mirrors.tuna.tsinghua.edu.cn/github-release/ibmruntimes/\næœ¬äººä¸‹è½½çš„ç‰ˆæœ¬ä¸º\nhttps://mirrors.tuna.tsinghua.edu.cn/github-release/ibmruntimes/semeru8-binaries/LatestRelease/ibm-semeru-open-jre_x64_linux_8u332b09_openj9-0.32.0.tar.gz\nä¸‹è½½åˆ°çš„taråŒ…è§£å‹åæ”¾å…¥æœåŠ¡å™¨ä»»æ„ä½ç½®ï¼Œå¹¶è®°ä½binæ–‡ä»¶å¤¹ä¸‹javaå¯¹åº”çš„è·¯å¾„\næœ¬äººçš„javaæ–‡ä»¶è·¯å¾„ä¸º/var/jre/jdk8u332-b09-jre/bin/java\nè¿è¡Œä»¥ä¸‹å‘½ä»¤è¿›è¡Œè½¯è¿æ¥ï¼Œæ³¨æ„æœ€åçš„è·¯å¾„ä¸ºjavaæ–‡ä»¶çš„è·¯å¾„\n```bash\nsudo update-alternatives --install /usr/bin/java java /var/jre/jdk8u332-b09-jre/bin/java 200\n```\nè¿è¡ŒæˆåŠŸæç¤º\n```text\nupdate-alternatives: using /var/jre/jdk8u332-b09-jre/bin/java to provide /usr/bin/java (java) in auto mode\n```\nè¿è¡Œä»¥ä¸‹å‘½ä»¤æµ‹è¯•javaæ˜¯å¦æˆåŠŸå®‰è£…\n```bash\njava -version\n```\nå¦‚æœå‡ºç°äº†ä»¥ä¸‹æŠ¥é”™\n```bash\nroot@Ubuntu:~# java -version\n-bash: /usr/bin/java: Permission denied\n```\næ­¤æ—¶è¯´æ˜è§£å‹åçš„æ–‡ä»¶æ²¡æœ‰è¿è¡Œæƒé™ï¼Œä¸ºæ–‡ä»¶å¢åŠ æƒé™\n```bash\nsudo chmod 755 -R /var/jre/jdk8u332-b09-jre\n```\nå†æ¬¡è¿è¡Œï¼Œå¦‚æœå‡ºç°äº†javaç‰ˆæœ¬åˆ™è¯´æ˜å®‰è£…æˆåŠŸ\n```bash\nroot@Ubuntu:~# java -version\nopenjdk version \"1.8.0_332\"\nIBM Semeru Runtime Open Edition (build 1.8.0_332-b09)\nEclipse OpenJ9 VM (build openj9-0.32.0, JRE 1.8.0 Linux amd64-64-Bit Compressed References 20220422_370 (JIT enabled, AOT enabled)\nOpenJ9   - 9a84ec34e\nOMR      - ab24b6666\nJCL      - 0b8b8af39a based on jdk8u332-b09)\n```\n## å®‰è£…git\nè¿è¡Œå¦‚ä¸‹å‘½ä»¤\n```bash\nsudo apt-get update\nsudo apt install git\ngit --version\n```\nå¦‚æœå‡ºç°äº†gitç‰ˆæœ¬åˆ™è¯´æ˜å®‰è£…æˆåŠŸ\n```bash\nroot@Ubuntu:~# git --version\ngit version 2.7.4\n```\n## æ„å»ºspigot\nç”±äºlog4jçš„æ¼æ´å­˜åœ¨ï¼Œæ‰€ä»¥éå¸¸ä¸å»ºè®®ä½¿ç”¨2021-12æœˆä»¥å‰æ„å»ºå‡ºçš„spigotæœåŠ¡å™¨jaråŒ…\nè¿›å…¥spigotå®˜ç½‘ä¸‹è½½BuildTools.jar\nhttps://hub.spigotmc.org/jenkins/job/BuildTools/\nè¿è¡Œå¦‚ä¸‹ä»£ç è¿›è¡Œæ„å»º\n```bash\njava -jar BuildTools.jar --rev 1.16.5\n```\nå¦‚æœå¡åœ¨å¦‚ä¸‹ç¯èŠ‚ï¼Œå¯ä»¥å°†æ‰‹åŠ¨è¿›å…¥è¯¥ç½‘ç«™ä¸‹è½½server.jarï¼Œé‡å‘½åä¸ºminecraft_server.\\[å¯¹åº”ç‰ˆæœ¬å·\\].jaråæ”¾åœ¨workæ–‡ä»¶å¤¹ä¸‹ï¼Œå¹¶é‡æ–°æ„å»º\n```text\nStarting download of https://launcher.mojang.com/v1/objects/1b557e7b033b583cd9f66746b7a9ab1ec1673ced/server.jar\n```\nå¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œåˆ™æ„å»ºæˆåŠŸåä¼šæ˜¾ç¤ºå¦‚ä¸‹ä¿¡æ¯ï¼Œæ­¤æ—¶é™¤äº†spigot-\\[å¯¹åº”ç‰ˆæœ¬å·\\].jarå¤–å…¶ä»–æ–‡ä»¶å‡å¯åˆ é™¤\n```text\n[INFO] ------------------------------------------------------------------------\n[INFO] Reactor Summary:\n[INFO] \n[INFO] Spigot-API 1.16.5-R0.1-SNAPSHOT .................... SUCCESS [ 12.795 s]\n[INFO] Spigot-Parent dev-SNAPSHOT ......................... SUCCESS [  0.018 s]\n[INFO] Spigot 1.16.5-R0.1-SNAPSHOT ........................ SUCCESS [ 46.675 s]\n[INFO] ------------------------------------------------------------------------\n[INFO] BUILD SUCCESS\n[INFO] ------------------------------------------------------------------------\n[INFO] Total time:  59.643 s\n[INFO] Finished at: 2022-07-01T12:59:46+08:00\n[INFO] -----------------------------------------------------------------------\nSuccess! Everything completed successfully. Copying final .jar files now.\nCopying spigot-1.16.5-R0.1-SNAPSHOT.jar to /opt/test_spigot/./spigot-1.16.5.jar\n  - Saved as ./spigot-1.16.5.jar\n```\n## æœåŠ¡å™¨åˆå§‹åŒ–\nåœ¨jaråŒ…åŒçº§ç›®å½•ä¸‹æ–°å»ºstart.shæ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶å†…è¾“å…¥\n```bash\njava -Xmx[å †æœ€å¤§å¤§å°] -Xms[å †åˆå§‹å¤§å°] -jar [æ„å»ºå‡ºçš„jaråŒ…åå­—] nogui\n```\n\n> å…³äºå¯åŠ¨å‚æ•°çš„é…ç½®è¿™é‡Œä¸å†èµ˜è¿°ï¼Œè¯·æ ¹æ®è‡ªå·±çš„é…ç½®è‡ªè¡Œè°ƒèŠ‚\n\nä¸ºè¯¥æ–‡ä»¶å¢åŠ æƒé™åè¿è¡Œè¯¥æ–‡ä»¶\n```bash\nsudo chmod +x start.sh\n./start.sh\n```\nç¬¬ä¸€æ¬¡è¿è¡Œä¼šæ˜¾ç¤ºå¦‚ä¸‹é”™è¯¯\n```text\n[13:06:00] [main/ERROR]: Failed to load properties from file: server.properties\n[13:06:00] [main/WARN]: Failed to load eula.txt\n[13:06:00] [main/INFO]: You need to agree to the EULA in order to run the server. Go to eula.txt for more info\n```\næ­¤æ—¶å¯ä»¥å‘ç°åŒçº§ç›®å½•ä¸‹æ–°å¢äº†è®¸å¤šæ–‡ä»¶ã€‚å°†eula.txtæ–‡ä»¶ä¸­æœ€åä¸€å¥eula=falseä¿®æ”¹ä¸ºeula=trueï¼Œå¹¶é‡æ–°è¿è¡Œè¯¥æ–‡ä»¶\n```bash\n./start.sh\n```\nç­‰å¾…åœ°å›¾ç”Ÿæˆå®Œæ¯•ï¼Œå¦‚æœå‡ºç°ä»¥ä¸‹ä¿¡æ¯ï¼Œåˆ™è¯´æ˜å¼€æœæˆåŠŸ\n```text\n[13:08:43] [Server thread/INFO]: Done (91.480s)! For help, type \"help\"\n```\nå¦‚æœå‡ºç°äº†ä»¥ä¸‹è­¦å‘Šä¿¡æ¯\n```text\n[13:08:48] [Server thread/WARN]: Can't keep up! Is the server overloaded? Running 5097ms or 101 ticks behind\n```\nåˆ™è¯´æ˜äº†æœåŠ¡å™¨é…ç½®è¾ƒå·®ï¼Œå¼€æœåˆæœŸtpsè¾ƒä½ï¼Œå¾…åœ°å›¾åŠ è½½å®Œæ¯•åtpså°†ä¼šæ¢å¤æ­£å¸¸\n## å®‰è£…screen\nè‹¥ä½¿ç”¨sshè¿œç¨‹è¿æ¥æœåŠ¡å™¨ï¼Œåˆ™åœ¨å…³é—­è¿æ¥åæœåŠ¡å™¨ä¹Ÿä¼šè‡ªåŠ¨å…³é—­ï¼Œæ­¤æ—¶éœ€è¦screenè®©æœåŠ¡å™¨èƒ½åœ¨åå°æŒç»­è¿è¡Œ\nè¿è¡Œå¦‚ä¸‹å‘½ä»¤å®‰è£…screen\n```bash\nsudo apt install screen\n```\nåˆ›å»ºä¸€ä¸ªscreen\n```bash\nscreen -S [screençš„åå­—]\n```\nåœ¨screenå†…éƒ¨å’Œä¹‹å‰ä¸€æ ·è¿è¡Œshæ–‡ä»¶è¿›è¡Œå¼€æœï¼Œå”¯ä¸€ä¸åŒçš„æ˜¯å½“å…³é—­è¿æ¥åæœåŠ¡å™¨å°†ä»ç„¶åœ¨åå°è¿è¡Œ\né‡æ–°è¿›å…¥è¯¥screen\n```bash\nscreen -r [screençš„åå­—]\n```\n## åç»­çš„é…ç½®\n> bukkit.ymlå’Œspigot.ymlå¤šç”¨äºæœåŠ¡å™¨è°ƒä¼˜ï¼Œè¿™é‡Œä¸å†èµ˜è¿°\n\nserver.propertiesä¸­å‡ ä¸ªé‡è¦çš„é…ç½®ï¼š\n- gamemode   æ¸¸æˆæ¨¡å¼\n- difficulty   æ¸¸æˆéš¾åº¦\n- pvp   æ˜¯å¦å…è®¸pvp\n- max-player   æœ€å¤§ç©å®¶æ•°é‡\n- server-port   æœåŠ¡å™¨ç«¯å£\n    - å¦‚æœæ˜¯ç§æœï¼Œä¸å»ºè®®ä½¿ç”¨é»˜è®¤25565ç«¯å£ï¼Œé˜²æ­¢æœ‰é™Œç”Ÿäººæ‰«IPè¿›å…¥æœåŠ¡å™¨ \n- view-distance   æœåŠ¡å™¨è§†è·\n    - è¿‡å¤§ä¼šé€ æˆç©å®¶è¿›å…¥å’Œé‡ç”Ÿæ—¶çš„å¡é¡¿ï¼Œå¦‚æœæœåŠ¡å™¨å¸¦å®½ä¸è¶³å»ºè®®è°ƒæ•´ä¸º6æˆ–è€…æ›´ä½\n- online-mode   æ­£ç‰ˆéªŒè¯\n    - å»ºè®®å¼€å¯ \n- motd   æœåŠ¡å™¨ç®€ä»‹","tags":["Minecraft","spigot"],"categories":["è®¡è½¯æ‚è°ˆ"]},{"title":"CSAPP - BombLab","url":"/20220619/csapp-bomblab/","content":"## å‰ç½®ä»»åŠ¡\n- å¯¹bombè¿›è¡Œåæ±‡ç¼–\n```shell\nobjdump -d bomb > bomb.txt\n```\n![0](https://d-sketon.top/img/csapp-bomblab/0.png)\næŸ¥çœ‹åç¼–è¯‘åçš„ç»“æœå¯ä»¥çŸ¥é“æ¯ä¸ªé˜¶æ®µè¾“å…¥ç­”æ¡ˆçš„æŒ‡é’ˆéƒ½å­˜å…¥äº†%rdiï¼ˆå‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°ï¼‰ï¼Œå¹¶å°†è¯¥å‚æ•°ä¼ å…¥phase_1~6å‡½æ•°\n## Phase 1\n![1](https://d-sketon.top/img/csapp-bomblab/1.png)\nå°†0x402400ç§»å…¥%esiå¹¶è°ƒç”¨string_not_equalå‡½æ•°ï¼Œè€Œstring_not_equalå‡½æ•°ç”¨äºåˆ¤æ–­ä¸¤ä¸ªå­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰ï¼Œè‹¥ç›¸ç­‰åˆ™è¿”å›0ï¼Œå¦åˆ™è¿”å›1\n349è¡Œstring_not_equalæ¯”è¾ƒè¾“å…¥å­—ç¬¦å’Œ0x402400çš„å†…å®¹\n![2](https://d-sketon.top/img/csapp-bomblab/2.png)\n350~351è¡Œå°†å‡½æ•°çš„è¿”å›å€¼ç›¸ä¸å¹¶åˆ¤æ–­ç»“æœæ˜¯å¦ä¸º0ï¼Œç”±äºåªæœ‰0&0çš„ç»“æœæ‰ä¸º0ï¼Œæ‰€ä»¥%raxä¸ä¸º0å°±ä¼šçˆ†ç‚¸ï¼Œå³è¾“å…¥å­—ç¬¦ä¸€å®šè¦å’Œ0x402400å†…çš„å†…å®¹ç›¸ç­‰\nè°ƒç”¨gdbæŸ¥çœ‹0x402400ï¼š\n![3](https://d-sketon.top/img/csapp-bomblab/3.png)\nç­”æ¡ˆå³ä¸ºBorder relations with Canada have never been better.\n## Phase 2\n![4](https://d-sketon.top/img/csapp-bomblab/4.png)\n360è¡Œæ ˆé¡¶æŒ‡é’ˆèµ‹å€¼ç»™%rsiï¼Œ361è¡Œè°ƒç”¨read_six_numberså‡½æ•°ï¼Œè€Œread_six_numberå‡½æ•°è¯»å…¥è¾“å…¥çš„å…­ä¸ªæ•°å­—å¹¶å‹å…¥æ ˆä¸­\n![5](https://d-sketon.top/img/csapp-bomblab/5.png)\n362~364è¡Œæ¯”è¾ƒæ ˆé¡¶å…ƒç´ ï¼ˆè¾“å…¥çš„ç¬¬ä¸€ä¸ªæ•°ï¼‰æ˜¯å¦å’Œ1ç›¸ç­‰ï¼Œå¦‚æœä¸ç›¸ç­‰åˆ™çˆ†ç‚¸ï¼Œæ‰€ä»¥ç¬¬ä¸€ä¸ªæ•°ä¸€å®šä¸º1ï¼Œè·³åˆ°0x400f30:\n![6](https://d-sketon.top/img/csapp-bomblab/6.png)\n375~377è¡Œæ ˆä¸­ç¬¬äºŒä¸ªå…ƒç´ çš„æŒ‡é’ˆèµ‹å€¼ç»™%rbxï¼Œå¹¶å°†æ ˆä¸­ç¬¬7ä¸ªå…ƒç´ çš„æŒ‡é’ˆï¼ˆç»ˆæ­¢æ¡ä»¶ï¼‰èµ‹å€¼ç»™%rbpï¼Œæ¥ç€è·³å›0x400f17è¿›å…¥å¾ªç¯ï¼š\n![7](https://d-sketon.top/img/csapp-bomblab/7.png)\n%rbxæœ¬å­˜ç€æ ˆä¸­ç¬¬äºŒä¸ªå…ƒç´ çš„æŒ‡é’ˆï¼Œ366è¡Œå°†æŒ‡é’ˆå‘é¡¶éƒ¨ç§»åŠ¨ï¼Œå³å°†æ ˆé¡¶å…ƒç´ èµ‹å€¼ç»™%eax,\n367è¡Œå°†%eaxå…ƒç´ ä¹˜2ï¼Œå³%eaxå…ƒç´ å˜ä¸º2\ngdbæ–­ç‚¹æµ‹è¯•è¯å®æ¨æµ‹ï¼š\n![8](https://d-sketon.top/img/csapp-bomblab/8.png)\n368è¡Œå°†%eaxå’Œæ ˆä¸­ç¬¬äºŒä¸ªå…ƒç´ æ¯”è¾ƒï¼Œå¦‚æœä¸ç›¸ç­‰åˆ™çˆ†ç‚¸ï¼Œæ‰€ä»¥è¾“å…¥çš„ç¬¬äºŒä¸ªå…ƒç´ åº”è¯¥ä¸º2\nè·³åˆ°0x400f25:\n![9](https://d-sketon.top/img/csapp-bomblab/9.png)\n%rbxä¸­çš„æŒ‡é’ˆå‘æ ˆåº•ç§»åŠ¨ï¼Œå¹¶å’Œç»ˆæ­¢æ¡ä»¶æ¯”è¾ƒï¼Œå¦‚æœæ²¡æœ‰åˆ°ç¬¬å…­ä¸ªå…ƒç´ åˆ™é‡æ–°è¿”å›0x400f17\nå½’çº³å¯å¾—å¾ªç¯ä¸­ï¼š\n1.%eaxå­˜ç€æ ˆä¸­å‰ä¸€ä¸ªå…ƒç´ çš„å€¼\n2.%eaxä¹˜ä»¥äºŒ\n3.%eaxå’Œæ ˆä¸­åä¸€ä¸ªå…ƒç´ æ¯”è¾ƒï¼Œå¦‚æœç›¸ç­‰åˆ™ç»§ç»­å¾ªç¯ç›´åˆ°ç»“æŸï¼Œå¦åˆ™ç›´æ¥çˆ†ç‚¸\nç­”æ¡ˆå³ä¸º1 2 4 8 16 32\n## Phase 3\n![10](https://d-sketon.top/img/csapp-bomblab/10.png)\n385~386è¡Œå°†æ ˆä¸­ç¬¬ä¸ª4å…ƒç´ çš„æŒ‡é’ˆèµ‹å€¼ç»™%rcxï¼ˆå‡½æ•°ç¬¬å››ä¸ªå‚æ•°ï¼‰ï¼Œç¬¬3ä¸ªå…ƒç´ çš„æŒ‡é’ˆèµ‹å€¼ç»™%rdxï¼ˆå‡½æ•°ç¬¬ä¸‰ä¸ªå‚æ•°ï¼‰\n387~389è¡Œå°†0x4025cfèµ‹å€¼ç»™%esiï¼ˆå‡½æ•°ç¬¬äºŒä¸ªå‚æ•°ï¼‰ï¼Œå°†%eaxç½®0ï¼Œå¹¶è°ƒç”¨sscanfå‡½æ•°\nsscanfå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºè¾“å…¥æºï¼Œç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºformatå‚æ•°ï¼Œè¿”å›è¾“å…¥æºæŒ‰ç…§formatå‚æ•°è¿›è¡ŒåŒ¹é…çš„ä¸ªæ•°ï¼Œå¹¶å°†åŒ¹é…çš„å­—ç¬¦ä¸²ä¾æ¬¡æ”¾å…¥ç¬¬ä¸‰å’Œç¬¬å››ä¸ªå‚æ•°ä¸­\nè°ƒç”¨gdbæŸ¥çœ‹0x4025cfï¼š\n![11](https://d-sketon.top/img/csapp-bomblab/11.png)\n390~392è¡Œå¦‚æœå‡½æ•°è¿”å›å€¼å¤§äº1ï¼ˆç­‰äº2ï¼‰åˆ™ä¸ä¼šçˆ†ç‚¸ï¼Œæ‰€ä»¥ç­”æ¡ˆåº”ä¸ºä¸¤ä¸ªæ•´æ•°\n![12](https://d-sketon.top/img/csapp-bomblab/12.png)\n393è¡Œå°†æ ˆä¸­ç¬¬ä¸‰ä¸ªå…ƒç´ ï¼ˆè¾“å…¥çš„ç¬¬ä¸€ä¸ªæ•°å­—ï¼‰å’Œ7è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœå¤§äºåˆ™çˆ†ç‚¸ï¼Œè¯´æ˜ç¬¬ä¸€ä¸ªæ•°å­—èŒƒå›´åœ¨0~7\n395è¡Œå°†è¾“å…¥çš„ç¬¬ä¸€ä¸ªæ•°å­—å­˜å…¥%eaxï¼Œ396è¡Œè¿›å…¥è·³è½¬è¡¨ï¼Œè·³è½¬åˆ°0x402470+%rax\\*8\nè°ƒç”¨gdbæŸ¥çœ‹è·³è½¬è¡¨ï¼š\n![13](https://d-sketon.top/img/csapp-bomblab/13.png)\næ ¹æ®è·³è½¬è¡¨æŸ¥çœ‹æ±‡ç¼–ä»£ç ï¼š\n![14](https://d-sketon.top/img/csapp-bomblab/14.png)\n%raxä»0åˆ°7éƒ½æœ‰ä¸€ä¸€å¯¹åº”çš„è·³è½¬ä»£ç ï¼Œè¯´æ˜æœ‰8ç§ç­”æ¡ˆ\nä»¥ç¬¬ä¸€ä¸ªæ•°å­—ä¸º0ä¸ºä¾‹ï¼š\næ ¹æ®è·³è½¬è¡¨è·³è½¬åˆ°397è¡Œï¼Œè€Œåœ¨397è¡Œå°†%eaxèµ‹å€¼ä¸º0xcfï¼Œå¹¶è·³è½¬åˆ°0x400fbeï¼Œæ¯”è¾ƒ%eaxï¼ˆ0xcfï¼‰æ˜¯å¦å’Œæ ˆä¸­ç¬¬å››ä¸ªå…ƒç´ ç›¸ç­‰ï¼Œä¸ç›¸ç­‰åˆ™çˆ†ç‚¸ï¼Œæ‰€ä»¥å½“ç¬¬ä¸€ä¸ªæ•°å­—ä¸º0æ—¶ï¼Œç¬¬äºŒä¸ªæ•°å­—ä¸º207\næ ¹æ®è·³è½¬è¡¨å¯ä»¥æ¨æ–­å‡ºå…¶ä½™7ä¸ªç­”æ¡ˆï¼š\n1 311\n2 707\n3 256\n4 389\n5 206\n6 682\n7 327\n## Phase 4\n![15](https://d-sketon.top/img/csapp-bomblab/15.png)\n![16](https://d-sketon.top/img/csapp-bomblab/16.png)\nå‰ä¸€éƒ¨åˆ†å’Œphase_3å®Œå…¨ç›¸åŒï¼Œè¾“å…¥åº”ä¸ºä¸¤ä¸ªæ•´æ•°ï¼Œä¸”æ”¾äºæ ˆä¸­ç¬¬ä¸‰ä¸ªä½ç½®å’Œç¬¬å››ä¸ªä½ç½®ä¸­\n![17](https://d-sketon.top/img/csapp-bomblab/17.png)\n455è¡Œåˆ¤æ–­è¾“å…¥çš„ç¬¬ä¸€ä¸ªæ•°å­—æ˜¯å¦å°äºç­‰äº14ä¸”éè´Ÿï¼ˆæ— ç¬¦å·ï¼‰ï¼Œå¦åˆ™çˆ†ç‚¸\n![18](https://d-sketon.top/img/csapp-bomblab/18.png)\n457~460è¡Œ%edxï¼ˆç¬¬ä¸‰ä¸ªå‚æ•°ï¼‰èµ‹å€¼ä¸º14ï¼Œ%esiï¼ˆç¬¬äºŒä¸ªå‚æ•°ï¼‰èµ‹å€¼ä¸º0ï¼Œ%ediï¼ˆç¬¬ä¸€ä¸ªå‚æ•°ï¼‰èµ‹å€¼ä¸ºè¾“å…¥çš„ç¬¬ä¸€ä¸ªæ•°å­—ï¼Œ%rcxï¼ˆç¬¬å››ä¸ªå‚æ•°ï¼‰ä¹‹å‰èµ‹å€¼ä¸ºè¾“å…¥çš„ç¬¬äºŒä¸ªæ•°å­—ï¼Œè°ƒç”¨func4å‡½æ•°\nå…ˆåˆ†æfunc4åçš„ä»£ç ï¼š\n![19](https://d-sketon.top/img/csapp-bomblab/19.png)\n461~462è¡Œåˆ¤æ–­func4å‡½æ•°çš„è¿”å›å€¼æ˜¯å¦ä¸º0ï¼Œä¸ä¸º0åˆ™çˆ†ç‚¸\n463è¡Œåˆ¤æ–­è¾“å…¥çš„ç¬¬äºŒä¸ªæ•°å­—æ˜¯å¦ä¸º0ï¼Œä¸ä¸º0åˆ™çˆ†ç‚¸ï¼Œæ‰€ä»¥è¾“å…¥çš„ç¬¬äºŒä¸ªæ•°å­—ä¸€å®šä¸º0\nç”±äºfunc4å‡½æ•°ä¸­åŒ…å«é€’å½’ï¼Œæ‰€ä»¥é€‰æ‹©åæ±‡ç¼–ä¸ºcè¯­è¨€ï¼š\n![20](https://d-sketon.top/img/csapp-bomblab/20.png)\n```c\nint a = 7, b = 0, c = 14, d = 0, rax;\nvoid func4()\n{\n    rax = ((int)(c - b + ((unsigned)(c - b) >> 31))) >> 1;\n    d = b + rax;\n    if (d > a)\n    {\n        c = d - 1;\n        func4();\n        rax = rax * 2;\n    }\n    else if (d < a)\n    {\n        rax = 0;\n        b = d + 1;\n        func4();\n        rax = rax * 2 + 1;\n    }\n    else if (d == a)\n        rax = 0;\n}\n```\nå‘ç°ç¬¬ä¸€æ¬¡è¿›å…¥å‡½æ•°ä¸­æ—¶dçš„å€¼ä¸º7ï¼Œè€Œå½“è¾“å…¥çš„æ•°ä¹Ÿä¸º7æ—¶ä¸ºæœ€ç®€å•çš„ä¸€ç§æƒ…å†µï¼Œå³æ—¢ä¸ä¼šè¿›å…¥ï¼ˆd>aï¼‰çš„é€’å½’ï¼Œä¹Ÿä¸ä¼šè¿›å…¥ï¼ˆd\\<aï¼‰çš„é€’å½’ï¼Œç›´æ¥è¿”å›0\n\n> é™¤äº†æœ€ç®€å•çš„7 0è¿™ä¸€ç§æƒ…å†µï¼Œç¬¬ä¸€ä¸ªæ•°ä¹Ÿå¯ä»¥ä¸º3æˆ–1æˆ–0\n\n## Phase 5\n![22](https://d-sketon.top/img/csapp-bomblab/22.png)\n472è¡Œå°†è¾“å…¥å­—ç¬¦ä¸²çš„æŒ‡é’ˆèµ‹å€¼ç»™%rbxï¼Œ476è¡Œæ¸…ç©º%eaxï¼Œ477è¡Œè°ƒç”¨string_lengthå‡½æ•°ï¼Œ478~480è¡Œå¦‚æœå‡½æ•°è¿”å›å€¼ä¸ä¸º6åˆ™çˆ†ç‚¸ï¼Œè¯´æ˜ç­”æ¡ˆä¸ºé•¿åº¦ä¸º6çš„å­—ç¬¦ä¸²\n![23](https://d-sketon.top/img/csapp-bomblab/23.png)\nè·³åˆ°0x4010d2å°†%eaxæ¸…ç©ºï¼Œè·³å›0x40108b\n![24](https://d-sketon.top/img/csapp-bomblab/24.png)\n%raxç­‰äº0ï¼Œæ‰€ä»¥482è¡Œ%ecxä¸ºè¾“å…¥å­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼Œ483è¡Œå°†ç¬¬ä¸€ä¸ªå­—ç¬¦å­˜å…¥æ ˆé¡¶ï¼Œ484è¡Œ~485è¡Œå°†ç¬¬ä¸€ä¸ªå­—ç¬¦å­˜å…¥%rdxå¹¶ä¸ä¸Š0xfï¼ˆç›¸å½“äºmod16ï¼‰ï¼Œ486è¡Œå°†%rdx+0x4024b0é‡æ–°èµ‹å€¼ç»™%rdx\nè°ƒç”¨gdbæŸ¥çœ‹0x4024b0ï¼š\n![25](https://d-sketon.top/img/csapp-bomblab/25.png)\nå³%rdxä¸­å­˜æ”¾ç€maduiersnfotvbylçš„ç¬¬ï¼ˆè¾“å…¥çš„ç¬¬ä¸€ä¸ªæ•°mod16ï¼‰ä½çš„å­—ç¬¦\n487è¡Œ~490è¡Œå°†%rdxé‡æ–°å­˜å…¥æ ˆä¸­å‘ä¸‹0x10ä½ï¼Œ%raxåŠ 1å¹¶å’Œ6æ¯”è¾ƒï¼Œå¦‚æœä¸ç­‰äº6åˆ™è·³å›0x4024b0è¿›å…¥å¾ªç¯\nå½’çº³å¯å¾—å¾ªç¯åï¼šä»æ ˆä¸­å‘ä¸‹0x10ä½èµ·èµ·æ¯ä¸ªå­—èŠ‚ï¼ˆå…±6ä¸ªå­—èŠ‚ï¼‰å­˜æ”¾ç€maduiersnfotvbylçš„ç¬¬ï¼ˆè¾“å…¥çš„ç¬¬næ•°mod16ï¼‰ä½çš„å­—ç¬¦\n![26](https://d-sketon.top/img/csapp-bomblab/26.png)\n491è¡Œå°†0x10èµ·ç¬¬7ä¸ªå­—èŠ‚ç½®0ï¼Œ492~496è¡Œå°†0x40245eèµ‹å€¼ç»™%esiï¼ˆç¬¬äºŒä¸ªå‚æ•°ï¼‰ï¼Œå°†æ ˆå‘ä¸‹0x10ä½åœ°å€å­˜å…¥%rdiï¼ˆç¬¬ä¸€ä¸ªå‚æ•°ï¼‰å¹¶è°ƒç”¨strings_not_equalå‡½æ•°ï¼Œå¦‚æœè¿”å›å€¼ä¸ç­‰äº0åˆ™çˆ†ç‚¸\nè°ƒç”¨gdbæŸ¥çœ‹0x40245eï¼š\n![27](https://d-sketon.top/img/csapp-bomblab/27.png)\nè¯´æ˜æ ˆä¸­å­˜æ”¾çš„å†…å®¹åº”è¯¥ä¸ºflyersï¼Œæ¨å¾—è¾“å…¥çš„å­—ç¬¦ä¸²mod16ååº”è¯¥ä¸º12,18,17,6,7,8ï¼Œé€šè¿‡asciiç åæ¨å¯å¾—è¾“å…¥çš„ç­”æ¡ˆåº”è¯¥ä¸ºionefg\n## Phase 6\n![28](https://d-sketon.top/img/csapp-bomblab/28.png)\n518~519è¡Œå°†æ ˆæŒ‡é’ˆèµ‹å€¼ç»™%r13å’Œ%rsiï¼Œå¹¶è°ƒç”¨read_six_numberså‡½æ•°ï¼Œæ‰€ä»¥ç­”æ¡ˆåº”ä¸º6ä¸ªæ•´æ•°\nread_six_numberå‡½æ•°å°†è¾“å…¥çš„æ•°å­—ä¾æ¬¡å­˜å…¥æ ˆä¸­\n![29](https://d-sketon.top/img/csapp-bomblab/29.png)\n521~528è¡Œå°†æ ˆæŒ‡é’ˆèµ‹å€¼ç»™%r14å’Œ%rbpï¼Œ%r12dèµ‹å€¼ä¸º0ï¼ˆè®¡æ•°å™¨ï¼‰ï¼Œå°†æ ˆé¡¶ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆè¾“å…¥çš„è¯»ä¸€ä¸ªæ•°å­—ï¼‰èµ‹å€¼ç»™%eaxï¼Œå°†%eaxå‡1å¹¶å’Œ5æ¯”è¾ƒï¼Œå¦‚æœæ¯”5å¤§å°±çˆ†ç‚¸ï¼Œè¯´æ˜è¾“å…¥çš„ç¬¬ä¸€ä¸ªæ•°å­—ä¸èƒ½å¤§äº6ï¼Œä¸”å¿…é¡»å¤§äºç­‰äº1ï¼ˆjbeæ¯”è¾ƒçš„æ˜¯æ— ç¬¦å·æ•´æ•°ï¼‰\n![30](https://d-sketon.top/img/csapp-bomblab/30.png)\n529~531è¡Œå°†è®¡æ•°å™¨%r12dåŠ ä¸Š1å¹¶åˆ¤æ–­æ˜¯å¦ç­‰äº6ï¼Œå¦‚æœç­‰äº6åˆ™è·³å‡ºå¤§å¾ªç¯è¿›å…¥0x401153\nå¦‚æœä¸ç­‰äº6åˆ™ç»§ç»­è¿›å…¥ä¸‹ä¸€æ­¥ï¼š\n![31](https://d-sketon.top/img/csapp-bomblab/31.png)\nå°†è®¡æ•°å™¨èµ‹å€¼ç»™%ebxï¼ˆç¬¬äºŒä¸ªè®¡æ•°å™¨ï¼‰å’Œ%raxï¼Œå¹¶å°†æ ˆä¸­ç¬¬%raxä¸ªå…ƒç´ é‡æ–°èµ‹å€¼ç»™%eaxå¹¶å’Œæ ˆé¡¶å…ƒç´ æ¯”è¾ƒï¼Œå¦‚æœç›¸ç­‰åˆ™çˆ†ç‚¸ï¼Œå¦‚æœä¸ç›¸ç­‰åˆ™è¿›å…¥ä¸‹ä¸€æ­¥ï¼š\n![32](https://d-sketon.top/img/csapp-bomblab/32.png)\n538~542è¡Œ%ebxåŠ ä¸Š1å¹¶å’Œ5æ¯”è¾ƒï¼Œå¦‚æœå°äºç­‰äº5åˆ™è·³å›0x401135é‡å¤æ¯”è¾ƒæ ˆä¸­ç¬¬%raxä¸ªå…ƒç´ å’Œæ ˆé¡¶å…ƒç´ ï¼Œå¦‚æœå¤§äº5åˆ™å°†%r13åŠ ä¸Š4ï¼Œè·³ä¼šå¾ªç¯å¼€å§‹0x401114\nç”±æ­¤å¯ä»¥å½’çº³ä¸Šè¿°äºŒé‡å¾ªç¯ä»£ç ï¼š\nå¤§å¾ªç¯æ¯”è¾ƒè¾“å…¥çš„æ¯ä¸ªæ•°å­—æ˜¯å¦åœ¨1åˆ°6ä¹‹é—´ï¼Œå°å¾ªç¯æ¯”è¾ƒå¤§å¾ªç¯ä¸­ä¸­ç¬¬iä½ï¼ˆiè¡¨ç¤ºå¤§å¾ªç¯äº†å‡ è½®ï¼‰è¾“å…¥å’Œä¹‹åè¾“å…¥çš„æ•°å­—æ˜¯å¦ç›¸ç­‰\nå³è¾“å…¥çš„æ¯ä¸ªæ•°å­—æ˜¯å¦åœ¨1åˆ°6ä¹‹é—´ä¸”äº’ä¸ç›¸ç­‰\n![33](https://d-sketon.top/img/csapp-bomblab/33.png)\ncä»£ç ï¼š\n```c\nint input[6] = { 1,2,3,4,5,6 };\nvoid phase_6()\n{\n    for (int i = 0; i < 6; i++)\n    {\n        if (input[i] > 6 || input[i] < 1)\n        {\n            cout << \"bomb\" << endl;\n            break;\n        }\n        for (int j = i + 1; j <= 5; j++)\n        {\n            if (input[i] == input[j])\n            {\n                cout << \"bomb\" << endl;\n                break;\n            }\n        }\n    }\n}\n```\n![35](https://d-sketon.top/img/csapp-bomblab/35.png)\n543~548è¡Œå°†æ ˆä¸­ç¬¬ä¸ƒä¸ªå…ƒç´ å­˜å…¥%rsiï¼ˆå¾ªç¯ç»ˆæ­¢æ¡ä»¶ï¼‰ï¼Œå°†%r14ï¼ˆæ ˆæŒ‡é’ˆï¼‰èµ‹å€¼ç»™%raxï¼Œå°†7èµ‹å€¼ç»™%ecxï¼Œå¹¶å°†ï¼ˆ7-æ ˆé¡¶å…ƒç´ ï¼‰é‡æ–°èµ‹å€¼å›æ ˆä¸­ï¼Œ%raxå‘æ ˆåº•ç§»åŠ¨ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœ%raxä¸ç­‰äº%rsiï¼ˆç»ˆæ­¢æ¡ä»¶ï¼‰åˆ™å¾ªç¯ä¸Šè¿°æ“ä½œï¼ˆè¾“å…¥çš„æ•´æ•°å–ç›¸åæ•°å¹¶åŠ 7ï¼‰\nå¾ªç¯è·³å‡ºåå°†%esiï¼ˆå¤§å¾ªç¯çš„è®¡æ•°å™¨ï¼‰æ¸…é›¶å¹¶è·³åˆ°0x401197ï¼š\n![36](https://d-sketon.top/img/csapp-bomblab/36.png)\n%ecxé¦–å…ˆå­˜å…¥æ ˆé¡¶å…ƒç´ ï¼Œå¹¶å’Œ1æ¯”è¾ƒï¼Œå¦‚æœå°äºç­‰äº1åˆ™è·³åˆ°0x401183ï¼š\n![37](https://d-sketon.top/img/csapp-bomblab/37.png)\n561~562è¡Œå°†0x6032d0å­˜å…¥æ ˆé¡¶å‘ä¸‹0x20ä¸ªå­—èŠ‚çš„ä½ç½®ï¼Œ563è¡Œå°†%rsiåŠ ä¸Š1å¹¶å’Œ0x18æ¯”è¾ƒï¼Œå¦‚æœç›¸ç­‰åˆ™è·³å‡ºå¾ªç¯ï¼Œå¦åˆ™567è¡Œ%ecxå˜ä¸ºæ ˆä¸­ç¬¬äºŒä¸ªå…ƒç´ ï¼Œç»§ç»­å’Œ1æ¯”è¾ƒ\nè€Œè‹¥æ ˆä¸­ç›®å‰éå†åˆ°çš„å…ƒç´ å¤§äº1ï¼Œåˆ™è·³è¿‡è·³è½¬ä»£ç å‘ä¸‹è¿è¡Œ\n![38](https://d-sketon.top/img/csapp-bomblab/38.png)\n%eaxï¼ˆå°å¾ªç¯çš„è®¡æ•°å™¨ï¼ŒåŒæ ·ç”¨ä½œæ¯”è¾ƒï¼‰ç½®1ï¼ŒåŒæ ·å°†0x6032d0å­˜å…¥%eaxï¼Œå¹¶è·³è½¬åˆ°0x401176ï¼š\n![39](https://d-sketon.top/img/csapp-bomblab/39.png)\n555è¡Œ%rdxåŠ ä¸Š0x8å¹¶å°†æŒ‡é’ˆç›¸å¯¹åº”çš„å…ƒç´ é‡æ–°èµ‹å€¼ç»™%rdx\nè°ƒç”¨gdbæŸ¥çœ‹0x6032d0ï¼š\n![40](https://d-sketon.top/img/csapp-bomblab/40.png)\nå‘ç°å…¶ä¸ºé“¾è¡¨ï¼Œè€Œ%raxåŠ ä¸Š0x8å¹¶å°†æŒ‡é’ˆç›¸å¯¹åº”çš„å…ƒç´ é‡æ–°èµ‹å€¼ç›¸å½“äº%rdx+0x10\nè®¡æ•°å™¨%eaxåŠ 1å¹¶å’Œ%ecxï¼ˆæ ˆä¸­ç›®å‰éå†åˆ°çš„å…ƒç´ ï¼‰æ¯”è¾ƒï¼Œå¦‚æœä¸ç›¸ç­‰åˆ™è·³å›0x401176è¿›è¡Œå¾ªç¯ç›´åˆ°è®¡æ•°å™¨%eaxå’Œ%ecxç›¸ç­‰ï¼Œæ­¤æ—¶%rdxåº”è¯¥ç­‰äº0x6032d0+0x10*ï¼ˆæ ˆä¸­ç›®å‰éå†åˆ°çš„æ•°å­—-1ï¼‰ï¼Œè·³åˆ°0x401188\nå°†%rdxçš„å€¼èµ‹å€¼åˆ°æ ˆä¸­%rsi\\*2+0x20ä½ç½®ï¼Œå¹¶å°†%rsiï¼ˆå¤§å¾ªç¯è®¡æ•°å™¨ï¼‰åŠ ä¸Š0x4ï¼Œå¹¶å’Œ0x18æ¯”è¾ƒï¼Œå¦‚æœä¸ç›¸ç­‰ï¼ˆæ²¡æœ‰éå†å®Œå…­ä¸ªå…ƒç´ ï¼‰åˆ™ç»§ç»­å¾ªç¯ï¼Œå¦åˆ™è·³å‡ºå¾ªç¯è¿›å…¥0x4011ab\nç”±æ­¤å¯ä»¥å½’çº³ä¸Šè¿°äºŒé‡å¾ªç¯ä»£ç ï¼š\næ¯æ¬¡å°†0x6032d0+0x10\\*ï¼ˆæ ˆä¸­ç›®å‰éå†åˆ°çš„æ•°å­—-1ï¼‰èµ‹å€¼åˆ°æ ˆä¸­ï¼ˆæ ˆä¸­ç›®å‰éå†åˆ°ç¬¬å‡ ä¸ªæ•°ï¼‰\\*8+0x20ä½ç½®\nå³æ ˆä¸­ä»æ ˆé¡¶èµ·å‘ä¸‹ï¼ˆ1ï¼‰0x20ï¼Œï¼ˆ2ï¼‰00x28ï¼Œï¼ˆ3ï¼‰0x30ï¼Œï¼ˆ4ï¼‰0x38ï¼Œï¼ˆ5ï¼‰0x40ï¼Œï¼ˆ6ï¼‰0x48åˆ†åˆ«ä¿å­˜äº†0x6032d0+0x10\\*ï¼ˆ6-aiï¼‰\n![41](https://d-sketon.top/img/csapp-bomblab/41.png)\n![42](https://d-sketon.top/img/csapp-bomblab/42.png)\n573~575è¡Œå°†æ ˆé¡¶èµ·å‘ä¸‹0x20çš„å…ƒç´ å­˜å…¥%rbxï¼Œå°†æ ˆé¡¶èµ·å‘ä¸‹0x28çš„åœ°å€å­˜å…¥%raxï¼Œå°†æ ˆé¡¶èµ·å‘ä¸‹0x50çš„åœ°å€å­˜å…¥%rsiï¼ˆå¾ªç¯ç»ˆæ­¢æ¡ä»¶ï¼‰\n576~578è¡Œå°†å’Œ%rcxæ ˆä¸­éå†åˆ°çš„æŒ‡é’ˆæ‰€å¯¹åº”çš„èŠ‚ç‚¹çš„nextåœ°å€ï¼ˆ%rcx+0x8ï¼‰ç½®æ¢ä¸ºæ ˆä¸­éå†åˆ°çš„åä¸€ä¸ªæŒ‡é’ˆï¼ˆ%rdxï¼‰ï¼Œ%raxå‘åç§»åŠ¨ï¼Œå¹¶å°†%raxå’Œç»ˆæ­¢æ¡ä»¶æ¯”è¾ƒï¼Œå¦‚æœä¸ç›¸ç­‰åˆ™%rcxä¹Ÿå‘åç§»åŠ¨å¹¶ç»§ç»­å¾ªç¯ï¼Œå¦åˆ™è·³åˆ°0x4011d2å°†æœ€ç»ˆçš„èŠ‚ç‚¹çš„æŒ‡é’ˆç½®ç©º\nï¼ˆæ ¹æ®æ ˆä¸­å­˜å‚¨çš„æŒ‡é’ˆå¯¹é“¾è¡¨è¿›è¡Œé‡æ’ï¼‰\n![43](https://d-sketon.top/img/csapp-bomblab/43.png)\n586è¡Œ%ebpç½®5ï¼ˆè®¡æ•°å™¨ï¼‰ï¼Œ%raxç½®ä¸ºæ ˆä¸­ç¬¬ä¸€ä¸ªå…ƒç´ æŒ‡é’ˆæŒ‡å‘çš„èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æŒ‡é’ˆï¼Œ%rbxä¸ºæ ˆä¸­ç¬¬ä¸€ä¸ªå…ƒç´ æŒ‡é’ˆï¼Œå¹¶å°†ï¼ˆ%raxï¼‰ä½å››å­—èŠ‚å’Œï¼ˆ%rbxï¼‰æ¯”è¾ƒï¼Œå¦‚æœï¼ˆ%rbxï¼‰æ¯”ï¼ˆ%raxï¼‰å°åˆ™çˆ†ç‚¸ï¼Œå¦åˆ™ç»§ç»­å¾ªç¯ç›´åˆ°è®¡æ•°å™¨ä¸º0ï¼Œå³ä»é‡æ’åºé“¾è¡¨çš„ç¬¬äºŒä¸ªèŠ‚ç‚¹å¼€å§‹ä¾æ¬¡æ¯”è¾ƒå‰èŠ‚ç‚¹å’Œè¯¥èŠ‚ç‚¹çš„ä½å››ä½å¤§å°\nä¸ºäº†ä¸çˆ†ç‚¸ï¼Œé‡æ’åºé“¾è¡¨åº”ä¸ºé™åºï¼Œç”±æ­¤å¯åæ¨ï¼š\nç¬¬1ä¸ªæ•°â€”â€”>ï¼ˆ924æ’ç¬¬3ä½ï¼‰â€”â€”>-3+7=4\nç¬¬2ä¸ªæ•°â€”â€”>ï¼ˆ691æ’ç¬¬4ä½ï¼‰â€”â€”>-4+7=3\nç¬¬3ä¸ªæ•°â€”â€”>ï¼ˆ477æ’ç¬¬5ä½ï¼‰â€”â€”>-5+7=2\nç¬¬4ä¸ªæ•°â€”â€”>ï¼ˆ443æ’ç¬¬6ä½ï¼‰â€”â€”>-6+7=1\nç¬¬5ä¸ªæ•°â€”â€”>ï¼ˆ332æ’ç¬¬1ä½ï¼‰â€”â€”>-1+7=6\nç¬¬6ä¸ªæ•°â€”â€”>ï¼ˆ168æ’ç¬¬2ä½ï¼‰â€”â€”>-2+7=5\n## Secret Phase\nåˆ†æphase_defusedä»£ç ï¼š\n![44](https://d-sketon.top/img/csapp-bomblab/44.png)\n891è¡Œæ¸…ç©º%raxï¼Œ892è¡Œåˆ¤æ–­0x603760æ˜¯å¦å’Œ6ç›¸ç­‰ï¼Œå¦‚æœä¸ç›¸ç­‰åˆ™è·³è¿‡äº†secret_phaseå‡½æ•°ï¼Œæ‰€ä»¥0x603760ä¸€å®šè¦ç­‰äº6\nè°ƒç”¨gdbåœ¨ç¬¬ä¸€é˜¶æ®µç»“æŸååŠ æ–­ç‚¹ï¼Œå¹¶æŸ¥çœ‹0x603760ï¼š\n![45](https://d-sketon.top/img/csapp-bomblab/45.png)\n0x603760ä¸­å­˜æ”¾çš„æ•°å­—ä¸º1ï¼Œæ‰€ä»¥0x603760å­˜æ”¾äº†è¾“å…¥ç­”æ¡ˆçš„æ¬¡æ•°ï¼Œåªæœ‰é€šè¿‡äº†phase_6æ‰ä¼šè¿›å…¥secret_phase\n![46](https://d-sketon.top/img/csapp-bomblab/46.png)\n899è¡Œè°ƒç”¨sscanfï¼Œ900è¡Œå‡½æ•°è¿”å›å€¼å¦‚æœä¸ç­‰äº3å°±ä¼šè·³è¿‡secret_phaseï¼Œè¯´æ˜%ediä¸€å®šè¦å’Œ%esiåŒ¹é…\nè°ƒç”¨gdbæŸ¥çœ‹0x402619ï¼ˆ%esiï¼‰å’Œ0x603870ï¼ˆ%ediï¼‰ï¼š\n![47](https://d-sketon.top/img/csapp-bomblab/47.png)\n0x603870ä¸­å­˜æ”¾äº†ç¬¬å››é˜¶æ®µçš„è¾“å…¥ï¼Œæ‰€ä»¥ç¬¬å››é˜¶æ®µåº”å†è¾“å…¥ä¸€ä¸ªå­—ç¬¦ä¸²\n![48](https://d-sketon.top/img/csapp-bomblab/48.png)\n902è¡Œå°†0x402622èµ‹å€¼ç»™%esiï¼Œ903è¡Œå°†æ ˆä¸­ç¬¬äº”ä¸ªä½ç½®æŒ‡é’ˆèµ‹å€¼ç»™%rdiï¼Œ904~906è¡Œè°ƒç”¨strings_not_equalå‡½æ•°ï¼Œæ¯”è¾ƒ%rdiå’Œ%esiæ‰€æŒ‡å‘çš„å†…å®¹å­—ç¬¦ä¸²æ˜¯å¦ç›¸ç­‰ï¼Œä¸ç›¸ç­‰åˆ™è·³è¿‡secret_phaseå‡½æ•°ï¼Œæ‰€ä»¥ä¸¤è€…å¿…é¡»ç›¸ç­‰\nè°ƒç”¨gdbæŸ¥çœ‹0x402622ï¼š\n![49](https://d-sketon.top/img/csapp-bomblab/49.png)\næ‰€ä»¥ç¬¬å››é˜¶æ®µç­”æ¡ˆåº”ä¸º7 0 DrEvil\nè¿›å…¥éšè—å…³å¡ï¼š\n![50](https://d-sketon.top/img/csapp-bomblab/50.png)\næŸ¥çœ‹secret_phaseå‡½æ•°ä»£ç ï¼š\n![51](https://d-sketon.top/img/csapp-bomblab/51.png)\n622è¡Œå°†è¾“å…¥çš„å­—ç¬¦ä¸²è½¬æˆç›¸åº”çš„10è¿›åˆ¶é•¿æ•´å‹ï¼Œ623è¡Œå°†é•¿æ•´å‹èµ‹å€¼ç»™%rbxï¼Œè¯´æ˜åº”è¾“å…¥ä¸€ä¸ªæ•´æ•°\n![52](https://d-sketon.top/img/csapp-bomblab/52.png)\n624~627è¡Œå¦‚æœè¾“å…¥çš„æ•°å­—å‡ä¸€åå¤§äº1000åˆ™çˆ†ç‚¸ï¼Œè¯´æ˜è¾“å…¥çš„æ•°å­—åº”è¯¥å°äºç­‰äº1001\n![53](https://d-sketon.top/img/csapp-bomblab/53.png)\n628è¡Œå°†%ebxï¼Œå³è¾“å…¥çš„æ•°å­—èµ‹å€¼ç»™ç¬¬äºŒä¸ªå‚æ•°ï¼Œå°†0x6030f0èµ‹å€¼ç»™ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå¹¶è°ƒç”¨fun7\nå…ˆçœ‹fun7ä¹‹åçš„ä»£ç ï¼š\n![54](https://d-sketon.top/img/csapp-bomblab/54.png)\n631~633è¡Œå¦‚æœ%raxä¸ç­‰äº2å°±ä¼šçˆ†ç‚¸ï¼Œè¯´æ˜å‡½æ•°è¿”å›å€¼ä¸€å®šæ˜¯2\nfun7å‡½æ•°ä»£ç ï¼š\n![55](https://d-sketon.top/img/csapp-bomblab/55.png)\n![56](https://d-sketon.top/img/csapp-bomblab/56.png)\né¦–å…ˆä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°å¦‚æœç­‰äº0åˆ™ä¼šè·³åˆ°0x401238å°†%eaxèµ‹å€¼ä¸º0xffffffffï¼Œæ‰€ä»¥ç¬¬ä¸€ä¸ªå‚æ•°ä¸èƒ½ç­‰äº0\nç”±äºfun7å‡½æ•°ä¸­åŒ…å«é€’å½’ï¼Œæ‰€ä»¥é€‰æ‹©åæ±‡ç¼–ä¸ºcè¯­è¨€ï¼š\n```c\nint x[]{36,8,50,22,45,6,107,40,1,99,35,7,20,47,1001};\nint rdx, input=20;\nint key=0;\nvoid fun7()\n{\n    if (key != 15)\n    {\n        rdx = x[key];    //key is address\n        if (rdx < input)\n        {\n            rax = 0;\n            key += 2;\n            fun7();\n            rax = 2 * rax + 1;\n        }\n        else if (rdx == input)\n            rax = 0;\n        else if (rdx > input)\n        {\n            key += 1;\n            fun7();\n            rax = rax * 2;\n        }\n    }\n    else\n        rax = 0xffffffff;\n}\n```\n![57](https://d-sketon.top/img/csapp-bomblab/57.png)\nç”±äºå‡½æ•°æœ€ç»ˆ%raxå¿…é¡»ç­‰äº2ï¼Œæ‰€ä»¥æ ¹æ®cè¯­è¨€ä»£ç ç¡®å®š%raxçš„æœ€ç®€å•çš„é€’å½’é¡ºåºåº”è¯¥ä¸º0->1ï¼ˆ2\\*rax+1ï¼‰->2ï¼ˆrax=rax\\*2ï¼‰\nè°ƒç”¨gdbæŸ¥çœ‹%rdiå†…å­˜æ”¾çš„å†…å®¹ï¼š\n![58](https://d-sketon.top/img/csapp-bomblab/58.png)\nä»0x6030f0èµ·å†…å­˜è¢«åˆ†æˆäº†15å—èŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹åˆ†æˆä¸‰ä¸ªéƒ¨åˆ†ï¼Œç¬¬ä¸€ä¸ªéƒ¨åˆ†ä¸ºæ•°å€¼ï¼Œç¬¬äºŒã€ä¸‰éƒ¨åˆ†ä¸ºæŒ‡é’ˆ\nå¯ä»¥æ¨æ–­å‡ºç¬¬ä¸€æ¬¡èŠ‚ç‚¹åˆå€¼ä¸º36ï¼Œè¿›å…¥rdx > inputéƒ¨åˆ†ï¼Œåœ°å€+0x8å˜ä¸º0x603110ï¼Œå€¼å˜ä¸º8ï¼Œè¾“å…¥æ•°å­—å°äº36\nç¬¬äºŒæ¬¡è¿›å…¥rdx < inputéƒ¨åˆ†ï¼Œåœ°å€+0x10å˜ä¸º0x603150ï¼Œå€¼å˜ä¸º22ï¼Œè¾“å…¥æ•°å­—å¤§äº8\nç¬¬ä¸‰æ¬¡è¿›å…¥rdx=inputéƒ¨åˆ†ï¼Œå³è¾“å…¥æ•°å­—ç­‰äº22ï¼Œä¸”22å¤§äº8ä¸”å°äº36ï¼Œæ‰€ä»¥22ä¸ºç­”æ¡ˆ\n![59](https://d-sketon.top/img/csapp-bomblab/59.png) \n\n> 22å¹¶ä¸æ˜¯å”¯ä¸€çš„ç­”æ¡ˆï¼Œ20ä¹Ÿèƒ½é€šè¿‡éšè—å…³å¡\n","tags":["CSAPP","æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿ"],"categories":["è®¡è½¯æ‚è°ˆ"]},{"title":"CSAPP - MallocLab","url":"/20220619/csapp-malloclab/","content":"\n> æ‰€æœ‰ä»£ç åªé’ˆå¯¹æµ‹è¯•æ•°æ®è¿›è¡Œç‰¹åˆ«ä¼˜åŒ–ï¼Œå¯èƒ½ä¸å…·æœ‰æ™®é€‚æ€§\n\n## ä»£ç é¢„è§ˆ\næ˜¾å¼ç©ºé—²é“¾è¡¨+åˆ†ç¦»é€‚é…+realloc_balæµ‹è¯•ç‚¹ä¼˜åŒ–+binary_balæµ‹è¯•ç‚¹ä¼˜åŒ–\n### å®å®šä¹‰\n![0](https://d-sketon.top/img/csapp-malloclab/0.png)\nå®å®šä¹‰å’Œä¹¦æœ¬åŸºæœ¬ç›¸åŒï¼Œä½†å¢åŠ äº†PREDå’ŒSUCCä¸¤ä¸ªå®ç”¨ä½œå®šä½ç©ºé—²å—ä¸­çš„å‰é©±æŒ‡é’ˆå’Œåç»§æŒ‡é’ˆï¼Œå‰é©±æŒ‡é’ˆä¿å­˜åœ¨ç©ºé—²å—é¦–èµ·4ä¸ªå­—èŠ‚ï¼Œè€Œåç»§æŒ‡é’ˆä¿å­˜åœ¨å4ä¸ªå­—èŠ‚\n### å‡½æ•°åŠå…¨å±€å˜é‡å£°æ˜\n![1](https://d-sketon.top/img/csapp-malloclab/1.png)\nrootæŒ‡é’ˆæ•°ç»„ç”¨ä½œåˆ†ç¦»é€‚é…å™¨çš„ç©ºé—²é“¾è¡¨æ•°ç»„ï¼Œç»´æŠ¤ç€é“¾è¡¨å¤´\nMAX_SIZEä¸ºrootæ•°ç»„çš„å¤§å°\nheap_listpä¸ºå †é¡¶æŒ‡é’ˆ\næ ¹æ®2çš„å¹‚åˆ’åˆ†å—çš„å¤§å°ï¼š{0~8}ï¼Œ{9~16}ï¼Œ{17~32}ï¼Œ...ï¼Œ{2049~4096}ï¼Œ{4097~âˆ}\n### mm_initå‡½æ•°\n![2](https://d-sketon.top/img/csapp-malloclab/2.png)\nç›¸æ¯”äºä¹¦ä¸Šä»£ç å¢åŠ äº†å¯¹rootçš„åˆå§‹åŒ–ï¼ŒåŒæ—¶æ”¹å˜åˆå§‹æ‰©å±•å †çš„å¤§å°ï¼ˆåŸä¸ºCHUNKSIZE/WSIZEï¼Œç°æ”¹ä¸º115å­—èŠ‚ï¼‰ï¼Œç»è¿‡æµ‹è¯•ï¼Œæ”¹åä»£ç èƒ½æ¯”åŸä»£ç å¢åŠ 5åˆ†\n### extend_heapå‡½æ•°\n![3](https://d-sketon.top/img/csapp-malloclab/3.png)\nå’Œä¹¦ä¸Šä»£ç ç›¸åŒ\n### mm_mallocå‡½æ•°\n![4](https://d-sketon.top/img/csapp-malloclab/4.png)\nå’Œä¹¦ä¸Šä»£ç åŸºæœ¬ç›¸åŒï¼Œä½†ç”±äºplaceå‡½æ•°ç”±voidç±»å‹æ”¹ä¸ºvoid*ç±»å‹ï¼ŒåŒæ—¶æ”¹å˜å½¢å‚æ•°é‡ï¼Œæ‰€ä»¥å¯¹placeå‡½æ•°æœ‰å…³ä»£ç åšå‡ºäº†è°ƒæ•´\n### mm_freeå‡½æ•°\n![5](https://d-sketon.top/img/csapp-malloclab/5.png)\nç›¸æ¯”äºä¹¦ä¸Šä»£ç å¢åŠ äº†å¯¹äºç©ºé—²å—çš„å‰é©±æŒ‡é’ˆå’Œåç»§æŒ‡é’ˆçš„åˆå§‹åŒ–æ“ä½œ\n### mm_reallocå‡½æ•°\n![6](https://d-sketon.top/img/csapp-malloclab/6.png)\npträ¸ºç©ºæ—¶ç›´æ¥è°ƒç”¨mm_mallocå‡½æ•°ï¼Œsizeä¸º0æ—¶ç›´æ¥è°ƒç”¨mm_freeå‡½æ•°ï¼Œå¦åˆ™\né¦–å…ˆå°†è¾“å…¥çš„sizeè¿›è¡Œ8å­—èŠ‚å¯¹é½ï¼Œå¾—åˆ°asize\næ¥ç€åˆ¤æ–­ptræœ¬èº«å¤§å°æ˜¯å¦å¤§äºasizeï¼Œå¦‚æœå°äºç­‰äºåˆ™ç›´æ¥è¿”å›ptræŒ‡é’ˆï¼ˆæŠ›å¼ƒç©ºé—²åŒºåŸŸï¼‰ï¼Œå¦åˆ™åˆ¤æ–­ptråæ˜¯å¦ä¸ºç©ºé—²å—ä¸”ç©ºé—²å—æ˜¯æœ€åä¸€å—ï¼Œå¦‚æœæ˜¯åˆ™åˆ¤æ–­ä¸¤è€…åˆå¹¶åæ˜¯å¦æ”¾çš„ä¸‹ï¼Œå¦‚æœæ”¾å¾—ä¸‹åˆ™ç›´æ¥æ›´æ–°ptrå¹¶è¿”å›ï¼Œå¦åˆ™è¿›è¡Œå †æ‰©å±•å¹¶æ›´æ–°è¿”å›\nå¦‚æœä¸æ»¡è¶³ä¸Šè¿°æ‰€æœ‰æƒ…å†µåˆ™è¿›è¡Œå¸¸è§„mm_mallocå¹¶è¿›è¡Œå†…å­˜å¤åˆ¶\n### judgeå‡½æ•°\n![7](https://d-sketon.top/img/csapp-malloclab/7.png)\nç”¨äºåˆ¤æ–­sizeå¤§å°çš„ç©ºé—²å—åº”è¯¥è¢«æ”¾ç½®åœ¨å“ªä¸ªç©ºé—²é“¾è¡¨æ•°ç»„ä¸­\n### placeå‡½æ•°\n![8](https://d-sketon.top/img/csapp-malloclab/8.png)\nflagç”¨äºåˆ¤æ–­è°ƒç”¨è€…æ¥æºäºmallocè¿˜æ˜¯reallocå‡½æ•°ï¼ˆreallocå‡½æ•°æ— éœ€è¿›è¡Œrelinkæ“ä½œï¼‰\nå¯¹äºå‰©ä½™éƒ¨åˆ†å¤§äº2\\*DSIZEçš„æƒ…å†µï¼Œå¯¹asizeè¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœå°äº96ï¼ˆå®é™…èŒƒå›´å¯ä»¥åœ¨80~110ä¹‹é—´æµ®åŠ¨ï¼Œåˆ†æ•°ç›¸åŒï¼‰ï¼Œåˆ™å°†ç©ºé—²å—æ”¾åœ¨å³è¾¹ï¼Œå¦åˆ™åˆ™å°†ç©ºé—²å—æ”¾åœ¨å·¦è¾¹ï¼Œæ”¾ç½®çš„åŒæ—¶å°†ç©ºé—²å—çš„å‰é©±å’Œåç»§åˆå§‹åŒ–å¹¶æ’å…¥ç©ºé—²é“¾è¡¨ä¸­\nå¯¹äºå‰©ä½™éƒ¨åˆ†å°äº2\\*DSIZEçš„æƒ…å†µï¼ŒæŠ›å¼ƒå‰©ä½™ç©ºé—²åŒºåŸŸ\nè¿”å›æŒ‡é’ˆä¸ºåˆ†é…å—æ‰€å¯¹åº”æŒ‡é’ˆ\n### coalesceå‡½æ•°\n![9](https://d-sketon.top/img/csapp-malloclab/9.png)\nå’Œä¹¦ä¸Šä»£ç åŸºæœ¬ç±»ä¼¼ï¼Œåªæ˜¯åœ¨å¯¹åº”æƒ…å†µä¸‹åŠ ä¸Šrelinkå¯¹åº”ç©ºé—²å—\næœ€ååŠ ä¸Šupdatenodeå‡½æ•°æ›´æ–°æ–°çš„ç©ºé—²å—åˆ°å¯¹äºç©ºé—²é“¾è¡¨ä¸­\n### find_fitå‡½æ•°\n![10](https://d-sketon.top/img/csapp-malloclab/10.png)\nä»å¯¹åº”ç©ºé—²é“¾è¡¨æ•°ç»„ä¸­å¼€å§‹å¯»æ‰¾ï¼Œé¦–æ¬¡é€‚é…ï¼Œå¦‚æœå½“å‰æ•°ç»„ä¸­æ²¡æœ‰æ‰¾åˆ°åˆ™è·³å…¥ä¸‹ä¸€ä¸‹æ ‡ä¸­ç»§ç»­å¯»æ‰¾ï¼Œå¦‚æœæ‰€æœ‰ç©ºé—²å—éƒ½æ— æ³•æ”¾å…¥åˆ™è¿”å›NULL\n### relinkå‡½æ•°\n![11](https://d-sketon.top/img/csapp-malloclab/11.png)\nåŸºç¡€çš„ç©ºé—²é“¾è¡¨åˆ é™¤èŠ‚ç‚¹å‡½æ•°ï¼Œæœ€åå¯¹bpè¿›è¡Œåˆå§‹åŒ–\n### updatenodeå‡½æ•°\n![12](https://d-sketon.top/img/csapp-malloclab/12.png)\nåŸºç¡€çš„ç©ºé—²é“¾è¡¨ï¼ˆOrderedListï¼‰æ’å…¥èŠ‚ç‚¹å‡½æ•°ï¼Œé“¾è¡¨ä¸ºå‡åºæ’åˆ—ï¼Œåˆ†å¤´éƒ¨æ’å…¥å’Œéå¤´éƒ¨æ’å…¥ä¸¤ç§æƒ…å†µ\n## ä¼˜åŒ–åŸç†\n- é‡‡ç”¨**æ˜¾å¼ç©ºé—²é“¾è¡¨**ç›¸å¯¹äºéšå¼ç©ºé—²é“¾è¡¨ï¼Œåœ¨æ’å…¥çš„è¿‡ç¨‹ä¸­åªéœ€éå†ç©ºé—²é“¾è¡¨è€Œéæ•´ä¸ªå †ï¼Œèƒ½å¤§å¤§åŠ å¿«é€Ÿåº¦\n- é‡‡ç”¨**åˆ†ç¦»é€‚é…**ï¼Œå°†å°†è¿‘å¤§å°çš„å—æ”¾å…¥ä¸€ä¸ªé“¾è¡¨ä¸­ï¼Œç±»ä¼¼äºé“¾å¼å“ˆå¸Œè¡¨ï¼Œèƒ½å¤§å¤§åŠ å¿«æ£€ç´¢é€Ÿåº¦ï¼ŒåŒæ—¶ç”±äºä¼˜å…ˆéå†ç›¸è¿‘çš„å—ï¼Œæ‰€ä»¥ç›¸è¿‘å¤§å°çš„åˆ†é…å—ä¼šè¢«åˆ†é…åˆ°ç›¸è¿‘å¤§å°çš„ç©ºé—²å—ä¸­ï¼Œæå‡å†…å­˜åˆ©ç”¨ç‡\n- é“¾è¡¨é‡‡ç”¨**å‡åºæ’åˆ—**ï¼Œ**é¦–æ¬¡é€‚é…**ï¼Œæ‰€ä»¥æ¯æ¬¡éƒ½èƒ½é€‚é…åˆ°æœ€æ¥è¿‘å¤§å°çš„ç©ºé—²å—ï¼Œå³æœ€ä½³é€‚é…ï¼Œèƒ½åœ¨ç‰ºç‰²ä¸€å°éƒ¨åˆ†é€Ÿåº¦çš„åŒæ—¶å¤§å¤§æå‡å†…å­˜åˆ©ç”¨ç‡\n- é’ˆå¯¹realloc_balå’Œrealloc2_balæµ‹è¯•ç‚¹è¿›è¡Œä¼˜åŒ–ï¼Œæ³¨æ„åˆ°æµ‹è¯•ç‚¹ä¸­å¯¹åŒä¸€å—åŒºåŸŸè¿›è¡Œåå¤reallocï¼Œsizeå‡åºæ’åˆ—ï¼ŒåŒæ—¶å†…éƒ¨ç©¿æ’allocå’Œfreeï¼Œæ­¤æ—¶è‹¥å¯¹äºreallocçš„å—ç›´æ¥å‘åæ‰©å±•å †ï¼ŒåŒæ—¶æŠ›å¼ƒç©ºé—²å—ï¼Œåˆ™ä¸ä¼šæ‰“ä¹±å †ä¸­çš„é¡ºåºï¼Œä½¿å†…å­˜åˆ©ç”¨ç‡ä¸Šå‡\n- é’ˆå¯¹binary_balå’Œbinary2_balæµ‹è¯•ç‚¹è¿›è¡Œä¼˜åŒ–ï¼Œæ³¨æ„åˆ°æµ‹è¯•ç‚¹ä¸­å…ˆåå¤allocå°å—å’Œå¤§å—ï¼Œä¹‹åä¸€æ¬¡æ€§freeå¤§å—å¹¶allocæ›´å¤§çš„å—ï¼Œå¦‚æœä¸è¿›è¡Œä¼˜åŒ–ï¼Œåˆ™ç”±äºä¹‹åallocçš„å—å¹¶ä¸èƒ½è¢«æ’å…¥åˆ°ä¹‹å‰freeçš„å—ä¸­ï¼ˆå¤§å°ä¸å¤Ÿï¼‰ï¼Œæ‰€ä»¥ä¼šé€ æˆç©ºé—´çš„å¤§é‡æµªè´¹ï¼Œè€Œé€‰æ‹©å°†å¤§å—çš„ç©ºé—²å—æ”¾åœ¨å·¦è¾¹ï¼Œå°å—çš„ç©ºé—²å—æ”¾åœ¨å³è¾¹ï¼Œå½“freeå¤§å—æ—¶ï¼Œå°å—çš„ç©ºé—²å—ï¼Œå¤§å—çš„ç©ºé—²å—å’Œå¤§å—freeçš„ç©ºé—´éƒ½èƒ½ç›¸åˆå¹¶ï¼Œå½¢æˆä¸€ä¸ªæ›´å¤§çš„ç©ºé—´å¹¶èƒ½å®¹çº³ä¸‹ä¹‹åallocçš„å—ï¼Œèƒ½å¤§å¤§æå‡å†…å­˜åˆ©ç”¨ç‡\n- å…¶ä»–ä¼˜åŒ–ï¼šæ”¹å˜mm_initä¸­åˆå§‹å †çš„å¤§å°ï¼Œç»æµ‹è¯•ï¼Œå½“åˆå§‹å †çš„å¤§å°ä¸º115å­—èŠ‚æ—¶æœ‰æœ€å¤§å†…å­˜åˆ©ç”¨ç‡ï¼ˆ**ä»…å¯¹æµ‹è¯•ç‚¹è¿›è¡Œä¼˜åŒ–ï¼Œæ— æ™®é€‚æ€§**ï¼‰\n## å®éªŒè¿‡ç¨‹åŠåˆ†æ\n\n> è¯¦ç»†æ³¨é‡Šè¯·è§å®Œæ•´ä»£ç \n\n- ä½¿ç”¨ä¹¦æœ¬ä¸Šä»£ç ï¼ˆéšå¼ç©ºé—²é“¾è¡¨ï¼‰è¿›è¡Œé¦–æ¬¡å°è¯•\n![13](https://d-sketon.top/img/csapp-malloclab/13.png)\nå¯ä»¥å‘ç°å†…å­˜çš„åˆ©ç”¨ç‡åªæœ‰74%ï¼Œè€Œä¸”é€Ÿåº¦ä¹Ÿå¾ˆæ…¢\n- éšåå°è¯•å°†éšå¼æ”¹ä¸ºæ˜¾å¼ç©ºé—²é“¾è¡¨ï¼ˆLIFOï¼‰\n![14](https://d-sketon.top/img/csapp-malloclab/14.png)\næ—¶é—´æ–¹é¢å·²ç»åˆ°è¾¾æ»¡åˆ†ï¼Œä¹‹åéœ€è¦å¯¹ç©ºé—´è¿›è¡Œè¿›ä¸€æ­¥ä¼˜åŒ–\n- è€ƒè™‘é‡‡ç”¨åˆ†ç¦»é€‚é…æ–¹æ³•ï¼ˆLIFOï¼‰ï¼Œå°†å—å¤§å°åˆ†è§£åˆ°131072å¤§å°\n![15](https://d-sketon.top/img/csapp-malloclab/15.png)\nå†…å­˜åˆ©ç”¨ç‡åªæœ‰2%çš„æå‡ï¼Œè¿™ä¹Ÿåœ¨æ„æ–™ä¹‹ä¸­ï¼Œå› ä¸ºåˆ†ç¦»é€‚é…ä¸»è¦æå‡é€Ÿåº¦\né¦–å…ˆè§‚å¯Ÿåˆ°æœ€å4ä¸ªæµ‹è¯•ç‚¹çš„å†…å­˜åˆ©ç”¨ç‡éå¸¸ä½ï¼Œé¦–å…ˆè€ƒè™‘ä¼˜åŒ–æœ€åä¸¤ä¸ªæµ‹è¯•ç‚¹ï¼ˆrealloc_balå’Œrealloc2_balï¼‰\n- é€šè¿‡è§‚å¯Ÿæµ‹è¯•ç‚¹åé€‰æ‹©ä¿®æ”¹reallocå‡½æ•°å¦‚ä¸‹\n![25](https://d-sketon.top/img/csapp-malloclab/25.png)\n![26](https://d-sketon.top/img/csapp-malloclab/26.png)\nå³é¦–å…ˆåˆ¤æ–­asizeæ˜¯å¦å’ŒcopySizeç›¸ç­‰ï¼Œå¦‚æœç›¸ç­‰åˆ™ç›´æ¥è¿”å›ptrï¼Œå¦‚æœå°äºåˆ™è°ƒç”¨placeå‡½æ•°å¯¹åˆ†é…å—è¿›è¡Œé‡æ–°åˆ†é…ï¼Œå¦åˆ™åˆ™è°ƒç”¨coalesce2å‡½æ•°ï¼ˆå’Œcoalesceå‡½æ•°ç±»ä¼¼ï¼‰ï¼Œå¯¹äºåŸå—çš„å‰åå¯»æ‰¾æ˜¯å¦å­˜åœ¨ç©ºé—²å—ï¼Œå¦‚æœå­˜åœ¨åˆ™å¯¹å…¶è¿›è¡Œåˆå¹¶å¹¶é‡æ–°åˆ†é…ï¼Œå¦åˆ™åˆ™é‡æ–°allocå¹¶å†…å­˜å¤åˆ¶\n- æ­¤å¤–ä¿®æ”¹updatenodeå‡½æ•°ä»£ç ï¼Œä½¿å…¶å˜ä¸ºå‡åºæ’åˆ—ï¼Œè¿™æ ·å°±å¯ä»¥é…åˆå“ˆå¸Œè¡¨è¾¾åˆ°ä¸æŸè€—å¤ªå¤šé€Ÿåº¦çš„åŒæ—¶è¿›è¡Œæœ€ä¼˜é€‚é…\n![16](https://d-sketon.top/img/csapp-malloclab/16.png)\næ­¤æ—¶å†…å­˜åˆ©ç”¨ç‡æœ‰äº†éƒ¨åˆ†çš„æå‡\n- æ¥ç€è€ƒè™‘å¯¹åéƒ¨ç©ºé—²å—ç›´æ¥æ‰©å±•å †ï¼Œå³åˆ¤æ–­\n```c\n(( !GET_ALLOC(HDRP(NEXT_BLKP(ptr)))&&!GET_SIZE(HDRP(NEXT_BLKP(NEXT_BLKP(ptr))))))\n```\n- åœ¨ä¿®æ”¹å®Œä»£ç å¹¶ç¡®è®¤ä»£ç æ— è¯¯åå´ä¸€ç›´å‘ç”Ÿæ®µé”™è¯¯\n![17](https://d-sketon.top/img/csapp-malloclab/17.png)\nåœ¨å°è¯•äº†è®¸å¤šåŠæ³•åå‘ç°å°†CHUNKSIZEçš„å¤§å°ç¼©å‡åˆ°256å­—èŠ‚åå°±ä¸å†å‘ç”Ÿæ®µé”™è¯¯ï¼Œæ¨æµ‹å¯èƒ½æ˜¯ä»£ç ä¹‹é—´ä»ç„¶å­˜åœ¨é€»è¾‘é”™è¯¯ï¼Œæˆ–æ˜¯ç”±äºæµ‹è¯•ç‚¹çš„ç‰¹æ®Šæ€§å¯¼è‡´æ®µé”™è¯¯ï¼Œè€Œå°†CHUNKSIZEè¿›è¡Œäº†ä¿®æ”¹åæ­£å¥½æ”¹å˜äº†åˆ†é…å—åœ¨å†…å­˜ä¸­çš„æ’å¸ƒé¡ºåºï¼Œä»è€Œæ¶ˆé™¤äº†æ®µé”™è¯¯\n- åŒæ—¶æœ€åçš„æµ‹è¯•ç‚¹æœ‰äº†è¾ƒå¤§å¹…åº¦çš„æå‡ï¼Œå·²ç»åˆ° 97%\n![18](https://d-sketon.top/img/csapp-malloclab/18.png)\néšåå°è¯•å¯¹binary_balå’Œbinary2_balæµ‹è¯•ç‚¹è¿›è¡Œä¼˜åŒ–\nè€ƒè™‘æŒ‰ç…§å—çš„å¤§å°é€‰æ‹©placeåˆ†é…æ–¹å¼ï¼Œå³å¤§å—åˆ†åœ¨å³è¾¹ï¼Œè€Œå°å—åˆ†åœ¨å·¦è¾¹ï¼Œåˆ†ç•Œçº¿ä»‹äº80~110å­—èŠ‚ä¹‹é—´\n- ä½†åœ¨ä¿®æ”¹å®Œä»£ç åå‘ç°\n![19](https://d-sketon.top/img/csapp-malloclab/19.png)\næ‰€æœ‰æµ‹è¯•ç‚¹å‡åœ¨ç¬¬å…­è¡Œå‘ç”Ÿè´Ÿè½½è¦†ç›–é—®é¢˜ï¼Œé€šè¿‡æŸ¥çœ‹æµ‹è¯•ç‚¹å¯ä»¥çŸ¥é“ç¬¬ä¸€æ¬¡mallocå¯ä»¥æ­£å¸¸æ‰§è¡Œï¼Œä½†åœ¨è¿›è¡Œç¬¬äºŒæ¬¡mallocåå°±è¦†ç›–æ‰äº†ç¬¬ä¸€æ¬¡mallocçš„å†…å®¹\n- è°ƒè¯•å‘ç°\n![20](https://d-sketon.top/img/csapp-malloclab/20.png)\nå‘ç°ç¬¬ä¸€æ¬¡å°†åˆ†é…å—ï¼ˆ0xf697c118ï¼‰çš„ALLOCç½®ä¸º1ï¼Œä½†åœ¨ ç¬¬äºŒæ¬¡mallocæ—¶ALLOCè¢«éšå¼åœ°ä¿®æ”¹å›äº†0\nç»è¿‡é•¿æ—¶é—´çš„è°ƒè¯•å‘ç°é—®é¢˜åœ¨äºæ²¡æœ‰ä¿®æ”¹ä¼ å…¥çš„bpæŒ‡é’ˆï¼Œå¯¼è‡´bpæŒ‡é’ˆæŒ‡å‘äº†é”™è¯¯çš„ä½ç½®ï¼Œè€Œåœ¨ä¹‹åmallocä¸­å½±å“åˆ°äº†ä¹‹å‰çš„ALLOC\næ‰€ä»¥å°†placeå‡½æ•°ä»voidç±»å‹ä¿®æ”¹ä¸ºvoid *ç±»å‹ï¼Œå°†ä¿®æ”¹åçš„bpæŒ‡é’ˆä¼ å‡ºï¼Œå¹¶åœ¨mallocå‡½æ•°ä¸­æ›´æ–°bpæŒ‡é’ˆå³å¯æ¶ˆé™¤è´Ÿè½½è¦†ç›–çš„é—®é¢˜\n- ä½†è¿™æ—¶åˆå†æ¬¡å‡ºç°äº†æ®µé”™è¯¯çš„é—®é¢˜\n![21](https://d-sketon.top/img/csapp-malloclab/21.png)\nç»è¿‡æ’æŸ¥å‘ç°æ˜¯coalesce2å‡½æ•°ä¸­åˆ¤æ–­å—çš„å‰éƒ¨æ˜¯å¦å­˜åœ¨ç©ºé—²å—å’Œplaceå‡½æ•°å‘ç”Ÿäº†å†²çª\nç®€å•èµ·è§ï¼Œç›´æ¥æš´åŠ›åˆ é™¤coalesce2ä¸­å¯¹äºflag==2çš„æƒ…å†µï¼ŒåŒæ—¶å°†CHUNKSIZEä¿®æ”¹å›4096\n- ä¿®æ”¹åæœ€åä¸¤ä¸ªæµ‹è¯•ç‚¹å‘ç”Ÿerror\n![22](https://d-sketon.top/img/csapp-malloclab/22.png)\n- è€ƒè™‘coealesce2å‡½æ•°å’Œå…¶ä»–è®¸å¤šå‡½æ•°å¯èƒ½å‘ç”Ÿäº†å†²çªï¼Œæœ€åé€‰æ‹©ç›´æ¥åˆ é™¤coalesce2æ•´ä¸ªå‡½æ•°\n![23](https://d-sketon.top/img/csapp-malloclab/23.png)\nåˆ†æ•°æå‡åˆ°äº†92åˆ†\næœ€åé€šè¿‡é‡æ•´ä»£ç å’Œä¿®æ”¹CHUNSIZEå¤§å°å’Œåˆå§‹å †çš„å¤§å°ï¼ŒæˆåŠŸå†æ¬¡æå‡5åˆ†\n- æœ€ç»ˆå®éªŒç»“æœ\n![24](https://d-sketon.top/img/csapp-malloclab/24.png)\n## å®Œæ•´ä»£ç \n```c\n/*\nÂ *Â mm-naive.cÂ -Â TheÂ fastest,Â leastÂ memory-efficientÂ mallocÂ package.\nÂ *Â \nÂ *Â InÂ thisÂ naiveÂ approach,Â aÂ blockÂ isÂ allocatedÂ byÂ simplyÂ incrementing\nÂ *Â theÂ brkÂ pointer.Â Â AÂ blockÂ isÂ pureÂ payload.Â ThereÂ areÂ noÂ headersÂ or\nÂ *Â footers.Â Â BlocksÂ areÂ neverÂ coalescedÂ orÂ reused.Â ReallocÂ is\nÂ *Â implementedÂ directlyÂ usingÂ mm_mallocÂ andÂ mm_free.\nÂ *\nÂ *Â NOTEÂ TOÂ STUDENTS:Â ReplaceÂ thisÂ headerÂ commentÂ withÂ yourÂ ownÂ header\nÂ *Â commentÂ thatÂ givesÂ aÂ highÂ levelÂ descriptionÂ ofÂ yourÂ solution.\nÂ */\n#includeÂ <stdio.h>\n#includeÂ <stdlib.h>\n#includeÂ <assert.h>\n#includeÂ <unistd.h>\n#includeÂ <string.h>\n\n#includeÂ \"mm.h\"\n#includeÂ \"memlib.h\"\n/*********************************************************\nÂ *Â NOTEÂ TOÂ STUDENTS:Â BeforeÂ youÂ doÂ anythingÂ else,Â please\nÂ *Â provideÂ yourÂ teamÂ informationÂ inÂ theÂ followingÂ struct.\nÂ ********************************************************/\nteam_tÂ teamÂ =Â {\nÂ Â Â Â /*Â TeamÂ nameÂ */\nÂ Â Â Â \"ECNUÂ SE\",\nÂ Â Â Â /*Â FirstÂ member'sÂ fullÂ nameÂ */\nÂ Â Â Â \"JackÂ Qiu\",\nÂ Â Â Â /*Â FirstÂ member'sÂ emailÂ addressÂ */\nÂ Â Â Â \"2055272094@qq.com\",\nÂ Â Â Â /*Â SecondÂ member'sÂ fullÂ nameÂ (leaveÂ blankÂ ifÂ none)Â */\nÂ Â Â Â \"\",\nÂ Â Â Â /*Â SecondÂ member'sÂ emailÂ addressÂ (leaveÂ blankÂ ifÂ none)Â */\nÂ Â Â Â \"\"};\n/*Â singleÂ wordÂ (4)Â orÂ doubleÂ wordÂ (8)Â alignmentÂ */\n#defineÂ ALIGNMENTÂ 8\n/*Â roundsÂ upÂ toÂ theÂ nearestÂ multipleÂ ofÂ ALIGNMENTÂ */\n#defineÂ ALIGN(size)Â (((size)Â +Â (ALIGNMENTÂ -Â 1))Â &Â ~0x7)\n\n#defineÂ SIZE_T_SIZEÂ (ALIGN(sizeof(size_t)))\n#defineÂ WSIZEÂ 4\n#defineÂ DSIZEÂ 8\n#defineÂ CHUNKSIZEÂ 4096\n\n#defineÂ MAX(x,Â y)Â ((x)Â >Â (y)Â ?Â (x)Â :Â (y))\n#defineÂ PACK(size,Â alloc)Â ((size)Â |Â (alloc))\n#defineÂ GET(p)Â (*(unsignedÂ intÂ *)(p))\n#defineÂ PUT(p,Â val)Â (*(unsignedÂ intÂ *)(p)Â =Â (val))\n\n#defineÂ GET_SIZE(p)Â (GET(p)Â &Â ~0x7)\n#defineÂ GET_ALLOC(p)Â (GET(p)Â &Â 0x1)\n\n#defineÂ HDRP(bp)Â ((charÂ *)(bp)-WSIZE)\n#defineÂ FTRP(bp)Â ((charÂ *)(bp)Â +Â GET_SIZE(HDRP(bp))Â -Â DSIZE)\n\n#defineÂ NEXT_BLKP(bp)Â ((charÂ *)(bp)Â +Â GET_SIZE(((charÂ *)(bp)-WSIZE)))\n#defineÂ PREV_BLKP(bp)Â ((charÂ *)(bp)-GET_SIZE(((charÂ *)(bp)-DSIZE)))\n\n#defineÂ PRED(bp)Â ((charÂ *)(bp))Â Â Â Â Â Â Â Â Â //è¿”å›å‰é©±ç»“ç‚¹\n#defineÂ SUCC(bp)Â ((charÂ *)(bp)Â +Â WSIZE)Â //è¿”å›åç»§ç»“ç‚¹\n\nstaticÂ voidÂ *extend_heap(size_tÂ words);\nstaticÂ voidÂ *coalesce(voidÂ *bp);\nstaticÂ voidÂ relink(voidÂ *bp);\nstaticÂ voidÂ *find_fit(size_tÂ size);\nstaticÂ void*Â place(voidÂ *bp,Â size_tÂ asize,Â intÂ flag);\nstaticÂ intÂ judge(intÂ size);\nstaticÂ voidÂ updatenode(voidÂ *bp);\n\nconstÂ intÂ MAX_SIZEÂ =Â 15;Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //ç©ºé—²é“¾è¡¨æ•°ç»„å¤§å°\nstaticÂ voidÂ *heap_listpÂ =Â NULL;\nstaticÂ unsignedÂ intÂ *root[15];Â Â Â Â Â Â Â Â Â Â //ç©ºé—²é“¾è¡¨æ•°ç»„\n\nstaticÂ intÂ judge(intÂ size)\n{\nÂ Â Â Â //ç›¸æ¯”äºé‡‡ç”¨logï¼Œè€ƒè™‘é‡‡ç”¨if-elseè¯­å¥æå‡é€Ÿåº¦\nÂ Â Â Â intÂ indexÂ =Â 0;\nÂ Â Â Â ifÂ (sizeÂ <=Â 8)Â Â Â Â Â Â Â Â Â Â indexÂ =Â 3;Â Â //ç”±äº8å­—èŠ‚å¯¹é½ï¼Œsizeä¸å¯èƒ½å°äº8\nÂ Â Â Â elseÂ ifÂ (sizeÂ <=Â 16)Â Â Â Â indexÂ =Â 4;\nÂ Â Â Â elseÂ ifÂ (sizeÂ <=Â 32)Â Â Â Â indexÂ =Â 5;\nÂ Â Â Â elseÂ ifÂ (sizeÂ <=Â 64)Â Â Â Â indexÂ =Â 6;\nÂ Â Â Â elseÂ ifÂ (sizeÂ <=Â 128)Â Â Â indexÂ =Â 7;\nÂ Â Â Â elseÂ ifÂ (sizeÂ <=Â 256)Â Â Â indexÂ =Â 8;\nÂ Â Â Â elseÂ ifÂ (sizeÂ <=Â 512)Â Â Â indexÂ =Â 9;\nÂ Â Â Â elseÂ ifÂ (sizeÂ <=Â 1024)Â Â indexÂ =Â 10;\nÂ Â Â Â elseÂ ifÂ (sizeÂ <=Â 2048)Â Â indexÂ =Â 11;\nÂ Â Â Â elseÂ ifÂ (sizeÂ <=Â 4096)Â Â indexÂ =Â 12;\nÂ Â Â Â elseÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â indexÂ Â =13;\nÂ Â Â Â returnÂ index;\n}\n\n/*Â \nÂ *Â mm_initÂ -Â initializeÂ theÂ mallocÂ package.\nÂ */\nintÂ mm_init(void)\n{\nÂ Â Â Â ifÂ ((heap_listpÂ =Â mem_sbrk(4Â *Â WSIZE))Â ==Â (voidÂ *)-1)\nÂ Â Â Â Â Â Â Â returnÂ -1;\nÂ Â Â Â PUT(heap_listp,Â 0);\nÂ Â Â Â PUT(heap_listpÂ +Â (1Â *Â WSIZE),Â PACK(DSIZE,Â 1));\nÂ Â Â Â PUT(heap_listpÂ +Â (2Â *Â WSIZE),Â PACK(DSIZE,Â 1));\nÂ Â Â Â PUT(heap_listpÂ +Â (3Â *Â WSIZE),Â PACK(0,Â 1));\nÂ Â Â Â forÂ (intÂ iÂ =Â 0;Â iÂ <Â MAX_SIZE;Â i++)\nÂ Â Â Â Â Â Â Â root[i]Â =Â NULL;Â Â Â Â Â Â Â Â Â Â Â Â Â //åˆå§‹åŒ–ç©ºé—²é“¾è¡¨æ•°ç»„\nÂ Â Â Â heap_listpÂ +=Â (4Â *Â WSIZE);\nÂ Â Â Â ifÂ (extend_heap(115)Â ==Â NULL)Â Â Â //å¯¹äºæµ‹è¯•ç‚¹è¿›è¡Œç‰¹åˆ«ä¼˜åŒ–\nÂ Â Â Â Â Â Â Â returnÂ -1;\nÂ Â Â Â returnÂ 0;\n}\n\nstaticÂ voidÂ *extend_heap(size_tÂ words)\n{\nÂ Â Â Â charÂ *bp;\nÂ Â Â Â size_tÂ size;\nÂ Â Â Â sizeÂ =Â (wordsÂ %Â 2)Â ?Â (wordsÂ +Â 1)Â *Â DSIZEÂ :Â wordsÂ *Â DSIZE;Â Â Â //WSIZEä¿®æ”¹ä¸ºDSIZE\nÂ Â Â Â ifÂ ((long)(bpÂ =Â mem_sbrk(size))Â ==Â -1)\nÂ Â Â Â Â Â Â Â returnÂ NULL;\nÂ Â Â Â PUT(HDRP(bp),Â PACK(size,Â 0));\nÂ Â Â Â PUT(FTRP(bp),Â PACK(size,Â 0));\nÂ Â Â Â PUT(PRED(bp),Â 0);Â Â Â Â Â Â Â //å‰é©±ç»“ç‚¹åˆå§‹åŒ–\nÂ Â Â Â PUT(SUCC(bp),Â 0);Â Â Â Â Â Â Â //åç»§èŠ‚ç‚¹åˆå§‹åŒ–\nÂ Â Â Â PUT(HDRP(NEXT_BLKP(bp)),Â PACK(0,Â 1));\nÂ Â Â Â returnÂ coalesce(bp);\n}\n\n/*Â \nÂ *Â mm_mallocÂ -Â AllocateÂ aÂ blockÂ byÂ incrementingÂ theÂ brkÂ pointer.\nÂ *Â Â Â Â Â AlwaysÂ allocateÂ aÂ blockÂ whoseÂ sizeÂ isÂ aÂ multipleÂ ofÂ theÂ alignment.\nÂ */\nvoidÂ *mm_malloc(size_tÂ size)\n{\nÂ Â Â Â size_tÂ asize;\nÂ Â Â Â size_tÂ extendsize;\nÂ Â Â Â charÂ *bp;\nÂ Â Â Â ifÂ (sizeÂ ==Â 0)\nÂ Â Â Â Â Â Â Â returnÂ NULL;\nÂ Â Â Â ifÂ (sizeÂ <=Â DSIZE)\nÂ Â Â Â Â Â Â Â asizeÂ =Â 2Â *Â (DSIZE);\nÂ Â Â Â else\nÂ Â Â Â Â Â Â Â asizeÂ =Â (DSIZE)Â *Â ((sizeÂ +Â (DSIZE)Â +Â (DSIZEÂ -Â 1))Â /Â (DSIZE));\nÂ Â Â Â ifÂ ((bpÂ =Â find_fit(asize))Â !=Â NULL)\nÂ Â Â Â {\nÂ Â Â Â Â Â Â Â bpÂ =Â place(bp,Â asize,Â 0);Â Â Â //æ›´æ–°bp\nÂ Â Â Â Â Â Â Â returnÂ bp;\nÂ Â Â Â }\nÂ Â Â Â extendsizeÂ =Â MAX(asize,Â CHUNKSIZE);\nÂ Â Â Â ifÂ ((bpÂ =Â extend_heap(extendsizeÂ /Â DSIZE))Â ==Â NULL)\nÂ Â Â Â Â Â Â Â returnÂ NULL;\nÂ Â Â Â bpÂ =Â place(bp,Â asize,Â 0);Â Â Â Â Â Â Â //æ›´æ–°bp\nÂ Â Â Â returnÂ bp;\n}\n\nstaticÂ voidÂ *find_fit(size_tÂ size)\n{\nÂ Â Â Â forÂ (intÂ iÂ =Â judge(size);Â iÂ <Â MAX_SIZE;Â i++)Â Â Â Â //è‹¥æŸ¥æ‰¾ä¸åˆ°ä¾æ¬¡å‘ä¸‹ä¸€ä¸ªä¸‹æ ‡ç§»åŠ¨\nÂ Â Â Â {\nÂ Â Â Â Â Â Â Â voidÂ *bpÂ =Â root[i];Â Â Â Â Â //ç©ºé—²é“¾è¡¨å†…éƒ¨æŸ¥æ‰¾\nÂ Â Â Â Â Â Â Â whileÂ (bpÂ !=Â NULL)\nÂ Â Â Â Â Â Â Â {\nÂ Â Â Â Â Â Â Â Â Â Â Â ifÂ (sizeÂ <=Â GET_SIZE(HDRP(bp)))\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â returnÂ bp;\nÂ Â Â Â Â Â Â Â Â Â Â Â bpÂ =Â GET(SUCC(bp));\nÂ Â Â Â Â Â Â Â }\nÂ Â Â Â }\nÂ Â Â Â returnÂ NULL;\n}\n\nstaticÂ voidÂ *place(voidÂ *bp,Â size_tÂ asize,Â intÂ flag)\n{\nÂ Â Â Â size_tÂ csizeÂ =Â GET_SIZE(HDRP(bp));\nÂ Â Â Â ifÂ (!flag)Â Â Â Â Â Â Â Â Â Â //mallocè°ƒç”¨æ—¶éœ€è¦relinkï¼Œè€Œreallocè°ƒç”¨æ—¶ä¸éœ€è¦relink\nÂ Â Â Â Â Â Â Â relink(bp);\nÂ Â Â Â ifÂ ((csizeÂ -Â asize)Â >=Â (2Â *Â DSIZE))Â //ç©ºé—²åŒºåŸŸå˜ä¸ºç©ºé—²å—\nÂ Â Â Â {\nÂ Â Â Â Â Â Â Â //åˆ†å‰²åŒºé—´å¯åœ¨80å­—èŠ‚~110å­—èŠ‚ä¹‹é—´æµ®åŠ¨ï¼Œå¯¹ç»“æœå‡ ä¹æ— å½±å“\nÂ Â Â Â Â Â Â Â ifÂ (asizeÂ <Â 96)Â //å°äº96å­—èŠ‚\nÂ Â Â Â Â Â Â Â {\nÂ Â Â Â Â Â Â Â Â Â Â Â PUT(HDRP(bp),Â PACK(asize,Â 1));Â Â Â Â Â Â Â Â Â Â //åˆ†é…å—ç½®1\nÂ Â Â Â Â Â Â Â Â Â Â Â PUT(FTRP(bp),Â PACK(asize,Â 1));\nÂ Â Â Â Â Â Â Â Â Â Â Â bpÂ =Â NEXT_BLKP(bp);\nÂ Â Â Â Â Â Â Â Â Â Â Â PUT(HDRP(bp),Â PACK(csizeÂ -Â asize,Â 0));Â Â //ç©ºé—²å—ç½®0\nÂ Â Â Â Â Â Â Â Â Â Â Â PUT(FTRP(bp),Â PACK(csizeÂ -Â asize,Â 0));\nÂ Â Â Â Â Â Â Â Â Â Â Â PUT(PRED(bp),Â 0);Â Â Â //å‰é©±åˆå§‹åŒ–\nÂ Â Â Â Â Â Â Â Â Â Â Â PUT(SUCC(bp),Â 0);Â Â Â //åç»§åˆå§‹åŒ–\nÂ Â Â Â Â Â Â Â Â Â Â Â updatenode(bp);Â Â Â Â Â //å°†ç©ºé—²å—æ’å…¥ç©ºé—²é“¾è¡¨ä¸­\nÂ Â Â Â Â Â Â Â Â Â Â Â returnÂ PREV_BLKP(bp);Â Â Â //è¿”å›åˆ†é…å—æŒ‡é’ˆ\nÂ Â Â Â Â Â Â Â }\nÂ Â Â Â Â Â Â Â elseÂ Â Â Â Â Â Â Â Â Â Â Â //å¤§äºç­‰äº96å­—èŠ‚\nÂ Â Â Â Â Â Â Â {\nÂ Â Â Â Â Â Â Â Â Â Â Â PUT(HDRP(bp),Â PACK(csizeÂ -Â asize,Â 0));Â Â //ç©ºé—²å—ç½®0\nÂ Â Â Â Â Â Â Â Â Â Â Â PUT(FTRP(bp),Â PACK(csizeÂ -Â asize,Â 0));\nÂ Â Â Â Â Â Â Â Â Â Â Â PUT(HDRP(NEXT_BLKP(bp)),Â PACK(asize,Â 1));Â Â Â //åˆ†é…å—ç½®1\nÂ Â Â Â Â Â Â Â Â Â Â Â PUT(FTRP(NEXT_BLKP(bp)),Â PACK(asize,Â 1));\nÂ Â Â Â Â Â Â Â Â Â Â Â PUT(PRED(bp),Â 0);Â Â Â //å‰é©±åˆå§‹åŒ–\nÂ Â Â Â Â Â Â Â Â Â Â Â PUT(SUCC(bp),Â 0);Â Â Â //åç»§åˆå§‹åŒ–\nÂ Â Â Â Â Â Â Â Â Â Â Â updatenode(bp);Â Â Â Â Â //å°†ç©ºé—²å—æ’å…¥ç©ºé—²é“¾è¡¨ä¸­\nÂ Â Â Â Â Â Â Â Â Â Â Â returnÂ NEXT_BLKP(bp);Â Â Â //è¿”å›åˆ†é…å—æŒ‡é’ˆ\nÂ Â Â Â Â Â Â Â }\nÂ Â Â Â }\nÂ Â Â Â elseÂ Â Â Â //ä¸¢å¼ƒç©ºé—²åŒºåŸŸ\nÂ Â Â Â {\nÂ Â Â Â Â Â Â Â PUT(HDRP(bp),Â PACK(csize,Â 1));\nÂ Â Â Â Â Â Â Â PUT(FTRP(bp),Â PACK(csize,Â 1));\nÂ Â Â Â Â Â Â Â returnÂ bp;\nÂ Â Â Â }\n}\n/*\nÂ *Â mm_freeÂ -Â FreeingÂ aÂ blockÂ doesÂ nothing.\nÂ */\n\nvoidÂ mm_free(voidÂ *ptr)\n{\nÂ Â Â Â size_tÂ sizeÂ =Â GET_SIZE(HDRP(ptr));\nÂ Â Â Â PUT(HDRP(ptr),Â PACK(size,Â 0));\nÂ Â Â Â PUT(FTRP(ptr),Â PACK(size,Â 0));\nÂ Â Â Â PUT(SUCC(ptr),Â 0);Â Â //å‰é©±åˆå§‹åŒ–\nÂ Â Â Â PUT(PRED(ptr),Â 0);Â Â //åç»§åˆå§‹åŒ–\nÂ Â Â Â coalesce(ptr);\n}\n\nstaticÂ voidÂ relink(voidÂ *bp)\n{\nÂ Â Â Â intÂ indexÂ =Â judge(GET_SIZE(HDRP(bp)));\nÂ Â Â Â voidÂ *beforeÂ =Â GET(PRED(bp));\nÂ Â Â Â voidÂ *afterÂ =Â GET(SUCC(bp));\nÂ Â Â Â ifÂ (beforeÂ ==Â NULL)Â Â Â Â Â Â Â Â Â Â Â Â Â //å¤´éƒ¨æ’å…¥\nÂ Â Â Â {\nÂ Â Â Â Â Â Â Â ifÂ (afterÂ !=Â NULL)\nÂ Â Â Â Â Â Â Â Â Â Â Â PUT(PRED(after),Â 0);Â Â Â Â //åå—å‰é©±ç½®0\nÂ Â Â Â Â Â Â Â root[index]Â =Â after;Â Â Â Â Â Â Â Â //ç©ºé—²æ•°ç»„æ›´æ–°å¤´éƒ¨\nÂ Â Â Â }\nÂ Â Â Â else\nÂ Â Â Â {\nÂ Â Â Â Â Â Â Â ifÂ (afterÂ !=Â NULL)\nÂ Â Â Â Â Â Â Â Â Â Â Â PUT(PRED(after),Â before);Â Â Â //åå—å‰é©±æ›´æ–°\nÂ Â Â Â Â Â Â Â PUT(SUCC(before),Â after);Â Â Â //å‰å—åé©±æ›´æ–°\nÂ Â Â Â }\nÂ Â Â Â PUT(PRED(bp),Â 0);Â Â Â //å‰é©±åˆå§‹åŒ–\nÂ Â Â Â PUT(SUCC(bp),Â 0);Â Â Â //åç»§åˆå§‹åŒ–\n}\n\nstaticÂ voidÂ *coalesce(voidÂ *bp)\n{\nÂ Â Â Â //æ‰€æœ‰æƒ…å†µä¸€å¾‹é€‰æ‹©å…ˆåˆ é™¤åæ’å…¥èŠ‚ç‚¹\nÂ Â Â Â size_tÂ prev_allocÂ =Â GET_ALLOC(FTRP(PREV_BLKP(bp)));\nÂ Â Â Â size_tÂ next_allocÂ =Â GET_ALLOC(HDRP(NEXT_BLKP(bp)));\nÂ Â Â Â size_tÂ sizeÂ =Â GET_SIZE(HDRP(bp));\nÂ Â Â Â ifÂ (prev_allocÂ &&Â !next_alloc)Â Â //CaseÂ 2\nÂ Â Â Â {\nÂ Â Â Â Â Â Â Â sizeÂ +=Â GET_SIZE(HDRP(NEXT_BLKP(bp)));\nÂ Â Â Â Â Â Â Â relink(NEXT_BLKP(bp));Â Â //åˆ é™¤å‰é¢çš„ç©ºé—²å—\nÂ Â Â Â Â Â Â Â PUT(HDRP(bp),Â PACK(size,Â 0));\nÂ Â Â Â Â Â Â Â PUT(FTRP(bp),Â PACK(size,Â 0));\nÂ Â Â Â }\nÂ Â Â Â elseÂ ifÂ (!prev_allocÂ &&Â next_alloc)Â //CaseÂ 3Â \nÂ Â Â Â {\nÂ Â Â Â Â Â Â Â sizeÂ +=Â GET_SIZE(HDRP(PREV_BLKP(bp)));\nÂ Â Â Â Â Â Â Â relink(PREV_BLKP(bp));Â Â //åˆ é™¤åé¢çš„ç©ºé—²å—\nÂ Â Â Â Â Â Â Â PUT(FTRP(bp),Â PACK(size,Â 0));\nÂ Â Â Â Â Â Â Â PUT(HDRP(PREV_BLKP(bp)),Â PACK(size,Â 0));\nÂ Â Â Â Â Â Â Â bpÂ =Â PREV_BLKP(bp);\nÂ Â Â Â }\nÂ Â Â Â elseÂ ifÂ (!prev_allocÂ &&Â !next_alloc)Â Â Â Â //CaseÂ 4Â \nÂ Â Â Â {\nÂ Â Â Â Â Â Â Â sizeÂ +=Â GET_SIZE(FTRP(NEXT_BLKP(bp)))Â +Â GET_SIZE(HDRP(PREV_BLKP(bp)));\nÂ Â Â Â Â Â Â Â relink(PREV_BLKP(bp));Â Â //åˆ é™¤å‰é¢çš„ç©ºé—²å—\nÂ Â Â Â Â Â Â Â relink(NEXT_BLKP(bp));Â Â //åˆ é™¤åé¢çš„ç©ºé—²å—\nÂ Â Â Â Â Â Â Â PUT(FTRP(NEXT_BLKP(bp)),Â PACK(size,Â 0));\nÂ Â Â Â Â Â Â Â PUT(HDRP(PREV_BLKP(bp)),Â PACK(size,Â 0));\nÂ Â Â Â Â Â Â Â bpÂ =Â PREV_BLKP(bp);\nÂ Â Â Â }\nÂ Â Â Â updatenode(bp);Â //æ’å…¥æ–°çš„ç©ºé—²å—\nÂ Â Â Â returnÂ bp;\n}\n\nstaticÂ voidÂ updatenode(voidÂ *bp)\n{\nÂ Â Â Â voidÂ *now_rootÂ =Â root[judge(GET_SIZE(HDRP(bp)))];\nÂ Â Â Â charÂ *prevpÂ =Â NULL;\nÂ Â Â Â charÂ *nextpÂ =Â now_root;\nÂ Â Â Â //å‡åºæ’åˆ—\nÂ Â Â Â whileÂ (nextpÂ !=Â NULL)\nÂ Â Â Â {\nÂ Â Â Â Â Â Â Â ifÂ (GET_SIZE(HDRP(nextp))Â >=Â GET_SIZE(HDRP(bp)))\nÂ Â Â Â Â Â Â Â Â Â Â Â break;Â Â //ç¡®å®šæ’å…¥ä½ç½®\nÂ Â Â Â Â Â Â Â prevpÂ =Â nextp;\nÂ Â Â Â Â Â Â Â nextpÂ =Â GET(SUCC(nextp));\nÂ Â Â Â }\nÂ Â Â Â ifÂ (prevpÂ ==Â NULL)Â Â //å¤´éƒ¨æ’å…¥\nÂ Â Â Â {\nÂ Â Â Â Â Â Â Â root[judge(GET_SIZE(HDRP(bp)))]Â =Â bp;\nÂ Â Â Â Â Â Â Â PUT(SUCC(bp),Â nextp);\nÂ Â Â Â Â Â Â Â PUT(PRED(bp),Â 0);\nÂ Â Â Â Â Â Â Â ifÂ (nextpÂ !=Â NULL)\nÂ Â Â Â Â Â Â Â Â Â Â Â PUT(PRED(nextp),Â bp);\nÂ Â Â Â }\nÂ Â Â Â elseÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â //ä¸­é—´æ’å…¥\nÂ Â Â Â {\nÂ Â Â Â Â Â Â Â PUT(SUCC(prevp),Â bp);\nÂ Â Â Â Â Â Â Â PUT(PRED(bp),Â prevp);\nÂ Â Â Â Â Â Â Â PUT(SUCC(bp),Â nextp);\nÂ Â Â Â Â Â Â Â ifÂ (nextpÂ !=Â NULL)\nÂ Â Â Â Â Â Â Â Â Â Â Â PUT(PRED(nextp),Â bp);\nÂ Â Â Â }\n}\n\n/*\nÂ *Â mm_reallocÂ -Â ImplementedÂ simplyÂ inÂ termsÂ ofÂ mm_mallocÂ andÂ mm_free\nÂ */\nvoidÂ *mm_realloc(voidÂ *ptr,Â size_tÂ size)\n{\nÂ Â Â Â ifÂ (ptrÂ ==Â NULL)Â Â Â Â //ptrÂ ==Â NULLÂ ç›´æ¥mm_malloc\nÂ Â Â Â Â Â Â Â returnÂ mm_malloc(size);\nÂ Â Â Â ifÂ (sizeÂ ==Â 0)Â Â Â Â Â Â //sizeÂ ==Â 0Â ç›´æ¥free\nÂ Â Â Â {\nÂ Â Â Â Â Â Â Â mm_free(ptr);\nÂ Â Â Â Â Â Â Â returnÂ NULL;\nÂ Â Â Â }\nÂ Â Â Â size_tÂ asize;\nÂ Â Â Â size_tÂ copySizeÂ =Â GET_SIZE(HDRP(ptr));\nÂ Â Â Â voidÂ *bp;\nÂ Â Â Â ifÂ (sizeÂ <=Â DSIZE)Â Â //8å­—èŠ‚å¯¹é½\nÂ Â Â Â Â Â Â Â asizeÂ =Â 2Â *Â (DSIZE);\nÂ Â Â Â else\nÂ Â Â Â Â Â Â Â asizeÂ =Â (DSIZE)Â *Â ((sizeÂ +Â (DSIZE)Â +Â (DSIZEÂ -Â 1))Â /Â (DSIZE));\nÂ Â Â Â ifÂ (copySizeÂ >=Â asize)Â Â //å°äºåŸptrå¤§å°æŠ›å¼ƒç©ºé—²åŒºåŸŸç›´æ¥è¿”å›\nÂ Â Â Â Â Â Â Â returnÂ ptr;Â \nÂ Â Â Â ifÂ (!GET_ALLOC(HDRP(NEXT_BLKP(ptr)))Â &&Â !GET_SIZE(HDRP(NEXT_BLKP(NEXT_BLKP(ptr)))))\nÂ Â Â Â {\nÂ Â Â Â Â Â Â Â //åˆ¤æ–­åå—æ˜¯å¦ä¸ºç©ºé—²å—ä¸”ç©ºé—²å—æ˜¯å¦ä¸ºæœ€åä¸€å—\nÂ Â Â Â Â Â Â Â size_tÂ new_sizeÂ =Â GET_SIZE(HDRP(ptr))Â +Â GET_SIZE(HDRP(NEXT_BLKP(ptr)));\nÂ Â Â Â Â Â Â Â ifÂ (new_sizeÂ <Â asize)Â Â Â //å¤§å°ä¸å¤Ÿéœ€è¦è¿›è¡Œæ‰©å±•å †\nÂ Â Â Â Â Â Â Â {\nÂ Â Â Â Â Â Â Â Â Â Â Â ifÂ (extend_heap(MAX(asizeÂ -Â new_size,Â CHUNKSIZE)Â ==Â NULL))\nÂ Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â returnÂ NULL;Â Â Â Â //æ‰©å±•å¤±è´¥\nÂ Â Â Â Â Â Â Â Â Â Â Â new_sizeÂ +=Â MAX(asizeÂ -Â new_size,Â CHUNKSIZE);Â Â Â //æ›´æ–°å¤§å°\nÂ Â Â Â Â Â Â Â }\nÂ Â Â Â Â Â Â Â relink(NEXT_BLKP(ptr));Â //åˆ é™¤ç©ºé—²å—\nÂ Â Â Â Â Â Â Â PUT(HDRP(ptr),Â PACK(new_size,Â 1));Â Â //æ›´æ–°åŸå—å¤§å°\nÂ Â Â Â Â Â Â Â PUT(FTRP(ptr),Â PACK(new_size,Â 1));\nÂ Â Â Â Â Â Â Â returnÂ ptr;\nÂ Â Â Â }\nÂ Â Â Â //ä¸Šè¿°æ¡ä»¶å‡ä¸æ»¡è¶³æ—¶é€‰æ‹©åŸå§‹æ–¹æ³•\nÂ Â Â Â bpÂ =Â mm_malloc(size);\nÂ Â Â Â memcpy(bp,Â ptr,Â size);\nÂ Â Â Â mm_free(ptr);\nÂ Â Â Â returnÂ bp;\n}\n```","tags":["CSAPP","æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿ"],"categories":["è®¡è½¯æ‚è°ˆ"]},{"title":"CSAPP - AttackLab","url":"/20220619/csapp-attacklab/","content":"> - **ç¼“å†²åŒºæº¢å‡º**\n>     - é€šè¿‡æ‰§è¡Œæ³¨å…¥çš„ä»£ç ï¼Œé‡å†™è¿”å›åœ°å€ï¼Œæ‰§è¡Œå¦ä¸€ä¸ªä»£ç ç‰‡æ®µã€‚\n> - **ROPæ”»å‡»**\n>     - éšæœºåŒ–ã€å°†ä¿å­˜æ ˆçš„å†…å­˜åŒºåŸŸè®¾ç½®ä¸ºä¸å¯æ‰§è¡Œç­‰æŠ€æœ¯ä½¿å¾—ç¼“å†²åŒºæº¢å‡ºæ”»å‡»å¤±æ•ˆã€‚è¿™æ—¶å¯ä»¥é€šè¿‡ç°æœ‰ç¨‹åºä¸­çš„ä»£ç è€Œä¸æ˜¯æ³¨å…¥æ–°çš„ä»£ç å®ç°æ”»å‡»ã€‚åˆ©ç”¨gadgetså’Œstringç»„æˆæ³¨å…¥çš„ä»£ç ï¼Œå…·ä½“æ¥è¯´æ˜¯ä½¿ç”¨popå’ŒmovæŒ‡ä»¤åŠ ä¸ŠæŸäº›å¸¸æ•°æ¥æ‰§è¡Œç‰¹å®šçš„æ“ä½œã€‚\n\n## å®éªŒè¦æ±‚\n- å®éªŒåˆ†ä¸º5ä¸ªé˜¶æ®µï¼Œlevel1-3æ˜¯é€šè¿‡ç¼“å†²åŒºæº¢å‡ºæ–¹å¼è¿›è¡Œæ”»å‡»ï¼Œlevel4-5åˆ™æ˜¯é€šè¿‡ROPæ”»å‡»æ–¹å¼è¿›è¡Œæ”»å‡»ã€‚\n### æ–‡ä»¶åŠŸèƒ½\n- cookie.txt:å­˜æ”¾ä½ æ”»å‡»ç”¨çš„æ ‡è¯†ç¬¦\n- ctarget:æ‰§è¡Œcode-injectionæ”»å‡»çš„ç¨‹åº\n- rtarget:æ‰§è¡Œreturn-oriented-programmingæ”»å‡»çš„ç¨‹åº\n- farm.c:gadget farmäº§ç”Ÿä»£ç ç‰‡æ®µ\n- hex2raw:ç”Ÿæˆæ”»å‡»å­—ç¬¦ä¸²\nå…¶ä¸­ï¼Œctargetå’Œrtargetä¼šä»æ ‡å‡†è¾“å…¥è¯»å–å­—ç¬¦ä¸²ï¼Œä¿å­˜åœ¨å¤§å°ä¸ºBUFFER_SIZEçš„charæ•°ç»„ä¸­ã€‚\n## å‰ç½®ä»»åŠ¡\n- å¯¹ctargetè¿›è¡Œåæ±‡ç¼–\n```shell\nobjdump -d ctarget > ctarget.txt\n```\n- å¯¹rtargetè¿›è¡Œåæ±‡ç¼–\n```shell\nobjdump -d rtarget > rtarget.txt\n```\n- ç¡®å®šgetbufçš„ç¼“å†²åŒºå¤§å°\n![0](https://d-sketon.top/img/csapp-attacklab/0.png)\n778è¡Œå¯çŸ¥getbufå¼€è¾Ÿäº†40(0x28)å­—èŠ‚çš„æ ˆç©ºé—´ï¼Œå³bufferä¸º40å­—èŠ‚\n## **level 1**\n\n> ä¸éœ€è¦æ³¨å…¥æ–°çš„ä»£ç ï¼Œåªéœ€è¦è®©ç¨‹åºé‡å®šå‘è°ƒç”¨æŸä¸ªæ–¹æ³•ã€‚\n\n```c\nvoid touch1()\n{\n    vlevel = 1;     /* Part of validation protocol */\n    printf(\"Touch1!: You called touch1()\\n\");\n    validate(1);\n    exit(0);\n}\n```\ntouch1å‡½æ•°ä¸­æ²¡æœ‰ç‰¹åˆ«è¦æ±‚ï¼Œåªè¦è¿è¡Œè¿›å…¥è¯¥å‡½æ•°å³å¯è°ƒç”¨validate(1)\næ‰€ä»¥åªéœ€è¾“å…¥å­—ç¬¦ä¸²ç¬¬40å­—èŠ‚åä¸ºtouch1å‡½æ•°çš„åœ°å€å³å¯ä»¥è¦†ç›–æ‰åŸå‡½æ•°è¿”å›åœ°å€è¿›å…¥touch1\n- æŸ¥çœ‹æ±‡ç¼–ä»£ç ï¼š\n![2](https://d-sketon.top/img/csapp-attacklab/2.png)\n\nç­”æ¡ˆä¸ºï¼š\n```text\n00 00 00 00 00 00 00 00\n00 00 00 00 00 00 00 00\n00 00 00 00 00 00 00 00\n00 00 00 00 00 00 00 00\n00 00 00 00 00 00 00 00\nc0 17 40 00 00 00 00 00    //å°ç«¯è¾“å…¥\n```\n![e_1](https://d-sketon.top/img/csapp-attacklab/e_1.png)\n## **level 2**\n\n> éœ€è¦æ³¨å…¥ä¸€æ®µä»£ç \n\n```c\nvoid touch2(unsigned val)\n{\n    vlevel = 2;     /* Part of validation protocol */\n    if (val == cookie) {\n        printf(\"Touch2!: You called touch2(0x%.8x)\\n\", val);\n        validate(2);\n    } else {\n        printf(\"Misfire: You called touch2(0x%.8x)\\n\", val);\n        fail(2);\n    }\n    exit(0);\n}\n```\ntouch2ä¸­åªæœ‰val==cookieåæ‰èƒ½è¿›å…¥validate(2)ï¼Œè¯´æ˜é™¤äº†è¿›å…¥è¯¥å‡½æ•°å¤–ï¼Œvalå¿…é¡»ç­‰äºcookie\n- æŸ¥çœ‹æ±‡ç¼–ä»£ç ï¼š\n![3](https://d-sketon.top/img/csapp-attacklab/3.png)\n%ediä¸­å­˜æ”¾valï¼Œ0x202ce2(%rip)ï¼ˆå³0x6044e4ï¼‰å­˜æ”¾cookie\n- è°ƒç”¨gdbï¼š\n![4](https://d-sketon.top/img/csapp-attacklab/4.png)\nå³%rdiéœ€è¦ä¿®æ”¹ä¸º0x59b997fa\næ‰€ä»¥éœ€è¦åœ¨bufferä¸­æ³¨å…¥ä»£ç ï¼Œè€Œä¸ºäº†è¿è¡Œæ³¨å…¥çš„ä»£ç ï¼Œéœ€è¦è·³è½¬å›æ ˆé¡¶åœ°å€\n- è°ƒç”¨gdbï¼š\n![5](https://d-sketon.top/img/csapp-attacklab/5.png)\nå¾—åˆ°æ ˆé¡¶åœ°å€ä¸º0x5561dc78ï¼Œå³è¾“å…¥å­—ç¬¦ä¸²ç¬¬40å­—èŠ‚åä¸º0x5561dc78å³å¯ä»¥è¦†ç›–æ‰åŸå‡½æ•°è¿”å›åœ°å€è·³å›æ ˆé¡¶è¿è¡Œæ³¨å…¥çš„ä»£ç \nè€Œæ³¨å…¥çš„ä»£ç éœ€è¦ä¿®æ”¹%rdiçš„å†…å®¹å¹¶è·³åˆ°touch2å‡½æ•°ï¼š\n```text\nmov $0x59b997fa %rdi        //å°†%rdiå†…å®¹ä¿®æ”¹ä¸ºcookie\npush $0x4017ec              //å°†touch2çš„åœ°å€pushå…¥æ ˆä¸­\nret                         //ç»“æŸè¯¥å‡½æ•°ï¼Œå¹¶è¿”å›ä¸Šå±‚å‡½æ•°è¿”å›åœ°å€\n\n//ç”±äºè¯¥ä»£ç æ˜¯äººä¸ºæ³¨å…¥çš„ï¼Œæ‰€ä»¥å¹¶ä¸å­˜åœ¨ä¸Šå±‚å‡½æ•°è¿”å›åœ°å€\n//è€Œæ­¤æ—¶å°±ä¼šå°†åˆšå…¥æ ˆçš„0x4017ecä½œä¸ºè¿”å›åœ°å€ï¼Œå³è·³åˆ°äº†touch2\n```\ngccæ±‡ç¼–å¹¶objdumpåæ±‡ç¼–åå¾—åˆ°å¯¹åº”çš„16è¿›åˆ¶è¡¨ç¤ºï¼š\n![7](https://d-sketon.top/img/csapp-attacklab/7.png)\n- å°†æ³¨å…¥ä»£ç å’Œè·³è½¬åœ°å€ç»“åˆå³ä¸ºç­”æ¡ˆï¼š\n```text\n48 c7 c7 fa 97 b9 59 68    //ä¿®æ”¹%rdiå¹¶è·³åˆ°touch2\nec 17 40 00 c3 00 00 00\n00 00 00 00 00 00 00 00\n00 00 00 00 00 00 00 00\n00 00 00 00 00 00 00 00\n78 dc 61 55 00 00 00 00    //å›åˆ°æ ˆé¡¶\n```\n![e_2](https://d-sketon.top/img/csapp-attacklab/e_2.png)\n## **level 3**\n\n> éœ€è¦ä¼ å…¥å­—ç¬¦ä¸²\n\n```c\n/* Compare string to hex represention of unsigned value */\nint hexmatch(unsigned val, char *sval)\n{\n    char cbuf[110];\n    /* Make position of check string unpredictable */\n    char *s = cbuf + random() % 100;\n    sprintf(s, \"%.8x\", val);\n    return strncmp(sval, s, 9) == 0;\n}\nvoid touch3(char *sval)\n{\n    vlevel = 3;     /*Part of validation protocol */\n    if (hexmatch(cookie, sval)) {\n        printf(\"Touch3!:You called touch3(\\\"%s\\\")\\n\", sval);\n        validate(3);\n    } else {\n        printf(\"Misfire:You called touch3(\\\"%s\\\")\\n\", sval);\n        fail(3);\n    }\n    exit(0);\n}\n```\ntouch3ä¸­åªæœ‰hexmatch(cookie,sval)==1åæ‰èƒ½è¿›å…¥validate(3)\nè€Œhexmatchå‡½æ•°çš„ä½œç”¨ä¸ºå°†cookieè½¬æˆå­—ç¬¦ä¸²å¹¶å’Œsvalæ¯”è¾ƒï¼Œå¦‚æœç›¸ç­‰åˆ™è¿”å›1ï¼Œè¯´æ˜é™¤äº†éœ€è¿›å…¥touch3å‡½æ•°å¤–ï¼Œ*svalå¿…é¡»ç­‰äºcookieçš„å­—ç¬¦ä¸²å½¢å¼\n- æŸ¥çœ‹æ±‡ç¼–ä»£ç ï¼š\n![8](https://d-sketon.top/img/csapp-attacklab/8.png)\n%rsiï¼ˆå‡½æ•°ç¬¬äºŒä¸ªå‚æ•°ï¼‰ä¸ºchar* svalï¼Œ%ediä¸ºcookieï¼Œè€Œ877è¡Œå°†%rdiè½¬å…¥%rsiï¼Œè¯´æ˜åˆå§‹çŠ¶æ€ä¸‹%rdiä¸­å­˜æ”¾ç€char* svalï¼Œå³%rdiéœ€è¦ä¿®æ”¹\næ‰€ä»¥éœ€è¦åœ¨bufferä¸­æ³¨å…¥ä»£ç ï¼Œè€Œä¸ºäº†è¿è¡Œæ³¨å…¥çš„ä»£ç ï¼ŒåŒPhase 2 ä¸€æ ·éœ€è¦è·³è½¬å›æ ˆé¡¶åœ°å€0x5561dc78\n![9](https://d-sketon.top/img/csapp-attacklab/9.png)\næ³¨æ„åˆ°hexmatchå‡½æ•°ä¸­å°†%r12ï¼Œ%rbpï¼Œ%rbxå…¥æ ˆï¼Œè€Œè¿™æ ·ä¼šé€ æˆæ ˆä¸­åŸæ¥è¾“å…¥çš„å†…å®¹çš„è¦†ç›–\n![10](https://d-sketon.top/img/csapp-attacklab/10.png)\nï¼ˆä¸‰æ¬¡pushåˆ†åˆ«æ”¹å˜äº†0x5561dc90,0x5561dc88,0x5561dc80ä¸­çš„å†…å®¹ï¼‰\n### æ–¹æ³•ä¸€\nç”±äºåŸå‡½æ•°è¿”å›åœ°å€æ›´ä½çš„åœ°æ–¹ï¼ˆå³0x5561dca8åŠåŸæ ˆå¸§ä¸­æ›´ä½çš„åœ°æ–¹ï¼‰å¹¶ä¸ä¼šè¢«è¦†ç›–\næ‰€ä»¥å¯ä»¥å°†å­—ç¬¦ä¸²ï¼ˆASCIIç å½¢å¼ï¼‰å­˜å…¥0x5561dca8å¹¶å°†svalæŒ‡é’ˆï¼ˆ%rdiï¼‰ç½®ä¸º0x5561dca8\nobjdumpåæ±‡ç¼–åä»£ç ï¼š\n![11](https://d-sketon.top/img/csapp-attacklab/11.png)\n- è¯¥æ–¹æ³•ç­”æ¡ˆï¼š\n```text\n48 c7 c7 a8 dc 61 55 68\nfa 18 40 00 c3 00 00 00    //ä»£ç æ— éœ€è¡¥è¶³ä¸€å­—èŠ‚\n00 00 00 00 00 00 00 00\n00 00 00 00 00 00 00 00\n00 00 00 00 00 00 00 00\n78 dc 61 55 00 00 00 00    //åœ°å€è¦è¡¥è¶³ä¸€å­—èŠ‚ï¼Œå¦åˆ™segmentation fault\n35 39 62 39 39 37 66 61    //å°ç«¯å­˜å‚¨\n```\n### æ–¹æ³•äºŒ(æœ€å…ˆå°è¯•çš„æ–¹æ³•ï¼‰\næ³¨æ„åˆ°0x5561dc88å¯¹åº”%rbpï¼Œ0x5561dc90å¯¹åº”%r12ï¼Œæ‰€ä»¥å¯ä»¥å°†å­—ç¬¦ä¸²ï¼ˆASCIIç å½¢å¼ï¼‰å­˜å…¥%rbpï¼Œå¹¶å°†%r12æ¸…é›¶ï¼ˆå› ä¸º%r12ä¸­å­˜ç€0x3ï¼Œä¸æ¸…é›¶ä¼šæŠŠ3ä»¥ASCIIç çš„å½¢å¼æ‰“å‡ºæ¥ï¼‰ï¼Œå°†svalæŒ‡é’ˆï¼ˆ%rdiï¼‰ç½®ä¸º0x5561dc88ï¼Œè¿™æ ·åœ¨hexmatchå¼€å¤´ä¸‰æ¬¡pushåå­—ç¬¦ä¸²å°±è¢«å­˜å…¥äº†0x5561dc88ä¸­ï¼š\n![12](https://d-sketon.top/img/csapp-attacklab/12.png)\nobjdumpåæ±‡ç¼–åä»£ç ï¼š\n![13](https://d-sketon.top/img/csapp-attacklab/13.png)\n- è¯¥æ–¹æ³•ç­”æ¡ˆï¼š\n```text\n48 c7 c7 88 dc 61 55 48 //ä¿®æ”¹%rdi\nbd 35 39 62 39 39 37 66 //%rbpæ³¨å…¥å­—ç¬¦ä¸²\n61 49 c7 c4 00 00 00 00 //%r12æ¸…é›¶\n68 fa 18 40 00 c3 00 00 //touch3åœ°å€å…¥æ ˆ\n00 00 00 00 00 00 00 00\n78 dc 61 55 00 00 00 00 //å›åˆ°æ ˆé¡¶\n```\n![e_3](https://d-sketon.top/img/csapp-attacklab/e_3.png)\n\nROPæ”»å‡»ä¸åŒäºå…ˆå‰çš„æ”»å‡»ä»£ç æ³¨å…¥ï¼ˆæ³¨å…¥ä»£ç ä»æ ˆé¡¶å†™å…¥ï¼‰ï¼Œæ‰€æœ‰çš„gadgetéƒ½åº”è¯¥ä»è¿”å›åœ°å€å¼€å§‹ä¾æ¬¡å†™å…¥ï¼Œè€Œæ¯æ®µgadgetè¿è¡Œå®Œretåéƒ½ä¼šä¾æ¬¡è¿›å…¥ä¸‹ä¸€ä¸ªgadget\n## **level 4**\nç”±äºè¯¥é˜¶æ®µè¦å®ç°çš„æ•ˆæœå’Œlevel 2ä¸€æ ·ï¼Œæ‰€ä»¥åŒæ ·éœ€è¦å°†%rdiå†…å®¹ä¿®æ”¹ä¸º0x59b997faå¹¶è·³åˆ°touch2å‡½æ•°\nç”±äºåªèƒ½ä½¿ç”¨mov(Resigter to Register)ï¼Œpopï¼Œretå’Œnopï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥å°†ç«‹å³æ•°è½¬å…¥å¯„å­˜å™¨ä¸­ï¼Œè€Œéœ€è¦å€ŸåŠ©popå°†æ ˆä¸­çš„ç«‹å³æ•°è½¬å…¥å¯„å­˜å™¨ä¸­\næŸ¥è¯¢farmï¼Œå‘ç°é™¤äº†0x58ï¼ˆpop %raxï¼‰å¤–æ²¡æœ‰0x59~0x5fæœ‰å…³èƒ½ä½œä¸ºgadgetçš„ä»£ç \næ‰€ä»¥æ±‡ç¼–ä»£ç åªèƒ½ä¸ºï¼š\n```txt\npop         %rax        \nretq\nmovq        %rax,%rdi\nretq\n```\næŸ¥è¯¢farmå¯çŸ¥pop %rax+retå¯ä»¥ç”¨ä¸¤ç§gadgetè¡¨ç¤ºï¼šï¼ˆ0x90=nopï¼Œå¯ä»¥å¿½ç•¥ï¼‰\n![14](https://d-sketon.top/img/csapp-attacklab/14.png \"0x4019ab\")\n![15](https://d-sketon.top/img/csapp-attacklab/15.png \"0x4019cc\")\nmovq %rax,%rdi+retå¯ä»¥ç”¨ä¸¤ç§gadgetè¡¨ç¤ºï¼šï¼ˆ0x90=nopï¼Œå¯ä»¥å¿½ç•¥ï¼‰\n![16](https://d-sketon.top/img/csapp-attacklab/16.png \"0x4019a2\")\n![17](https://d-sketon.top/img/csapp-attacklab/17.png \"0x4019c5\")\nè€Œpopçš„å†…å®¹ï¼ˆ0x59b997faï¼‰åº”è¯¥æ”¾åœ¨pop+retqæŒ‡ä»¤ä¹‹åï¼Œæ­¤æ—¶popæŒ‡ä»¤ä¼šå°†popåå¯¹åº”ä½ç½®çš„å…ƒç´ popè¿›å¯¹åº”çš„å¯„å­˜å™¨ä¸­\nè€Œtouch2å‡½æ•°åœ°å€ï¼ˆ0x4017ecï¼‰åº”è¯¥æ”¾åœ¨movq+retqæŒ‡ä»¤ä¹‹åï¼Œå½“retæŒ‡ä»¤è¿è¡Œå®Œæ¯•åä¹‹åçš„åœ°å€ä¼šå……å½“è¿”å›åœ°å€è¿›å…¥touch2å‡½æ•°\n- ç­”æ¡ˆï¼š**ï¼ˆæ‰€æœ‰gadgetåº”è¯¥å¡«å……è‡³1å­—èŠ‚ï¼Œå¦åˆ™ä¼šsegmentation faultï¼‰**\n```text\n00 00 00 00 00 00 00 00\n00 00 00 00 00 00 00 00\n00 00 00 00 00 00 00 00\n00 00 00 00 00 00 00 00    \n00 00 00 00 00 00 00 00    //å¡«å……40å­—èŠ‚\ncc 19 40 00 00 00 00 00    //pop %raxï¼ˆæˆ–ab 19 40 00 00 00 00 00ï¼‰\nfa 97 b9 59 00 00 00 00    //è¢«popçš„cookie\nc5 19 40 00 00 00 00 00    //movq %rax,%rdiï¼ˆæˆ–a2 19 40 00 00 00 00 00ï¼‰\nec 17 40 00 00 00 00 00    //è¿”å›åœ°å€\n```\n![e_4](https://d-sketon.top/img/csapp-attacklab/e_4.png)\n## **level 5**\nç”±äºè¯¥é˜¶æ®µè¦å®ç°çš„æ•ˆæœå’ŒPhase 3ä¸€æ ·ï¼Œæ‰€ä»¥åŒæ ·éœ€è¦å°†%rdiå†…å®¹ä¿®æ”¹ä¸ºcookieå­—ç¬¦ä¸²å¯¹åº”åœ°å€å¹¶è·³åˆ°touch3å‡½æ•°\nç”±äºæ¯æ¬¡æ ˆéƒ½æ˜¯éšæœºå¼€è¾Ÿï¼Œå­˜å…¥å­—ç¬¦ä¸²çš„åœ°å€å¹¶ä¸å›ºå®šï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥æŠŠåœ°å€èµ‹å€¼ç»™%rdiï¼Œè€Œéœ€è¦é€šè¿‡è¯»å–æ ˆé¡¶åœ°å€%rspåŠ ä¸Šä¸€å®šçš„åç§»é‡æ¥è·å¾—å­—ç¬¦ä¸²åœ°å€\nè€Œåœ°å€è®¡ç®—éœ€è¦leaå‘½ä»¤ï¼ŒæŸ¥æ‰¾farmï¼š\n![18](https://d-sketon.top/img/csapp-attacklab/18.png)\nè¯¥å‘½ä»¤æ­£å¥½å¯ä½œä¸ºä¸€ä¸ªæ ˆåœ°å€åç§»çš„gadgetï¼Œ%rdiå’Œ%rsiä¸€ä¸ªä¸ºæ ˆé¡¶åœ°å€ï¼Œä¸€ä¸ªä¸ºåç§»é‡\nç»§ç»­é€šè¿‡æŸ¥æ‰¾farmå‘ç°ä»…ä»…å­˜åœ¨%eax->%edx->%ecx->%esiè¿™æ ·ä¸€æ¡è·¯å¾„é€šè¿‡movlä¸º%rdièµ‹å€¼ï¼Œè€ŒmovlæŒ‡ä»¤ä»¥å¯„å­˜å™¨ä½œä¸ºç›®çš„æ—¶ï¼Œä¼šæŠŠè¯¥å¯„å­˜å™¨çš„é«˜ä½4å­—èŠ‚è®¾ç½®ä¸º0ï¼Œå³ä¼šæŸå¤±é«˜å››å­—èŠ‚çš„å€¼ã€‚è€Œæ ˆé¡¶åœ°å€ç»è¿‡gdbæ–­ç‚¹æµ‹è¯•ï¼Œéƒ½è‡³å°‘å¤§äº0x7ffffff00000ï¼š\n![19](https://d-sketon.top/img/csapp-attacklab/19.png)\nè€Œåç§»é‡è‚¯å®šå°äº0xfffffffffï¼Œæ‰€ä»¥åœ°å€åªèƒ½å­˜å…¥%rdiä¸­ï¼Œè€ŒæŠŠåç§»é‡å­˜å…¥%rsiä¸­\næ­¤å¤–ç”±äºåç§»é‡å¿…é¡»ä¸ºæ­£æ•°ï¼ˆé«˜å››å­—èŠ‚ç½®0ï¼‰ï¼Œæ‰€ä»¥è¾“å…¥çš„å­—ç¬¦ä¸²ä¸èƒ½åœ¨å‰40ä¸ªå­—èŠ‚ä¸­ï¼ˆè¯¥ä½ç½®åœ°å€æ¯”%rspæ›´å°ï¼Œä¸”å¯èƒ½ä¼šè¢«è¦†ç›–ï¼‰ï¼Œåªèƒ½åœ¨æ‰€æœ‰gadgetä¹‹åå†™å…¥ï¼ˆé˜²æ­¢å¹²æ‰°æ ˆä¸­gadgetï¼‰\n\næ‰€ä»¥ROPæ•´ä½“æ€è·¯ä¸ºï¼š\n1.å°†åç§»é‡popå…¥%raxä¸­\n2.movlæŒ‡ä»¤å°†åç§»é‡ä»¥è¯¥é¡ºåºï¼š%eax->%edx->%ecx->%esiç§»å…¥%rsiä¸­\n3.movqæŒ‡ä»¤å°†æ ˆæŒ‡é’ˆä»¥è¯¥é¡ºåºï¼š%rsp->%rax->%rdiç§»å…¥%rdiä¸­\n4.leaæŒ‡ä»¤è®¡ç®—å­—ç¬¦ä¸²åœ°å€\n5.è®¡ç®—ç»“æœ%raxèµ‹å€¼ç»™%rdi\n6.è°ƒç”¨touch3\n\næ±‡ç¼–ä»£ç ä¸ºï¼š\n```text\npop %rax\nretq\n```\n![20](https://d-sketon.top/img/csapp-attacklab/20.png)\n```text\nmovl         %eax,%edx\nretq\n```\n![21](https://d-sketon.top/img/csapp-attacklab/21.png)\n```text\nmovl        %edx,%ecx\nretq\n```\n![22](https://d-sketon.top/img/csapp-attacklab/22.png)\n```text\nmovl         %ecx,%esi\nretq\n```\n![23](https://d-sketon.top/img/csapp-attacklab/23.png)\n```text\nmovq         %rsp,%rax\nretq\n```\n![24](https://d-sketon.top/img/csapp-attacklab/24.png)\n```text\nmovq         %rax,%rdi\nretq\n```\n![25](https://d-sketon.top/img/csapp-attacklab/25.png)\n```text\nlea         (%rdi,%rsi,1),%rax\nretq\n```\n![26](https://d-sketon.top/img/csapp-attacklab/26.png)\n```text\nmovq        %rax,%rdi\nretq\n```\n![27](https://d-sketon.top/img/csapp-attacklab/27.png)\næ³¨æ„åˆ°æ¯æ¬¡retå%rspéƒ½ä¼šåŠ 0x8ï¼Œ%raxå†…çš„åœ°å€å’Œæœ«å°¾å­—ç¬¦ä¸²åœ°å€ä¹‹é—´çš„å·®ç­‰äº(ä¸¤è€…ä¹‹é—´çš„å‘½ä»¤ä¸ªæ•°+1)*8\nä»movq %rsp,%raxç®—èµ·æœ‰ä¸¤ä¸ªmovqå’Œä¸€ä¸ªleaï¼Œæ‰€ä»¥åç§»é‡ä¸º(3+1)*8=32=0x20\n![28](https://d-sketon.top/img/csapp-attacklab/28.png)\nè°ƒç”¨gdbå‘ç°è¾“å…¥çš„å­—ç¬¦ä¸²ä¹‹åçš„å­—èŠ‚ä¸º0xf4f4f4f4f4f4f400ï¼Œæœ«å°¾ä¸¤ä½ä¸º0ï¼Œç”±äºå­—ç¬¦ä¸²æ˜¯ä»å³å‘å·¦è¾“å‡ºï¼Œæ‰€ä»¥0xf4f4f4f4f4f4f400ä¸ä¼šè¾“å‡ºå¤šä½™å­—ç¬¦ï¼Œä¹Ÿå°±æ— éœ€å°†è¯¥å­—èŠ‚æ¸…é›¶\n\n- æœ€ç»ˆç­”æ¡ˆï¼ˆç­”æ¡ˆä¸å”¯ä¸€ï¼‰ï¼š\n```text\n00 00 00 00 00 00 00 00\n00 00 00 00 00 00 00 00\n00 00 00 00 00 00 00 00\n00 00 00 00 00 00 00 00\n00 00 00 00 00 00 00 00    //å¡«å……40å­—èŠ‚\nab 19 40 00 00 00 00 00    //pop %rax\n20 00 00 00 00 00 00 00    //è¢«popçš„åç§»é‡\n42 1a 40 00 00 00 00 00    //mov %eax,%edx\n34 1a 40 00 00 00 00 00 //mov %edx,%ecx\n27 1a 40 00 00 00 00 00    //mov %ecx,%esi\n06 1a 40 00 00 00 00 00    //mov %rsp,%rax\nc5 19 40 00 00 00 00 00    //mov %rax,%rdi\nd6 19 40 00 00 00 00 00    //lea (%rdi,%rsi,1),%rax\nc5 19 40 00 00 00 00 00    //mov %rax,%rdi\nfa 18 40 00 00 00 00 00    //touch3åœ°å€\n35 39 62 39 39 37 66 61    //å­—ç¬¦ä¸²\n```\n![e_5](https://d-sketon.top/img/csapp-attacklab/e_5.png)","tags":["CSAPP","æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿ"],"categories":["è®¡è½¯æ‚è°ˆ"]},{"title":"ä¿®å¤leancloudæ— æ³•æ˜¾ç¤ºé˜…è¯»æ¬¡æ•°","url":"/20220601/leancloud-recovery/","content":"æœ¬äººè¿‘æœŸæ‰“ç®—ä¿®å¤ä¸€ä¸‹ä¸€ç›´æ— æ³•ä½¿ç”¨çš„åšå®¢é˜…è¯»æ¬¡æ•°ã€‚\nHexo-shokaä¸»é¢˜æ‰€é‡‡ç”¨çš„æ˜¯valineç»“åˆleancloudæ¥è®°å½•æ¯ä¸€ç¯‡åšå®¢çš„é˜…è¯»æ¬¡æ•°ï¼Œå¯ä¸çŸ¥é“ä½•æ—¶å¼€å§‹åº•ä¸‹çš„é˜…è¯»æ¬¡æ•°å°±å§‹ç»ˆä¸ºç©ºã€‚\n![01](https://d-sketon.top/img/leancloud/lean01.png)\né€šè¿‡æŸ¥çœ‹F12å¯ä»¥å‘ç°ï¼Œmd5.min.jsï¼Œav-min.jså‡è·å–å¤±è´¥ï¼Œè€Œå‘èµ·ç¨‹åºåˆ™æ˜¯MiniValine.min.jsã€‚å…¶åŸå› åœ¨äºè¿‘æœŸjsdelivrçš„DNSå‘ç”Ÿäº†æ±¡æŸ“æ‰€è‡´ã€‚\n![02](https://d-sketon.top/img/leancloud/lean02.png)\nå¯åœ¨è¿™ä¹‹å‰æœ¬äººå·²ç»å°†åšå®¢å†…çš„jsdelivrå‡æ›´æ¢ä¸ºäº†fastlyé•œåƒï¼Œå¯ä»ç„¶å‘ç”Ÿäº†è¯¥å¼‚å¸¸ï¼Œé€šè¿‡æŸ¥çœ‹MiniValine.min.jså¯ä»¥å‘ç°åœ¨jså†…éƒ¨å¼•ç”¨äº†è®¸å¤šcdn.jsdelivræœ‰å…³çš„èµ„æºã€‚\n![03](https://d-sketon.top/img/leancloud/lean03.png)\nè€ƒè™‘å°†jsæ–‡ä»¶ä¸‹è½½åˆ°æœåŠ¡å™¨ï¼Œå¹¶å¯¹jsè¿›è¡Œé­”æ”¹æ“ä½œã€‚\n\nå°†themes\\shoka\\scripts\\helpersä¸­çš„\n```js\nlet result = vendorJs ? `<script src=\"//fastly.jsdelivr.net/combine/${vendorJs}\"></script>` : '';\nreturn vendorJs ? htmlTag('script', { src: `//fastly.jsdelivr.net/combine/${vendorJs}` }, '') : '';\n```\nä¿®æ”¹ä¸º\n```js\nlet result = vendorJs ? `<script src=\"//d-sketon.top/combine/${vendorJs}\"></script>` : '';\nreturn vendorJs ? htmlTag('script', { src: `//d-sketon.top/combine/${vendorJs}` }, '') : '';\n```\nthemes\\shoka\\source\\js\\_appä¸­çš„\n```js\nif(str.indexOf('npm')>-1||str.indexOf('gh')>-1||str.indexOf('combine')>-1)\n     return \"//fastly.jsdelivr.net/\" + str\n```\nä¿®æ”¹ä¸º\n```js\nif(str.indexOf('npm')>-1||str.indexOf('gh')>-1||str.indexOf('combine')>-1)\n     return \"//d-sketon.top/\" + str\n```\nå¹¶åœ¨æœåŠ¡å™¨ä¸Šåˆ›å»ºå¯¹åº”çš„jsæ–‡ä»¶ä½¿ç”¨nginxè¿›è¡ŒURLæ˜ å°„ï¼Œæ³¨æ„å¢åŠ ç¼“å†²é˜²æ­¢jsè¢«æˆªæ–­\n```text\nlocation  ^~/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist {\n          alias /var/www/cdn;\n          proxy_buffer_size 128k;\n          proxy_buffers   32 128k;\n          proxy_busy_buffers_size 128k;\n}\nlocation ^~/gh/amehime/MiniValine@4.2.2-beta10/dist {\n          alias /var/www/cdn;\n          proxy_buffer_size 128k;\n          proxy_buffers   32 128k;\n          proxy_busy_buffers_size 128k;\n}\nlocation  ^~/combine/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css,npm/justifiedGallery@3.8.1/dist/css {\n          alias /var/www/cdn;\n          proxy_buffer_size 128k;\n          proxy_buffers   32 128k;\n          proxy_busy_buffers_size 128k;\n}\nlocation  ^~/combine/npm/jquery@3.5.1/dist/jquery.min.js,npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js,npm/justifiedGallery@3.8.1/dist/js {\n          alias /var/www/cdn;\n          proxy_buffer_size 128k;\n          proxy_buffers   32 128k;\n          proxy_busy_buffers_size 128k;\n}\n```\n![07](https://d-sketon.top/img/leancloud/lean07.png)\nå°†MiniValine.min.jsä¸­æ‰€æœ‰çš„cdn.jsdelivræ”¹ä¸ºfastly.jsdelivr\nç»è¿‡æµ‹è¯•åå‘ç°md5.min.jsï¼Œav-min.jså‡è·å–æˆåŠŸï¼Œä¸”å¯ä»¥è·å¾—é˜…è¯»æ¬¡æ•°ï¼Œä¿®å¤å®Œæˆã€‚\n![06](https://d-sketon.top/img/leancloud/lean06.png)","tags":["leancloud"],"categories":["è®¡è½¯æ‚è°ˆ"]},{"title":"ç™¾åº¦åœ°å›¾API GLä½¿ç”¨æ€»ç»“","url":"/20211224/baidumap-api/","content":"J2EEé¡¹ç›®æ€»ç»“\n\n<!-- more -->\n\n- JavaScript API GL  v1.0æ˜¯ç›®å‰ç‰ˆæœ¬æœ€æ–°çš„ç™¾åº¦åœ°å›¾APIï¼Œç›¸æ¯”äºJavaScript API v3.0ç•Œé¢æ›´åŠ ç¾è§‚ï¼ŒåŠŸèƒ½æ›´åŠ å¼ºå¤§ã€‚\n## é¡¹ç›®éœ€æ±‚\n- ä»åç«¯è¯»å–èµ·ç‚¹å’Œç»ˆç‚¹çš„åœ°å€ï¼Œåœ¨åœ°å›¾ä¸Šæ˜¾ç¤ºä¸¤è€…ä¹‹é—´çš„è·¯å¾„ã€‚\n- è·å¾—è·¯å¾„ä¸Šæ‰€æœ‰ç‚¹çš„åæ ‡ï¼Œç”¨ä»¥æ˜¾ç¤ºå¡è½¦çš„è™šæ‹Ÿä½ç½®ã€‚\n## å…·ä½“å®ç°\n### è§£æåœ°å€\n- ä»å®˜æ–¹æ–‡æ¡£ä¸­å¯ä»¥å¾—åˆ°ç¤ºä¾‹ä»£ç ï¼š\n```js\nvar map = new BMapGL.Map('container');\n//åˆ›å»ºåœ°å€è§£æå™¨å®ä¾‹\nvar myGeo = new BMapGL.Geocoder();\n// å°†åœ°å€è§£æç»“æœæ˜¾ç¤ºåœ¨åœ°å›¾ä¸Šï¼Œå¹¶è°ƒæ•´åœ°å›¾è§†é‡\nmyGeo.getPoint('åŒ—äº¬å¸‚æµ·æ·€åŒºä¸Šåœ°10è¡—', function(point){\n    if(point){\n        map.centerAndZoom(point, 16);\n        map.addOverlay(new BMapGL.Marker(point, {title: 'åŒ—äº¬å¸‚æµ·æ·€åŒºä¸Šåœ°10è¡—'}))\n    }else{\n        alert('æ‚¨é€‰æ‹©çš„åœ°å€æ²¡æœ‰è§£æåˆ°ç»“æœï¼');\n    }\n}, 'åŒ—äº¬å¸‚')\n```\n- åˆ†æä»£ç å¯ä»¥å¾—çŸ¥ï¼šgetPointå‡½æ•°ç”¨ä»¥å°†åœ°å€å­—ç¬¦ä¸²è§£æä¸ºPointï¼Œå¹¶é€šè¿‡å›è°ƒå‡½æ•°è¿›ä¸€æ­¥å¯¹Pointè¿›è¡Œå¤„ç†ã€‚\n### æ˜¾ç¤ºè·¯å¾„\n- è·å¾—è·¯å¾„å¯ä»¥æœ‰å¤šç§é€‰æ‹©ï¼Œä¾‹å¦‚ï¼šé©¾è½¦è·¯çº¿ï¼Œæ­¥è¡Œè·¯å¾„ï¼Œå…¬äº¤è·¯å¾„ï¼Œéª‘è¡Œè·¯å¾„ç­‰ç­‰ã€‚ç™¾åº¦ä¹Ÿæä¾›äº†è´§è½¦è·¯å¾„çš„è§„åˆ’ï¼Œä½†éœ€è¦å‘ç™¾åº¦é€’äº¤ç”³è¯·ï¼Œè¿‡ç¨‹è¾ƒä¸ºç¹çï¼Œæ‰€ä»¥æœ€ç»ˆè€ƒè™‘é€‰æ‹©ä½¿ç”¨é©¾è½¦è·¯çº¿è§„åˆ’ã€‚\n- ä»å®˜æ–¹æ–‡æ¡£ä¸­å¯ä»¥å¾—åˆ°ç¤ºä¾‹ä»£ç ï¼š\n```js\nvar map = new BMapGL.Map(\"container\");\nmap.centerAndZoom(new BMapGL.Point(116.404, 39.915), 11);\n\nvar p1 = new BMapGL.Point(116.301934,39.977552);\nvar p2 = new BMapGL.Point(116.508328,39.919141);\n\nvar driving = new BMapGL.DrivingRoute(map, {renderOptions:{map: map, autoViewport: true}});\ndriving.search(p1, p2);\n```\n- åˆ†æä»£ç å¯ä»¥å¾—çŸ¥ï¼šsearchå‡½æ•°ç”¨ä»¥è·å¾—p1ï¼Œp2ä¸¤ä¸ªåæ ‡ä¹‹é—´çš„è·¯å¾„\n- å°†ä»¥ä¸Šä¸¤ä¸ªç¤ºä¾‹ä»£ç ç»“åˆå¯ä»¥å¾ˆè‡ªç„¶çš„æƒ³åˆ°ä»¥ä¸‹ä»£ç ï¼š\n```js\n var map = new BMapGL.Map(\"container\");\nmap.centerAndZoom(new BMapGL.Point(116.404, 39.915), 11);\nvar myGeo = new BMapGL.Geocoder();\nvar p1,p2;\nmyGeo.getPoint('åŒ—äº¬å¸‚æµ·æ·€åŒºä¸Šåœ°10è¡—', function (point) {\n  if (point) {\n    p1 = point;\n  } else {\n    alert('æ‚¨é€‰æ‹©çš„åœ°å€æ²¡æœ‰è§£æåˆ°ç»“æœï¼');\n  }\n})\nmyGeo.getPoint('åŒ—äº¬å¸‚æµ·æ·€åŒºé¢å’Œå›­è·¯5å·', function (point) {\n  if (point) {\n    p2 = point;\n  } else {\n    alert('æ‚¨é€‰æ‹©çš„åœ°å€æ²¡æœ‰è§£æåˆ°ç»“æœï¼');\n  }\n})\nvar driving = new BMapGL.DrivingRoute(map, { renderOptions: { map: map, autoViewport: true } });\ndriving.search(p1, p2);\n```\n- ä½†å®é™…ä¸Šä»¥ä¸Šä»£ç æ˜¯ä¸èƒ½è¿è¡Œçš„ï¼Œåœ¨searchå‡½æ•°è¢«è°ƒç”¨ä¹‹å‰è¾“å‡ºp1å’Œp2å¯ä»¥å‘ç°ä¸¤è€…éƒ½æ˜¯undefinedã€‚è¿™æ˜¯å› ä¸ºgetPointå‡½æ•°å…¶å®æ˜¯å¼‚æ­¥å‡½æ•°ï¼Œæ‰§è¡Œé¡ºåºå¹¶éæŒ‰ç…§é¡ºåºæ‰§è¡Œï¼Œæ‰€ä»¥ä¼šå¯¼è‡´æ— æ³•å¯¹p1å’Œp2èµ‹å€¼ã€‚æ‰€ä»¥æ”¹å˜ç­–ç•¥ï¼Œè€ƒè™‘ä½¿ç”¨å‡½æ•°åµŒå¥—çš„æ‰‹æ®µè¿›è¡Œèµ‹å€¼ï¼š\n```js\nvar map = new BMapGL.Map(\"container\");\nmap.centerAndZoom(new BMapGL.Point(116.404, 39.915), 11);\nvar myGeo = new BMapGL.Geocoder();\nmyGeo.getPoint('åŒ—äº¬å¸‚æµ·æ·€åŒºä¸Šåœ°10è¡—', function (point) {\n  if (point) {\n    var p1 = point;\n    myGeo.getPoint('åŒ—äº¬å¸‚æµ·æ·€åŒºé¢å’Œå›­è·¯5å·', function (point) {\n      if (point) {\n        var p2 = point;\n        var driving = new BMapGL.DrivingRoute(map, { renderOptions: { map: map, autoViewport: true } });\n        driving.search(p1, p2);\n      } else {\n        alert('æ‚¨é€‰æ‹©çš„åœ°å€æ²¡æœ‰è§£æåˆ°ç»“æœï¼');\n      }\n    })\n  } else {\n    alert('æ‚¨é€‰æ‹©çš„åœ°å€æ²¡æœ‰è§£æåˆ°ç»“æœï¼');\n  }\n})\n```\n- ç»æµ‹è¯•ï¼Œå¯ä»¥æ­£å¸¸è¿è¡Œï¼š\n![36](https://d-sketon.top/img/baidumap-api/36.png)\n### è·å–åæ ‡\n- è·å¾—åæ ‡åœ¨å®˜æ–¹æ–‡æ¡£ä¸­å¹¶æ²¡æœ‰ç›¸å…³çš„ä»£ç ä¾›å‚è€ƒï¼Œæ‰€ä»¥åªèƒ½è‡ªè¡Œè§£å†³ã€‚\n- ç½‘ç»œä¸Šè®¸å¤šå’Œè·å–è·¯å¾„ä¸Šåæ ‡çš„ä»£ç å¤šä¸ºï¼š\n```js\ndriving.search(p1, p2);\nvar pts = driving.getResults().getPlan(0).getRoute(0).getPath();\n```\n- ä½†è¿™å®é™…ä¸Šæ˜¯æ— æ³•è¿è¡Œçš„ï¼Œä¼šæ˜¾ç¤ºCannot read property 'getPlan' of undefinedï¼š\n![37](https://d-sketon.top/img/baidumap-api/37.png)\n- åœ¨æŸ¥çœ‹äº†è®¡ç®—é©¾è½¦è·ç¦»å’Œæ—¶é—´çš„ç›¸å…³ç¤ºä¾‹ä»£ç åå¯ä»¥çŸ¥é“åœ¨DrivingRouteä¸­å‚æ•°renderOptionså¯ä»¥ä¼ å…¥ä¸€ä¸ªå›è°ƒå‡½æ•°å®Œæˆå¯¹routeç»“æœçš„å¤„ç†ï¼Œå³ï¼š\n```js\nvar p2 = point;\nvar searchComplete = function (results) {\n  if (driving.getStatus() != BMAP_STATUS_SUCCESS) {\n    return;\n  }\n    //å¯¹ç»“æœçš„å¤„ç†ï¼Œå¯ä»¥ä½¿ç”¨getPlanå‡½æ•°äº†\n  var plan = results.getPlan(0).getRoute(0).getPath();\n}\nvar driving = new BMapGL.DrivingRoute(map, {\n  renderOptions: { map: map, autoViewport: true },\n  onSearchComplete: searchComplete,\n});\ndriving.search(p1, p2);\n```\n- ä»¥ä¸Šä»£ç å¯ä»¥æˆåŠŸè¾“å‡ºï¼Œè¿”å›ç»“æœä¸ºä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«è·¯å¾„ä¸Šæ‰€æœ‰ç‚¹çš„ç»çº¬åº¦ï¼š\n![38](https://d-sketon.top/img/baidumap-api/38.png)\n- å¯ä»¥ä½¿ç”¨Markeråœ¨åœ°å›¾ä¸Šæ ‡æ³¨ç‚¹çš„ä½ç½®ï¼š\n```js\nvar marker1 = new BMapGL.Marker(new BMapGL.Point(plan[i].lng, plan[i].lat));\nmap.addOverlay(marker1);\n```\n## å®Œæ•´ä»£ç \n```js\nfunction generateMap(sendAddress, receiveAddress, createTime, status) {\n    var map = new BMapGL.Map(\"container\");\n    var myGeo = new BMapGL.Geocoder();\n    myGeo.getPoint(sendAddress, function (point) {\n      if (point) {\n        var p1 = point;\n        map.centerAndZoom(point, 16);\n        myGeo.getPoint(receiveAddress, function (point) {\n          if (point) {\n            var p2 = point;\n            var searchComplete = function (results) {\n              if (driving.getStatus() != BMAP_STATUS_SUCCESS) {\n                return;\n              }\n              var plan = results.getPlan(0).getRoute(0).getPath();\n              if (status == \"ON_THE_WAY\") {\n                var len = plan.length - 1;\n                var now = parseInt(Date.now() / 1000);\n                var time1 = Date.parse(createTime) / 1000;\n                var i = parseInt((now - time1) / 259200 * len);\n                if (i > len) i = len;\n                var marker1 = new BMapGL.Marker(new BMapGL.Point(plan[i].lng, plan[i].lat));\n                map.addOverlay(marker1);\n              }\n            }\n            var driving = new BMapGL.DrivingRoute(map, {\n              renderOptions: { map: map, autoViewport: true },\n              onSearchComplete: searchComplete,\n            });\n            driving.search(p1, p2);\n          } else {\n            alert('æ”¶è´§åœ°å€æ²¡æœ‰è§£æåˆ°ç»“æœï¼');\n          }\n        })\n      } else {\n        alert('å‘è´§åœ°å€æ²¡æœ‰è§£æåˆ°ç»“æœï¼');\n      }\n    })\n    map.enableScrollWheelZoom(true);     //å¼€å¯é¼ æ ‡æ»šè½®ç¼©æ”¾\n    var scaleCtrl = new BMapGL.ScaleControl();  // æ·»åŠ æ¯”ä¾‹å°ºæ§ä»¶\n    map.addControl(scaleCtrl);\n    var zoomCtrl = new BMapGL.ZoomControl();  // æ·»åŠ æ¯”ä¾‹å°ºæ§ä»¶\n    map.addControl(zoomCtrl);\n    var navi3DCtrl = new BMapGL.NavigationControl3D();  // æ·»åŠ 3Dæ§ä»¶\n    map.addControl(navi3DCtrl);\n  }\n```","tags":["å‰ç«¯"],"categories":["å‰ç«¯"]},{"title":"è®¡ç®—æœºç½‘ç»œ-ç‰©ç†å±‚ å­¦ä¹ ç¬”è®°","url":"/20211024/physical-layer/","content":"- æ˜¯å…¶ä»–å±‚å»ºç«‹çš„åŸºç¡€\n- ç”µçº¿ã€å…‰çº¤å’Œæ— çº¿çš„ä»‹è´¨ç‰¹æ€§é™åˆ¶äº†ç½‘ç»œçš„åŠŸèƒ½\n- å…³é”®é—®é¢˜æ˜¯åªä½¿ç”¨ï¼ˆæ¨¡æ‹Ÿï¼‰ä¿¡å·å‘é€ï¼ˆæ•°å­—ï¼‰ä½ï¼Œä¹Ÿå°±æ˜¯è°ƒåˆ¶\n\n## æ•°æ®å’Œä¿¡å·\n### æ•°æ®\n- æ¨¡æ‹Ÿæ•°æ®ï¼ˆanalog dataï¼‰æŒ‡çš„æ˜¯**è¿ç»­**çš„ä¿¡æ¯\n- æ•°å­—æ•°æ®ï¼ˆdigital dataï¼‰æ˜¯æŒ‡å…·æœ‰**ç¦»æ•£**çŠ¶æ€çš„ä¿¡æ¯\n### ä¿¡å·\n- æ¨¡æ‹Ÿä¿¡å·ï¼ˆanalog signalï¼‰åœ¨ä¸€æ®µæ—¶é—´å†…å…·æœ‰**æ— é™**å¤šä¸ªå¼ºåº¦çº§åˆ«\n- æ•°å­—ä¿¡å·ï¼ˆdigital signalï¼‰åªèƒ½æœ‰**æœ‰é™**æ•°é‡çš„å®šä¹‰å€¼\n- å‘¨æœŸä¿¡å·ï¼ˆperiodic signalï¼‰åœ¨å¯æµ‹é‡çš„æ—¶é—´èŒƒå›´å†…å®Œæˆä¸€ä¸ªæ¨¡å¼ï¼Œç§°ä¸ºå‘¨æœŸï¼Œå¹¶åœ¨éšåçš„ç›¸åŒå‘¨æœŸå†…é‡å¤è¯¥æ¨¡å¼\n    - ç®€å•çš„å‘¨æœŸæ€§**æ¨¡æ‹Ÿ**ä¿¡å·ï¼ˆæ­£å¼¦æ³¢ï¼‰ä¸èƒ½åˆ†è§£ä¸ºæ›´ç®€å•çš„ä¿¡å·ã€‚æ­£å¼¦æ³¢ç”±å…¶æŒ¯å¹…ã€é¢‘ç‡å’Œç›¸ä½æ¥å®šä¹‰\n    - å¤åˆå‘¨æœŸæ¨¡æ‹Ÿä¿¡å·ç”±å¤šä¸ªæ­£å¼¦æ³¢ç»„æˆ\n- éå‘¨æœŸæ€§ä¿¡å·ï¼ˆnon-periodic signalï¼‰åœ¨ä¸æ˜¾ç¤ºéšæ—¶é—´é‡å¤çš„æ¨¡å¼æˆ–å‘¨æœŸçš„æƒ…å†µä¸‹å‘ç”Ÿå˜åŒ–\n    - å¤§å¤šæ•°**æ•°å­—**ä¿¡å·æ˜¯éå‘¨æœŸæ€§çš„ï¼Œå› æ­¤ä¸é€‚åˆç”¨å‘¨æœŸå’Œé¢‘ç‡æ¥æè¿°\n### é“¾è·¯ä¼ è¾“æœ¯è¯­\n- å•å·¥ï¼ˆsimplexï¼‰\n- åŠåŒå·¥ï¼ˆhalf-duplexï¼‰\n- å…¨åŒå·¥ï¼ˆfull-duplexï¼‰\n- å¹¶è¡Œä¼ è¾“ï¼ˆParallel Transmissionï¼‰\n- ä¸²è¡Œä¼ è¾“ï¼ˆSerial Transmissionï¼‰\n    - å¼‚æ­¥ä¼ è¾“ï¼ˆAsynchronous Transmissionï¼‰\n        - å¼‚æ­¥ä¼ è¾“ä¸­ï¼Œåœ¨æ¯ä¸ª**å­—èŠ‚**çš„å¼€å¤´å‘é€ä¸€ä¸ªèµ·å§‹ä½ï¼ˆ0ï¼‰ï¼Œåœ¨ç»“å°¾å‘é€ä¸€ä¸ªæˆ–å¤šä¸ªåœæ­¢ä½ï¼ˆ1ï¼‰ã€‚å­—èŠ‚ä¹‹é—´å¯èƒ½æœ‰é—´éš™\n        - å¼‚æ­¥åœ¨è¿™é‡Œæ„å‘³ç€â€œå­—èŠ‚çº§å¼‚æ­¥â€ï¼Œä½†ä½çº§ä»ç„¶æ˜¯åŒæ­¥çš„ï¼›å®ƒä»¬çš„æŒç»­æ—¶é—´æ˜¯ç›¸åŒçš„\n        - ä¿¡å·çš„æ—¶åºå¹¶ä¸é‡è¦\n    - åŒæ­¥ä¼ è¾“ï¼ˆSynchronous Transmissionï¼‰\n        - åœ¨åŒæ­¥ä¼ è¾“ä¸­ï¼Œæˆ‘ä»¬ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°å‘é€**ä½**ï¼Œæ²¡æœ‰èµ·å§‹æˆ–åœæ­¢ä½æˆ–é—´éš™ã€‚æ¥æ”¶æœºè´Ÿè´£å¯¹ä½è¿›è¡Œåˆ†ç»„\n        - ä¿¡å·çš„æ—¶åºéå¸¸é‡è¦\n\n## æ•°æ®é€šä¿¡çš„ç†è®ºåŸºç¡€\n### å‚…é‡Œå¶å˜æ¢\n- æ—¶åŸŸå¦‚æœå‘¨æœŸï¼Œåˆ™é¢‘åŸŸç¦»æ•£\n- æ—¶åŸŸå¦‚æœéå‘¨æœŸï¼Œåˆ™é¢‘åŸŸè¿ç»­\n- æ—¶åŸŸå¦‚æœè¿ç»­ï¼Œåˆ™é¢‘åŸŸéå‘¨æœŸ\n- æ—¶åŸŸå¦‚æœç¦»æ•£ï¼Œåˆ™é¢‘åŸŸå‘¨æœŸ\n### å¸¦å®½æœ‰é™çš„ä¿¡å·\n- åŸºäºå‚…ç«‹å¶åˆ†æï¼Œæ•°å­—ä¿¡å·æ˜¯ä¸€ç§å¤åˆæ¨¡æ‹Ÿä¿¡å·ã€‚å¸¦å®½æ˜¯**æ— é™**çš„\n- å¯¹äºç”µæ°”å·¥ç¨‹å¸ˆæ¥è¯´ï¼Œï¼ˆæ¨¡æ‹Ÿï¼‰å¸¦å®½æ˜¯é¢‘ç‡èŒƒå›´ï¼Œä»¥**Hz**ä¸ºå•ä½\n- å¯¹è®¡ç®—æœºç§‘å­¦å®¶æ¥è¯´ï¼Œï¼ˆæ•°å­—ï¼‰å¸¦å®½æ˜¯ä¿¡é“çš„æœ€å¤§æ•°æ®é€Ÿç‡ï¼Œä»¥**bits/s**ä¸ºå•ä½\n### ä¿¡é“çš„æœ€å¤§æ•°æ®é€Ÿç‡\n- **å¥ˆå¥æ–¯ç‰¹å®šç†**ï¼ˆNyquistâ€™s theoremï¼‰å°†æ•°æ®é€Ÿç‡ä¸æ— å™ªå£°ä¿¡é“çš„å¸¦å®½ï¼ˆBï¼‰å’Œä¿¡å·ç”µå¹³æ•°ï¼ˆVï¼‰è”ç³»èµ·æ¥ï¼š\n    - Max. data rate = 2B log2V bits/sec\n- **é¦™å†œå®šç†**ï¼ˆShannon's theoremï¼‰å°†æ•°æ®é€Ÿç‡ä¸å¸¦å®½ï¼ˆBï¼‰å’Œä¿¡å·å¼ºåº¦ï¼ˆSï¼‰ä¸å™ªå£°ï¼ˆNï¼‰è”ç³»èµ·æ¥ï¼š\n    - Max. data rate = B log2(1 + S/N) bits/sec\n    - å¦‚æœSNRå•ä½ä¸ºdBåˆ™éœ€è¦è¿›è¡Œæ¢ç®—ï¼š\n        - S/N(dB)=10log10(S/N)(~)\n\n## å¼•å¯¼æ€§ä¼ è¾“ä»‹è´¨\nä»‹è´¨å…·æœ‰ä¸åŒçš„å±æ€§ï¼Œå› æ­¤æ€§èƒ½ä¸åŒ\n- å­˜å‚¨ä»‹è´¨\n- ç”µçº¿\n    - åŒç»çº¿\n    - åŒè½´ç”µç¼†\n    - ç”µåŠ›çº¿\n- å…‰ç¼†\n### å­˜å‚¨ä»‹è´¨\n- é€šè¿‡ç£å¸¦/ç£ç›˜/DVDå‘é€æ•°æ®ä»¥å®ç°é«˜å¸¦å®½é“¾è·¯\n    - é‚®å¯„ä¸€ä¸ªè£…æœ‰1000ä¸ª 800 GBç£å¸¦ï¼ˆ6400 TBï¼‰çš„ç›’å­\n    - å‘é€éœ€è¦ä¸€å¤©æ—¶é—´ï¼ˆ86400ç§’ï¼‰\n    - æ•°æ®é€Ÿç‡ä¸º70 Gbpsã€‚\n- æ•°æ®é€Ÿç‡æ¯”è¿œç¨‹ç½‘ç»œå¿«\n- æ¶ˆæ¯å»¶è¿Ÿéå¸¸å·®\n### åŒç»çº¿ï¼ˆTwisted Pairï¼‰\n- éå¸¸æ™®éï¼›ç”¨äºå±€åŸŸç½‘ã€ç”µè¯çº¿\n- æ‰­è½¬å‡å°‘è¾å°„ä¿¡å·ï¼ˆå¹²æ‰°ï¼‰\n### åŒè½´ç”µç¼†ï¼ˆCoaxial Cableï¼‰\n- å¸¸è§ï¼Œæ¯”åŒç»çº¿å…·æœ‰æ›´å¥½çš„å±è”½æ•ˆæœå’Œæ›´å¤§çš„å¸¦å®½ï¼Œé€‚ç”¨äºæ›´é•¿çš„è·ç¦»å’Œæ›´é«˜çš„ä¼ è¾“é€Ÿç‡\n### ç”µåŠ›çº¿ï¼ˆPower Linesï¼‰\n- ä½¿ç”¨æ–¹ä¾¿ï¼Œä½†ç›®å‰ä¸é€‚åˆç”¨äºå‘é€æ•°æ®\n### å…‰ç¼†ï¼ˆFiber Cablesï¼‰\n- é€‚ç”¨äºé«˜é€Ÿç‡å’Œé•¿è·ç¦»\n    - è¿œç¨‹ISPé“¾è·¯ï¼Œå…‰çº¤åˆ°æˆ·ï¼ˆFttHï¼‰\n    - å…‰çº¿é€šè¿‡ä¸€æ¡å¾ˆé•¿å¾ˆç»†çš„ç»ç’ƒçº¿ä¼ è¾“\n- å…‰çº¤å…·æœ‰å·¨å¤§çš„å¸¦å®½ï¼ˆTHzï¼‰å’Œå¾®å°çš„ä¿¡å·æŸè€—ï¼Œå› æ­¤åœ¨é•¿è·ç¦»å†…ä¼ è¾“é€Ÿç‡å¾ˆé«˜\n- å•æ¨¡ï¼ˆSingle-modeï¼‰\n    - æ ¸å¿ƒç‹­çª„ï¼ˆ8-10å¾®ç±³ï¼‰ï¼Œå…‰çº¿æ— æ³•åå¼¹\n    - ç”¨äºé•¿è·ç¦»ä¼ è¾“ï¼ˆ100kmï¼‰\n- å¤šæ¨¡ï¼ˆMulti-modeï¼‰\n    - å…‰å¯ä»¥åå¼¹ï¼ˆ50å¾®ç±³æ ¸å¿ƒï¼‰\n    - ä¸LEDä¸€èµ·ä½¿ç”¨ï¼Œç”¨äºæ›´ä¾¿å®œã€æ›´çŸ­è·ç¦»çš„é“¾è·¯\n\n## æ— çº¿ä¼ è¾“\n- é¢‘ç‡å’Œæ³¢é•¿å­˜åœ¨å¦‚ä¸‹å…³ç³»\n    - Î»f=cï¼ˆ3x108 m/sï¼‰\n    - **Î”f=cÎ”Î»/Î»^2**\n### æ— çº¿ç”µä¼ è¾“\n- æ— çº¿ç”µä¿¡å·èƒ½å¾ˆå¥½åœ°ç©¿é€å»ºç­‘ç‰©ï¼Œå¹¶åœ¨è·¯å¾„æŸè€—ï¼ˆpath lossï¼‰çš„æƒ…å†µä¸‹é•¿è·ç¦»ä¼ æ’­\n- åœ¨VLF, LFï¼Œå’ŒMFæ³¢æ®µï¼Œæ— çº¿ç”µæ³¢æ²¿ç€åœ°çƒçš„æ›²ç‡ä¼ æ’­\n- åœ¨HFæ³¢æ®µï¼Œæ— çº¿ç”µæ³¢å°†ä»ç”µç¦»å±‚åå¼¹\n### å¾®æ³¢ä¼ è¾“\n- å¾®æ³¢å…·æœ‰å¾ˆé«˜çš„å¸¦å®½ï¼Œå¹¿æ³›åº”ç”¨äºå®¤å†…ï¼ˆWiFiï¼‰å’Œå®¤å¤–ï¼ˆ3Gã€å«æ˜Ÿï¼‰\n- ä¿¡å·ä¼šè¢«æ—¥å¸¸ç‰©ä½“è¡°å‡/åå°„\n- ç”±äºå¤šå¾„è¡°è½ï¼ˆmultipath lossï¼‰ç­‰åŸå› ï¼Œå¼ºåº¦éšç§»åŠ¨è€Œå˜åŒ–\n### å…‰é€šä¿¡\n- è§†çº¿ç¯ï¼ˆéå…‰çº¤ï¼‰å¯ç”¨äºé“¾è·¯\n- å…‰çº¿æ–¹å‘æ€§å¼ºï¼Œå¸¦å®½å¤§\n- LED/æ‘„åƒæœºå’Œæ¿€å…‰å™¨/å…‰ç”µæ¢æµ‹å™¨çš„ä½¿ç”¨\n\n## é€šä¿¡å«æ˜Ÿ\n- åœ°çƒé™æ­¢è½¨é“ï¼ˆGEOï¼‰\n    - VSATï¼ˆå¾®å‹ç«™ï¼‰å¯ä»¥å€ŸåŠ©ä¸­ç»§ç«™ï¼ˆhubï¼‰è¿›è¡Œé€šä¿¡\n    - ä½¿ç”¨GHzä¸­çš„ä¸åŒé¢‘å¸¦ï¼ˆLã€Sã€Cã€Kuã€Kaï¼‰ï¼Œä½†å¯èƒ½æ‹¥æŒ¤æˆ–æ˜“å—é›¨æ°´å½±å“\n- ä¸­åœ°çƒè½¨é“ï¼ˆMEOï¼‰\n- ä½åœ°çƒè½¨é“ï¼ˆLEOï¼‰\n    - é“±æ˜Ÿç­‰ç³»ç»Ÿä½¿ç”¨è®¸å¤šä½å»¶è¿Ÿå«æ˜Ÿè¿›è¡Œè¦†ç›–ï¼Œå¹¶é€šè¿‡å®ƒä»¬è·¯ç”±é€šä¿¡ \n\n## æ•°å­—è°ƒåˆ¶å’Œå¤šè·¯å¤ç”¨\næ•°å­—è°ƒåˆ¶å°†æ¯”ç‰¹ä½œä¸ºä¿¡å·å‘é€ï¼›å¤šè·¯å¤ç”¨åœ¨ç”¨æˆ·ä¹‹é—´å…±äº«ä¿¡é“\n### **åŸºå¸¦**ä¼ è¾“ï¼ˆBaseband Transmissionï¼‰\n- NRZï¼ˆNon-Return-Zeroï¼‰æ˜¯æœ€ç®€å•çš„çº¿è·¯ç ï¼ˆ+1V=\"1\"ï¼Œ-1V=\"0\"ï¼‰\n    - Unipolar NRZï¼ˆæ™®é€šNRZï¼‰\n    - Polar RZï¼ˆ-1V->0V=\"0\"ï¼Œ+1V->0V=\"1\"ï¼‰\n    - Polar NRZ-Iï¼ˆä¸å˜=\"0\"ï¼ŒÂ±1Vè·³å˜=\"1\"ï¼‰\n- æ›¼å½»æ–¯ç‰¹ç¼–ç ï¼ˆManchesterï¼‰\n    - Manchester\n    - Differential Manchesterï¼ˆå·®åˆ†æ›¼å½»æ–¯ç‰¹ï¼‰\n- åŒæï¼ˆBipolarï¼‰\n    - AMI\n    - ä¼ªä¸‰è¿›ç ï¼ˆpseudoternaryï¼‰\n- å¤šç”µå¹³ï¼ˆMultilevelï¼‰\n    - 2B1Q\n    - 8B6T\n    - 4D-PAM5\n#### å¥½çš„çº¿è·¯ç¼–ç æ–¹æ¡ˆå‡†åˆ™\n- å¸¦å®½æ•ˆç‡\n- ç›´æµåˆ†é‡\n    - å½“æ•°å­—ä¿¡å·ä¸­çš„ç”µå‹ç”µå¹³åœ¨ä¸€æ®µæ—¶é—´å†…ä¿æŒæ’å®šæ—¶ï¼Œé¢‘è°±ä¼šåœ¨é›¶ç‚¹é™„è¿‘äº§ç”Ÿéå¸¸ä½çš„é¢‘ç‡ï¼ˆå‚…é‡Œå¶åˆ†æçš„ç»“æœï¼‰ï¼Œè¿™ç»™æ— æ³•é€šè¿‡ä½é¢‘çš„ç³»ç»Ÿå¸¦æ¥äº†é—®é¢˜\n    - DCåˆ†é‡è¡¨ç¤ºå¯èƒ½å¯¼è‡´åŸºçº¿æ¼‚ç§»çš„0/1å¥‡å¶æ ¡éªŒï¼Œå³0æˆ–1çš„é•¿ä¸²å¯èƒ½å¯¼è‡´åŸºçº¿æ¼‚ç§»ï¼Œå¹¶ä½¿æ¥æ”¶å™¨éš¾ä»¥æ­£ç¡®è§£ç \n- æ—¶é’Ÿæ¢å¤/è‡ªåŒæ­¥\n    - è‡ªåŒæ­¥æ•°å­—ä¿¡å·åŒ…æ‹¬æ­£åœ¨ä¼ è¾“çš„æ•°æ®ä¸­çš„å®šæ—¶ä¿¡æ¯\n    - å¦‚æœä¿¡å·ä¸­å­˜åœ¨å‘æ¥æ”¶å™¨æç¤ºè„‰å†²å¼€å§‹ã€ä¸­é—´æˆ–ç»“æŸçš„è¿‡æ¸¡ï¼Œåˆ™å¯ä»¥å®ç°è¿™ä¸€ç‚¹\n#### æ—¶é’Ÿæ¢å¤\n- ç­–ç•¥ï¼š\n    - æ›¼å½»æ–¯ç‰¹ç¼–ç ï¼Œåœ¨æ¯ä¸ªç¬¦å·ä¸­æ··åˆæ—¶é’Ÿä¿¡å·\n    - 4B/5Bç”¨1å’Œ0å°†4ä¸ªæ•°æ®ä½æ˜ å°„ä¸º5ä¸ªç¼–ç ä½ï¼š\n    - å¸¦ä¼ªéšæœºä½çš„æ‰°ç ï¼ˆscramblingï¼‰å¼‚æˆ–ï¼ˆXORingï¼‰å‘é€/æ¥æ”¶æ•°æ®\n### **é€šå¸¦**ä¼ è¾“ï¼ˆPassband Transmissionï¼‰\n- è°ƒåˆ¶è½½æ³¢ä¿¡å·çš„æŒ¯å¹…ã€é¢‘ç‡/ç›¸ä½å¯åœ¨éé›¶é¢‘ç‡èŒƒå›´å†…å‘é€æ•°æ®\n- å¹…ç§»é”®æ§ï¼ˆAmplitude Shift Keying ASKï¼‰\n- é¢‘ç§»é”®æ§ï¼ˆFrequency Shift Keying FSKï¼‰\n- ç›¸ç§»é”®æ§ï¼ˆPhase Shift Keying PSKï¼‰\n- BPSK    2 symbols    1 bit/symbol\n- QPSK    4 symbols    2 bit/symbol\n- QAM-16    16 symbols    4 bits/symbol\n- QAM-64    64 symbols    6 bits/symbol\n\n> BPSK/QPSKä»…ä»…æ”¹å˜ç›¸ä½\n> QAMæ—¢æ”¹å˜ç›¸ä½åˆæ”¹å˜æŒ¯å¹…\n\n- ä½¿ç”¨æ ¼é›·ç è¿›è¡Œæ˜ å°„ï¼Œå‡å°‘é”™è¯¯\n### **é¢‘åˆ†**å¤ç”¨ï¼ˆFrequency Division Multiplexing FDMï¼‰ï¼ˆæ¨¡æ‹Ÿï¼‰\n- é¢‘åˆ†å¤šè·¯å¤ç”¨\n- é€šè¿‡å°†ç”¨æˆ·ç½®äºä¸åŒçš„é¢‘ç‡ä¸Šæ¥å…±äº«ä¿¡é“\n- OFDMï¼ˆæ­£äº¤é¢‘åˆ†å¤ç”¨ï¼‰æ˜¯ä¸€ç§é«˜æ•ˆçš„FDMæŠ€æœ¯ï¼Œç”¨äº802.11ã€4Gèœ‚çªå’Œå…¶ä»–é€šä¿¡\n    - å­è½½æ³¢åœ¨é¢‘åŸŸä¸­è¢«ç´§ç´§åŒ…è£¹åœ¨ä¸€èµ·\n### **æ—¶åˆ†**å¤ç”¨ï¼ˆTime Division Multiplexing TDMï¼‰ï¼ˆæ•°å­—ï¼‰\n- æ—¶åˆ†å¤šè·¯å¤ç”¨éšæ—¶é—´å…±äº«ä¸€ä¸ªä¿¡é“\n    - ç”¨æˆ·æŒ‰ç…§å›ºå®šçš„æ—¶é—´è¡¨è½®æµä½¿ç”¨ï¼›æ³¨æ„å’Œåˆ†ç»„äº¤æ¢æˆ–STDMï¼ˆç»Ÿè®¡æ—¶åˆ†å¤ç”¨ï¼‰ç›¸åŒºåˆ«\n    - å¹¿æ³›åº”ç”¨äºç”µè¯/èœ‚çªç³»ç»Ÿ\n### **ç åˆ†**å¤šå€ï¼ˆCode Division Multiple Access CDMAï¼‰\n- CDMAé€šè¿‡ç»™ç”¨æˆ·ä¸€ä¸ªç¼–ç æ¥å…±äº«ä¿¡é“\n    - ç¼–ç æ˜¯æ­£äº¤çš„ï¼Œå¯ä»¥åŒæ—¶å‘é€\n    - å¹¿æ³›ç”¨ä½œ3Gç½‘ç»œçš„ä¸€éƒ¨åˆ†\n\n## å…¬å…±ç”µè¯äº¤æ¢ç½‘ç»œ\n### æœ¬åœ°å›è·¯ è°ƒåˆ¶è§£è°ƒå™¨\n- ç”µè¯è°ƒåˆ¶è§£è°ƒå™¨é€šè¿‡3.3 KHzæ¨¡æ‹Ÿè¯­éŸ³ä¿¡é“æ¥å£å‘POTSå‘é€æ•°å­—æ•°æ®\n    - é€Ÿç‡<56kbpsï¼›æ—©æœŸè¿æ¥åˆ°Internetçš„æ–¹æ³•\n### æ•°å­—ç”¨æˆ·çº¿\n- DSLå®½å¸¦ä½¿ç”¨POTSä¸ä½¿ç”¨çš„é¢‘ç‡é€šè¿‡æœ¬åœ°ç¯è·¯å‘æœ¬åœ°ç«¯å±€å‘é€æ•°æ®\n- ç”µè¯/è®¡ç®—æœºè¿æ¥åˆ°ç›¸åŒçš„æ—§ç”µè¯çº¿\n- é€Ÿç‡å› çº¿è·¯è€Œå¼‚\n    - ADSL2é«˜è¾¾12 Mbps\n- å¯¹äºADSL2ï¼ŒOFDMçš„ä½¿ç”¨é¢‘ç‡é«˜è¾¾1.1MHz\n    - å¤§éƒ¨åˆ†å¸¦å®½ç”¨ä½œä¸‹è¡Œ\n### å…‰çº¤åˆ°æˆ·\n- FTTHå®½å¸¦ä¾é å…‰çº¤ç”µç¼†çš„éƒ¨ç½²ä¸ºå®¢æˆ·æä¾›é«˜æ•°æ®é€Ÿç‡\n- ä¸€ä¸ªæ³¢é•¿å¯ä»¥åœ¨è®¸å¤šæˆ¿å±‹ä¸­å…±äº«\n- å…‰çº¤æ˜¯æ— æºçš„ï¼ˆæ— æ”¾å¤§å™¨ç­‰ï¼‰\n### è„‰å†²ç¼–ç è°ƒåˆ¶ï¼ˆPulse Code Modulationï¼‰\n- å°†æ¨¡æ‹Ÿä¿¡å·è½¬æ¢ä¸ºæ•°å­—æ•°æ®ï¼ˆæ•°å­—åŒ–ï¼‰çš„æœ€å¸¸ç”¨æŠ€æœ¯ç§°ä¸ºè„‰å†²ç¼–ç è°ƒåˆ¶ï¼ˆPCMï¼‰\n### å¥ˆå¥æ–¯ç‰¹é‡‡æ ·å®šç†\n- æ ¹æ®å¥ˆå¥æ–¯ç‰¹å®šç†ï¼Œé‡‡æ ·ç‡å¿…é¡»è‡³å°‘æ˜¯ä¿¡å·ä¸­åŒ…å«çš„æœ€é«˜é¢‘ç‡çš„2å€\n\n> æ³¨æ„ï¼šæœ€é«˜é¢‘ç‡ä¸æ˜¯å¸¦å®½\n\n- å¦‚æœæ¨¡æ‹Ÿä¿¡å·æ˜¯ä½é€šçš„ï¼Œåˆ™å¸¦å®½å’Œæœ€é«˜é¢‘ç‡æ˜¯ç›¸åŒçš„å€¼\n- å¦‚æœæ¨¡æ‹Ÿä¿¡å·æ˜¯å¸¦é€šä¿¡å·ï¼Œåˆ™å¸¦å®½å€¼ä½äºæœ€å¤§é¢‘ç‡å€¼\n### ä¸­ç»§çº¿å’Œå¤šè·¯å¤ç”¨ï¼ˆTrunks and Multiplexingï¼‰\n#### TDM\n- å‘¼å«ä½¿ç”¨TDMåœ¨å…¬å…±äº¤æ¢ç”µè¯ç½‘ç»œï¼ˆPSTNï¼‰ä¸­ç»§çº¿ä¸Šä»¥æ•°å­—æ–¹å¼è¿›è¡Œä¼ è¾“\n- ä¸€ä¸ªå‘¼å«æ˜¯ä¸€ä¸ªæ¯125Î¼s 8bitsï¼ˆ64 kbpsï¼‰çš„PCMé‡‡æ ·\n- ä¼ ç»ŸT1è½½æ³¢æœ‰24ä¸ªå‘¼å«é€šé“ï¼Œæ¯ä¸ªé€šé“125Î¼sï¼ˆ1.544 Mbpsï¼‰ï¼Œå¸¦æœ‰åŸºäºAMIçš„ç¬¦å·\n#### SONET\n- SONETï¼ˆåŒæ­¥å…‰ç½‘ç»œï¼‰æ˜¯åœ¨å…‰ä¸­ç»§ä¸Šä¼ è¾“æ•°å­—ä¿¡å·çš„å…¨çƒæ ‡å‡†\n- ä¿æŒ125Î¼så¸§ï¼›åŸºå‡†å¸§ä¸º810å­—èŠ‚ï¼ˆ52Mbpsï¼‰\n- æœ‰æ•ˆè½½è·åœ¨æ¡†æ¶å†…â€œæµ®åŠ¨â€ï¼Œä»¥å®ç°çµæ´»æ€§\n### äº¤æ¢\n- ç”µè·¯äº¤æ¢ï¼ˆcircuit switchingï¼‰\n- åˆ†ç»„äº¤æ¢ï¼ˆpacket switchingï¼‰\n    - è™šç”µè·¯ï¼ˆvirtual-circuitï¼‰\n    - æ•°æ®æŠ¥ï¼ˆdatagramï¼‰\n- æŠ¥æ–‡äº¤æ¢ï¼ˆmessage switchingï¼‰\n- PSTNé‡‡ç”¨ç”µè·¯äº¤æ¢ï¼›å› ç‰¹ç½‘ä½¿ç”¨åˆ†ç»„äº¤æ¢\n- ç”µè·¯äº¤æ¢åœ¨è¿›è¡Œæ•°æ®æµåŠ¨å‰éœ€è¦è¿æ¥å»ºç«‹ï¼Œåœ¨æ•°æ®æµåŠ¨ç»“æŸåéœ€è¦è¿æ¥é‡Šæ”¾\n- åˆ†ç»„äº¤æ¢ç‹¬ç«‹å¯¹å¾…æ¯ä¸€ä¸ªåŒ…\n    - æ— éœ€å»ºç«‹è¿æ¥ï¼Œä½†åœ¨è·¯ç”±å™¨ä¸Šå¯èƒ½ä¼šæœ‰ä¸åŒçš„é˜Ÿåˆ—å»¶è¿Ÿï¼ˆqueuing delayï¼‰\n### åˆ†ç»„æ—¶å»¶\n#### æ¥æº\n- å¤„ç†æ—¶å»¶ï¼ˆprocessing delayï¼‰\n    - æ£€æŸ¥ä½é”™è¯¯\n    - ç¡®å®šè¾“å‡ºé“¾è·¯\n- æ’é˜Ÿæ—¶å»¶ï¼ˆqueueing delayï¼‰\n    - è¾“å‡ºé“¾è·¯ç­‰å¾…ä¼ è¾“\n    - è·¯ç”±å™¨çš„æ‹¥å¡çº§åˆ«\n- å‘é€ï¼ˆä¼ è¾“ï¼‰æ—¶å»¶ï¼ˆtransmission delayï¼‰\n    - R=é“¾è·¯å¸¦å®½ï¼ˆbpsï¼‰\n    - L=æ•°æ®åŒ…é•¿åº¦ï¼ˆbitsï¼‰\n    - å‘é€æ—¶å»¶=L/R\n- ä¼ æ’­æ—¶å»¶ï¼ˆpropagation delayï¼‰\n    - d=ç‰©ç†é“¾è·¯çš„é•¿åº¦\n    - s=ä»‹è´¨ä¸­çš„ä¼ æ’­é€Ÿåº¦ï¼ˆ~2x10^8 m/sï¼‰\n    - ä¼ æ’­æ—¶å»¶=d/s\n- å¦‚æœä¸€ä¸ªæŠ¥æ–‡è¢«åˆ†è§£ä¸ºNä¸ªåŒ…ï¼Œæ¯ä¸ªåŒ…ä¼ è¾“æ—¶é—´ä¸º1/Nåˆ†é’Ÿï¼Œåˆ™æ€»å…±ä¼ è¾“æ—¶é—´ä¸º2/N+(N-1)/Nåˆ†é’Ÿ","tags":["è®¡ç®—æœºç½‘ç»œ"],"categories":["è®¡è½¯æ‚è°ˆ","å­¦ä¹ ç¬”è®°"]},{"title":"è®¡ç®—æœºç½‘ç»œ-æ•°æ®é“¾è·¯å±‚ å­¦ä¹ ç¬”è®°","url":"/20211023/data-link-layer/","content":"- è´Ÿè´£åœ¨é“¾è·¯ä¸Šä¼ é€’æ•°æ®å¸§\n- å¤„ç†ä¼ è¾“é”™è¯¯\n- è°ƒèŠ‚æ•°æ®æµ\n\n## é“¾è·¯åˆ†ç±»\n- **ç‚¹å¯¹ç‚¹é“¾è·¯ï¼ˆpoint-to-pointï¼‰** ä½¿ç”¨ä»‹è´¨çš„å…¨éƒ¨å®¹é‡\n    - ä¸“ç”¨äºä¸¤ä¸ªè®¾å¤‡\n    - ä¾‹å¦‚ï¼Œå½“ä¸¤ä¸ªæœ‹å‹ä½¿ç”¨åº§æœºèŠå¤©æ—¶ï¼Œä»–ä»¬ä½¿ç”¨çš„æ˜¯ç‚¹å¯¹ç‚¹é“¾è·¯\n- **å¹¿æ’­å¼é“¾è·¯ï¼ˆbroadcastï¼‰** ä»…ä½¿ç”¨é“¾è·¯å®¹é‡çš„ä¸€éƒ¨åˆ†\n    - åœ¨å¤šå¯¹è®¾å¤‡ä¹‹é—´å…±äº«\n    - ä¾‹å¦‚ï¼Œå½“åŒä¸¤ä¸ªæœ‹å‹ä½¿ç”¨ä»–ä»¬çš„æ‰‹æœºæ—¶ï¼Œä»–ä»¬æ­£åœ¨ä½¿ç”¨å¹¿æ’­é“¾æ¥ï¼ˆè®¸å¤šæ‰‹æœºç”¨æˆ·å…±äº«å¹¿æ’­ï¼‰\n## æ•°æ®é“¾è·¯å±‚çš„ä¸¤ä¸ªå­å±‚\n- **é€»è¾‘é“¾è·¯æ§åˆ¶å­å±‚ï¼ˆLLC Logical Link Controlï¼‰** å¤„ç†ç‚¹å¯¹ç‚¹å’Œå¹¿æ’­é“¾è·¯çš„æ‰€æœ‰å¸¸è§é—®é¢˜\n- **åª’ä½“æ¥å…¥æ§åˆ¶å­å±‚ï¼ˆMAC Media Access Controlï¼‰** ä»…å¤„ç†ç‰¹å®šçš„å¹¿æ’­é“¾è·¯é—®é¢˜\n\n## æ•°æ®é“¾è·¯è®¾è®¡é—®é¢˜\n### å¸§\n- æ•°æ®é“¾è·¯å±‚æ¥å—æ¥è‡ªç½‘ç»œå±‚çš„æ•°æ®åŒ…ï¼Œå¹¶å°†å…¶å°è£…åˆ°å¸§ä¸­å‘é€ç»™ç‰©ç†å±‚ï¼›æ¥æ”¶åˆ™ä¸å…¶ç›¸å\n- å°è£…å’Œå»å°è£…çš„åŸå› ï¼š\n    - é“¾è·¯å±‚åœ°å€é€šå¸¸æ˜¯ä¸åŒçš„\n    - æ¯ä¸ªé“¾è·¯å¯èƒ½ä½¿ç”¨å…·æœ‰ä¸åŒå¸§æ ¼å¼çš„ä¸åŒåè®®\n### å‘ç½‘ç»œå±‚æä¾›çš„æœåŠ¡\n- æ— ç¡®è®¤çš„æ— è¿æ¥æœåŠ¡\n    - å‘é€å¸§æ—¶æ²¡æœ‰å»ºç«‹è¿æ¥/æ¢å¤é”™è¯¯\n    - é€‚åˆé”™è¯¯ç‡ä½çš„åœºæ™¯æˆ–å®æ—¶é€šä¿¡\n    - ä¾‹å¦‚ä»¥å¤ªç½‘\n- æœ‰ç¡®è®¤çš„æ— è¿æ¥æœåŠ¡\n    - å¦‚æœéœ€è¦ï¼Œå¸§ä¼šè¿›è¡Œé‡ä¼ \n    - ä¾‹å¦‚802.11ï¼ˆWIFIï¼‰\n- æœ‰ç¡®è®¤çš„æœ‰è¿æ¥æœåŠ¡\n    - å»ºç«‹è¿æ¥\n    - å«æ˜Ÿä¿¡å·æˆ–é•¿é€”ç”µè¯ç”µè·¯\n### æˆå¸§\n#### å­—èŠ‚è®¡æ•°æ³•ï¼ˆByte countï¼‰\n- å¤´éƒ¨æ·»åŠ å­—æ®µç”¨æ¥æ ‡è®°å¸§çš„å­—èŠ‚æ•°\n- ç›¸å¯¹ç®€å•ï¼Œä½†å‡ºé”™åå¾ˆéš¾é‡æ–°åŒæ­¥\n#### å­—èŠ‚å¡«å……çš„æ ‡å¿—å­—èŠ‚æ³•ï¼ˆFlag bytes with byte stuffingï¼‰\n- æ ‡å¿—å­—èŠ‚ï¼ˆflag byteï¼‰åˆ†éš”å¸§ï¼›å¦‚æœæ•°æ®ä¸­å­˜åœ¨æ ‡å¿—å­—èŠ‚æˆ–è½¬ä¹‰å­—èŠ‚ï¼Œåˆ™åœ¨å…¶ä¹‹å‰å¡«å……è½¬ä¹‰å­—èŠ‚ï¼ˆESCï¼‰\n- ä¾‹å¦‚ï¼ŒA ESC FLAG B ----> A ESC ESC ESC FLAG B\n- å¸§ä¼šå˜çš„æ›´é•¿ï¼Œä½†åœ¨å‡ºé”™åå¾ˆå®¹æ˜“é‡æ–°åŒæ­¥\n#### æ¯”ç‰¹å¡«å……çš„æ ‡å¿—æ¯”ç‰¹æ³•ï¼ˆFlag bits with bit stuffingï¼‰\n- åœ¨ä½çº§åˆ«å®Œæˆçš„å¡«å……\n- æ ‡å¿—å­—èŠ‚ä¸º0x7Eï¼ŒåŒ…å«111111ï¼ˆ6ä¸ªè¿ç»­çš„1ï¼‰\n- åœ¨ä¼ è¾“æ—¶ï¼Œåœ¨æ•°æ®ä¸­5ä¸ª1ä¹‹åï¼Œæ·»åŠ 0ï¼ˆé˜²æ­¢å¹²æ‰°æ ‡å¿—å­—èŠ‚çš„è¯†åˆ«ï¼‰\n- æ¥æ”¶æ—¶ï¼Œåˆ é™¤äº”ä¸ª1åçš„0\n- USBï¼ˆé€šç”¨ä¸²è¡Œæ€»çº¿ï¼‰æ‰€ä½¿ç”¨\n#### ç‰©ç†å±‚ç¼–ç è¿ç¦æ³•ï¼ˆPhysical layer coding violationsï¼‰\n- ä½¿ç”¨ç¼–ç ä¸­çš„å†—ä½™æ¯”ç‰¹\n### å·®é”™æ£€æµ‹\n#### å·®é”™ç§ç±»\n- å•æ¯”ç‰¹é”™è¯¯ï¼ˆSingle-bit errorï¼‰æ•°æ®å•å…ƒä¸­åªæœ‰1ä½ä»1å˜ä¸º0æˆ–ä»0å˜ä¸º1\n- çªå‘é”™è¯¯ï¼ˆBurst errorï¼‰æ•°æ®å•å…ƒä¸­çš„2ä¸ªæˆ–æ›´å¤šä½ä»1å˜ä¸º0æˆ–ä»0å˜ä¸º1\n#### å·®é”™æ£€æµ‹&å·®é”™çº æ­£\n- å·®é”™çº æ­£æ¯”å·®é”™æ£€æµ‹æ›´å›°éš¾\n- åœ¨å·®é”™æ£€æµ‹ä¸­ï¼Œæˆ‘ä»¬åªå…³å¿ƒæ˜¯å¦å‘ç”Ÿäº†ä»»ä½•é”™è¯¯\n- åœ¨å·®é”™çº æ­£ä¸­ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“è¢«ç ´åçš„æ¯”ç‰¹çš„æ•°ç›®å’Œä½ç½®\n- å·®é”™æ£€æµ‹ä½¿ç”¨æ£€é”™ç ï¼Œå·®é”™çº æ­£ä½¿ç”¨çº é”™ç ï¼Œä½¿ç”¨çº é”™ç çš„æŠ€æœ¯ä¹Ÿç§°ä¸ºå‰å‘çº é”™ï¼ˆFEC Forward Error Correctionï¼‰\n- åœ¨é«˜åº¦å¯é çš„ä¿¡é“ä¸Šå»ºè®®ä½¿ç”¨æ£€é”™ç ï¼Œè€Œåœ¨é”™è¯¯æ¯”è¾ƒé¢‘ç¹çš„ä¿¡é“ä¸Šå»ºè®®ä½¿ç”¨çº é”™ç \n#### æµ·æ˜è·ç¦»ï¼ˆHamming distanceï¼‰\n- æµ·æ˜è·ç¦»æ˜¯å°†ä¸€ä¸ªæœ‰æ•ˆç å­—è½¬æ¢ä¸º**ä»»ä½•**å…¶ä»–æœ‰æ•ˆç å­—çš„æœ€å°ä½ç¿»è½¬\n- ç¼–ç å°†nä½çš„æ•°æ®è½¬æ¢ä¸ºn+kä½çš„ç å­—\n- å…·æœ‰10ä½ï¼ˆn=2ï¼Œk=8ï¼‰çš„4ä¸ªç å­—çš„ç¤ºä¾‹ï¼š\n    - 0000000000ã€0000011111ã€1111100000å’Œ1111111\n    - å…¶æ±‰æ˜è·ç¦»æ˜¯5\n- å…·æœ‰æœ€å°æ±‰æ˜è·ç¦»d_minçš„ç¼–ç ç•Œé™ï¼š\n    - **$d_{min}â‰¥2d+1$** å¯ä»¥çº æ­£dé”™è¯¯ï¼ˆä¸Šä¾‹2ä¸ªé”™è¯¯ï¼‰\n    - **$d_{min}â‰¥d+1$** å¯æ£€æµ‹dä¸ªé”™è¯¯ï¼ˆä¸Šä¾‹4ä¸ªé”™è¯¯ï¼‰\n#### çº¿æ€§åˆ†ç»„ç¼–ç ï¼ˆLinear Block Codesï¼‰\n- çº¿æ€§åˆ†ç»„ç¼–ç æ˜¯å°†ä»»ä½•ç å­—ä¸ä»»ä½•å…¶ä»–ç å­—è¿›è¡Œçº¿æ€§è¿ç®—çš„ç»“æœä¸ºæœ‰æ•ˆç å­—çš„ç¼–ç \n- çº¿æ€§è¿ç®—é€šå¸¸é€‰ç”¨XORæˆ–æ˜¯æ¨¡2è¿ç®—\n#### çº é”™ç \n- **æµ·æ˜ç **\n- äºŒè¿›åˆ¶å·ç§¯ç \n    - GSMç§»åŠ¨ç”µè¯ç³»ç»Ÿã€å«æ˜Ÿé€šä¿¡\n- é‡Œå¾·æ‰€ç½—é—¨ç å’Œä½å¯†åº¦å¥‡å¶æ ¡éªŒç \n    - åœ¨æ•°å­¦ä¸Šè¾ƒä¸ºå¤æ‚ï¼Œå¹¿æ³›åº”ç”¨äºå®é™…\n    - RSç¼–ç ï¼šDSLã€æœ‰çº¿æ•°æ®ã€å«æ˜Ÿé€šä¿¡ã€CDã€DVDå’Œè“å…‰å…‰ç›˜\n    - LDPCç¼–ç ï¼šæ•°å­—è§†é¢‘å¹¿æ’­ã€10Gbpsä»¥å¤ªç½‘ã€ç”µåŠ›çº¿ç½‘ç»œã€æœ€æ–°ç‰ˆæœ¬çš„802.11\n##### **æµ·æ˜ç **\n- å…è®¸çº æ­£å•æ¯”ç‰¹é”™è¯¯\n- é€šè¿‡ä½¿ç”¨å¤šä¸ªå¥‡å¶æ ¡éªŒä½æ¥å®ç°\n- è¦è®¾è®¡ä¸€ä¸ªåŒ…å«mä¸ªæ•°æ®ä½å’Œrä¸ªæ ¡éªŒä½çš„nä½ç¼–ç ï¼Œå¹¶èƒ½å¤Ÿçº æ­£æ‰€æœ‰å•ä¸ªé”™è¯¯ï¼Œå¿…é¡»æœ‰\n  $$(m+r+1ï¼‰â‰¤2^r$$\n\n- å¯¹äº$2^m$ä¸ªåˆæ³•æ¶ˆæ¯ä¸­çš„æ¯ä¸€æ¡éƒ½æœ‰nä¸ªéæ³•ç å­—ï¼Œå®ƒä»¬ä¸è¯¥æ¶ˆæ¯çš„æµ·æ˜è·ç¦»ä¸º1\n- æ‰€ä»¥$2^m$ä¸ªåˆæ³•æ¶ˆæ¯éœ€è¦n+1ä¸ªä½æ¨¡å¼æ¥è¿›è¡Œæ ‡è¯†ã€‚å› ä¸ºä½æ¨¡å¼çš„æ€»æ•°ä¸º$2^n$ï¼Œæ‰€ä»¥å¿…é¡»æœ‰\n  $$(n+1ï¼‰2^mâ‰¤2^n$$\n- ç”±äºn=m+rï¼Œç»è¿‡å˜å½¢å˜ä¸ºä¸Šå¼\n#### æ£€é”™ç \n- å¥‡å¶ï¼ˆParityï¼‰\n- æ ¡éªŒå’Œï¼ˆChecksumsï¼‰\n- **å¾ªç¯å†—ä½™æ ¡éªŒ**ï¼ˆCRCï¼‰\n##### å¥‡å¶æ ¡éªŒ\n- å¥‡å¶æ ¡éªŒä½ç­‰äºæ•°æ®ä½çš„æ¨¡2åŠ æˆ–XOR\n- èƒ½æ£€æµ‹å¥‡æ•°ä½æ¯”ç‰¹é”™è¯¯ï¼Œæ£€æµ‹éšæœºé”™è¯¯çš„æ¦‚ç‡ä¸º1/2\n- ä½¿ç”¨**äº¤é”™æ ¡éªŒ**ï¼ˆInterleavingï¼‰èƒ½æ£€æµ‹çªå‘é”™è¯¯ï¼Œå…¶æœ¬è´¨æ˜¯å‘é€æ¬¡åºå’Œæ£€éªŒæ¬¡åºä¸åŒ\n- Nä¸ªå¥‡å¶æ ¡éªŒä½çš„äº¤é”™æ£€éªŒå¯æ£€æµ‹é«˜è¾¾Nä¸ªçš„çªå‘é”™è¯¯\n- æ¯ä¸ªå¥‡å¶æ ¡éªŒå’Œåœ¨éç›¸é‚»ä½ä¸Šè¿›è¡Œ\n- å³ä½¿å‡ºç°å¤šè¾¾Nä¸ªé”™è¯¯ï¼Œä¹Ÿä¸ä¼šå¯¼è‡´æ ¡éªŒå¤±è´¥\n![1_1](https://d-sketon.top/img/data-link-layer/1_1.png)\n##### æ ¡éªŒå’Œ\n- æ ¡éªŒå’Œå°†æ•°æ®åˆ†éš”ä¸ºNä½å­—ï¼Œå¹¶æ·»åŠ Nä¸ªæ ¡éªŒä½ï¼Œè¿™äº›æ ¡éªŒä½æ˜¯å­—çš„æ¨¡$2^N$å’Œ\n    - ä¾‹ï¼š16ä½Internetåç æ ¡éªŒå’Œ\n- ç‰¹æ€§\n    - æ”¹è¿›çš„å¥‡å¶æ ¡éªŒ\n    - æ£€æµ‹æœ€å¤šNä¸ªçªå‘é”™è¯¯\n    - æ£€æµ‹éšæœºé”™è¯¯çš„æ¦‚ç‡ä¸º$1-2^N$\n    - æ˜“å—ç³»ç»Ÿè¯¯å·®çš„å½±å“ï¼Œä¾‹å¦‚æ— æ³•æ£€æµ‹0æ•°æ®çš„å¢åŠ æˆ–åˆ é™¤\n\n> 1's complement åç \n> 2's complement è¡¥ç \n\n- å¦‚æœåœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ä¸¤ä¸ª16ä½é¡¹é¡ºåºé¢ å€’ï¼Œæ ¡éªŒå’Œæ— æ³•æ•è·æ­¤é”™è¯¯ï¼ŒåŸå› æ˜¯ä¼ ç»Ÿçš„æ ¡éªŒå’Œæ²¡æœ‰åŠ æƒï¼Œæ•°æ®é¡¹çš„é¡ºåºå¯¹è®¡ç®—ä¸é‡è¦\n- å¯ä»¥ä½¿ç”¨Fletcheræ ¡éªŒå’Œå’ŒAdleræ ¡éªŒå’Œæ¥è§£å†³\n##### CRC\n- è®¡ç®—æ–¹æ³•ï¼š\n    - å‡è®¾G(x)çš„é˜¶ä¸ºrï¼Œåœ¨å¸§çš„ä½ç«¯ä½åŠ ä¸Šrä¸ª0ä½\n    - åˆ©ç”¨æ¨¡2é™¤æ³•ï¼Œå°†å¸§å¯¹åº”çš„ä½ä¸²ä¸G(x)ç›¸é™¤ï¼Œè·å¾—ä½™æ•°\n    - ä½™æ•°å’Œå¸§å¯¹åº”çš„ä½ä¸²æ¨¡2ç›¸åŠ \n    - éªŒè¯åˆ™ç›¸åï¼Œå¦‚æœæ²¡æœ‰å‘ç”Ÿé”™è¯¯åˆ™ä½™æ•°åº”è¯¥ä¸º0\n- åœ¨å¾ªç¯ç ä¸­ï¼Œé‚£äº›å¯è¢«G(x)æ•´é™¤çš„e(x)é”™è¯¯ä¸ä¼šè¢«æ•è·ã€‚\n- å¦‚æœç”Ÿæˆå¤šé¡¹å¼æœ‰å¤šä¸ªé¡¹ä¸”x0çš„ç³»æ•°ä¸º1ï¼Œåˆ™å¯ä»¥æ•è·æ‰€æœ‰å•æ¯”ç‰¹é”™è¯¯\n- åŒ…å«ç³»æ•°x+1çš„ç”Ÿæˆå¤šé¡¹å¼å¯ä»¥æ£€æµ‹æ‰€æœ‰å¥‡æ•°ä½æ¯”ç‰¹é”™è¯¯\n- æ‰€æœ‰çªå‘é”™è¯¯ï¼Œé•¿åº¦L â‰¤ rå°†ä¼šè¢«æ£€æµ‹åˆ°\n- æ‰€æœ‰çªå‘é”™è¯¯ï¼Œé•¿åº¦L = r+1å°†ä¼šæœ‰$1-(1/2)^{r-1}$çš„æ¦‚ç‡è¢«æ£€æµ‹åˆ°\n- æ‰€æœ‰çªå‘é”™è¯¯ï¼Œé•¿åº¦L > r+1å°†ä¼šæœ‰$1-(1/2)^r$çš„æ¦‚ç‡è¢«æ£€æµ‹åˆ°\n- ä¸€ä¸ªå¥½çš„ç”Ÿæˆå¤šé¡¹å¼åº”è¯¥ï¼š\n    - è‡³å°‘æ‹¥æœ‰ä¸¤é¡¹\n    - é¡¹x0çš„ç³»æ•°åº”ä¸º1\n    - åº”è¯¥å…·æœ‰å› å­x+1\n---\n## åŸºæœ¬æ•°æ®é“¾è·¯åè®®\n### ä¹Œæ‰˜é‚¦å¼å•å·¥åè®® P1\n- å‡è®¾æ²¡æœ‰é”™è¯¯ï¼Œå¹¶ä¸”æ¥æ”¶æ–¹å’Œå‘é€æ–¹ä¸€æ ·å¿«\n- å•å‘æ•°æ®ä¼ è¾“\n### æ— é”™ä¿¡é“ä¸Šçš„å•å·¥åœ-ç­‰å¼åè®® P2\n- ç¡®ä¿å‘é€æ–¹ä¸èƒ½è¶…è¿‡æ¥æ”¶æ–¹\n- æ¥æ”¶æœºåœ¨å‡†å¤‡å°±ç»ªæ—¶è¿”å›ä¸€ä¸ªå“‘å¸§ï¼ˆ**ack**ï¼‰ï¼Œå…è®¸å®ƒå‘é€ä¸‹ä¸€å¸§\n- ä¸€æ¬¡åªèƒ½è¾“å‡ºä¸€å¸§â€”â€”ç§°ä¸ºåœ-ç­‰å¼åè®®ï¼ˆ**stop-and-wait**ï¼‰\n### æœ‰é”™ä¿¡é“ä¸Šçš„å•å·¥åœ-ç­‰å¼åè®® P3\n- ARQï¼ˆAutomatic Repeat reQuestï¼‰ä¹Ÿç§°ä¸ºPARï¼ˆPositive Acknowledgement with Retransmissionï¼‰æ·»åŠ äº†é”™è¯¯æ§åˆ¶\n- æ¥æ”¶å™¨ç¡®è®¤æ­£ç¡®ä¼ é€çš„å¸§å¹¶å‘é€ack\n- å‘é€æ–¹è®¾ç½®å®šæ—¶å™¨å¹¶åœ¨æ— åº”ç­”æ—¶é‡æ–°å‘é€å¸§\n- ä¸ºç¡®ä¿æ­£ç¡®æ€§ï¼Œå¿…é¡»å¯¹æ•°æ®å¸§å’Œackè¿›è¡Œç¼–å·ï¼Œå¦åˆ™ï¼Œæ¥æ”¶æ–¹æ— æ³•ä»æ–°å¸§ä¸­åˆ†è¾¨å‡ºé‡ä¼ \n- å¯¹äºåœ-ç­‰å¼åè®®ï¼Œåºå·é‡‡ç”¨1ä½ï¼ˆ2ä¸ªæ•°å­—ï¼‰è¶³çŸ£\n---\n## æ»‘åŠ¨çª—å£åè®®\n- å‘é€æ–¹ç»´æŠ¤å®ƒå¯ä»¥å‘é€çš„å¸§çª—å£\n    - éœ€è¦ä¸ºå¯èƒ½çš„é‡ä¼ ä¿ç•™ç¼“å†²ç©ºé—´\n    - çª—å£åœ¨æ”¶åˆ°ä¸‹ä¸€æ¬¡ç¡®è®¤æ—¶å‰ç§»\n- æ¥æ”¶æ–¹ç»´æŠ¤å®ƒå¯ä»¥æ¥æ”¶çš„å¸§çª—å£\n    - éœ€è¦ä¸ºåˆ°è¾¾å¸§ä¿ç•™ç¼“å†²ç©ºé—´\n    - çª—å£åœ¨å¸§æŒ‰é¡ºåºåˆ°è¾¾æ—¶å‰ç§»\n- ç¡®è®¤ä¿¡æ¯å¯ä»¥è¢«å•ç‹¬é™„åœ¨æ•°æ®å¸§ä¸Šï¼ˆackï¼‰ï¼Œä¹Ÿå¯ä»¥é™„åœ¨ä¸‹ä¸€ä¸ªå‡ºå¢ƒçš„æ•°æ®å¸§ä¸Šã€‚è¿™è¢«ç§°ä¸º**æå¸¦ç¡®è®¤**ï¼ˆpiggybackingï¼‰\n### ç®¡é“åŒ–ï¼ˆPipeliningï¼‰\n- æ›´å¤§çš„çª—å£å¯ä»¥ä½¿ç”¨ç®¡é“åŒ–æ¥å®ç°é«˜æ•ˆé“¾æ¥\n- åœ-ç­‰å¼åè®®ï¼ˆw=1ï¼‰å¯¹äºé•¿è·ç¦»é“¾æ¥è€Œè¨€æ•ˆç‡ä½ä¸‹\n- çª—å£æœ€å¤§å¸§æ•°é‡ï¼ˆwï¼‰å–å†³äºå¸¦å®½-å»¶è¿Ÿï¼ˆBD bandwidth-delayï¼‰\n- **w â‰¥ 2BD+1**ä»¥ç¡®ä¿é«˜é“¾è·¯åˆ©ç”¨ç‡\n\n> æ³¨æ„ï¼šè¿™é‡Œçš„BDå·²ç»æ¢ç®—æˆå¸§çš„æ•°é‡\n\n- å¦‚æœæˆ‘ä»¬ç›´æ¥ä½¿ç”¨BDPï¼ˆbandwidth-delay productï¼‰ï¼Œå‡è®¾Læ˜¯ä¸€å¸§çš„é•¿åº¦ï¼Œå…¬å¼åº”ä¸º\n- **W â‰¥ 2BDP/L+1**\n- ç®¡é“åŒ–å¯¼è‡´äº†å¯¹äºé”™è¯¯/ç¼“å­˜çš„ä¸åŒé€‰æ‹©ï¼š\n    - å›é€€N\n    - é€‰æ‹©é‡ä¼ \n### 1ä½æ»‘åŠ¨çª—å£åè®® P4\n- åºåˆ—å·åŸºäºæ¨¡2ç®—æ³•ï¼Œé€šè¿‡åœ-ç­‰å¼åè®®åœ¨ä¸¤ä¸ªæ–¹å‘ä¼ è¾“æ•°æ®\n    - å€ŸåŠ©æå¸¦ç¡®è®¤æé«˜æ•ˆç‡\n    - å¤„ç†ä¼ è¾“é”™è¯¯ã€æµé‡æ§åˆ¶\n- å¦‚æœåŒæ—¶å‘èµ·é€šä¿¡ä¼šé€ æˆé‡å¤ä¼ è¾“ï¼Œæ•ˆç‡ä¸‹é™\n### å›é€€Nåè®® P5\n- æ¥æ”¶æ–¹ä»…æ¥å—/ç¡®è®¤æŒ‰é¡ºåºåˆ°è¾¾çš„å¸§ï¼š\n    - ä¸¢å¼ƒä¸¢å¤±/å‡ºé”™å¸§ä¹‹åçš„å¸§\n    - å‘é€æ–¹è¶…æ—¶å¹¶é‡ä¼ æ‰€æœ‰æœªå®Œæˆçš„å¸§\n![1_2](https://d-sketon.top/img/data-link-layer/1_2.png)\n- åœ¨å›é€€Nåè®®ä¸­ï¼Œå‘é€çª—å£å¤§å°å¿…é¡»å°äº$2^m$ï¼Œæ¥æ”¶çª—å£çš„å¤§å°å§‹ç»ˆä¸º1\n- å…¶æœ¬è´¨å°±æ˜¯çª—å£å¤§å°ä¸èƒ½è¶…è¿‡åºå·èƒ½è¡¨ç¤ºçš„èŒƒå›´ï¼Œå¦‚æœå‘é€çª—å£å¤§å°ç­‰äº$2^m$ï¼Œåˆ™æ¥æ”¶æ–¹æ‰€æœ‰ackä¸¢å¤±åæ— æ³•åˆ¤æ–­é‡ä¼ å¸§\n![1_4](https://d-sketon.top/img/data-link-layer/1_4.png)\n- å¯¹å›é€€Nè¿›è¡Œæƒè¡¡ï¼š\n    - å¯¹æ¥æ”¶æ–¹æ¥è¯´è¾ƒä¸ºç®€å•ï¼Œåªéœ€è¦1å¸§\n    - ç”±äºå¤§çª—å£é”™è¯¯è€Œæµªè´¹é“¾è·¯å¸¦å®½ï¼Œæ•´ä¸ªçª—å£å°†è¢«é‡ä¼ \n### é€‰æ‹©é‡ä¼ åè®® P6\n- æ¥æ”¶æ–¹åœ¨æ¥æ”¶çª—å£ä¸­çš„ä»»æ„ä½ç½®æ¥æ”¶å¸§\n- ç´¯ç§¯ackï¼ˆCumulative ackï¼‰è¡¨ç¤ºå¸§ä¸­çš„æœ€é«˜é¡ºåº\n- NAKï¼ˆnegative ackï¼‰å¯¼è‡´å‘é€æ–¹åœ¨è¶…æ—¶é‡æ–°å‘é€çª—å£ä¹‹å‰é‡æ–°ä¼ è¾“ä¸¢å¤±çš„å¸§\n![1_3](https://d-sketon.top/img/data-link-layer/1_3.png)\n- åœ¨é€‰é€‰æ‹©é‡ä¼ åè®®ä¸­ï¼Œå‘é€æ–¹å’Œæ¥æ”¶æ–¹çª—å£çš„å¤§å°ä¸å¾—è¶…è¿‡$2^{m-1}$\n- å¦‚æœå‘é€çª—å£å¤§å°$2^{m-1}$ï¼Œåˆ™æ¥æ”¶æ–¹æ‰€æœ‰ackä¸¢å¤±åæ— æ³•åˆ¤æ–­é‡ä¼ å¸§\n![1_5](https://d-sketon.top/img/data-link-layer/1_5.png)\n- å¯¹é€‰æ‹©æ€§é‡å¤è¿›è¡Œæƒè¡¡ï¼š\n    - ç”±äºæ¥æ”¶ç«¯æœ‰ç¼“å†²ï¼Œå‘é€ç«¯æœ‰å¤šä¸ªå®šæ—¶å™¨ï¼Œå› æ­¤æ¯”å›é€€Næ›´å¤æ‚\n    - æ›´æœ‰æ•ˆåœ°åˆ©ç”¨é“¾è·¯å¸¦å®½ï¼Œå› ä¸ºåªé‡æ–°å‘é€ä¸¢å¤±çš„å¸§ï¼ˆä½é”™è¯¯ç‡ï¼‰\n\n## æ•°æ®é“¾è·¯åè®®å®ä¾‹\n### HDLC\n- é«˜çº§æ•°æ®é“¾è·¯æ§åˆ¶ï¼ˆHDLCï¼‰æ˜¯ä¸€ç§é¢å‘ä½çš„åè®®ï¼Œç”¨äºç‚¹å¯¹ç‚¹å’Œå¤šç‚¹é“¾è·¯ä¸Šçš„é€šä¿¡\n- è™½ç„¶HDLCæ›´å¤šçš„æ˜¯ä¸€ä¸ªç†è®ºé—®é¢˜è€Œä¸æ˜¯å®é™…é—®é¢˜ï¼Œä½†HDLCä¸­å®šä¹‰çš„å¤§å¤šæ•°æ¦‚å¿µæ˜¯å…¶ä»–å®é™…åè®®ï¼ˆå¦‚PPPã€ä»¥å¤ªç½‘æˆ–æ— çº¿å±€åŸŸç½‘ï¼‰çš„åŸºç¡€\n- HDLCæä¾›ä¸¤ç§å¸¸è§çš„ä¼ è¾“æ¨¡å¼ï¼Œå¯ç”¨äºä¸åŒçš„é…ç½®ï¼šæ­£å¸¸å“åº”æ¨¡å¼ï¼ˆNRMï¼‰å’Œå¼‚æ­¥å¹³è¡¡æ¨¡å¼ï¼ˆABMï¼‰\n#### HDCLå¸§\n- ä¿¡æ¯å¸§ï¼ˆIå¸§ï¼‰ï¼ˆç”¨äºä¼ é€’æ•°æ®ï¼‰\n- ç›‘æ§å¸§ï¼ˆSå¸§ï¼‰ï¼ˆç”¨äºACKå’ŒNAKï¼‰\n- æœªç¼–å·çš„å¸§ï¼ˆUå¸§ï¼‰ï¼ˆç”¨äºå»ºç«‹è¿æ¥ï¼‰\n### SONETä¸Šçš„æ•°æ®åŒ…\n- SONETä¸Šçš„æ•°æ®åŒ…æ˜¯ç”¨äºé€šè¿‡SONETå…‰çº¤é“¾è·¯æ‰¿è½½IPæ•°æ®åŒ…çš„æ–¹æ³•\n    - ä½¿ç”¨PPPï¼ˆç‚¹å¯¹ç‚¹åè®®ï¼‰è¿›è¡Œæˆå¸§\n#### PPP\n- PPPï¼ˆç‚¹å¯¹ç‚¹åè®®ï¼‰æ˜¯è·¨é“¾è·¯ä¼ é€æ•°æ®åŒ…çš„é€šç”¨æ–¹æ³•\n    - æˆå¸§ä½¿ç”¨æ ‡å¿—å­—èŠ‚ï¼ˆ0x7Eï¼‰å’Œ**å­—èŠ‚å¡«å……**ï¼Œè½¬ä¹‰å­—èŠ‚ï¼ˆ0x7Dï¼‰\n    - â€œæ— ç¼–å·æ¨¡å¼â€ï¼ˆæ— è¿æ¥æ— ç¡®è®¤æœåŠ¡ï¼‰ç”¨äºæ‰¿è½½IPæ•°æ®åŒ…\n    - ä½¿ç”¨æ ¡éªŒå’Œæ£€æµ‹é”™è¯¯\n![1_6](https://d-sketon.top/img/data-link-layer/1_6.png)\n#### PPPä¸­çš„å¤šè·¯å¤ç”¨\n- è™½ç„¶PPPæ˜¯ä¸€ç§é“¾è·¯å±‚åè®®ï¼Œä½†å®ƒä½¿ç”¨å¦ä¸€ç»„åè®®æ¥å»ºç«‹é“¾è·¯ã€éªŒè¯ç›¸å…³æ–¹å¹¶ä¼ è¾“ç½‘ç»œå±‚æ•°æ®\n- ä¸ºä½¿PPPåŠŸèƒ½å¼ºå¤§ï¼Œå®šä¹‰äº†ä¸‰ç»„åè®®ï¼šé“¾è·¯æ§åˆ¶åè®®ï¼ˆLCPï¼‰ã€ä¸¤ä¸ªèº«ä»½éªŒè¯åè®®ï¼ˆAPsï¼‰å’Œå¤šä¸ªç½‘ç»œæ§åˆ¶åè®®ï¼ˆNCPsï¼‰\n### ADSL\n- å¹¿æ³›ç”¨äºé€šè¿‡æœ¬åœ°ç¯è·¯çš„å®½å¸¦äº’è”ç½‘\n- ADSLä»è°ƒåˆ¶è§£è°ƒå™¨ï¼ˆç”¨æˆ·ï¼‰åˆ°DSLAMï¼ˆISPï¼‰\n- IPæ•°æ®åŒ…é€šè¿‡PPPå’ŒAAL5/ATMå‘é€\n- PPPæ•°æ®é€šè¿‡ATMä¿¡å…ƒä»¥AAL5å¸§å‘é€ï¼š\n    - ATMæ˜¯ä¸€ä¸ªé“¾è·¯å±‚ï¼Œä½¿ç”¨çŸ­çš„å›ºå®šå¤§å°çš„ä¿¡å…ƒï¼ˆ53å­—èŠ‚ï¼‰ï¼›æ¯ä¸ªå•å…ƒéƒ½æœ‰ä¸€ä¸ªè™šç”µè·¯æ ‡è¯†ç¬¦\n    - AAL5æ˜¯ä¸€ç§é€šè¿‡ATMå‘é€æ•°æ®åŒ…çš„æ ¼å¼\n    - PPPå¸§è½¬æ¢ä¸ºAAL5å¸§ï¼ˆPPPoAï¼‰\n","tags":["è®¡ç®—æœºç½‘ç»œ"],"categories":["è®¡è½¯æ‚è°ˆ","å­¦ä¹ ç¬”è®°"]},{"title":"CSAPP - CacheLab","url":"/20211015/csapp-cachelab/","content":"\n> ä¸ªäººå®éªŒï¼Œå‚è€ƒå’Œå€Ÿé‰´äº†çŸ¥ä¹å¤§ä½¬å’ŒCSDN\n\n- æœ¬å®éªŒä¸Šå­¦æœŸèŠ±äº†ä¸€å‘¨çš„æ—¶é—´æ‰åšå®Œï¼Œä¹Ÿç®—æ˜¯CSAPPä¸­åšçš„æœ€è®¤çœŸçš„ä¸€ä¸ªäº†\n- ç›¸æ¯”äºPhaseAï¼ŒPhaseBæ›´åŠ çš„é˜´é—´å’Œè€—æ—¶\n- åœ¨åšå®éªŒçš„è¿‡ç¨‹ä¸­å‚è€ƒäº†çŸ¥ä¹å¤§ä½¬å’ŒCSDNä¸Šçš„ä»£ç ï¼Œå¹¶èå…¥äº†è‡ªå·±çš„ideaï¼Œå¸Œæœ›èƒ½å¸®åŠ©åˆ°è®¡è½¯çš„åŒå­¦ï¼ˆç¬‘ï¼‰\n## **PhaseA**\n### å®éªŒè¦æ±‚\n- å®ç°ä¸€ä¸ªcacheæ¨¡æ‹Ÿå™¨ï¼Œè¿è¡Œæ—¶è¾“å…¥s,b,Eï¼Œè¦æ±‚ç»Ÿè®¡å‘½ä¸­ï¼Œæœªå‘½ä¸­å’Œé©±é€çš„æ¬¡æ•°ï¼Œcacheå¿½ç•¥å—åç§»é‡ï¼Œä¸”é‡‡ç”¨LRUç­–ç•¥è¿›è¡Œé©±é€\n### å®éªŒè¿‡ç¨‹\n- tracesæ–‡ä»¶ä¸­åŒ…å«Iï¼ŒLï¼ŒSï¼ŒMå››ç§æ¨¡å¼ï¼šIéœ€è¦å¿½ç•¥ï¼Œè€Œç»è¿‡åˆ†æå¯çŸ¥Sï¼ˆStoreï¼‰å’ŒLï¼ˆLoadï¼‰æ¨¡å¼æœ¬è´¨ä¸Šç›¸åŒï¼ˆç¼“å­˜ä¸­å·²å­˜åœ¨ç›´æ¥å‘½ä¸­ï¼Œç¼“å­˜ä¸­æœªå­˜åœ¨åˆ™æœªå‘½ä¸­ï¼Œå¦‚æœç¼“å­˜å·²æ»¡åˆ™éœ€è¦é©±é€ï¼‰ï¼Œè€ŒMæ¨¡å¼åˆ™æ˜¯å…ˆè¿›è¡ŒLå†è¿›è¡ŒSæ¨¡å¼\n#### å£°æ˜cache_lineç»“æ„ä½“\n```c\nstruct cache_line\n{\n    int tag;    //æ ‡è®°ä½\n    int LRU_counter;    //æœ€åè®¿é—®æ—¶é—´\n};\n```\n- cache_lineä¸­åŒ…å«tagæ ‡è®°ä½å’ŒLRU_counterç”¨äºè®°å½•æœ€åè®¿é—®æ—¶é—´ä¾¿äºé©±é€ï¼ˆValid_bitæœ‰æ•ˆä½çœç•¥è€Œé‡‡ç”¨å¦ä¸€ç§æ–¹æ³•ï¼‰\n#### å»ºç«‹å…¨å±€å˜é‡\n```c\nstruct cache_line **cache;\nint hit_count, miss_count, eviction_count;\nint *cache_index;\nint s, E, b, S;\nint count = 0;    //æ—¶é—´åˆ»\n```\n- cacheç»“æ„ä½“äºŒçº§æŒ‡é’ˆç”¨äºå»ºç«‹äºŒç»´æ•°ç»„\n- hit_countï¼Œmiss_countï¼Œeviction_countç”¨äºè®°å½•å‘½ä¸­ï¼Œæœªå‘½ä¸­å’Œé©±é€çš„æ¬¡æ•°\n- cache_indexä»¥åŠæŒ‡é’ˆç”¨äºå»ºç«‹ä¸€ç»´æ•°ç»„æ¥ç»´æŠ¤ç»„æœ‰æ•ˆè¡Œçš„ä¸ªæ•°\n- sï¼ŒEï¼Œbæ¥æ”¶ä¼ å…¥å‚æ•°ï¼ŒSä¾¿äºå¼€è¾Ÿå†…å­˜\n- countä½œä¸ºæ—¶é—´åˆ»\n#### æ¥æ”¶ä¼ å…¥sï¼ŒEï¼Œbå‚æ•°\n```c\nint opt;\nchar *trace_name;    //traceæ–‡ä»¶åœ°å€\n//å‘½ä»¤è¡Œè¯»å…¥\nwhile ((opt = getopt(argc, argv, \"s:E:b:t:\")) != -1)\n{\n    switch (opt)\n    {\n    case 's':\n        s = atoi(optarg);    //è¯»å…¥s\n        break;\n    case 'E':\n        E = atoi(optarg);    //è¯»å…¥E\n        break;\n    case 'b':\n        b = atoi(optarg);    //è¯»å…¥b\n        break;\n    case 't':\n        trace_name = optarg;    //è¯»å…¥åœ°å€\n    default:\n        break;\n    }\n}\n```\n- ä½¿ç”¨getoptå‡½æ•°å°†å‚æ•°ä¼ å…¥sï¼ŒEï¼Œbä¸­ï¼ŒåŒæ—¶åˆ›å»ºtrace_nameå­—ç¬¦ä¸²ç”¨äºè®°å½•traceæ–‡ä»¶çš„åœ°å€ä¾¿äºä¹‹åæ–‡ä»¶çš„è¯»å…¥\n#### åˆå§‹åŒ–æ•°ç»„\n```c\n //åˆå§‹åŒ–\nS = pow(2, s);    //è®¡ç®—S=2^s\ncache = (struct cache_line **)malloc(sizeof(struct cache_line *) * S);\nfor (int i = 0; i < S; i++)\n    cache[i] = (struct cache_line *)malloc(sizeof(struct cache_line *) * E);    //cacheå¼€è¾Ÿå†…å­˜\nfor (int i = 0; i < S; i++)\n    for (int j = 0; j < E; j++)\n        cache[i][j].tag = cache[i][j].LRU_counter = 0;    //cacheåˆå§‹åŒ–\ncache_index = (int *)malloc(sizeof(int) * S);    //cache_indexå¼€è¾Ÿå†…å­˜\nmemset(cache_index, 0, sizeof(int) * S);    //cache_indexåˆå§‹åŒ–\n```\n- ä½¿ç”¨mallocå‡½æ•°å¯¹cache_lineå’Œcache_indexå¼€è¾Ÿå†…å­˜ï¼Œå»ºç«‹cache_line\\[S]\\[E]å’Œcache\\[S]ï¼ŒåŒæ—¶åˆå§‹åŒ–ä¸º0\nï¼ˆcache_line\\[x]\\[y]è¡¨ç¤ºç¬¬xç»„ç¬¬yè¡Œæ‰€å­˜å†…å®¹ï¼Œcache\\[x]è¡¨ç¤ºç¬¬xç»„æœ€åçš„æœ‰æ•ˆå—æ‰€åœ¨è¡Œæ•°ï¼‰\n#### æ–‡ä»¶è¯»å…¥\n```c\n//æ–‡ä»¶è¯»å…¥\nFILE *pFile = fopen(trace_name, \"r\");    //æ‰“å¼€æ–‡ä»¶\nchar identifier;\nunsigned address;\nint size;\n```\n- ä½¿ç”¨fopenå‡½æ•°å’Œä¹‹å‰è¯»å…¥çš„trace_nameæ–‡ä»¶çš„åœ°å€è¯»å…¥\\*pFileä¸­ï¼Œå¹¶åˆ›å»ºidentifierï¼Œaddressï¼Œsizeç”¨äºå­˜å‚¨æ–‡ä»¶ä¸­è¯»å…¥çš„å†…å®¹\n#### è¯»å…¥åæ•°æ®å¤„ç†\n```c\nwhile (fscanf(pFile, \" %c %x,%d\", &identifier, &address, &size) > 0)    //æŒ‰è¡Œè¯»å…¥\n{\n    if (identifier == 'I')    //å¿½ç•¥Iæ¨¡å¼\n        continue;\n    int t_address = address / ((int)pow(2, s + b));    //è®¡ç®—æ ‡è®°ä½\n    int s_address = address / ((int)pow(2, b)) % (int)(pow(2, s));    //è®¡ç®—ç´¢å¼•ä½\n    if (identifier == 'M')    //Mæ¨¡å¼ä¸¤æ¬¡solve\n    {\n        Solve(t_address, s_address);\n        Solve(t_address, s_address);\n    }\n    else    //Sæ¨¡å¼æˆ–Læ¨¡å¼\n        Solve(t_address, s_address);\n}\n```\n- ä½¿ç”¨fscanfå‡½æ•°æŒ‰è¡Œè¯»å–traceæ–‡ä»¶çš„å†…å®¹ï¼Œæ¨¡å¼è¯»å…¥identifierä¸­ï¼Œåœ°å€è¯»å…¥addressä¸­ï¼Œæ“ä½œèŒƒå›´è¯»å…¥sizeä¸­\n- ç”±äºå¿½ç•¥Iæ¨¡å¼ï¼Œæ‰€ä»¥identifier==â€™Iâ€™åç›´æ¥continue\n- ç”±äºå¿½ç•¥å—åç§»é‡ï¼Œæ‰€ä»¥æ— éœ€è®°å½•åœ°å€ä¸­çš„å—åç§»éƒ¨åˆ†è€Œåªéœ€ç»Ÿè®¡ç´¢å¼•éƒ¨åˆ†ï¼ˆs_addressï¼‰å’Œæ ‡è®°éƒ¨åˆ†ï¼ˆt_addressï¼‰\n- æ ¹æ®è¯»å…¥çš„så’Œè®¡ç®—å¹¶åˆ†å‰²å‡ºè¿™ä¸¤éƒ¨åˆ†ï¼ˆt_address=âŒŠaddress / 2^(s+b)Â âŒ‹ï¼Œ\ns_address=âŒŠaddress/ 2^bÂ âŒ‹mod 2^sï¼‰\n- ç”±äºLæ¨¡å¼å’ŒSæ¨¡å¼æ“ä½œæ–¹å¼ç›¸åŒï¼Œè€ŒMæ¨¡å¼æ˜¯Læ¨¡å¼+Sæ¨¡å¼ï¼Œæ‰€ä»¥å¯ä»¥åªå†™ä¸€ä¸ªsolveå‡½æ•°ï¼Œå¯¹äºMæ¨¡å¼æ‰§è¡Œä¸¤æ¬¡ï¼Œè€Œå¯¹äºLå’ŒSæ¨¡å¼éƒ½åªæ‰§è¡Œä¸€æ¬¡\n#### ç»“æŸé˜¶æ®µ\n```c\n//ç»“æŸ\nfree(cache);\nfree(cache_index);    //é‡Šæ”¾å†…å­˜\nfclose(pFile);    //å…³é—­æ–‡ä»¶\nprintSummary(hit_count, miss_count, eviction_count);    //è¾“å‡º\n```\n- é‡Šæ”¾å¼€è¾Ÿçš„å†…å­˜å¹¶å…³é—­æ–‡ä»¶\n- è°ƒç”¨printSummaryè¾“å‡ºå‘½ä¸­ï¼Œæœªå‘½ä¸­å’Œé©±é€çš„ä¸ªæ•°\n#### **solveå‡½æ•°**\n\n> å‰æï¼šåŒä¸€ä¸ªç»„å†…ï¼Œæœ‰æ•ˆå—æŒ‰è®¿é—®æ—¶é—´é¡ºåºä¾æ¬¡é¡ºåºå­˜å‚¨ï¼ˆç»„æœªæ»¡çŠ¶æ€ä¸‹ï¼‰ï¼Œä¸”ä½¿ç”¨cache_indexæ¥è®°å½•è¯¥ç»„æœ€åçš„æœ‰æ•ˆå—æ‰€åœ¨è¡Œæ•°\n\n- ä¸è®ºStoreè¿˜æ˜¯Loadéƒ½å­˜åœ¨ä¸¤ç§çŠ¶æ€ï¼šç¼“å­˜ä¸­å·²å­˜åœ¨â€”â€”å‘½ä¸­ï¼Œç¼“å­˜ä¸­ä¸å­˜åœ¨â€”â€”æœªå‘½ä¸­\n- 1.å‘½ä¸­çŠ¶æ€ï¼ˆfind_flag=1ï¼‰\n- åŸºæœ¬æ€æƒ³ï¼šåœ¨cache_index\\[ç»„æ•°]ä¸‹æ ‡çš„èŒƒå›´å†…ï¼ˆè¯¥ç»„æ‰€æœ‰æœ‰æ•ˆå—ï¼‰å¯»æ‰¾ï¼Œå¦‚æœæ‰¾åˆ°åˆ™å‘½ä¸­ï¼Œå¹¶æ›´æ–°æœ€åè®¿é—®æ—¶é—´\n```c\nint find_flag = 0;    //å¯»æ‰¾å“¨å…µ\nfor (int i = 0; i < cache_index[s_address]; i++)\n{\n    if (cache[s_address][i].tag == t_address)   //æ‰¾åˆ°\n    {\n        ++hit_count;    \n        cache[s_address][i].LRU_counter = count;    \n        find_flag = 1;    \n        break;\n    }\n}\n```\n- 2. ä¸å‘½ä¸­çŠ¶æ€ï¼ˆfind_flag=0ï¼‰\n- åŸºæœ¬æ€æƒ³ï¼šåœ¨è¯¥ç»„æ‰€æœ‰æœ‰æ•ˆè¡Œä¸­éƒ½å¯»æ‰¾ä¸åˆ°ï¼Œåˆ™æœªå‘½ä¸­ã€‚æ­¤æ—¶åˆ†ä¸¤ç§æƒ…å†µï¼š\n    - 2.1. ç»„æœªæ»¡ï¼š\n    - æ— éœ€é©±é€ï¼Œä»…éœ€åœ¨cache\\[ç»„æ•°]\\[]ä¸­å‘åæ’å…¥è¯¥æœ‰æ•ˆå—ï¼Œå¹¶æ›´æ–°æœ€åè®¿é—®æ—¶é—´å’Œè¯¥ç»„cache_line\\[]\n    ```c\n    if (cache_index[s_address] != E) //ç»„æœªæ»¡\n    {\n        ++miss_count;    //æœªå‘½ä¸­\n        cache[s_address][cache_index[s_address]].tag = t_address;    //æ›´æ–°ç¼“å­˜\n        cache[s_address][cache_index[s_address]++].LRU_counter = count;    //æ›´æ–°æœ€åè®¿é—®æ—¶é—´\n    }\n    ```\n    - 2.2. ç»„å·²æ»¡ï¼š\n    - éœ€è¦é©±é€ï¼Œæ­¤æ—¶åœ¨è¯¥ç»„ä¸­å¯»æ‰¾è®¿é—®æ—¶é—´æœ€å°çš„æœ‰æ•ˆå—ï¼ˆLRUï¼‰ï¼Œé©±é€æ›¿æ¢è¯¥å—ï¼Œå¹¶æ›´æ–°è¯¥å—æœ€åè®¿é—®æ—¶é—´\n    ```c\n    else //ç»„å·²æ»¡ï¼Œéœ€è¦LRU\n    {\n        ++eviction_count;    //é©±é€\n        ++miss_count;    //æœªå‘½ä¸­\n        int min_count = cache[s_address][0].LRU_counter;    //æœ€åè®¿é—®æ—¶é—´æœ€è¿œå—è®¿é—®æ—¶é—´\n        int min_count_index = 0;    //æœ€åè®¿é—®æ—¶é—´æœ€è¿œå—ä¸‹æ ‡\n        for (int i = 1; i < E; i++)\n            if (cache[s_address][i].LRU_counter < min_count)\n            {\n                min_count = cache[s_address][i].LRU_counter;    //æ›´æ–°æœ€åè®¿é—®æ—¶é—´æœ€è¿œå—è®¿é—®æ—¶é—´\n                min_count_index = i;    //æ›´æ–°æœ€åè®¿é—®æ—¶é—´æœ€è¿œå—ä¸‹æ ‡\n            }\n        cache[s_address][min_count_index].tag = t_address;    //æ›´æ–°ç¼“å­˜\n        cache[s_address][min_count_index].LRU_counter = count;    //æ›´æ–°æœ€åè®¿é—®æ—¶é—´\n    }\n    ```\n- åœ¨solveå‡½æ•°ç»“æŸåæ›´æ–°countæ—¶é—´åˆ»ï¼Œä»¥ä¾¿äºä¸‹æ¬¡ä½¿ç”¨æ›´æ–°è®¿é—®æ—¶é—´\n```c\n++count;    //æ›´æ–°æ—¶é—´åˆ»\n```\n### å®Œæ•´ä»£ç \n```c\n#include \"cachelab.h\"\n#include <stdio.h>\n#include <stdlib.h>\n#include <unistd.h>\n#include <getopt.h>\n#include <math.h>\n#include <string.h>\nstruct cache_line\n{\n    int tag;    //æ ‡è®°ä½\n    int LRU_counter;    //æœ€åè®¿é—®æ—¶é—´\n};\nstruct cache_line **cache;\nint hit_count, miss_count, eviction_count;\nint *cache_index;\nint s, E, b, S;\nint count = 0;    //æ—¶é—´åˆ»\nvoid Solve(int t_address, int s_address)\n{\n    int find_flag = 0;    //å¯»æ‰¾å“¨å…µ\n    for (int i = 0; i < cache_index[s_address]; i++)\n    {\n        if (cache[s_address][i].tag == t_address)   //æ‰¾åˆ°\n        {\n            ++hit_count;    \n            cache[s_address][i].LRU_counter = count;    \n            find_flag = 1;    \n            break;\n        }\n    }\n    if (!find_flag) //æœªæ‰¾åˆ°\n    {\n        if (cache_index[s_address] != E) //ç»„æœªæ»¡\n        {\n            ++miss_count;    //æœªå‘½ä¸­\n            cache[s_address][cache_index[s_address]].tag = t_address;    //æ›´æ–°ç¼“å­˜\n            cache[s_address][cache_index[s_address]++].LRU_counter = count;    //æ›´æ–°æœ€åè®¿é—®æ—¶é—´\n        }\n        else //ç»„å·²æ»¡ï¼Œéœ€è¦LRU\n        {\n            ++eviction_count;    //é©±é€\n            ++miss_count;    //æœªå‘½ä¸­\n            int min_count = cache[s_address][0].LRU_counter;    //æœ€åè®¿é—®æ—¶é—´æœ€è¿œå—è®¿é—®æ—¶é—´\n            int min_count_index = 0;    //æœ€åè®¿é—®æ—¶é—´æœ€è¿œå—ä¸‹æ ‡\n            for (int i = 1; i < E; i++)\n                if (cache[s_address][i].LRU_counter < min_count)\n                {\n                    min_count = cache[s_address][i].LRU_counter;    //æ›´æ–°æœ€åè®¿é—®æ—¶é—´æœ€è¿œå—è®¿é—®æ—¶é—´\n                    min_count_index = i;    //æ›´æ–°æœ€åè®¿é—®æ—¶é—´æœ€è¿œå—ä¸‹æ ‡\n                }\n            cache[s_address][min_count_index].tag = t_address;    //æ›´æ–°ç¼“å­˜\n            cache[s_address][min_count_index].LRU_counter = count;    //æ›´æ–°æœ€åè®¿é—®æ—¶é—´\n        }\n    }\n    ++count;    //æ›´æ–°æ—¶é—´åˆ»\n}\nint main(int argc, char *argv[])\n{\n    int opt;\n    char *trace_name;    //traceæ–‡ä»¶åœ°å€\n    //å‘½ä»¤è¡Œè¯»å…¥\n    while ((opt = getopt(argc, argv, \"s:E:b:t:\")) != -1)\n    {\n        switch (opt)\n        {\n        case 's':\n            s = atoi(optarg);    //è¯»å…¥s\n            break;\n        case 'E':\n            E = atoi(optarg);    //è¯»å…¥E\n            break;\n        case 'b':\n            b = atoi(optarg);    //è¯»å…¥b\n            break;\n        case 't':\n            trace_name = optarg;    //è¯»å…¥åœ°å€\n        default:\n            break;\n        }\n    }\n    //åˆå§‹åŒ–\n    S = pow(2, s);    //è®¡ç®—S=2^s\n    cache = (struct cache_line **)malloc(sizeof(struct cache_line *) * S);\n    for (int i = 0; i < S; i++)\n        cache[i] = (struct cache_line *)malloc(sizeof(struct cache_line *) * E);    //cacheå¼€è¾Ÿå†…å­˜\n    for (int i = 0; i < S; i++)\n        for (int j = 0; j < E; j++)\n            cache[i][j].tag = cache[i][j].LRU_counter = 0;    //cacheåˆå§‹åŒ–\n    cache_index = (int *)malloc(sizeof(int) * S);    //cache_indexå¼€è¾Ÿå†…å­˜\n    memset(cache_index, 0, sizeof(int) * S);    //cache_indexåˆå§‹åŒ–\n    //æ–‡ä»¶è¯»å…¥\n    FILE *pFile = fopen(trace_name, \"r\");    //æ‰“å¼€æ–‡ä»¶\n    char identifier;\n    unsigned address;\n    int size;\n    //å¤„ç†\n    while (fscanf(pFile, \" %c %x,%d\", &identifier, &address, &size) > 0)    //æŒ‰è¡Œè¯»å…¥\n    {\n        if (identifier == 'I')    //å¿½ç•¥Iæ¨¡å¼\n            continue;\n        int t_address = address / ((int)pow(2, s + b));    //è®¡ç®—æ ‡è®°ä½\n        int s_address = address / ((int)pow(2, b)) % (int)(pow(2, s));    //è®¡ç®—ç´¢å¼•ä½\n        if (identifier == 'M')    //Mæ¨¡å¼ä¸¤æ¬¡solve\n        {\n            Solve(t_address, s_address);\n            Solve(t_address, s_address);\n        }\n        else    //Sæ¨¡å¼æˆ–Læ¨¡å¼\n            Solve(t_address, s_address);\n    }\n    //ç»“æŸ\n    free(cache);\n    free(cache_index);    //é‡Šæ”¾å†…å­˜\n    fclose(pFile);    //å…³é—­æ–‡ä»¶\n    printSummary(hit_count, miss_count, eviction_count);    //è¾“å‡º\n    return 0;\n}\n```\n\n## **PhaseB**\n### å®éªŒè¦æ±‚\n- ä¼˜åŒ–è½¬ç½®çŸ©é˜µçš„ä»£ç ï¼Œä½¿å…¶æœªå‘½ä¸­ç‡å°½å¯èƒ½ä½\n- çŸ©é˜µå¤§å°åˆ†åˆ«ä¸º32\\*32,64\\*64å’Œ61\\*67ï¼Œç”±äºä¸åŒçŸ©é˜µå¤§å°çš„ä»£ç å¯èƒ½ä¸åŒï¼Œæ‰€ä»¥æ‰€å†™ä»£ç åªå¯¹æµ‹è¯•çš„ä¸‰ç»„æ•°æ®è¿›è¡Œä¼˜åŒ–\n- ä»è€å¸ˆæ‰€ç»™çš„PPTå’Œpdfä¸­å¯ä»¥çŸ¥é“å¯¹çŸ©é˜µåˆ†ç»„ï¼ˆblockingï¼‰å¯ä»¥æœ‰æ•ˆåœ°æå‡ç¼“å­˜å‘½ä¸­ç‡\n\n> å‰æï¼šä»å¯¼å‡ºçš„trans.f0æ–‡ä»¶ä¸­å¯ä»¥å¾—çŸ¥ï¼Œä½¿ç”¨./test-transå‘½ä»¤æµ‹è¯•å¾—å‡ºçš„æœªå‘½ä¸­æ•°é‡æ¯”å®é™…çš„å¤š3ï¼ˆvalgrindæ¨¡æ‹Ÿé¢å¤–å¼€é”€ï¼‰\n> ä»¥ä¸‹æåŠçš„æ‰€æœ‰æœªå‘½ä¸­å‡ä¸ºå®é™…æœªå‘½ä¸­æ•°é‡ï¼Œå¦‚éœ€è½¬æ¢åˆ°å‘½ä»¤è¾“å‡ºéœ€åŠ 3\n\n### 32\\*32ï¼ˆç†è®ºæœ€ä¼˜256ï¼‰\n#### åŸºå‡†æµ‹è¯•\n- ç»è¿‡æµ‹è¯•ï¼Œæ–‡ä»¶è‡ªå¸¦è½¬ç½®å‡½æ•°å¯¹äº32\\*32çŸ©é˜µè½¬ç½®æœªå‘½ä¸­ä¸º1180\n##### å‘½ä¸­ç‡åˆ†æ\n- **Aï¼šï¼ˆ156æœªå‘½ä¸­ï¼Œ15.23%æœªå‘½ä¸­ç‡ï¼‰**\n![1](https://d-sketon.top/img/csapp-cachelab/1.png){width=\"500\"}\n- **Bï¼šï¼ˆ1024æœªå‘½ä¸­ï¼Œ100%æœªå‘½ä¸­ç‡ï¼‰**\n![2](https://d-sketon.top/img/csapp-cachelab/2.png){width=\"500\"}\n- åœ¨AçŸ©é˜µéå†æ¯ä¸€è¡Œæ—¶ï¼ŒBä¸­æ¯ä¸€åˆ—çš„æ¯ä¸ªå…ƒç´ æ¯éš”8è¡Œéƒ½ä¼šå‘ç”Ÿå†²çªä¸å‘½ä¸­ï¼Œå¦‚æ­¤é€ æˆä½å‘½ä¸­ç‡\n#### ç¬¬ä¸€æ¬¡ä¼˜åŒ–\n- ç”±äºæ˜¯æ¯éš”8è¡Œå‘ç”Ÿä¸å‘½ä¸­ï¼Œæ‰€ä»¥é¦–å…ˆè€ƒè™‘8\\*8çŸ©é˜µåˆ†å—ã€‚æ³¨æ„åˆ°æ¯ä¸ªç¼“å­˜å—ä¸­æ­£å¥½èƒ½å­˜æ”¾8ä¸ªæ•´å‹ï¼Œä¸”æ¯ä¸ªåˆ†å—é™¤å¯¹è§’çº¿äº’ä¸å¹²æ‰°ï¼ˆä¸ä¼šå‘ç”Ÿé©±é€ï¼‰ï¼Œå¦‚æ­¤ä¸€æ¥æŒ‰å—è¿›è¡Œè½¬ç½®ï¼Œæ¯ä¸ªå—ä¸­ä¸ä¼šå‘ç”Ÿå¤§é‡çš„å†²çªä¸å‘½ä¸­ï¼Œä¸”å—ä¸å—ä¹‹é—´ç»å¯¹ä¸ä¼šå‘ç”Ÿå†²çªã€‚æ‰€ä»¥8\\*8åˆ†å—æ˜¯å¯è¡Œçš„\n- ä»£ç \n![4](https://d-sketon.top/img/csapp-cachelab/4.png)\n- ç»è¿‡æµ‹è¯•ï¼Œ8\\*8å¯¹äº32\\*32çŸ©é˜µè½¬ç½®æœªå‘½ä¸­ä¸º340\n![3](https://d-sketon.top/img/csapp-cachelab/3.png)\n##### å‘½ä¸­ç‡åˆ†æ\n- **Aï¼šï¼ˆ156æœªå‘½ä¸­ï¼Œ15.23%æœªå‘½ä¸­ç‡ï¼‰**\n![5](https://d-sketon.top/img/csapp-cachelab/5.png){width=\"500\"}\n- **Bï¼šï¼ˆ184æœªå‘½ä¸­17.97%æœªå‘½ä¸­ç‡ï¼‰**\n![6](https://d-sketon.top/img/csapp-cachelab/6.png){width=\"500\"}\n- Aæ²¡æœ‰å‘ç”Ÿå˜åŒ–è€ŒBå‘½ä¸­ç‡å¤§å¤§æé«˜ï¼Œä½†æ€»æœªå‘½ä¸­æ•°ä»ç„¶è¶…è¿‡300\n#### ç¬¬äºŒæ¬¡ä¼˜åŒ–\n- æ³¨æ„åˆ°AçŸ©é˜µä¸­å…ƒç´ ä»ç„¶ä¼šå’ŒBçŸ©é˜µä¸­å…ƒç´ äº’ç›¸å†²çªï¼Œå¯¼è‡´AçŸ©é˜µçš„å¯¹è§’çº¿å’ŒBçŸ©é˜µå¯¹è§’çº¿ä¸Šä¸€æ ¼å…ƒç´ å‘ç”Ÿå†²çªä¸å‘½ä¸­ï¼Œå…·ä½“è§£é‡Šå¦‚å›¾æ‰€ç¤ºï¼š\n![7](https://d-sketon.top/img/csapp-cachelab/7.png){width=\"500\"}\n- å¤§éƒ¨åˆ†å†²çªå‘½ä¸­å‡å‘ç”Ÿåœ¨Aå’ŒBçš„ç›¸é‚»æ“ä½œä¸­ï¼ˆçº¢è‰²ç”»åœˆéƒ¨åˆ†ï¼‰ï¼Œæ‰€ä»¥å¯ä»¥è€ƒè™‘å…ˆåŒæ—¶å¯¹Aå—ä¸­çš„åŒä¸€è¡Œè¿›è¡Œè¯»å–æ“ä½œï¼Œå†åŒæ—¶å¯¹Bå—å¯¹åº”åˆ—è¿›è¡Œå†™å…¥æ“ä½œï¼Œè¿™æ ·ä¾¿å¯ä»¥æ¶ˆé™¤ç›¸é‚»æ“ä½œå¸¦æ¥çš„å†²çªä¸å‘½ä¸­\n- æ›¿æ¢å†…éƒ¨å¾ªç¯ä»£ç ä¸ºï¼š\n![8](https://d-sketon.top/img/csapp-cachelab/8.png)\n- ç»è¿‡æµ‹è¯•ï¼Œ8\\*8å¯¹äº32\\*32çŸ©é˜µè½¬ç½®æœªå‘½ä¸­ä¸º284ï¼Œå·²è¾¾åˆ°æ»¡åˆ†æ ‡å‡†\n![9](https://d-sketon.top/img/csapp-cachelab/9.png)\n##### å‘½ä¸­ç‡åˆ†æ\n- **Aï¼šï¼ˆ128æœªå‘½ä¸­ï¼Œ12.5%æœªå‘½ä¸­ç‡ï¼‰**\n![10](https://d-sketon.top/img/csapp-cachelab/10.png){width=\"500\"}\n- **Bï¼šï¼ˆ156æœªå‘½ä¸­ï¼Œ15.23%æœªå‘½ä¸­ç‡ï¼‰**\n![11](https://d-sketon.top/img/csapp-cachelab/11.png){width=\"500\"}\n### 64\\*64ï¼ˆç†è®ºæœ€ä¼˜1024ï¼‰\n#### åŸºå‡†æµ‹è¯•\n- ç›¸æ¯”äº32\\*32çŸ©é˜µç¼“å­˜èƒ½å­˜æ”¾8è¡Œå…ƒç´ ï¼Œ64\\*64çŸ©é˜µç¼“å­˜åªèƒ½å­˜æ”¾4è¡Œå…ƒç´ \n- é¦–å…ˆå°è¯•å’Œä¸Šé¢˜ä¸€æ ·8\\*8åˆ†å—å¹¶ä¸€æ¬¡æ€§è¯»å–ä¸€è¡Œï¼ˆä»£ç çœç•¥ï¼‰\n- ç»è¿‡æµ‹è¯•ï¼Œ8\\*8å¹¶ä¸€æ¬¡æ€§è¯»å–å¯¹äº64\\*64çŸ©é˜µè½¬ç½®æœªå‘½ä¸­ä¸º4608ï¼Œå‡ ä¹æ²¡æœ‰æå‡\n![12](https://d-sketon.top/img/csapp-cachelab/12.png)\n- æ–‡ä»¶è‡ªå¸¦è½¬ç½®å‡½æ•°æœªå‘½ä¸­ä¸º4720\n![13](https://d-sketon.top/img/csapp-cachelab/13.png)\n##### å‘½ä¸­ç‡åˆ†æ\n- **Aï¼šï¼ˆ512æœªå‘½ä¸­ï¼Œ12.5%æœªå‘½ä¸­ç‡ï¼‰**\n![14](https://d-sketon.top/img/csapp-cachelab/14.png){width=\"500\"}\n- **Bï¼šï¼ˆ4096æœªå‘½ä¸­ï¼Œ100%æœªå‘½ä¸­ç‡ï¼‰**\n![15](https://d-sketon.top/img/csapp-cachelab/15.png){width=\"500\"}\n- ç”±äºæ¯æ¬¡å¯¹Aä¸€æ¬¡æ€§è¯»å–ä¸€è¡Œï¼Œæ‰€ä»¥AçŸ©é˜µçš„å‘½ä¸­ç‡å¾—åˆ°äº†æå‡ï¼ˆ12.5%æœªå‘½ä¸­ç‡ï¼‰\n- ä½†ç”±äºç¼“å­˜åªèƒ½å­˜ä¸‹çŸ©é˜µå‰4è¡Œå…ƒç´ ï¼ŒBçŸ©é˜µåœ¨è¯»å–å4åˆ—æ—¶ä¼šè¦†ç›–å‰4åˆ—ï¼ŒåŒæ—¶è¯»å–å‰4åˆ—æ—¶ä¼šè¦†ç›–å4åˆ—ï¼Œå¯¼è‡´æ¯ä¸ªå…ƒç´ éƒ½å‘ç”Ÿäº†å†²çªä¸å‘½ä¸­ï¼ˆåˆå§‹ä¸ºå†·ä¸å‘½ä¸­ï¼‰\n![16](https://d-sketon.top/img/csapp-cachelab/16.png){width=\"500\"}\nï¼ˆçº¢è‰²ç®­å¤´è¡¨ç¤ºå†²çªä¸å‘½ä¸­ï¼‰\n#### ç¬¬ä¸€æ¬¡ä¼˜åŒ–\n- ç”±äºå‰å4åˆ—ä¼šäº’ç›¸è¦†ç›–ï¼Œæ‰€ä»¥è€ƒè™‘å°†8\\*8åˆ†å—æ”¹ä¸º4\\*4åˆ†å—ï¼Œæ¯æ¬¡ä¸€æ¬¡æ€§è¯»å–ä¸€è¡Œï¼Œè¿™æ ·ä¾¿èƒ½é™ä½BçŸ©é˜µçš„æœªå‘½ä¸­ç‡\n- ä»£ç ï¼š\n![17](https://d-sketon.top/img/csapp-cachelab/17.png)\n- ç»è¿‡æµ‹è¯•ï¼Œ4\\*4å¹¶ä¸€æ¬¡æ€§è¯»å–å¯¹äº64\\*64çŸ©é˜µè½¬ç½®æœªå‘½ä¸­ä¸º1696ï¼Œæœ‰äº†è¾ƒå¤§çš„æå‡ï¼Œä½†ä¾ç„¶æ²¡æœ‰å°äº1300\n![18](https://d-sketon.top/img/csapp-cachelab/18.png)\n##### å‘½ä¸­ç‡åˆ†æ\n- **Aï¼šï¼ˆ576ï¼Œ14.06%æœªå‘½ä¸­ç‡ï¼‰**\n![19](https://d-sketon.top/img/csapp-cachelab/19.png){width=\"500\"}\n- **Bï¼šï¼ˆ1120ï¼Œ27.34%æœªå‘½ä¸­ç‡ï¼‰**\n![20](https://d-sketon.top/img/csapp-cachelab/20.png){width=\"500\"}\n- BçŸ©é˜µç”±äºé™ä½åˆ†å—å¤§å°ä¸”ä»ç„¶ä¸€æ¬¡æ€§è¯»å–ä¸€è¡Œï¼Œä¸å†100%æœªå‘½ä¸­ç‡ï¼Œä½†ç”±äºé‡‡ç”¨äº†4\\*4åˆ†å—ï¼Œåœ¨éå¯¹è§’çº¿å—å†…éƒ¨ä»ç„¶ä¼šå‘ç”Ÿå¤§é‡å†²çªä¸å‘½ä¸­ï¼Œæœªå‘½ä¸­ç‡ä¸º25%ï¼Œè€Œåœ¨å¯¹è§’çº¿å—ä¸Šç”±äºAçŸ©é˜µå’ŒBçŸ©é˜µæ‰€æ˜ å°„åˆ°ç›¸åŒçš„ç¼“å­˜å—ï¼Œå¯¼è‡´AçŸ©é˜µå’ŒBçŸ©é˜µå‘ç”Ÿå†²çªä¸å‘½ä¸­ï¼Œæœªå‘½ä¸­ç‡æ›´é«˜\n![21](https://d-sketon.top/img/csapp-cachelab/21.png)\nï¼ˆéå¯¹è§’çº¿å—ï¼‰\n- ç”±æ­¤å¯è§å•çº¯çš„4\\*4åˆ†å—å·²ç»è¾¾åˆ°äº†æé™ï¼Œéœ€è¦æ›´è¿›ä¸€æ­¥çš„ä¼˜åŒ–\n#### ç¬¬äºŒæ¬¡ä¼˜åŒ–\n- ç”±äºç¼“å­˜ä¸­èƒ½å­˜æ”¾8ä¸ªæ•´å‹ï¼Œæ‰€ä»¥è€ƒè™‘å…ˆè¿›è¡Œ8\\*8åˆ†å—ï¼Œè€Œåœ¨å¤§å—å†…éƒ¨å†è¿›è¡Œ4\\*4åˆ†å—æ“ä½œ\nä¸ºäº†æœ€å¤§åŒ–çš„åˆ©ç”¨ç¼“å­˜ï¼Œå°½å¯èƒ½ä½å‡å°‘å†²çªï¼Œè€ƒè™‘åœ¨8\\*8å¤§å—å†…éƒ¨è¿›è¡Œä¸‰æ­¥æ“ä½œï¼š\n\n> è¿™é‡Œçš„æ€æƒ³å‚è€ƒäº†æŸä½å¤§ç¥ï¼Œè¿™é‡Œç€é‡åˆ†æ\n> æ¯ä¸ª8\\*8å—ä¸­çš„4\\*4å—æŒ‰è¡Œé¡ºåºå°†å—è¢«æ ‡è®°ä¸º1,2,3,4å—\n\n- 1.é¦–å…ˆå¯¹AçŸ©é˜µçš„1,2å—ä¸€æ¬¡æ€§è¯»å–ä¸€è¡Œ8ä¸ªå…ƒç´ ï¼Œå¹¶æŒ‰åˆ—åˆ†åˆ«ç§»å…¥BçŸ©é˜µçš„1å—å’Œ2å—ä¸­\n![22](https://d-sketon.top/img/csapp-cachelab/22.png){width=\"500\"}\n- 2.å¯¹AçŸ©é˜µçš„3å—æŒ‰åˆ—è¯»å–ï¼Œå¯¹BçŸ©é˜µçš„2å—æŒ‰è¡Œè¯»å–ï¼Œå°†è¯»å–åˆ°çš„AçŸ©é˜µæŒ‰è¡Œç§»å…¥BçŸ©é˜µçš„2å—ï¼Œå°†è¯»å–åˆ°çš„BçŸ©é˜µæŒ‰è¡Œç§»å…¥BçŸ©é˜µçš„3å—ï¼ˆä¸¤æ¬¡è¯»å–åç›´æ¥è¿›è¡Œç§»å…¥ï¼‰\n![23](https://d-sketon.top/img/csapp-cachelab/23.png){width=\"500\"}\n- 3.å¯¹AçŸ©é˜µçš„4å—ä¸€æ¬¡æ€§è¯»å–ä¸¤è¡Œï¼Œå¹¶æŒ‰åˆ—ç§»å…¥BçŸ©é˜µçš„4å—ä¸­\n![24](https://d-sketon.top/img/csapp-cachelab/24.png){width=\"500\"}\n- ä»£ç ï¼š\n![25](https://d-sketon.top/img/csapp-cachelab/25.png)\n- ç»è¿‡æµ‹è¯•ï¼Œè¯¥æ–¹æ³•å¯¹äº64\\*64çŸ©é˜µè½¬ç½®æœªå‘½ä¸­ä¸º1160ï¼Œå·²è¾¾åˆ°æ»¡åˆ†æ ‡å‡†\n![26](https://d-sketon.top/img/csapp-cachelab/26.png)\n##### å‘½ä¸­ç‡åˆ†æ\n- **Aï¼šï¼ˆ552ï¼Œ13.48%æœªå‘½ä¸­ç‡ï¼‰**\n![34](https://d-sketon.top/img/csapp-cachelab/34.png){width=\"500\"}\n- **Bï¼šï¼ˆ608ï¼Œ14.84%æœªå‘½ä¸­ç‡ï¼‰**\n![35](https://d-sketon.top/img/csapp-cachelab/35.png){width=\"500\"}\n- å¯¹äºå¯¹è§’å—ï¼š\n    - ç¬¬ä¸€æ­¥å¯¹AçŸ©é˜µçš„1,2å—ä¸€æ¬¡æ€§è¯»å–ä¸€è¡Œ8ä¸ªå…ƒç´ ï¼ŒAçŸ©é˜µçš„1,2å—çš„æœªå‘½ä¸­ç‡é™ä½ä¸º12.5%ï¼ˆæœ¬æ¥ä¸º25%ï¼‰ï¼Œç”±äºå……åˆ†ä½¿ç”¨äº†ç¼“å­˜å—ï¼Œæå‡äº†AçŸ©é˜µå‘½ä¸­ç‡\n    - å¯¹äºBçŸ©é˜µæŒ‰åˆ—ç§»å…¥1,2å—ï¼Œåœ¨é¦–æ¬¡å†™å…¥1å—çš„ç¬¬ä¸€åˆ—æ—¶å†·ä¸å‘½ä¸­ï¼ŒåŒæ—¶ç¼“å­˜è¢«å†™å…¥ç›¸å¯¹åº”è¡Œä¸­å…ƒç´ ï¼Œæ‰€ä»¥2å—æ‰€æœ‰å…ƒç´ åœ¨è¿™ä¸€æ­¥ä¸­ä¼šå…¨éƒ¨å‘½ä¸­ï¼Œè€Œä»…ä»…ä¼šåœ¨1å—çš„å¯¹è§’çº¿ä¸Šå‘ç”Ÿå†²çªä¸å‘½ä¸­\n    - ç¬¬äºŒæ­¥å…ˆå¯¹AçŸ©é˜µçš„3å—æŒ‰åˆ—è¯»å–ï¼Œå¯¹BçŸ©é˜µçš„2å—æŒ‰è¡Œè¯»å–\n    - AçŸ©é˜µé¦–æ¬¡è¯»å–3å—ç¬¬ä¸€åˆ—å‘ç”Ÿå†²çªä¸å‘½ä¸­ï¼Œè€Œåœ¨ä¹‹åçš„çš„è¯»å–ä¸­å¯¹è§’çº¿ä¸Šå…ƒç´ ä¼šå’ŒBçŸ©é˜µå‘ç”Ÿå†²çªä¸å‘½ä¸­ï¼Œè€Œå¯¹äºBçŸ©é˜µï¼Œç”±äºæŒ‰è¡Œè¿›è¡Œè¯»å–ï¼Œæ‰€ä»¥å†²çªä¸å‘½ä¸­ä»…ä»…å‘ç”Ÿåœ¨2å—çš„ç¬¬ä¸€åˆ—ä¸Š\n    - å°†è¯»å–åˆ°çš„AçŸ©é˜µæŒ‰è¡Œç§»å…¥BçŸ©é˜µçš„2å—ï¼Œå°†è¯»å–åˆ°çš„BçŸ©é˜µæŒ‰è¡Œç§»å…¥BçŸ©é˜µçš„3å—ï¼ˆæ³¨æ„è¡Œåˆ—é¡ºåºï¼‰\n    - ç”±äºä¹‹å‰åœ¨è¯»å–æ—¶å·²æŒ‰è¡Œå°†BçŸ©é˜µå­˜å…¥ç¼“å­˜ä¸­ï¼Œæ‰€ä»¥BçŸ©é˜µ2å—ä¸Šä¼šå…¨éƒ¨å‘½ä¸­ï¼Œè€Œä»…ä»…åœ¨ç§»å…¥3å—æ—¶åœ¨æ¯ä¸€åˆ—ä¸Šå‘ç”Ÿå†²çªä¸å‘½ä¸­\n    - ç¬¬ä¸‰æ­¥å¯¹AçŸ©é˜µçš„4å—ä¸€æ¬¡æ€§è¯»å–ä¸¤è¡Œï¼Œå¹¶æŒ‰åˆ—ç§»å…¥BçŸ©é˜µçš„4å—ä¸­\n    - å’Œä¹‹å‰4\\*4åˆ†å—ç±»ä¼¼ï¼Œä½†é€‰æ‹©ä¸€æ¬¡æ€§è¯»å…¥ä¸¤è¡Œç›¸æ¯”äºä¸€æ¬¡æ€§è¯»å–ä¸€è¡Œèƒ½å°å¹…æå‡å‘½ä¸­ç‡\n- å¯¹äºéå¯¹è§’å—ï¼š\n    - ä¸‰æ­¥æ“ä½œéƒ½ä»…ä»…ä¼šåœ¨4ä¸ªå°å—çš„ç¬¬ä¸€åˆ—ä¸Šå‘ç”Ÿå†²çªä¸å‘½ä¸­ï¼Œæœªå‘½ä¸­ç‡å‡ä¸º12.5%ï¼Œå¯¹äºBçŸ©é˜µæ¥è¯´å‘½ä¸­ç‡å¤§å¤§æå‡\n### 61\\*67\n- ç”±äº61å’Œ67éƒ½æ˜¯ç´ æ•°ï¼Œæ— æ³•è¢«8æ•´é™¤ï¼Œæ‰€ä»¥åœ¨ç¼“å­˜ä¸­ä¼šå‘ç”Ÿé”™ä½ç°è±¡ï¼Œå¦‚å›¾æ‰€ç¤º\n![27](https://d-sketon.top/img/csapp-cachelab/27.png){width=\"500\"}\nï¼ˆAçŸ©é˜µ67\\*61éƒ¨åˆ†ç¼“å­˜æ˜ å°„å…³ç³»ï¼‰\n- çŸ©é˜µä¸æ˜¯æ­£æ–¹å½¢ï¼ŒAçŸ©é˜µå’ŒBçŸ©é˜µçš„è¡Œæ•°å’Œåˆ—æ•°å¹¶ä¸ç›¸ç­‰ï¼Œæ‰€ä»¥ç›´æ¥åˆ†æç›¸æ¯”äºä¹‹å‰ä¼šéå¸¸å›°éš¾ï¼Œä¸”æ•ˆç‡ä¹Ÿä¸é«˜ï¼Œæ‰€ä»¥æœ¬æƒ…å†µä¸å†è¯¦ç»†åˆ†æ\n- ç”±äºå†²çªä¸å‘½ä¸­çš„æ¦‚ç‡ç›¸æ¯”äº64\\*64ä¼šä¸‹é™ï¼Œæ‰€ä»¥å—çš„å¤§å°å¯ä»¥é€‚å½“åŠ å¤§ï¼Œæ­¤å¤–å¯¹äºä¸èƒ½åˆ†å—çš„åŒºåŸŸéœ€è¦åˆ†å¼€å¤„ç†\n#### ç¬¬ä¸€æ¬¡ä¼˜åŒ–\n- é¦–å…ˆè€ƒè™‘å’Œ64\\*64çŸ©é˜µä¸€æ ·çš„è½¬ç½®æ–¹æ³•ï¼š\nå°†61\\*67çš„56\\*64éƒ¨åˆ†é‡‡ç”¨å’Œä¹‹å‰ä¸€æ ·çš„æ–¹æ³•ï¼Œè€Œå¯¹äºå‰©ä¸‹çš„éƒ¨åˆ†é‡‡ç”¨æœ€åŸå§‹çš„ç›´æ¥è½¬ç½®æ³•ï¼š\n![28](https://d-sketon.top/img/csapp-cachelab/28.png)\n- ç»æµ‹è¯•ï¼Œæœªå‘½ä¸­ä¸º2058ï¼Œå·²ç»éå¸¸æ¥è¿‘2000ï¼š\n![29](https://d-sketon.top/img/csapp-cachelab/29.png)\n- å‰©ä¸‹çš„çŸ©é˜µè€ƒè™‘åˆ†æˆ3å¤§éƒ¨åˆ†ï¼š\n- ç¬¬ä¸€éƒ¨åˆ†ï¼ˆA\\[64]\\[0]~A\\[67]\\[59]ï¼‰\n- åˆ†æˆ3\\*6çš„å—ï¼Œæ¯æ¬¡ä¸€æ¬¡æ€§è¯»å–ä¸€è¡Œè¿›è¡Œè½¬ç½®\n- ç¬¬äºŒéƒ¨åˆ†ï¼ˆA\\[0]\\[56]~A\\[63]\\[59]ï¼‰\n- ä¸€æ¬¡æ€§è¯»å–ä¸€è¡Œè¿›è¡Œè½¬ç½®\n- ç¬¬ä¸‰éƒ¨åˆ†ï¼ˆA\\[64]\\[60]~A\\[66]\\[60]ï¼‰\n- ç›´æ¥è½¬ç½®\n- å‰©ä¸‹éƒ¨åˆ†çš„ä»£ç ï¼šï¼ˆä¸å®Œæ•´ï¼‰\n![30](https://d-sketon.top/img/csapp-cachelab/30.png)\n- ç»æµ‹è¯•ï¼Œæœªå‘½ä¸­ä¸º1971ï¼Œå·²è¾¾åˆ°äº†æ»¡åˆ†æ ‡å‡†ï¼Œä½†è¿˜æœ‰ä¼˜åŒ–ç©ºé—´\n![31](https://d-sketon.top/img/csapp-cachelab/31.png)\n#### ç¬¬äºŒæ¬¡ä¼˜åŒ–\n- ç»è¿‡æµ‹è¯•ï¼Œå‘ç°å­˜åœ¨æ›´ä¼˜è§£ï¼š\n- å°†61\\*67çš„60\\*60éƒ¨åˆ†åˆ†æˆ20\\*4çš„å—ï¼Œæ¯æ¬¡ä¸€æ¬¡æ€§è¯»å–ä¸¤è¡Œ\n- å‰©ä¸‹çš„çŸ©é˜µè€ƒè™‘åˆ†æˆ2å¤§éƒ¨åˆ†ï¼š\n- ç¬¬ä¸€éƒ¨åˆ†ï¼ˆA\\[0]\\[60]~A\\[66]\\[60]ï¼‰\n- ç›´æ¥è½¬ç½®\n- ç¬¬äºŒéƒ¨åˆ†ï¼ˆA\\[60]\\[0]~A\\[66]\\[59]ï¼‰\n- ä¸€æ¬¡æ€§è¯»å–ä¸€åˆ—è¿›è¡Œè½¬ç½®ï¼ˆéæŒ‰è¡Œè¯»å–ï¼‰\n- ä»£ç ï¼š\n![32](https://d-sketon.top/img/csapp-cachelab/32.png)\n- ç»æµ‹è¯•ï¼Œæœªå‘½ä¸­ä¸º1750ï¼Œæœ‰äº†è¾ƒå¤§å¹…åº¦çš„ä¼˜åŒ–ï¼ŒåŒæ—¶ä»£ç å¤æ‚åº¦ä¹Ÿå¤§å¤§ä¸‹é™\n![33](https://d-sketon.top/img/csapp-cachelab/33.png)\n### å®Œæ•´ä»£ç \n```c\nvoid transpose_submit(int M, int N, int A[N][M], int B[M][N])\n{\n    int i, j, ii;\n    int x0, x1, x2, x3, x4, x5, x6, x7;\n    if (M == 32) //32x32çŸ©é˜µ\n    {\n        for (i = 0; i < 32; i += 8) \n            for (j = 0; j < 32; j += 8)     //8x8åˆ†å—\n                for (ii = i; ii < i + 8; ii++)\n                {\n                    x0 = A[ii][j];      x1 = A[ii][j + 1];\n                    x2 = A[ii][j + 2];  x3 = A[ii][j + 3];\n                    x4 = A[ii][j + 4];  x5 = A[ii][j + 5];\n                    x6 = A[ii][j + 6];  x7 = A[ii][j + 7];  //æ¯æ¬¡ä¸€æ¬¡æ€§è¯»å–ä¸€è¡Œï¼Œå­˜å…¥x0~x7\n                    B[j][ii] = x0;      B[j + 1][ii] = x1;\n                    B[j + 2][ii] = x2;  B[j + 3][ii] = x3;\n                    B[j + 4][ii] = x4;  B[j + 5][ii] = x5;\n                    B[j + 6][ii] = x6;  B[j + 7][ii] = x7;  //ç§»å…¥BçŸ©é˜µ\n                }\n    }\n    else if (M == 64) //64x64çŸ©é˜µ\n    {\n        for (i = 0; i < 64; i += 8)\n            for (j = 0; j < 64; j += 8) //å…ˆ8x8åˆ†å—\n            {\n                //8x8å¤§å—ä¸­è¿›è¡Œ3æ­¥æ“ä½œ\n                for (ii = i; ii < i + 4; ii++)  //AçŸ©é˜µçš„1,2å—\n                {\n                    x0 = A[ii][j];      x1 = A[ii][j + 1];\n                    x2 = A[ii][j + 2];  x3 = A[ii][j + 3];\n                    x4 = A[ii][j + 4];  x5 = A[ii][j + 5];\n                    x6 = A[ii][j + 6];  x7 = A[ii][j + 7];  //ä¸€æ¬¡æ€§è¯»å–ä¸€è¡Œï¼Œå­˜å…¥x0~x7\n                    B[j][ii] = x0;      B[j + 1][ii] = x1;\n                    B[j + 2][ii] = x2;  B[j + 3][ii] = x3;  //æŒ‰åˆ—ç§»å…¥BçŸ©é˜µ1å—\n                    B[j][ii + 4] = x4;  B[j + 1][ii + 4] = x5;\n                    B[j + 2][ii + 4] = x6;  B[j + 3][ii + 4] = x7;  //æŒ‰åˆ—ç§»å…¥BçŸ©é˜µ2å—\n                }\n                for (ii = j; ii < j + 4; ii++)  //AçŸ©é˜µçš„3å—å’ŒBçŸ©é˜µçš„2å—\n                {\n                    x0 = A[i + 4][ii];  x1 = A[i + 5][ii];\n                    x2 = A[i + 6][ii];  x3 = A[i + 7][ii];  //æŒ‰åˆ—è¯»å–AçŸ©é˜µ3å—\n                    x4 = B[ii][i + 4];  x5 = B[ii][i + 5];\n                    x6 = B[ii][i + 6];  x7 = B[ii][i + 7];  //æŒ‰è¡Œè¯»å–BçŸ©é˜µ2å—\n                    B[ii][i + 4] = x0;  B[ii][i + 5] = x1;\n                    B[ii][i + 6] = x2;  B[ii][i + 7] = x3;  //æŒ‰è¡Œç§»å…¥BçŸ©é˜µ2å—\n                    B[ii + 4][i] = x4;  B[ii + 4][i + 1] = x5;\n                    B[ii + 4][i + 2] = x6;  B[ii + 4][i + 3] = x7;  //æŒ‰è¡Œç§»å…¥BçŸ©é˜µ3å—\n                }\n                for (ii = i + 4; ii < i + 8; ii += 2)   //AçŸ©é˜µçš„4å—\n                {\n                    x0 = A[ii][j + 4];      x1 = A[ii][j + 5];\n                    x2 = A[ii][j + 6];      x3 = A[ii][j + 7];\n                    x4 = A[ii + 1][j + 4];  x5 = A[ii + 1][j + 5];\n                    x6 = A[ii + 1][j + 6];  x7 = A[ii + 1][j + 7];  //ä¸€æ¬¡æ€§è¯»å–ä¸¤è¡Œï¼Œå­˜å…¥x0~x7\n                    B[j + 4][ii] = x0;      B[j + 5][ii] = x1;\n                    B[j + 6][ii] = x2;      B[j + 7][ii] = x3;\n                    B[j + 4][ii + 1] = x4;  B[j + 5][ii + 1] = x5;\n                    B[j + 6][ii + 1] = x6;  B[j + 7][ii + 1] = x7;  //ç§»å…¥BçŸ©é˜µ\n                }\n            }\n    }\n    else //61x67çŸ©é˜µ\n    {\n        //ä»¥ä¸‹ä¸º1750missæ–¹æ³•\n        for (i = 0; i < 60; i += 20)\n            for (j = 0; j < 60; j += 4) //60x60éƒ¨åˆ†è¿›è¡Œ20x4åˆ†å—\n                for (ii = i; ii < i + 20; ii += 2)  \n                {\n                    x0 = A[ii][j];          x1 = A[ii][j + 1];\n                    x2 = A[ii][j + 2];      x3 = A[ii][j + 3];\n                    x4 = A[ii + 1][j];      x5 = A[ii + 1][j + 1];\n                    x6 = A[ii + 1][j + 2];  x7 = A[ii + 1][j + 3];  //ä¸€æ¬¡æ€§è¯»å–ä¸¤è¡Œï¼Œå­˜å…¥x0~x7\n                    B[j][ii] = x0;          B[j + 1][ii] = x1;\n                    B[j + 2][ii] = x2;      B[j + 3][ii] = x3;\n                    B[j][ii + 1] = x4;      B[j + 1][ii + 1] = x5;\n                    B[j + 2][ii + 1] = x6;  B[j + 3][ii + 1] = x7;  //ç§»å…¥BçŸ©é˜µ\n                }\n        for (i = 0; i < 67; i++)    //A[0][60]~A[66][60]éƒ¨åˆ†ç›´æ¥è½¬ç½®\n            B[60][i] = A[i][60];    \n        for (i = 0; i < 60; i++)    //A[60][0]~A[66][59]éƒ¨åˆ†\n        {\n            x0=A[60][i];    x1=A[61][i];\n            x2=A[62][i];    x3=A[63][i];\n            x4=A[64][i];    x5=A[65][i];\n            x6=A[66][i];    //ä¸€æ¬¡æ€§è¯»å–ä¸€åˆ—ï¼Œå­˜å…¥x0~x6\n            B[i][60]=x0;    B[i][61]=x1;\n            B[i][62]=x2;    B[i][63]=x3;\n            B[i][64]=x4;    B[i][65]=x5;\n            B[i][66]=x6;    //ç§»å…¥BçŸ©é˜µ\n        }\n        /*\n        //ä»¥ä¸‹ä¸º1971missæ–¹æ³•\n        for (i = 0; i < 64; i += 8)\n            for (j = 0; j < 56; j += 8) //64x56éƒ¨åˆ†è¿›è¡Œ8x8åˆ†å—\n            {\n                for (ii = i; ii < i + 4; ii++)  //ä»¥ä¸‹æ–¹æ³•åŒ64x64\n                {\n                    x0 = A[ii][j];      x1 = A[ii][j + 1];\n                    x2 = A[ii][j + 2];  x3 = A[ii][j + 3];\n                    x4 = A[ii][j + 4];  x5 = A[ii][j + 5];\n                    x6 = A[ii][j + 6];  x7 = A[ii][j + 7];\n                    B[j][ii] = x0;      B[j + 1][ii] = x1;\n                    B[j + 2][ii] = x2;  B[j + 3][ii] = x3;\n                    B[j][ii + 4] = x4;  B[j + 1][ii + 4] = x5;\n                    B[j + 2][ii + 4] = x6;  B[j + 3][ii + 4] = x7;\n                }\n                for (ii = j; ii < j + 4; ii++)\n                {\n                    x0 = A[i + 4][ii];  x1 = A[i + 5][ii];\n                    x2 = A[i + 6][ii];  x3 = A[i + 7][ii];\n                    x4 = B[ii][i + 4];  x5 = B[ii][i + 5];\n                    x6 = B[ii][i + 6];  x7 = B[ii][i + 7];\n                    B[ii][i + 4] = x0;  B[ii][i + 5] = x1;\n                    B[ii][i + 6] = x2;  B[ii][i + 7] = x3;\n                    B[ii + 4][i] = x4;  B[ii + 4][i + 1] = x5;\n                    B[ii + 4][i + 2] = x6;  B[ii + 4][i + 3] = x7;\n                }\n                for (ii = i + 4; ii < i + 8; ii += 2)\n                {\n                    x0 = A[ii][j + 4];      x1 = A[ii][j + 5];\n                    x2 = A[ii][j + 6];      x3 = A[ii][j + 7];\n                    x4 = A[ii + 1][j + 4];  x5 = A[ii + 1][j + 5];\n                    x6 = A[ii + 1][j + 6];  x7 = A[ii + 1][j + 7];\n                    B[j + 4][ii] = x0;      B[j + 5][ii] = x1;\n                    B[j + 6][ii] = x2;      B[j + 7][ii] = x3;\n                    B[j + 4][ii + 1] = x4;  B[j + 5][ii + 1] = x5;\n                    B[j + 6][ii + 1] = x6;  B[j + 7][ii + 1] = x7;\n                }\n            }   \n        for (j = 0; j < 60; j += 6)\n            for (ii = 64; ii < 67; ii++)    //A[64][0]~A[67][59]éƒ¨åˆ†è¿›è¡Œ3x6åˆ†å—\n            {\n                x0 = A[ii][j];      x1 = A[ii][j + 1];\n                x2 = A[ii][j + 2];  x3 = A[ii][j + 3];\n                x4 = A[ii][j + 4];  x5 = A[ii][j + 5];  //ä¸€æ¬¡æ€§è¯»å–ä¸€è¡Œ\n                B[j][ii] = x0;      B[j + 1][ii] = x1;\n                B[j + 2][ii] = x2;  B[j + 3][ii] = x3;\n                B[j + 4][ii] = x4;  B[j + 5][ii] = x5;\n            }\n        for (i = 0; i < 64; i ++)   //A[0][56]~A[63][59]éƒ¨åˆ†\n        {\n            x0 = A[i][56]; x1 = A[i][57];\n            x2 = A[i][58]; x3 = A[i][59];   //ä¸€æ¬¡æ€§è¯»å–ä¸€è¡Œ\n            x4 = A[i][60]; B[56][i] = x0;\n            B[57][i] = x1; B[58][i] = x2;\n            B[59][i] = x3; B[60][i] = x4;\n        }     \n        B[60][64] = A[64][60];  //å‰©ä½™ç›´æ¥è½¬ç½®\n        B[60][65] = A[65][60];\n        B[60][66] = A[66][60];\n        */\n    }\n}\n```","tags":["CSAPP","æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿ"],"categories":["è®¡è½¯æ‚è°ˆ"]},{"title":"jQueryå­¦ä¹ ç¬”è®°","url":"/20211009/jquery-note/","content":"## **jQueryè¯­æ³•**\n- åŸºæœ¬è¯­æ³•ï¼š`$(selector).action()`\n- `$`ç¬¦å·ï¼šå®šä¹‰ jQuery\n- `(selector)` ï¼šæŸ¥æ‰¾HTML å…ƒç´ \n- `action()` ï¼šå¯¹å…ƒç´ è¿›è¡Œæ“ä½œ\n- å…¥å£å‡½æ•°\n```js\n$(document).ready(function(){\n//...\n});\n\n//å¯ç®€å†™ä¸º\n$(function(){\n//...\n};\n```\n\n## **jQueryé€‰æ‹©å™¨**\n- å…ƒç´ é€‰æ‹©å™¨\n    - `$(\"p\")` é€‰å– \\<p> å…ƒç´ \n    - `$(\"p.intro\")` é€‰å–æ‰€æœ‰ class=\"intro\" çš„ \\<p> å…ƒç´ \n    - `$(\"p#demo\")` é€‰å–æ‰€æœ‰ id=\"demo\" çš„ \\<p> å…ƒç´ \n- å±æ€§é€‰æ‹©å™¨\n    - `$(\"[attri]\")` é€‰å–æ‰€æœ‰å«æœ‰ attri å±æ€§çš„å…ƒç´ \n    - `$(\"[attri='value']\")` é€‰å–æ‰€æœ‰å«æœ‰ attri å€¼ç­‰äº \"value\" çš„å…ƒç´ \n    - `$(\"[attri!='value']\")` é€‰å–æ‰€æœ‰å«æœ‰ attri å€¼ä¸ç­‰äº \"value\" çš„å…ƒç´ \n    - `$(\"[attri^='value']\")` é€‰å–æ‰€æœ‰ attri å€¼ä»¥ \"value\" å¼€å¤´çš„å…ƒç´ \n    - `$(\"[attri$='value']\")` é€‰å–æ‰€æœ‰ attri å€¼ä»¥ \"value\" ç»“å°¾çš„å…ƒç´ \n    - `$(\"[attri*='value']\")` é€‰å–æ‰€æœ‰ attri å€¼åŒ…å« \"value\" çš„å…ƒç´ \n\n## **jQueryæ•ˆæœ**\n### éšè—å’Œæ˜¾ç¤º\n- `hide()`  éšè—\n- `show()`  æ˜¾ç¤º\n- `toogle()`  hideå’Œshowåˆ‡æ¢\n```js\n$(selector).hide([duration],[complete]);\n\n$(selector).show([duration],[complete]);\n\n$(selector).toggle([duration],[complete]);\n```\n- duration è§„å®šåŠ¨ç”»é€Ÿåº¦ï¼Œé»˜è®¤400ms\n- complete è§„å®šå›è°ƒå‡½æ•°\n### æ·¡å…¥æ·¡å‡º\n- `fadeIn()`  æ·¡å…¥å·²éšè—çš„å…ƒç´ \n- `fadeOut()`  æ·¡å‡ºå¯è§å…ƒç´ \n- `fadeToggle()`  fadeInå’ŒfadeOutåˆ‡æ¢\n- `fadeTo()`  æ¸å˜ä¸ºç»™å®šçš„ä¸é€æ˜åº¦\n```js\n$(selector).fadeIn([duration],[complete]);\n\n$(selector).fadeOut([duration],[complete]);\n\n$(selector).fadeToggle([duration],[complete]);\n\n$(selector).fadeTo(duration,opacity,[complete]);\n```\n- duration è§„å®šåŠ¨ç”»é€Ÿåº¦\n- complete è§„å®šå›è°ƒå‡½æ•°\n### æ»‘åŠ¨\n- `slideDown()`  å‘ä¸‹æ»‘åŠ¨\n- `slideUp()`  å‘ä¸Šæ»‘åŠ¨\n- `slideToggle()`  slideDownå’Œslideupåˆ‡æ¢\n```js\n$(selector).slideDown([duration],[complete]);\n\n$(selector).slideUp([duration],[complete]);\n\n$(selector).slideToggle([duration],[complete]);\n```\n- duration è§„å®šåŠ¨ç”»é€Ÿåº¦\n- complete è§„å®šå›è°ƒå‡½æ•°\n### åŠ¨ç”»\n- `animate()`  è®¾ç½®CSSåŠ¨ç”»\n```js\n$(selector).animate(properties,[duration],[easing],[complete]);\n\n//ä¾‹å­\n$(\"button\").click(function(){\n  $(\"div\").animate({\n    left:'250px',\n    opacity:'0.5',\n  },1000);\n}); \n```\n- properties å®šä¹‰å½¢æˆåŠ¨ç”»çš„CSSå±æ€§ï¼Œå¤šä¸ªå±æ€§ç”¨å¯¹è±¡è¡¨ç¤º\n- duration è§„å®šåŠ¨ç”»é€Ÿåº¦\n- easing è§„å®šç¼“åŠ¨å‡½æ•°\n- complete è§„å®šå›è°ƒå‡½æ•°\n\n> æ³¨æ„jQueryå…è®¸é“¾å¼ç¼–ç¨‹\n> ```js\n> $(\"#p1\").css(\"color\",\"red\").slideUp(2000).slideDown(2000);\n> ```\n\n\n## **jQuery HTML**\n### è·å–&&è®¾ç½®\n- `text()`  è®¾ç½®æˆ–è¿”å›æ‰€é€‰å…ƒç´ çš„æ–‡æœ¬å†…å®¹\n- `html()`  è®¾ç½®æˆ–è¿”å›æ‰€é€‰å…ƒç´ çš„å†…å®¹ï¼ˆåŒ…æ‹¬ HTML æ ‡è®°ï¼‰\n- `val()`  è®¾ç½®æˆ–è¿”å›è¡¨å•å­—æ®µçš„å€¼\n- `attr()`  è®¾ç½®æˆ–è¿”å›æ‰€é€‰å…ƒç´ çš„å±æ€§\n```js\n$(selector).text(content);\n\n$(selector).html(html);\n\n$(selector).val(value);\n\n$(selector).attr(attributeName,value);\n```\n\n> æ³¨æ„text()ã€html() ä»¥åŠ val()æ‹¥æœ‰å›è°ƒå‡½æ•°ï¼Œå›è°ƒå‡½æ•°çš„ä¸¤ä¸ªå‚æ•°ä¸ºè¢«é€‰å…ƒç´ åˆ—è¡¨ä¸­å½“å‰å…ƒç´ çš„ä¸‹æ ‡ï¼Œä»¥åŠåŸå§‹å€¼ï¼Œå‡½æ•°è¿”å›å€¼ä¸ºæ–°å€¼\n> ```js\n> $(\"#test\").text(function(i,origText){\n>   return \"Old text: \" + origText + \" New text: Hello world!\n>   (index: \" + i + \")\";\n> });\n> ```\n\n### æ·»åŠ \n- `append()` åœ¨è¢«é€‰å…ƒç´ çš„ç»“å°¾æ’å…¥å†…å®¹\n- `prepend()` åœ¨è¢«é€‰å…ƒç´ çš„å¼€å¤´æ’å…¥å†…å®¹\n- `after()` åœ¨è¢«é€‰å…ƒç´ ä¹‹åæ’å…¥å†…å®¹\n- `before()` åœ¨è¢«é€‰å…ƒç´ ä¹‹å‰æ’å…¥å†…å®¹\n```js\n$(selector).append(content,[content]);\n\n$(selector).prepend(content,[content]);\n\n$(selector).after(content,[content]);\n\n$(selector).before(content,[content]);\n```\n### åˆ é™¤\n- `remove()` åˆ é™¤è¢«é€‰å…ƒç´ ï¼ˆåŠå­å…ƒç´ ï¼‰\n- `empty()` ä»è¢«é€‰å…ƒç´ ä¸­åˆ é™¤å­å…ƒç´ \n```js\n$(selector).remove();\n\n$(selector).empty()\n```\n- å¯ä»¥å¯¹å…ƒç´ è¿›è¡Œè¿‡æ»¤åˆ é™¤\n```js\n//åˆ é™¤class=\"del\"çš„æ‰€æœ‰<p>å…ƒç´ \n$(\"p\").remove(\".del\");\n```\n###  è·å–å¹¶è®¾ç½® CSS\n- `addClass()`  å‘è¢«é€‰å…ƒç´ æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªç±»\n- `removeClass()`  ä»è¢«é€‰å…ƒç´ åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªç±»\n- `toggleClass()`  addClasså’ŒremoveClassåˆ‡æ¢\n- `css()`  è®¾ç½®æˆ–è¿”å›æ ·å¼å±æ€§\n```js\n$(selector).addClass(className(s));\n\n$(selector).removeClass(className(s));\n\n$(selector).toggleClass(className(s));\n\n//è¿”å›æ ·å¼å±æ€§\n$(selector).css(propertyName(s));\n\n//è®¾ç½®æ ·å¼å±æ€§\n$(selector).css(propertyName,value);\n```\n- å¦‚éœ€è®¾ç½®å¤šä¸ªæ ·å¼å±æ€§ï¼Œéœ€è¦å†™æˆå¯¹è±¡å½¢å¼\n```js\n$(selector).css({\"propertyName\":\"value\",\"propertyName\":\"value\",...});\n```\n## **jQueryéå†**\n### DOMå‘ä¸Šéå†\n- `parent()`  è¿”å›è¢«é€‰å…ƒç´ çš„ç›´æ¥çˆ¶å…ƒç´ \n- `parents()`  è¿”å›è¢«é€‰å…ƒç´ çš„æ‰€æœ‰ç¥–å…ˆå…ƒç´ \n- `parentsUntil()` è¿”å›ä»‹äºä¸¤ä¸ªç»™å®šå…ƒç´ ä¹‹é—´çš„æ‰€æœ‰ç¥–å…ˆå…ƒç´ \n```js\n$(selector).parent([filter]);\n\n$(selector).parents([filter]);\n\n$(selector).parentsUntil([selector],[filter]);\n```\n- selector  ç»™å®šå…ƒç´ ï¼Œç¡®å®šæŸ¥æ‰¾èŒƒå›´ï¼ˆå¯¹äºparentsUntilï¼‰\n- filter  å…ƒç´ ç­›é€‰\n### DOMå‘ä¸‹éå†\n- `children()`  è¿”å›è¢«é€‰å…ƒç´ çš„æ‰€æœ‰**ç›´æ¥**å­å…ƒç´ \n- `find()`  è¿”å›è¢«é€‰å…ƒç´ çš„åä»£å…ƒç´ ï¼Œä¸€è·¯å‘ä¸‹ç›´åˆ°æœ€åä¸€ä¸ªåä»£\n```js\n$(selector).children([filter]);\n\n$(selector).find(filter);\n\ne,g\n//è¿”å›<div>åä»£çš„æ‰€æœ‰<span>å…ƒç´ \n$(\"div\").find(\"span\");\n\n//è¿”å›<div>çš„æ‰€æœ‰åä»£\n$(\"div\").find(\"*\");\n```\n- filter  å…ƒç´ ç­›é€‰\n### DOMæ°´å¹³éå†\n- `siblings()`  è¿”å›è¢«é€‰å…ƒç´ çš„æ‰€æœ‰åŒèƒå…ƒç´ \n- `next()`  è¿”å›è¢«é€‰å…ƒç´ çš„ä¸‹ä¸€ä¸ªåŒèƒå…ƒç´ \n- `nextAll()`  è¿”å›è¢«é€‰å…ƒç´ çš„æ‰€æœ‰è·Ÿéšçš„åŒèƒå…ƒç´ \n- `nextUntil()`  è¿”å›ä»‹äºä¸¤ä¸ªç»™å®šå‚æ•°ä¹‹é—´çš„æ‰€æœ‰è·Ÿéšçš„åŒèƒå…ƒç´ \n- `prev()`\n- `prevAll()`\n- `prevUntil()`\n```js\n$(selector).siblings([filter]);\n\n$(selector).next([filter]);\n\n$(selector).nextAll([filter]);\n\n$(selector).nextUntil([selector],[filter]);\n```\n- selector  ç»™å®šå…ƒç´ ï¼Œç¡®å®šæŸ¥æ‰¾èŒƒå›´\n- filter  å…ƒç´ ç­›é€‰\n### è¿‡æ»¤\n- `first()`  è¿”å›è¢«é€‰å…ƒç´ çš„é¦–ä¸ªå…ƒç´ \n- `last()`  è¿”å›è¢«é€‰å…ƒç´ çš„æœ€åä¸€ä¸ªå…ƒç´ \n- `eq()`  è¿”å›è¢«é€‰å…ƒç´ ä¸­å¸¦æœ‰æŒ‡å®šç´¢å¼•å·çš„å…ƒç´ \n```js\n$(selector).first()\n\n$(selector).last()\n\n$(selector).eq(index)\n```\n## **jQuery AJAX**\n### LOAD\n- `load()` ä»æœåŠ¡å™¨åŠ è½½æ•°æ®ï¼Œå¹¶æŠŠè¿”å›çš„æ•°æ®æ”¾å…¥è¢«é€‰å…ƒç´ ä¸­\n```js\n$(selector).load(url,[data],[complete])\n```\n- url  åŠ è½½çš„ URL\n- data  ä¸è¯·æ±‚ä¸€åŒå‘é€çš„æŸ¥è¯¢å­—ç¬¦ä¸²é”®/å€¼å¯¹é›†åˆ\n- complete  å›è°ƒå‡½æ•°\n### GET&&POST\n- GET  ä»æŒ‡å®šçš„èµ„æºè¯·æ±‚æ•°æ®\n- POST  å‘æŒ‡å®šçš„èµ„æºæäº¤è¦å¤„ç†çš„æ•°æ®\n- `$.get()`  é€šè¿‡ HTTP GET è¯·æ±‚ä»æœåŠ¡å™¨ä¸Šè¯·æ±‚æ•°æ®\n- `$.post()` é€šè¿‡ HTTP POST è¯·æ±‚ä»æœåŠ¡å™¨ä¸Šè¯·æ±‚æ•°æ®\n```js\n$.get(url,complete);\n$.post(url,data,complete);\n```\n- url  åŠ è½½çš„ URL\n- data  è¿åŒè¯·æ±‚å‘é€çš„æ•°æ®\n- complete  å›è°ƒå‡½æ•°","tags":["å‰ç«¯","jQuery"],"categories":["å‰ç«¯","jQuery"]},{"title":"Vue.jså­¦ä¹ ç¬”è®°","url":"/20211008/vue-note/","content":"## **ç®€ä»‹**\n- Vue.jsæ˜¯ä¸€å¥—æ„å»ºç”¨æˆ·ç•Œé¢çš„æ¸è¿›å¼æ¡†æ¶\n- Vue åªå…³æ³¨è§†å›¾å±‚ï¼Œ é‡‡ç”¨è‡ªåº•å‘ä¸Šå¢é‡å¼€å‘çš„è®¾è®¡\n- Vue æ˜¯é€šè¿‡å°½å¯èƒ½ç®€å•çš„ API å®ç°å“åº”çš„æ•°æ®ç»‘å®šå’Œç»„åˆçš„è§†å›¾ç»„ä»¶\n\n## **Vueå®ä¾‹**\n- æ¯ä¸ª Vue åº”ç”¨éƒ½é€šè¿‡å®ä¾‹åŒ– Vue æ¥å®ç°\n- å˜é‡åvmæ˜¯å—åˆ°äº†MVVMæ¨¡å‹çš„å¯å‘\n- el å‚æ•°ç»‘å®šå¯¹åº”DOMå…ƒç´ \n- data å®šä¹‰å±æ€§\n- methods å®šä¹‰å‡½æ•°\n```js\nvar vm = new Vue({\n    el: '#app',\n    data: {\n        msg: 'test'\n    },\n    methods: {\n        handle() {\n            alert(\"alert\")\n        }\n    }\n})\n```\n\n## **æ’å€¼**\n#### æ–‡æœ¬æ’å€¼\n- {% raw %}{{...}}{% endraw %}ï¼ˆåŒå¤§æ‹¬å·ï¼‰\n```html\n<span>Message: {% raw %}{{ msg }}{% endraw %}</span>\n```\n- v-text æŒ‡ä»¤ï¼Œç”¨äºæ–‡æœ¬æ’å€¼\n```html\n<p v-text=\"msg\"><p>\n```\n\n```js\ndata: {\n    msg: 'hello'\n}\n```\n\n> v-textä¼šè¦†ç›–å…ƒç´ ä¸­åŸæœ¬çš„å†…å®¹ï¼Œ{% raw %}{{...}}{% endraw %}åªä¼šæ›¿æ¢è‡ªå·±çš„è¿™ä¸ªå ä½ç¬¦ï¼Œä¸ä¼šæŠŠæ•´ä¸ªå…ƒç´ å†…å®¹æ›¿æ¢\n\n#### HTMLæ’å€¼\n- v-html æŒ‡ä»¤ï¼Œç”¨äºHTMLæ’å€¼\n```html\n<span v-html=\"rawhtml\"></span>\n```\n```js\ndata: {\n    rawhtml: '<p>hello</p>'\n}\n```\n#### å±æ€§\n- v-bind æŒ‡ä»¤ï¼Œç”¨äºå±æ€§ç»‘å®š\n```html\n<button v-bind:disabled=\"isButtonDisabled\">Button</button>\n```\n```js\ndata: {\n    isButtonDisabled: true\n}\n```\n- v-bind ç¼©å†™\n```html\n<button :disabled=\"isButtonDisabled\">Button</button>\n```\n#### JSè¡¨è¾¾å¼\n- å¯¹äºæ‰€æœ‰çš„æ•°æ®ç»‘å®šï¼ŒVue.js éƒ½æä¾›äº†å®Œå…¨çš„ JavaScript è¡¨è¾¾å¼æ”¯æŒ\n```html\n{% raw %}{{number + 1}}{% endraw %}\n\n{% raw %}{{ok ? 'YES' : 'NO'}}{% endraw %}\n\n{% raw %}{{message.split('').reverse().join('')}}{% endraw %}\n```\n\n> æ³¨æ„JSè¡¨è¾¾å¼å’ŒJSè¯­å¥çš„åŒºåˆ«\n\n\n## **æŒ‡ä»¤**\n- v-bind æŒ‡ä»¤ï¼Œå¦‚å‰æ–‡æ‰€ç¤º\n- v-on æŒ‡ä»¤ï¼Œç”¨äºç›‘å¬ DOM äº‹ä»¶\n```html\n<a v-on:click=\"doSomething\">...</a>\n```\n```js\nmethods: {\n    doSomething() {\n        alert(\"alert\")\n    }\n}\n```\n- v-on ç¼©å†™\n```html\n<a @click=\"doSomething\">...</a>\n```\n- v-model æŒ‡ä»¤ï¼Œç”¨äºåœ¨è¡¨å•\\<input\\>ã€\\<textarea\\> åŠ \\<select\\> å…ƒç´ ä¸Šå®ç°åŒå‘æ•°æ®ç»‘å®š\n```html\n<input v-model=\"message\" placeholder=\"edit me\">\n<p>Message is: {% raw %}{{ message }}{% endraw %}</p>\n```\n- v-if æŒ‡ä»¤ï¼Œç”¨äºæ¡ä»¶æ¸²æŸ“\n```html\n<h1 v-if=\"awesome\">Vue is awesome!</h1>\n```\n```js\ndata: {\n    awesome: true\n}\n```\n- v-elseæŒ‡ä»¤ï¼Œç”¨äºè¡¨ç¤º v-if çš„â€œelse å—â€\n```html\n<div v-if=\"Math.random() > 0.5\">\n  Now you see me\n</div>\n<div v-else>\n  Now you don't\n</div>\n```\n- v-show æŒ‡ä»¤ï¼Œç”¨äºæ¡ä»¶æ¸²æŸ“\n```html\n<h1 v-show=\"ok\">Hello!</h1>\n```\n\n> v-ifå’Œv-showçš„åŒºåˆ«ï¼š\n> å¸¦æœ‰ v-show çš„å…ƒç´ å§‹ç»ˆä¼šè¢«æ¸²æŸ“å¹¶ä¿ç•™åœ¨ DOM ä¸­ã€‚v-show åªæ˜¯ç®€å•åœ°åˆ‡æ¢å…ƒç´ çš„displayæ ·å¼\n> å¦‚æœéœ€è¦éå¸¸é¢‘ç¹åœ°åˆ‡æ¢ï¼Œåˆ™ä½¿ç”¨ v-show è¾ƒå¥½ï¼›å¦‚æœåœ¨è¿è¡Œæ—¶æ¡ä»¶å¾ˆå°‘æ”¹å˜ï¼Œåˆ™ä½¿ç”¨ v-if è¾ƒå¥½\n\n- v-for æŒ‡ä»¤ï¼Œç”¨äºåˆ—è¡¨æ¸²æŸ“\n- v-for æŒ‡ä»¤éœ€è¦ä½¿ç”¨ item in items å½¢å¼çš„ç‰¹æ®Šè¯­æ³•ï¼Œå…¶ä¸­ items æ˜¯æºæ•°æ®æ•°ç»„ï¼Œè€Œ item åˆ™æ˜¯è¢«è¿­ä»£çš„æ•°ç»„å…ƒç´ çš„åˆ«å\n```html\n<ul id=\"example-1\">\n    <li v-for=\"item in items\">\n        {% raw %}{{ item.message }}{% endraw %}\n    </li>\n</ul>\n```\n```js\nnew Vue({\n    el: '#example-1',\n    data: {\n        items: [\n            { message: 'Foo' },\n            { message: 'Bar' }\n        ]\n    }\n})\n```\n- v-forä¹Ÿå¯ä»¥éå†ä¸€ä¸ªå¯¹è±¡çš„ property\n\n## **è®¡ç®—å±æ€§å’Œä¾¦å¬å™¨**\n### è®¡ç®—å±æ€§\n- è®¡ç®—å±æ€§ï¼Œé€šè¿‡computedæ¥å®ç°å¤æ‚é€»è¾‘è¿ç®—\n- è®¡ç®—å±æ€§æ˜¯åŸºäºå®ƒä»¬çš„å“åº”å¼ä¾èµ–è¿›è¡Œç¼“å­˜çš„ã€‚åªåœ¨ç›¸å…³å“åº”å¼ä¾èµ–å‘ç”Ÿæ”¹å˜æ—¶å®ƒä»¬æ‰ä¼šé‡æ–°æ±‚å€¼\n```html\n<div id=\"example\">\n  <p>Original message: \"{% raw %}{{ message }}{% endraw %}\"</p>\n  <p>Computed reversed message: \"{% raw %}{{ reversedMessage }}{% endraw %}\"</p>\n</div>\n```\n```js\nnew Vue({\n  el: '#example',\n  data: {\n    message: 'Hello'\n  },\n  computed: {\n    // è®¡ç®—å±æ€§çš„ getter\n    reversedMessage: function () {\n      // this æŒ‡å‘ vm å®ä¾‹\n      return this.message.split('').reverse().join('')\n    }\n  }\n})\n```\n- è®¡ç®—å±æ€§å¯ä»¥æ‹¥æœ‰setter\n```js\ncomputed: {\n  fullName: {\n    // getter\n    get: function () {\n      return this.firstName + ' ' + this.lastName\n    },\n    // setter\n    set: function (newValue) {\n      var names = newValue.split(' ')\n      this.firstName = names[0]\n      this.lastName = names[names.length - 1]\n    }\n  }\n}\n```\n### ä¾¦å¬å™¨\n- ä¾¦å¬å±æ€§,é€šè¿‡ watch æ¥å“åº”æ•°æ®çš„å˜åŒ–\n```html\n<div id=\"demo\">{% raw %}{{ fullName }}{% endraw %}</div>\n```\n```js\nnew Vue({\n  el: '#demo',\n  data: {\n    firstName: 'Foo',\n    lastName: 'Bar',\n    fullName: 'Foo Bar'\n  },\n  watch: {\n    firstName: function (val) {\n      this.fullName = val + ' ' + this.lastName\n    },\n    lastName: function (val) {\n      this.fullName = this.firstName + ' ' + val\n    }\n  }\n})\n```\n\n## **äº‹ä»¶ä¿®é¥°ç¬¦**\n- .stop é˜»æ­¢äº‹ä»¶å†’æ³¡åˆ°çˆ¶å…ƒç´ \n- .prevent é˜»æ­¢å…ƒç´ å‘ç”Ÿé»˜è®¤çš„è¡Œä¸º\n- .capture å†…éƒ¨å…ƒç´ è§¦å‘çš„äº‹ä»¶å…ˆåœ¨æ­¤å¤„ç†ï¼Œç„¶åæ‰äº¤ç”±å†…éƒ¨å…ƒç´ è¿›è¡Œå¤„ç†\n- .self å¿½ç•¥äº‹ä»¶å†’æ³¡å’Œäº‹ä»¶æ•è·å¯¹æœ¬å…ƒç´ çš„å½±å“\n- .once äº‹ä»¶å°†åªä¼šè§¦å‘ä¸€æ¬¡\n- .passive\n```html\n<!-- é˜»æ­¢å•å‡»äº‹ä»¶ç»§ç»­ä¼ æ’­ -->\n<a v-on:click.stop=\"doThis\"></a>\n\n<!-- æäº¤äº‹ä»¶ä¸å†é‡è½½é¡µé¢ -->\n<form v-on:submit.prevent=\"onSubmit\"></form>\n\n<!-- ä¿®é¥°ç¬¦å¯ä»¥ä¸²è” -->\n<a v-on:click.stop.prevent=\"doThat\"></a>\n\n<!-- åªæœ‰ä¿®é¥°ç¬¦ -->\n<form v-on:submit.prevent></form>\n\n<!-- æ·»åŠ äº‹ä»¶ç›‘å¬å™¨æ—¶ä½¿ç”¨äº‹ä»¶æ•è·æ¨¡å¼ -->\n<!-- å³å†…éƒ¨å…ƒç´ è§¦å‘çš„äº‹ä»¶å…ˆåœ¨æ­¤å¤„ç†ï¼Œç„¶åæ‰äº¤ç”±å†…éƒ¨å…ƒç´ è¿›è¡Œå¤„ç† -->\n<div v-on:click.capture=\"doThis\">...</div>\n\n<!-- åªå½“åœ¨ event.target æ˜¯å½“å‰å…ƒç´ è‡ªèº«æ—¶è§¦å‘å¤„ç†å‡½æ•° -->\n<!-- å³äº‹ä»¶ä¸æ˜¯ä»å†…éƒ¨å…ƒç´ è§¦å‘çš„ -->\n<div v-on:click.self=\"doThat\">...</div>\n\n<!-- 2.1.4æ–°å¢ ç‚¹å‡»äº‹ä»¶å°†åªä¼šè§¦å‘ä¸€æ¬¡ -->\n<a v-on:click.once=\"doThis\"></a>\n\n<!-- 2.3.0æ–°å¢ æ»šåŠ¨äº‹ä»¶çš„é»˜è®¤è¡Œä¸º (å³æ»šåŠ¨è¡Œä¸º) å°†ä¼šç«‹å³è§¦å‘ -->\n<!-- è€Œä¸ä¼šç­‰å¾… `onScroll` å®Œæˆ  -->\n<!-- è¿™å…¶ä¸­åŒ…å« `event.preventDefault()` çš„æƒ…å†µ -->\n<div v-on:scroll.passive=\"onScroll\">...</div>\n```\n\n## **è¡¨å•è¾“å…¥ç»‘å®š**\n- v-model åœ¨å†…éƒ¨ä¸ºä¸åŒçš„è¾“å…¥å…ƒç´ ä½¿ç”¨ä¸åŒçš„ property å¹¶æŠ›å‡ºä¸åŒçš„äº‹ä»¶ï¼š\n    - text å’Œ textarea å…ƒç´ ä½¿ç”¨ value property å’Œ input äº‹ä»¶\n    - checkbox å’Œ radio ä½¿ç”¨ checked property å’Œ change äº‹ä»¶\n    - select å­—æ®µå°† value ä½œä¸º property å¹¶å°† change ä½œä¸ºäº‹ä»¶\n### æ–‡æœ¬/å¤šè¡Œæ–‡æœ¬\n```html\n<input v-model=\"message\">\n<textarea v-model=\"message\"></textarea>\n```\n### å¤é€‰æ¡†\n- å•ä¸ªå¤é€‰æ¡†ï¼Œç»‘å®šåˆ°å¸ƒå°”å€¼\n```html\n<input type=\"checkbox\" id=\"checkbox\" v-model=\"checked\">\n```\n```js\nnew Vue({\n  el: '...',\n  data: {\n    checked: false\n  }\n})\n```\n- å¤šä¸ªå¤é€‰æ¡†ï¼Œç»‘å®šåˆ°åŒä¸€ä¸ªæ•°ç»„\n```html\n<input type=\"checkbox\" id=\"jack\" value=\"Jack\" v-model=\"checkedNames\">\n<input type=\"checkbox\" id=\"john\" value=\"John\" v-model=\"checkedNames\">\n<input type=\"checkbox\" id=\"mike\" value=\"Mike\" v-model=\"checkedNames\">\n```\n```js\nnew Vue({\n  el: '...',\n  data: {\n    checkedNames: []\n  }\n})\n```\n### å•é€‰æŒ‰é’®\n```html\n<input type=\"radio\" id=\"one\" value=\"One\" v-model=\"picked\">\n<input type=\"radio\" id=\"two\" value=\"Two\" v-model=\"picked\">\n```\n```js\nnew Vue({\n  el: '#example-4',\n  data: {\n    picked: ''\n  }\n})\n```\n### è¡¨å•ä¿®é¥°ç¬¦\n- .lazy é»˜è®¤æƒ…å†µä¸‹ï¼Œ v-model åœ¨ input äº‹ä»¶ä¸­åŒæ­¥è¾“å…¥æ¡†çš„å€¼ä¸æ•°æ®ï¼Œæ·»åŠ ä¸€ä¸ªä¿®é¥°ç¬¦ lazy ï¼Œä»è€Œè½¬å˜ä¸ºåœ¨ change äº‹ä»¶ä¸­åŒæ­¥\n```html\n<input v-model.lazy=\"msg\" > \n```\n- .number è‡ªåŠ¨å°†ç”¨æˆ·çš„è¾“å…¥å€¼è½¬ä¸º Number ç±»å‹ï¼ˆå¦‚æœåŸå€¼çš„è½¬æ¢ç»“æœä¸º NaN åˆ™è¿”å›åŸå€¼ï¼‰\n```html\n<input v-model.number=\"age\" type=\"number\">\n```\n - .trim è‡ªåŠ¨è¿‡æ»¤ç”¨æˆ·è¾“å…¥çš„é¦–å°¾ç©ºæ ¼\n ```html\n<input v-model.trim=\"msg\">\n```\n\n## **ç»„ä»¶**\n### æ³¨å†Œ\n#### å…¨å±€æ³¨å†Œ\n```js\nVue.component('component-a', { /* ... */ })\nnew Vue({ el: '#app' })\n```\n#### å±€éƒ¨æ³¨å†Œ\n```js\nvar ComponentA = { /* ... */ }\nnew Vue({\n  el: '#app',\n  components: {\n    'component-a': ComponentA\n  }\n})\n```","tags":["å‰ç«¯","vue"],"categories":["å‰ç«¯","vue"]},{"title":"éŸ³MADæ•™ç¨‹","url":"/20210925/otomad-tutorial/","content":"- 2022.8.12 æ›´æ–°\n\n## åŸºç¡€\n### ç³»ç»Ÿæ€§æ•™å­¦\n\n{% externalLinkCard \"ã€éŸ³MADæ•™ç¨‹å…¥é—¨ç¯‡ã€‘ç»™èŒæ–°çš„é›¶åŸºç¡€éŸ³MADæ•™å­¦ï¼\" https://www.bilibili.com/video/BV1v5411Q7LH/ auto %}\n\n{% externalLinkCard \"ã€éŸ³MADæ•™ç¨‹ã€‘å¦‚ä½•å¯»æ‰¾æ•™ç¨‹\" https://www.bilibili.com/video/BV1BN411Q7Wk/ auto %}\n\n{% externalLinkCard \"ã€MMakerã€‘æ–°æ‰‹ AE&éŸ³MAD æ•™ç¨‹\" https://www.bilibili.com/video/BV1LE411A7NH/ auto %}\n\n{% externalLinkCard \"ã€éŸ³MADæ•™ç¨‹ç•ªå¤–ç¯‡ã€‘å¦‚ä½•åšä¸€ä¸ªåˆä½œå•å“ï¼Ÿ\" https://www.bilibili.com/video/BV1xS4y1s7SK/ auto %}\n\n### Vegas\n\n{% externalLinkCard \"ã€å…¥é—¨å‘ã€‘é¬¼ç•œï¼ˆéŸ³MADï¼‰åˆ¶ä½œæ•™ç¨‹\" https://www.bilibili.com/video/BV1ox411c7xV/ auto %}\n\n{% externalLinkCard \"éŸ³madæ•™ç¨‹-BPMç¯‡\" https://www.bilibili.com/video/BV1ss411f7nt/ auto %}\n### Pr\n\n{% externalLinkCard \"ã€éŸ³MADæ•™ç¨‹ã€‘æ•™å¤§å®¶å¦‚ä½•åšéŸ³ç”»åŒæ­¥ä»¥åŠä¸€äº›ç‰¹æ•ˆ\" https://www.bilibili.com/video/BV1is411o7S7/ auto %}\n\n### ç½‘ç«™\n\n{% externalLinkCard \"éŸ³MADç»´åŸº\" https://otomad.wiki/ https://otomad.wiki/kawaii/Wiki_Logo_Animated.svg?de058 %}\n\n{% externalLinkCard \"MMaker's YTPMV & éŸ³MAD Document\" https://mmaker.moe/ytpmv/ https://mmaker.moe/mmaker.png %}\n\n## éŸ³é¢‘\n### Fl\n\n{% externalLinkCard \"ã€FLæ•™ç¨‹ã€‘ã€éŸ³MADæ•™ç¨‹ã€‘harmorè¾ƒç³»ç»Ÿè®²è§£ã€å»ºè®®å€é€Ÿè§‚çœ‹ã€‘ã€åˆ†é›†ã€‘\" https://www.bilibili.com/video/BV184411B7dF/ auto %}\n\n{% externalLinkCard \"harmoråœ¨åˆ¶ä½œéŸ³madå’Œé¬¼ç•œæ—¶çš„ä¸€ç§åº”ç”¨\" https://www.bilibili.com/video/BV1gs411G7ei/ auto %}\n  \n{% externalLinkCard \"æ··éŸ³Fabfilterï¼ˆè‚¥æ³¢ï¼‰å…¨å¥—æ•™ç¨‹ã€15é›†ã€‘| å‹ç¼©ã€EQã€æ··å“ã€å¤šæ®µã€æ»¤æ³¢æ•ˆæœå™¨è¶…å…¨è®²è§£\" https://www.bilibili.com/video/BV1ii4y157Tn/ auto %}\n\n### UTAU && Melodyne\n\n{% externalLinkCard \"ã€é¬¼ç•œè°ƒéŸ³æ•™ç¨‹ã€‘å…¨ç½‘æœ€è¯¦ç»†ï¼æ¶µç›–Melodyneã€UTAUç­‰å¤šç§è°ƒéŸ³è½¯ä»¶è®²è§£ï¼Œæ‰‹æŠŠæ‰‹ä¿å§†çº§æ•™å­¦\" https://www.bilibili.com/video/BV1UU4y1c7yL/ auto %}\n\n### æ‰’è°±&&ä¿®éŸ³\n\n{% externalLinkCard \"ã€æ•™ç¨‹ã€‘æ‰’è°±è½¯ä»¶wavetoneçš„ä½¿ç”¨\" https://www.bilibili.com/video/BV1G4411N7WF/ auto %}\n\n{% externalLinkCard \"ã€ä¸ªäººæ¸£ç¿»ã€‘VocalShifterçš„ä½¿ç”¨æ–¹æ³•1\" https://www.bilibili.com/video/BV1KW411i7Dq/ auto %}\n\n{% externalLinkCard \"ã€é¬¼ç•œæ•™ç¨‹ã€‘è¾…åŠ©å·¥å…·Vocalshifterï¼ˆVSHï¼‰ä½¿ç”¨æ•™ç¨‹\" https://www.bilibili.com/read/cv3113948/ auto %}\n\n## PV\n### ä¸€å›¾æµ\n\n{% externalLinkCard \"ã€æ•™ç¨‹æ¬è¿ã€‘VegaséŸ³é¢‘å¯è§†åŒ–\" https://www.bilibili.com/video/BV1ix411W78s/ auto %}\n\n{% externalLinkCard \"AE æ•™å­¦ Particular ç²’å­å¯è§†åŒ– éŸ³éœ‡è¡æ•™å­¦åˆ†äº«\" https://www.bilibili.com/video/BV1Gx411M7ur/ auto %}\n\n{% externalLinkCard \"ã€AEæ•™ç¨‹ç¬¬6æœŸã€‘å¿«é€Ÿåˆ¶ä½œé…·ç‚«çš„éŸ³é¢‘é¢‘è°±+åŸç‰ˆç²’å­ç‰¹æ•ˆï¼ˆèŠ‚å¥ éŸ³é¢‘ pvå¸¸ç”¨ è·ŸéšéŸ³ä¹ å¯è§†åŒ–éŸ³é¢‘ éŸ³ä¹å¯è§†åŒ– ç™½è¡£ï¼‰\" https://www.bilibili.com/video/BV1Hx411J7Vz/ auto %}\n\n### å¸¸ç”¨æ•ˆæœ\n\n{% externalLinkCard \"\\[æ•™ç¨‹\\]éŸ³madä¸­PVå¸¸ç”¨çš„æ•ˆæœ\" https://www.bilibili.com/video/BV1St411u7hV/ auto %}\n\n{% externalLinkCard \"\\[æ•™ç¨‹\\]éŸ³madä¸­å¸¸ç”¨PVæ•ˆæœ2\" https://www.bilibili.com/video/BV1aK4y1b7PN/ auto %}\n\n{% externalLinkCard \"ç½¡æ¸¡æ™¨æ˜ŸAE-Formç²’å­å…¨ææ•™å­¦80èŠ‚\" https://www.bilibili.com/video/BV1Gx411Q79D/ auto %}\n\n{% externalLinkCard \"ã€AEæ•™ç¨‹ã€‘æˆ‘ä¸å¯èƒ½ä¼šåˆ¶ä½œæ¨±èŠ±é£èˆçš„æ•ˆæœã€‚\" https://www.bilibili.com/video/BV1jx411i7ys/ auto %}\n\n{% externalLinkCard \"AEæ•™ä½ å¦‚ä½•åšå‡ºé¦™è•‰ä¸é˜¿é²²åŠ¨æ€å…‰æ•ˆæè¾¹æ•ˆæœï¼\" https://www.bilibili.com/video/BV1tb411g7Uh/ auto %}\n\n{% externalLinkCard \"ã€AEæ•™ç¨‹ã€‘è®©ä½ çš„æ–‡å­—éšç€éŸ³ä¹èŠ‚æ‹è·³åŠ¨~beatsï¼\" https://www.bilibili.com/video/BV1w4411t7jE/ auto %}\n\n{% externalLinkCard \"ã€AEæ’ä»¶ã€‘ä½¿ç”¨FreqReactè‡ªåŠ¨å°†å£°éŸ³å˜ä¸ºè¿åŠ¨\\[1.5ç‰ˆæœ¬\\]\" https://www.bilibili.com/video/BV1Pq4y1n7uq/ auto %}\n\n{% externalLinkCard \"\\[Vegasæ•™ç¨‹\\] å¹³é“ºã€ä¼ é€å¸¦æ•ˆæœåˆ¶ä½œ\" https://www.bilibili.com/read/cv11110585/ auto %}\n## å…¶ä»–\n\n{% externalLinkCard \"\\[2å·å¼åŠ¨ç”»è®²åº§\\]\\[æ–°äººå‘\\]éŸ³madçš„ä¸­ä½éŸ³éƒ¨\" https://www.bilibili.com/video/BV1F4411x7bS/ auto %}\n\n{% externalLinkCard \"è°éƒ½å­¦ä¸ä¼šçš„vegaséŸ³é¢‘è¿›é˜¶æ•™ç¨‹\" https://www.bilibili.com/video/BV1Px411y7zQ/ auto %}\n\n{% externalLinkCard \"ã€ç†Ÿè‚‰ã€‘ã€è½¯ä»¶é…å¸ƒã€‘AI-MGRoidåˆ¶ä½œæ–¹æ³•ï¼ˆAIå§‰è²´UTAç‰ˆæ•™ç¨‹ï¼‰ï¼‹ä½¿ç”¨ä¾‹\" https://www.bilibili.com/video/BV1hL411b7xe/ auto %}\n\n{% externalLinkCard \"é¬¼ç•œäººåŠ›VéŸ³æºé…å¸ƒæ•´ç†ï¼ˆæŒç»­æ›´æ–°ï¼‰\" https://www.bilibili.com/read/cv363982/ auto %}\n\n{% externalLinkCard \"å…³äºNEUTRINOçš„åŸºæœ¬ä½¿ç”¨æ–¹æ³•\" https://www.bilibili.com/read/cv4971143/ auto %}\n","tags":["éŸ³MAD"],"categories":["éŸ³MAD"]},{"title":"MIDIé…å¸ƒ","url":"/20210925/otomad-midi/","content":"- ç®€å•æ•´ç†äº†ä¸€ä¸‹ä¹‹å‰æ‰’è¿‡çš„ä¸œæ–¹æ›²å­ï¼Œå¸Œæœ›èƒ½å¸®åˆ°æœ‰éœ€è¦çš„äºº\n- ä»…ä¾›å­¦ä¹ å’Œå‚è€ƒç”¨é€”ï¼Œç¦æ­¢äºŒæ¬¡ä¸Šä¼ \n- éƒ¨åˆ†ä¹å™¨æ¥æºäºç«™å†…è§†é¢‘çœ¼æ‰’ï¼Œå› ä¸ºå½“æ—¶æŠ€æœ¯åŠ›ä¸å¤ªå¤Ÿ\n- é“¾æ¥: https://pan.baidu.com/s/14l1QjaBTH2YUWnC4PTTzJw æå–ç : wnhx \n- æ‰€æœ‰MIDIå‡ï¼Œå¯èƒ½å­˜åœ¨é”™éŸ³ï¼Œè¯·è°…è§£\n## ç›®å½•\n- 2021.6.14æ›´æ–°\n  - æ­»çµçš„å¤œæ¨±\n  - ä¼šå—ç¨»ç”°å§¬çš„æ–¥è´£å•¦\n  - å…”å·²ç€é™†\n  - ä»Šå®µæ˜¯é£˜é€¸çš„è‡ªæˆ‘ä¸»ä¹‰è€…\n  - å¤©é­”ä¹‹å±±æ¼«å¤©æ˜Ÿ\n  - Smoking Dragon\n  - å¤§å‰çŒ«å’ª\n  - å¿ƒä¹‹æ‰€åœ¨\n  - å°å°çš„è´¤å°†\n  - æ˜¥ä¹‹å²¸è¾¹\n- 2021.9.25æ›´æ–°\n  - ä¸œæ–¹ç»¯æƒ³å¤©\n  - last remote","tags":["éŸ³MAD"],"categories":["éŸ³MAD"]},{"title":"Java é«˜çº§æ–‡ä»¶å¤„ç†ä½œä¸š","url":"/20210925/java-advanced-file-processing-homework/","content":"## xmlå’Œjsonçš„å¤„ç†\n### è¦æ±‚\n- è¯»å…¥ä»¥ä¸‹çš„score.xmlæ–‡ä»¶ï¼Œå¹¶è½¬åŒ–ä¸ºJSON  Objectå¯¹è±¡ï¼Œè¾“å‡ºJSON Objectçš„å­—ç¬¦ä¸²è¡¨è¾¾å¼ã€‚æœ€åï¼Œæ ¹æ®JSON Object çš„å€¼å’Œscore.xmlçš„æ ·å¼ï¼Œé‡æ–°ç”Ÿæˆscore2.xmlã€‚\n```xml\nâ€‹<student>\nâ€‹  <name>Tom</name>\nâ€‹  <subject>math</subject>\nâ€‹  <score>80</score>\nâ€‹</student>\n```\n- è¯»å–å’Œå†™å…¥xmlæ–¹æ³•ä¸é™ï¼ŒJSONå¤„ç†æ–¹æ³•ä¸é™ã€‚\n### mavenä¾èµ–\n```xml\n<dependency>\n    <groupId>dom4j</groupId>\n    <artifactId>dom4j</artifactId>\n    <version>1.6.1</version>\n</dependency>\n<!--net.sf.json-libå¯èƒ½ä¸éœ€è¦-->\n<dependency>\n    <groupId>net.sf.json-lib</groupId>\n    <artifactId>json-lib</artifactId>\n    <version>2.4</version>\n    <classifier>jdk15</classifier>\n</dependency>\n<dependency>\n    <groupId>org.json</groupId>\n    <artifactId>json</artifactId>\n    <version>20160810</version>\n</dependency>\n<dependency>\n    <groupId>commons-io</groupId>\n    <artifactId>commons-io</artifactId>\n    <version>2.8.0</version>\n</dependency>\n```\n### æœ¬ä½“\n```java\nimport org.apache.commons.io.IOUtils;\nimport org.dom4j.Document;\nimport org.dom4j.io.SAXReader;\nimport org.dom4j.io.XMLWriter;\nimport org.json.JSONObject;\nimport org.json.XML;\nimport org.dom4j.io.OutputFormat;\n\nimport java.io.*;\n\npublic class Xml2Json {\n\n    public static void xml2Json() throws Exception {\n        InputStream in = new FileInputStream(\"src/main/resources/score.xml\");\n        String xml = IOUtils.toString(in);\n        JSONObject xmlJSONObj = XML.toJSONObject(xml);\n        String json = xmlJSONObj.toString();\n        writeFile(json, \"src/main/resources/score.json\");\n        System.out.println(json);\n\n    }\n\n    public static void json2Xml() throws Exception {\n        InputStream in = new FileInputStream(\"src/main/resources/score.json\");\n        String json = IOUtils.toString(in);\n        JSONObject jsonObject = new JSONObject(json);\n        String xml = XML.toString(jsonObject);\n        xml = format(xml);\n        writeFile(xml, \"src/main/resources/score2.xml\");\n    }\n\n    public static void writeFile(String s, String url) {\n        try (BufferedWriter bw = new BufferedWriter(new OutputStreamWriter(new FileOutputStream(url)))) {\n            bw.write(s);\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n\n    public static String format(String str) throws Exception {\n        Document doc = new SAXReader().read(new StringReader(str));\n        OutputFormat formater = OutputFormat.createPrettyPrint();\n        formater.setEncoding(\"UTF-8\");\n        StringWriter out = new StringWriter();\n        XMLWriter writer = new XMLWriter(out, formater);\n        writer.write(doc);\n        writer.close();\n        return out.toString();\n    }\n\n    public static void main(String[] args) throws Exception {\n        xml2Json();\n        json2Xml();\n    }\n}\n```\n\n## xlsã€docã€pdfçš„å¤„ç†å’Œæ¡å½¢ç çš„ç”Ÿæˆ\n### è¦æ±‚\n- è¯»å–student.xslxé‡Œé¢çš„æ•°æ®ï¼Œæ ¹æ®é¢„è®¾çš„student.docxæ¨¡æ¿ï¼Œç”Ÿæˆå­¦ç”Ÿå…·ä½“çš„ä¿¡æ¯æ–‡æ¡£ï¼Œæœ€åè½¬åŒ–ä¸ºpdfæ–‡æ¡£ã€‚\n- æ•´ä¸ªç¨‹åºå¯ä»¥åˆ†æˆå¤šä¸ªæ­¥éª¤ï¼Œæˆ–è€…æ•´åˆä¸ºä¸€ä¸ªç¨‹åºã€‚\n### mavenä¾èµ–\n```xml\n<dependency>\n    <groupId>com.lowagie</groupId>\n    <artifactId>itext</artifactId>\n    <version>2.1.7</version>\n</dependency>\n<dependency>\n    <groupId>fr.opensagres.xdocreport</groupId>\n    <artifactId>org.apache.poi.xwpf.converter.pdf</artifactId>\n    <version>1.0.6</version>\n</dependency>\n<!--org.apache.pdfboxå¯èƒ½ä¸éœ€è¦-->\n<dependency>\n    <groupId>org.apache.pdfbox</groupId>\n    <artifactId>pdfbox</artifactId>\n    <version>2.0.13</version>\n</dependency>\n<dependency>\n    <groupId>org.apache.pdfbox</groupId>\n    <artifactId>xmpbox</artifactId>\n    <version>2.0.13</version>\n</dependency>\n<!--com.itextpdfå¯èƒ½ä¸éœ€è¦-->\n<dependency>\n    <groupId>com.itextpdf</groupId>\n    <artifactId>itextpdf</artifactId>\n    <version>5.5.13</version>\n</dependency>\n<dependency>\n    <groupId>org.apache.poi</groupId>\n    <artifactId>poi</artifactId>\n    <version>3.15</version>\n</dependency>\n<dependency>\n    <groupId>org.apache.poi</groupId>\n    <artifactId>poi-ooxml-schemas</artifactId>\n    <version>3.15</version>\n</dependency>\n<dependency>\n    <groupId>org.apache.xmlbeans</groupId>\n    <artifactId>xmlbeans</artifactId>\n    <version>3.1.0</version>\n</dependency>\n<dependency>\n    <groupId>org.apache.poi</groupId>\n    <artifactId>poi-ooxml</artifactId>\n    <version>3.15</version>\n</dependency>\n<dependency>\n    <groupId>org.apache.poi</groupId>\n    <artifactId>poi-scratchpad</artifactId>\n    <version>3.15</version>\n</dependency>\n<dependency>\n    <groupId>com.google.zxing</groupId>\n    <artifactId>core</artifactId>\n    <version>3.3.3</version>\n</dependency>\n<dependency>\n    <groupId>com.google.zxing</groupId>\n    <artifactId>javase</artifactId>\n    <version>3.3.3</version>\n</dependency>\n```\n### æœ¬ä½“\n```java\nimport com.google.zxing.BarcodeFormat;\nimport com.google.zxing.MultiFormatWriter;\nimport com.google.zxing.client.j2se.MatrixToImageWriter;\nimport com.google.zxing.common.BitMatrix;\nimport com.lowagie.text.Font;\nimport com.lowagie.text.pdf.BaseFont;\nimport fr.opensagres.xdocreport.itext.extension.font.IFontProvider;\nimport fr.opensagres.xdocreport.itext.extension.font.ITextFontRegistry;\nimport org.apache.poi.ss.usermodel.CellType;\nimport org.apache.poi.util.Units;\nimport org.apache.poi.xssf.usermodel.XSSFCell;\nimport org.apache.poi.xssf.usermodel.XSSFRow;\nimport org.apache.poi.xssf.usermodel.XSSFSheet;\nimport org.apache.poi.xssf.usermodel.XSSFWorkbook;\nimport org.apache.poi.xwpf.converter.pdf.PdfConverter;\nimport org.apache.poi.xwpf.converter.pdf.PdfOptions;\nimport org.apache.poi.xwpf.usermodel.*;\nimport org.apache.poi.xwpf.usermodel.XWPFDocument;\n\n\nimport javax.imageio.ImageIO;\nimport java.awt.*;\nimport java.awt.image.BufferedImage;\nimport java.io.*;\nimport java.util.*;\nimport java.util.List;\n\npublic class Main {\n    public static final int CODEWIDTH = 130;\n    public static int HEIGHT = 80;\n    public static final int CODEHEIGHT = 70;\n    public static int FONTSIZE = 10;\n\n    public static void main(String[] args) throws Exception {\n        //è¯»å–xls,å­˜å…¥Listä¸­\n        List<String> list = readXls();\n        //ç”Ÿæˆæ¡å½¢ç \n        File file = new File(\"src/main/resources/code.png\");\n        generateCode(file, list.get(2), CODEWIDTH, CODEHEIGHT);\n        generateFont(file, list.get(2));\n        //æ„é€ æ›¿æ¢æ˜ å°„\n        Map<String, Object> params = new HashMap<String, Object>();\n        params.put(\"{name}\", list.get(0));\n        params.put(\"{sex}\", list.get(1));\n        params.put(\"{barcode}\", list.get(2));\n        //è§£ædocå¹¶æ›¿æ¢\n        parserDoc(params);\n        //docè½¬æ¢ä¸ºpdf\n        writePdf();\n        System.out.println(\"generate successfully!\");\n    }\n\n    public static List<String> readXls() throws Exception {\n        List<String> list = new ArrayList<>();\n        InputStream ExcelFileToRead = new FileInputStream(\"src/main/resources/student.xlsx\");\n        XSSFWorkbook workbook = new XSSFWorkbook(ExcelFileToRead);\n        XSSFSheet sheet = workbook.getSheetAt(0);\n\n        //å…ˆæŒ‰è¡Œè¯»å–ï¼Œå†åœ¨æ¯è¡Œä¸­æŒ‰åˆ—è¯»å–\n        Iterator rows = sheet.iterator();\n        while (rows.hasNext()) {\n            XSSFRow row = (XSSFRow) rows.next();\n            Iterator cells = row.cellIterator();\n            while (cells.hasNext()) {\n                XSSFCell cell = (XSSFCell) cells.next();\n                //åˆ¤æ–­æ˜¯å¦ä¸ºå­—ç¬¦ä¸²è¿˜æ˜¯æ•°å­—\n                if (cell.getCellTypeEnum() == CellType.STRING) {\n                    list.add(cell.getStringCellValue());\n                } else if (cell.getCellTypeEnum() == CellType.NUMERIC) {\n                    list.add(\"\" + cell.getNumericCellValue());\n                }\n            }\n        }\n        ExcelFileToRead.close();\n        return list;\n    }\n\n    public static void replaceRun(XWPFParagraph xwpfParagraph, Map<String, Object> params) throws Exception {\n        //è·å¾—XWPFRuns\n        List<XWPFRun> runs = xwpfParagraph.getRuns();\n        if (runs.size() > 0) {\n            for (XWPFRun re : runs) {\n                //åˆ¤æ–­æ˜¯å¦ä¸ºéç©ºrun\n                if (re.text() != null || re.text().length() > 0) {\n                    String match = re.text();\n                    //åˆ¤æ–­æ˜¯å¦èƒ½è¢«æ›¿æ¢\n                    if (params.containsKey(match)) {\n                        //åˆ¤æ–­æ˜¯å¦æ˜¯æ¡å½¢ç \n                        if (match.equals(\"{barcode}\")) {\n                            xwpfParagraph.removeRun(0);\n                            XWPFRun run = xwpfParagraph.createRun();\n                            int format = XWPFDocument.PICTURE_TYPE_PNG;\n                            //æ·»åŠ æ¡å½¢ç å›¾ç‰‡\n                            run.addPicture(new FileInputStream(\"src/main/resources/code_new.png\"), format,\n                                    \"src/main/resources/code_new.png\", Units.toEMU(CODEWIDTH), Units.toEMU(CODEHEIGHT));\n                        } else {\n                            //æ­£å¸¸æ–‡æœ¬æ›¿æ¢\n                            xwpfParagraph.removeRun(0);\n                            XWPFRun run = xwpfParagraph.createRun();\n                            run.setText(params.get(match).toString());\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    public static void parserDoc(Map<String, Object> params) throws Exception {\n        InputStream WordFileToRead = new FileInputStream(\"src/main/resources/student.docx\");\n        XWPFDocument xwpfDocument = new XWPFDocument(WordFileToRead);\n        //è·å¾—IBodyElement\n        List<IBodyElement> iBodyElements = xwpfDocument.getBodyElements();\n        for (IBodyElement ibs : iBodyElements) {\n            BodyElementType bodyElementType = ibs.getElementType();\n            //æ˜¯å¦ä¸ºè¡¨æ ¼\n            if (bodyElementType == BodyElementType.TABLE) {\n                XWPFTable xwpfTable = (XWPFTable) ibs;\n                //è·å¾—è¡Œ\n                List<XWPFTableRow> rows = xwpfTable.getRows();\n                for (XWPFTableRow row : rows) {\n                    //è·å¾—å•å…ƒæ ¼\n                    List<XWPFTableCell> cells = row.getTableCells();\n                    for (XWPFTableCell cell : cells) {\n                        List<XWPFParagraph> paras = cell.getParagraphs();\n                        for (XWPFParagraph para : paras) {\n                            //æ›¿æ¢Run\n                            replaceRun(para, params);\n                        }\n                    }\n                }\n            } else if (bodyElementType == BodyElementType.PARAGRAPH) {\n                XWPFParagraph xwpfParagraph = (XWPFParagraph) ibs;\n                //æ›¿æ¢Run\n                replaceRun(xwpfParagraph, params);\n            }\n        }\n        OutputStream outputStream = new FileOutputStream(\"src/main/resources/student_new.docx\");\n        xwpfDocument.write(outputStream);\n        WordFileToRead.close();\n        outputStream.close();\n    }\n\n    public static void writePdf() throws Exception {\n        FileInputStream inputStream = new FileInputStream(\"src/main/resources/student_new.docx\");\n        XWPFDocument document = new XWPFDocument(inputStream);\n        PdfOptions options = PdfOptions.create();\n        options.fontProvider(new IFontProvider() {\n            @Override\n            public Font getFont(String familyName, String encoding, float size, int style, Color color) {\n                try {\n                    BaseFont bfChinese=BaseFont.createFont(\"C:/Windows/Fonts/simfang.ttf\",BaseFont.IDENTITY_H,BaseFont.EMBEDDED);\n                    Font fontChinese = new Font(bfChinese, size, style, color);\n                    if (familyName != null)\n                        fontChinese.setFamily(familyName);\n                    return fontChinese;\n                } catch(Exception e) {\n                    e.printStackTrace();\n                    return ITextFontRegistry.getRegistry().getFont(familyName, encoding, size, style, color);\n                }\n            }\n        });\n        PdfConverter.getInstance().convert(document, new FileOutputStream(\"src/main/resources/student.pdf\"), options);\n        inputStream.close();\n    }\n\n    public static void generateCode(File file, String code, int width, int height) {\n        BitMatrix matrix = null;\n        try {\n            MultiFormatWriter writer = new MultiFormatWriter();\n            matrix = writer.encode(code, BarcodeFormat.CODE_128, width, height, null);\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n        try (FileOutputStream outputStream = new FileOutputStream(file)) {\n            ImageIO.write(MatrixToImageWriter.toBufferedImage(matrix), \"png\", outputStream);\n            outputStream.flush();\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n\n    public static void generateFont(File file, String s) throws Exception {\n        BufferedImage code = ImageIO.read(file);\n        BufferedImage font = new BufferedImage(CODEWIDTH, HEIGHT, BufferedImage.TYPE_INT_RGB);\n        Graphics2D g = (Graphics2D) font.getGraphics();\n        g.clearRect(0, 0, CODEWIDTH, HEIGHT);\n        g.setColor(Color.WHITE);\n        g.fillRect(0, 0, CODEWIDTH, HEIGHT);\n        g.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);\n        g.setRenderingHint(RenderingHints.KEY_RENDERING, RenderingHints.VALUE_RENDER_QUALITY);\n        for (int i = 0; i < s.length(); i++) {\n            g.setColor(Color.black);\n            java.awt.Font font_ = new java.awt.Font(\"Consolas\", 0, FONTSIZE);\n            g.setFont(font_);\n            g.drawString(s.charAt(i) + \"\", (FONTSIZE * 4 + CODEWIDTH - s.length() * FONTSIZE) / 2 + (i - 1) * FONTSIZE * 5 / 6, HEIGHT);\n        }\n        g.drawImage(code, 0, 0, null);\n        g.dispose();\n        File outputfile = new File(\"src/main/resources/code_new.png\");\n        ImageIO.write(font, \"png\", outputfile);\n    }\n}\n```","tags":["Java"],"categories":["Java","Javaè¿›é˜¶"]},{"title":"Java ç½‘ç»œç¼–ç¨‹ä½œä¸š","url":"/20210925/java-network-programming-homework/","content":"## TCPç¼–ç¨‹\n### è¦æ±‚\n- è¯·ç¼–å†™ä¸€ä¸ªç¾¤èŠçš„ç¨‹åºï¼ŒåŒ…æ‹¬æœåŠ¡ç«¯ç¨‹åºå’Œå®¢æˆ·ç«¯ç¨‹åºã€‚ \n- æœåŠ¡ç«¯åŠŸèƒ½ï¼šæ”¶åˆ°æŸå®¢æˆ·ç«¯çš„ä¿¡æ¯ï¼Œå°†æ¶ˆæ¯åœ¨æ§åˆ¶å°è¾“å‡ºï¼Œç„¶åï¼Œå‘ç»™å…¶ä»–å¦å¤–çš„å®¢æˆ·ç«¯ã€‚\n- å®¢æˆ·ç«¯åŠŸèƒ½ï¼šæ¯éš”5ç§’å‘é€ä¸€æ¡ä¿¡æ¯ç»™æœåŠ¡ç«¯ã€‚ç„¶åæ¥æ”¶æœåŠ¡å™¨è½¬å‘è¿‡æ¥çš„æ¶ˆæ¯ï¼Œå¹¶åœ¨æ§åˆ¶å°è¾“å‡ºã€‚\n### å®¢æˆ·ç«¯\n- ç”±äºæ¯éš”5ç§’å‘é€ä¸€æ¡ä¿¡æ¯ç»™æœåŠ¡ç«¯ï¼Œæ‰€ä»¥è€ƒè™‘é‡‡ç”¨ä¸²è¡Œç»“æ„ï¼Œæ¯éš”äº”ç§’å‘é€å›ºå®šå­—ç¬¦ï¼Œå†è¿›è¡Œè¯»å–\n- ä¹Ÿå¯ä»¥é‡‡ç”¨å¤šçº¿ç¨‹ï¼Œä¸€ä¸ªçº¿ç¨‹è´Ÿè´£è¯»å–ï¼Œä¸€ä¸ªçº¿ç¨‹è´Ÿè´£å‘é€\n- ç”±äºDataOutputStreaméœ€è¦å…³é—­æµæ‰èƒ½è¿›è¡Œå‘é€ï¼Œè€Œä¸€æ—¦å…³é—­äº†æµä¹Ÿå°±å…³é—­äº†Socketï¼Œä¼šæŠ›å‡ºSocket is closedå¼‚å¸¸,æ‰€ä»¥é‡‡ç”¨PrintWriterè€ŒéDataOutputStreamï¼ŒæœåŠ¡ç«¯åŒç†\n```java\nimport java.io.*;\nimport java.net.InetAddress;\nimport java.net.Socket;\nimport java.text.DateFormat;\nimport java.text.SimpleDateFormat;\nimport java.util.Date;\n\npublic class Client {\n    public static void main(String[] args) throws Exception {\n        //å®šä¹‰æ—¶é—´æ ¼å¼ç±»\n        DateFormat normal=new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\");\n        //å®šä¹‰SocketæŒ‡å‘æœ¬æœº8001ç«¯å£\n        Socket socket = new Socket(InetAddress.getByName(\"127.0.0.1\"), 8001);\n        //å®šä¹‰è¾“å…¥æµ\n        InputStream inputStream = socket.getInputStream();\n        //å®šä¹‰ç¼“å†²å­—ç¬¦è¾“å…¥æµ\n        BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(inputStream));\n        //å®šä¹‰è¾“å‡ºæµ\n        OutputStream outputStream = socket.getOutputStream();\n        //å®šä¹‰ç¼“å†²å­—ç¬¦è¾“å‡ºæµ\n        PrintWriter printWriter=new PrintWriter(outputStream);\n        while (true) {\n            int localPort = socket.getLocalPort();\n            String msg=localPort + \"port send a message to server\";\n            //å‘è¾“å‡ºæµä¸­å†™å…¥æ•°æ® \n            printWriter.println(msg);\n            //åˆ·æ–°ç¼“å†²åŒºï¼Œå‘æœåŠ¡ç«¯å‘é€ä¿¡æ¯ \n            printWriter.flush();\n            //å¦‚æœè¾“å…¥æµä¸­æœ‰æ•°æ®ï¼Œåˆ™è¯»å–\n            if (bufferedReader.ready()) {\n                System.out.print(normal.format(new Date())+\" Receive from Server:\");\n                System.out.println(bufferedReader.readLine());\n            }\n            try {\n                Thread.sleep(5000);\n            } catch (Exception e) {\n                e.printStackTrace();\n            }\n\n        }\n    }\n}\n```\n### æœåŠ¡ç«¯\n- æœåŠ¡ç«¯ç›¸æ¯”äºå®¢æˆ·ç«¯æ›´ä¸ºå¤æ‚ï¼Œé¦–å…ˆè€ƒè™‘ä½¿ç”¨çº¿ç¨‹æ± æ¥è¿›è¡Œå¤šä¸ªClientè¿æ¥\n- ä¸ºäº†å®ç°ç¾¤å‘æ•ˆæœï¼Œéœ€è¦ä½¿ç”¨Listè®°å½•å½“å‰å¤„äºè¿æ¥çŠ¶æ€çš„æ‰€æœ‰Socketï¼Œåœ¨ç¾¤å‘è¿‡ç¨‹ä¸­è¿›è¡Œé€ä¸ªéå†ï¼ŒåŒæ—¶æ›´æ–°Listå»é™¤å¤±å»è¿æ¥çš„Socketï¼Œä½¿ç”¨CopyOnWriteArrayListé˜²æ­¢çº¿ç¨‹ä¸åŒæ­¥\n```java\nimport java.io.*;\nimport java.net.ServerSocket;\nimport java.net.Socket;\nimport java.text.DateFormat;\nimport java.text.SimpleDateFormat;\nimport java.util.Date;\nimport java.util.Iterator;\nimport java.util.List;\nimport java.util.concurrent.CopyOnWriteArrayList;\nimport java.util.concurrent.Executors;\nimport java.util.concurrent.ThreadPoolExecutor;\n\npublic class Server {\n    public static void main(String[] args) throws Exception {\n        //å®šä¹‰æ—¶é—´æ ¼å¼åŒ–ç±»\n        DateFormat normal=new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\");\n        //å®šä¹‰å›ºå®šå¤§å°çº¿ç¨‹æ± \n        ThreadPoolExecutor executor = (ThreadPoolExecutor) Executors.newFixedThreadPool(4);\n        //å®šä¹‰ServerSocketç»‘å®š8001ç«¯å£\n        ServerSocket serverSocket = new ServerSocket(8001);\n        //å®šä¹‰åˆ—è¡¨å­˜å…¥å½“å‰å¤„äºè¿æ¥ä¸­çš„Socketï¼Œä¾¿äºç¾¤å‘\n        //ä½¿ç”¨CopyOnWriteArrayListé˜²æ­¢çº¿ç¨‹ä¸åŒæ­¥\n        List<Socket> sockets = new CopyOnWriteArrayList<Socket>();\n        while (true) {\n            System.out.println(normal.format(new Date())+\" Waiting...\");\n            //ç­‰å¾…è¿æ¥\n            Socket socket = serverSocket.accept();\n            //socketåŠ å…¥åˆ—è¡¨\n            sockets.add(socket);\n            System.out.println(normal.format(new Date())+\" Connecting successfully \" + socket.getInetAddress() + \":\" + socket.getPort());\n            //æ„é€ çº¿ç¨‹å¤„ç†socket\n            executor.execute(new SingleServer(sockets, socket));\n        }\n    }\n}\n\nclass SingleServer implements Runnable {\n    List<Socket> sockets;\n    Socket socket;\n\n    public SingleServer(List<Socket> sockets, Socket socket) {\n        this.sockets = sockets;\n        this.socket = socket;\n    }\n\n    @Override\n    public void run() {\n        //å®šä¹‰æ—¶é—´æ ¼å¼åŒ–ç±»\n        DateFormat normal=new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\");\n        try {\n            //å®šä¹‰è¾“å…¥æµ\n            InputStream inputStream = socket.getInputStream();\n            //å®šä¹‰ç¼“å†²å­—ç¬¦è¾“å…¥æµ\n            BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(inputStream));\n            while (true) {\n                //è¯»å–è¾“å…¥æµæ•°æ®\n                System.out.println(normal.format(new Date())+\" Receive from \" + socket.getInetAddress() + \":\" + socket.getPort() +\"  Message:\"+ bufferedReader.readLine());\n                synchronized (sockets) {\n                    Iterator<Socket> iterator=sockets.iterator();\n                    //é€ä¸ªéå†List\n                    while(iterator.hasNext()) {\n                        Socket soc=iterator.next();\n                        if (soc.isConnected()) {\n                            //å¦‚æœä¸æ˜¯å‘é€ç«¯Socket,åˆ™å‘å…¶ç¾¤å‘\n                            if (soc != socket) {\n                                OutputStream outputStream = soc.getOutputStream();\n                                PrintWriter printWriter = new PrintWriter(outputStream);\n                                printWriter.println(bufferedReader.readLine());\n                                printWriter.flush();\n                            }\n                        } else {\n                            //å»é™¤å¤±å»è¿æ¥çš„Socket\n                            iterator.remove();\n                        }\n                    }\n                }\n                Thread.sleep(100);\n            }\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n}\n```\n\n## NIOç¼–ç¨‹\n### è¦æ±‚\n- è¯·åŸºäºNIO(ç¬¬6ç« ç¬¬å…­èŠ‚çš„NIOï¼ŒéAIO)ç¼–å†™ä¸€ä¸ªç¾¤èŠçš„ç¨‹åºï¼ŒåŒ…æ‹¬æœåŠ¡ç«¯ç¨‹åºå’Œå®¢æˆ·ç«¯ç¨‹åºã€‚ \n- æœåŠ¡ç«¯åŠŸèƒ½ï¼šåªç”¨ä¸€ä¸ªçº¿ç¨‹ï¼Œæ”¶åˆ°æŸå®¢æˆ·ç«¯çš„ä¿¡æ¯ï¼Œå°†æ¶ˆæ¯åœ¨æ§åˆ¶å°è¾“å‡ºï¼Œç„¶åï¼Œå‘ç»™å…¶ä»–å¦å¤–çš„å®¢æˆ·ç«¯ã€‚\n- å®¢æˆ·ç«¯åŠŸèƒ½ï¼šæ¯éš”5ç§’å‘é€ä¸€æ¡ä¿¡æ¯ç»™æœåŠ¡ç«¯ã€‚ç„¶åæ¥æ”¶æœåŠ¡å™¨è½¬å‘è¿‡æ¥çš„æ¶ˆæ¯ï¼Œå¹¶åœ¨æ§åˆ¶å°è¾“å‡ºã€‚\n### å®¢æˆ·ç«¯\n- å’ŒTCPç¼–ç¨‹ä¸åŒï¼Œå®¢æˆ·ç«¯çš„Selectorè½®è¯¢éœ€è¦ä¸åœåœ°è¿›è¡Œï¼Œè€Œå‘é€æ¶ˆæ¯éœ€è¦æ¯éš”5ç§’è¿›è¡Œï¼Œæ— æ³•è¿›è¡Œä¸²è¡Œç¼–å†™ï¼Œæ‰€ä»¥éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹è¿›è¡Œå‘é€æ¶ˆæ¯\n```java\nimport java.io.IOException;\nimport java.net.InetSocketAddress;\nimport java.nio.ByteBuffer;\nimport java.nio.channels.SelectionKey;\nimport java.nio.channels.Selector;\nimport java.nio.channels.SocketChannel;\nimport java.nio.charset.StandardCharsets;\nimport java.text.DateFormat;\nimport java.text.SimpleDateFormat;\nimport java.util.Date;\nimport java.util.Iterator;\nimport java.util.Set;\n\npublic class Client {\n\n    public static void main(String[] args) throws Exception {\n        //å®šä¹‰Selector\n        Selector selector = Selector.open();\n        //å®šä¹‰SocketChannel\n        SocketChannel socketChannel = SocketChannel.open();\n        //è®¾ç½®éé˜»å¡æ¨¡å¼\n        socketChannel.configureBlocking(false);\n        //è¿æ¥æœåŠ¡ç«¯å¹¶æ³¨å†Œäº‹ä»¶\n        if (socketChannel.connect(new InetSocketAddress(\"127.0.0.1\", 8001))) {\n            socketChannel.register(selector, SelectionKey.OP_READ);\n        } else {\n            socketChannel.register(selector, SelectionKey.OP_CONNECT);\n        }\n        //æ„é€ æ–°çº¿ç¨‹å‘æœåŠ¡ç«¯å‘é€æ¶ˆæ¯\n        new Thread(new DoWrite(socketChannel)).start();\n        //é€‰æ‹©å™¨è½®è¯¢\n        while (true) {\n            try {\n                //1000mså“åº”æ—¶é—´\n                selector.select(1000);\n                //è·å¾—æ„Ÿå…´è¶£äº‹ä»¶çš„SelectionKey\n                Set<SelectionKey> selectionKeys = selector.selectedKeys();\n                Iterator<SelectionKey> iterator = selectionKeys.iterator();\n                //é€ä¸ªéå†\n                while (iterator.hasNext()) {\n                    SelectionKey key = iterator.next();\n                    iterator.remove();\n                    try {\n                        //å¤„ç†\n                        handleInput(selector, key);\n                    } catch (Exception e) {\n                        if (key != null) {\n                            key.cancel();\n                            if (key.channel() != null) {\n                                key.channel().close();\n                            }\n                        }\n                    }\n                }\n            } catch (Exception e) {\n                e.printStackTrace();\n            }\n        }\n    }\n\n    private static void handleInput(Selector selector, SelectionKey key) throws Exception {\n        //å®šä¹‰æ—¶é—´æ ¼å¼åŒ–ç±»\n        DateFormat normal = new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\");\n        if (key.isValid()) {\n            //è·å¾—Keyçš„SocketChannel\n            SocketChannel socketChannel = (SocketChannel) key.channel();\n            //è¿æ¥çŠ¶æ€(è¿æ¥ä¸­)\n            if (key.isConnectable()) {\n                //å¦‚æœè¿æ¥æˆåŠŸåˆ™å‘Selectoræ³¨å†ŒREADäº‹ä»¶\n                if (socketChannel.finishConnect()) {\n                    socketChannel.register(selector, SelectionKey.OP_READ);\n                }\n            }\n            //å¯è¯»çŠ¶æ€(æ”¶åˆ°æœåŠ¡ç«¯çš„æ•°æ®)\n            if (key.isReadable()) {\n                ByteBuffer byteBuffer = ByteBuffer.allocate(1024);\n                //è¯»å–socketChannelä¸­çš„æ•°æ®\n                int readBytes = socketChannel.read(byteBuffer);\n                if (readBytes > 0) {\n                    //å†™å…¥buffer->è¯»å–buffer\n                    byteBuffer.flip();\n                    byte[] bytes = new byte[byteBuffer.remaining()];\n                    byteBuffer.get(bytes);\n                    String message = new String(bytes, \"UTF-8\");\n                    System.out.println(normal.format(new Date()) + \" Receive from Server:\" + message);\n                } else if (readBytes < 0) {\n                    key.cancel();\n                    socketChannel.close();\n                }\n            }\n        }\n    }\n}\nclass DoWrite implements Runnable{\n    private SocketChannel socketChannel;\n\n    public DoWrite(SocketChannel socketChannel) {\n        this.socketChannel = socketChannel;\n    }\n    @Override\n    public void run() {\n        while(true) {\n            try {\n                //å…ˆä¼‘çœ 5ç§’é˜²æ­¢æœªæˆåŠŸè¿æ¥\n                Thread.sleep(5000);\n                int localPort=socketChannel.socket().getLocalPort();\n                String message=localPort + \"port send a message to server\";\n                byte[] str=message.getBytes(StandardCharsets.UTF_8);\n                ByteBuffer buffer=ByteBuffer.allocate(str.length);\n                buffer.put(str);\n                //å†™å…¥buffer->è¯»å–buffer\n                buffer.flip();\n                //å‘SocketChannelå†™å…¥æ•°æ®\n                socketChannel.write(buffer);\n            } catch (Exception e) {\n                e.printStackTrace();\n            }\n        }\n    }\n}\n```\n### æœåŠ¡ç«¯\n- å’Œå®¢æˆ·ç«¯ç±»ä¼¼ï¼Œæ•…ä¸å†èµ˜è¿°\n```java\nimport java.io.IOException;\nimport java.net.InetSocketAddress;\nimport java.nio.ByteBuffer;\nimport java.nio.channels.SelectionKey;\nimport java.nio.channels.Selector;\nimport java.nio.channels.ServerSocketChannel;\nimport java.nio.channels.SocketChannel;\nimport java.nio.charset.Charset;\nimport java.text.DateFormat;\nimport java.text.SimpleDateFormat;\nimport java.util.Date;\nimport java.util.Iterator;\nimport java.util.Set;\n\npublic class Server {\n\n    public static void main(String[] args) throws Exception {\n        int port = 8001;\n        //å®šä¹‰Selector\n        Selector selector = Selector.open();\n        //å®šä¹‰ServerSocketChannel\n        ServerSocketChannel socketChannel = ServerSocketChannel.open();\n        //è®¾ç½®éé˜»å¡æ¨¡å¼\n        socketChannel.configureBlocking(false);\n        //ServerSocketChannelç»‘å®šç«¯å£\n        socketChannel.socket().bind(new InetSocketAddress(port), 1024);\n        //æ³¨å†Œäº‹ä»¶ä¸ºOP_ACCEPT\n        socketChannel.register(selector, SelectionKey.OP_ACCEPT);\n        //é€‰æ‹©å™¨è½®è¯¢\n        while (true) {\n            System.out.println(\"Waiting...\");\n            //1000mså“åº”æ—¶é—´\n            selector.select(1000);\n            //è·å¾—æ„Ÿå…´è¶£äº‹ä»¶çš„SelectionKey\n            Set<SelectionKey> selectionKeySet = selector.selectedKeys();\n            Iterator<SelectionKey> iterator = selectionKeySet.iterator();\n\n            while (iterator.hasNext()) {\n                SelectionKey key = iterator.next();\n                iterator.remove();\n                try {\n                    //å¤„ç†\n                    handleInput(selector, key);\n                } catch (Exception e) {\n                    if (key != null) {\n                        key.cancel();\n                        if (key.channel() != null) {\n                            key.channel().close();\n                        }\n                    }\n                }\n            }\n            try {\n                Thread.sleep(500);\n            } catch (Exception e) {\n                e.printStackTrace();\n            }\n        }\n    }\n\n    public static void handleInput(Selector selector, SelectionKey key) throws IOException {\n        DateFormat normal = new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\");\n        if (key.isValid()) {\n            //æ¥æ”¶çŠ¶æ€(æ”¶åˆ°å®¢æˆ·ç«¯çš„è¿æ¥è¯·æ±‚)\n            if (key.isAcceptable()) {\n                ServerSocketChannel serverSocketChannel = (ServerSocketChannel) key.channel();\n                //æ¥æ”¶å®¢æˆ·ç«¯çš„è¿æ¥\n                SocketChannel socketChannel = serverSocketChannel.accept();\n                //è®¾ç½®éé˜»å¡æ¨¡å¼\n                socketChannel.configureBlocking(false);\n                //æ³¨å†Œäº‹ä»¶ä¸ºREAD\n                socketChannel.register(selector, SelectionKey.OP_READ);\n                System.out.println(normal.format(new Date())+\" Connecting successfully \" + socketChannel.socket().getInetAddress() + \":\" + socketChannel.socket().getPort());\n            }\n            //å¯è¯»çŠ¶æ€(æ”¶åˆ°å®¢æˆ·ç«¯çš„æ•°æ®)\n            if (key.isReadable()) {\n                SocketChannel socketChannel = (SocketChannel) key.channel();\n                ByteBuffer byteBuffer = ByteBuffer.allocate(1024);\n                //è¯»å–socketChannelä¸­çš„æ•°æ®\n                int readBytes = socketChannel.read(byteBuffer);\n                if (readBytes > 0) {\n                    //å†™å…¥buffer->è¯»å–buffer\n                    byteBuffer.flip();\n                    byte[] bytes = new byte[byteBuffer.remaining()];\n                    byteBuffer.get(bytes);\n                    String message = new String(bytes, \"UTF-8\");\n                    System.out.println(normal.format(new Date()) + \" Receive from \" + socketChannel.socket().getInetAddress() + \":\" + socketChannel.socket().getPort() + \"  Message:\" + message);\n                    //ç¾¤å‘æ“ä½œ\n                    broadcastClient(message, selector, socketChannel);\n                } else if (readBytes < 0) {\n                    key.cancel();\n                    socketChannel.close();\n                }\n            }\n        }\n    }\n\n    private static void broadcastClient(String message, Selector selector, SocketChannel socketChannel) throws IOException {\n        //è·å¾—æ‰€æœ‰è¿æ¥ä¸­çš„key\n        Set<SelectionKey> keys = selector.keys();\n        Iterator<SelectionKey> iterator = keys.iterator();\n        while (iterator.hasNext()) {\n            SelectionKey key = iterator.next();\n            //å¦‚æœä¸æ˜¯å‘é€ç«¯Socket,åˆ™å‘å…¶ç¾¤å‘\n            if (key.channel() != socketChannel && key.channel() instanceof SocketChannel) {\n                ((SocketChannel) key.channel()).write(Charset.forName(\"UTF-8\").encode(message));\n            }\n        }\n    }\n}\n```","tags":["Java"],"categories":["Java","Javaè¿›é˜¶"]},{"title":"JVMå†…å­˜ç®¡ç†","url":"/20210922/java-jvm/","content":"## **1.JVMæ¦‚è¿°**\n### **è™šæ‹Ÿæœºï¼šVM, Virtual Machine**\n- é€»è¾‘ä¸Šï¼Œä¸€å°è™šæ‹Ÿçš„è®¡ç®—æœº\n- å®é™…ä¸Šï¼Œä¸€ä¸ªè½¯ä»¶ï¼Œèƒ½å¤Ÿæ‰§è¡Œä¸€ç³»åˆ—è™šæ‹Ÿçš„è®¡ç®—æŒ‡ä»¤\n- ç³»ç»Ÿè™šæ‹Ÿæœº\n    - å¯¹ç‰©ç†è®¡ç®—æœºçš„ä»¿çœŸ\n    - å¦‚VMWareï¼ŒOracle VirtualBoxç­‰ \n- è½¯ä»¶è™šæ‹Ÿæœº\n    - ä¸“é—¨ä¸ºå•ä¸ªè®¡ç®—ç¨‹åºè€Œè®¾è®¡\n    - å¦‚JVMç­‰\n\n## **2.JVMå†…å­˜åˆ†ç±»**\n- çº¿ç¨‹ç§æœ‰å†…å­˜\n    - ç¨‹åºè®¡æ•°å™¨(Program Counter Register)\n    - Javaè™šæ‹Ÿæœºæ ˆ(JVM Stack)\n    - æœ¬åœ°æ–¹æ³•æ ˆ(Native Method Stack)\n- å¤šçº¿ç¨‹å…±äº«å†…å­˜\n    - å †(Heap)\n    - æ–¹æ³•åŒº(Method Area)\n        - è¿è¡Œæ—¶å¸¸é‡æ± \n\n### **ç¨‹åºè®¡æ•°å™¨**\n- Program Counter Register, **ä¸€å—å°å†…å­˜ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰**\n- PCå­˜å‚¨å½“å‰æ–¹æ³•\n    - çº¿ç¨‹æ­£åœ¨æ‰§è¡Œçš„æ–¹æ³•ç§°ä¸ºè¯¥çº¿ç¨‹çš„å½“å‰æ–¹æ³•\n- å½“å‰æ–¹æ³•ä¸ºæœ¬åœ°(native)æ–¹æ³•æ—¶, pcå€¼æœªå®šä¹‰(undefined)\n- æ–¹æ³•ä¸ºéæœ¬åœ°æ–¹æ³•æ—¶ï¼ŒpcåŒ…å«äº†å½“å‰æ­£åœ¨æ‰§è¡ŒæŒ‡ä»¤çš„åœ°å€\n- ä¸ä¼šå¼•å‘OutOfMemoryErrorå¼‚å¸¸\n\n###  **JVM æ ˆ(JVM Stackï¼ŒJava æ ˆ)** \n- çº¿ç¨‹æœ‰è‡ªå·±ç‹¬ç«‹çš„Javaè™šæ‹Ÿæœºæ ˆï¼Œ**çº¿ç¨‹ç§æœ‰**\n- **-Xssè®¾ç½®æ¯ä¸ªçº¿ç¨‹å †æ ˆå¤§å°**\n- Javaæ–¹æ³•çš„æ‰§è¡ŒåŸºäºæ ˆ\n    - æ¯ä¸ªæ–¹æ³•ä»è°ƒç”¨åˆ°å®Œæˆå¯¹åº”ä¸€ä¸ªæ ˆå¸§åœ¨æ ˆä¸­å…¥æ ˆã€å‡ºæ ˆçš„è¿‡ç¨‹\n        - æ ˆå¸§å­˜å‚¨å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆç­‰\n        - **å±€éƒ¨å˜é‡è¡¨å­˜æ”¾æ–¹æ³•ä¸­å­˜åœ¨â€œæ ˆâ€é‡Œé¢çš„ä¸œè¥¿**\n- å¼•å‘çš„å¼‚å¸¸\n    - æ ˆçš„æ·±åº¦è¶…è¿‡è™šæ‹Ÿæœºè§„å®šæ·±åº¦ï¼ŒStackOverflowErrorå¼‚å¸¸\n    - æ— æ³•æ‰©å±•å†…å­˜ï¼ŒOutOfMemoryErrorå¼‚å¸¸\n\n### **æœ¬åœ°æ–¹æ³•æ ˆ(Native Method Stacks)**\n- å­˜å‚¨nativeæ–¹æ³•çš„æ‰§è¡Œä¿¡æ¯ï¼Œ**çº¿ç¨‹ç§æœ‰**\n- **VMè§„èŒƒæ²¡æœ‰å¯¹æœ¬åœ°æ–¹æ³•æ ˆåšæ˜æ˜¾è§„å®š**\n- å¼•å‘çš„å¼‚å¸¸\n    - æ ˆçš„æ·±åº¦è¶…è¿‡è™šæ‹Ÿæœºè§„å®šæ·±åº¦ï¼ŒStackOverflowErrorå¼‚å¸¸\n    - æ— æ³•æ‰©å±•å†…å­˜ï¼ŒOutOfMemoryErrorå¼‚å¸¸\n\n### **å †(Heap)**\n- è™šæ‹Ÿæœºå¯åŠ¨æ—¶åˆ›å»ºï¼Œ**æ‰€æœ‰çº¿ç¨‹å…±äº«ï¼Œå åœ°æœ€å¤§**\n- å¯¹è±¡å®ä¾‹å’Œæ•°ç»„éƒ½æ˜¯åœ¨å †ä¸Šåˆ†é…å†…å­˜\n- åƒåœ¾å›æ”¶çš„ä¸»è¦åŒºåŸŸ\n- è®¾ç½®å¤§å°\n    - -Xms åˆå§‹å †å€¼ï¼Œ-Xmxæœ€å¤§å †å€¼\n- å¼•å‘çš„å¼‚å¸¸\n    - æ— æ³•æ»¡è¶³å†…å­˜åˆ†é…è¦æ±‚ï¼ŒOutOfMemoryErrorå¼‚å¸¸\n\n### **æ–¹æ³•åŒº(Method Area)**\n- å­˜å‚¨JVMå·²ç»åŠ è½½ç±»çš„ç»“æ„ï¼Œ**æ‰€æœ‰çº¿ç¨‹å…±äº«**\n    - è¿è¡Œæ—¶å¸¸é‡æ± ã€ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ç­‰\n- JVMå¯åŠ¨æ—¶åˆ›å»ºï¼Œé€»è¾‘ä¸Šå±äºå †(Heap)çš„ä¸€éƒ¨åˆ†\n- å¾ˆå°‘åšåƒåœ¾å›æ”¶\n- å¼•å‘çš„å¼‚å¸¸\n    - æ— æ³•æ»¡è¶³å†…å­˜åˆ†é…è¦æ±‚ï¼Œ OutOfMemoryErrorå¼‚å¸¸\n\n### **è¿è¡Œæ—¶å¸¸é‡æ± (Run-Time Constant Pool)**\n- Classæ–‡ä»¶ä¸­å¸¸é‡æ± çš„è¿è¡Œæ—¶è¡¨ç¤º\n- å±äºæ–¹æ³•åŒºçš„ä¸€éƒ¨åˆ†\n- åŠ¨æ€æ€§\n    - Javaè¯­è¨€å¹¶ä¸è¦æ±‚å¸¸é‡ä¸€å®šåªæœ‰åœ¨ç¼–è¯‘æœŸäº§ç”Ÿ\n    - æ¯”å¦‚String.internæ–¹æ³•\n- å¼•å‘çš„å¼‚å¸¸\n    - æ— æ³•æ»¡è¶³å†…å­˜åˆ†é…è¦æ±‚ï¼ŒOutOfMemoryErrorå¼‚å¸¸\n\n|åç§°|çº¿ç¨‹ç§æœ‰/å…±äº«|åŠŸèƒ½|å¤§å°|å¼‚å¸¸|\n|-|-|-|-|-|\n|ç¨‹åºè®¡æ•°å™¨|ç§æœ‰|ä¿å­˜å½“å‰çº¿ç¨‹æ‰§è¡Œæ–¹æ³•|é€šå¸¸å›ºå®šå¤§å°|ä¸ä¼š|\nJVMæ ˆ|ç§æœ‰|æ–¹æ³•çš„æ ˆå¸§|-Xss StackOverflowError|OutOfMemoryError|\næœ¬åœ°æ–¹æ³•æ ˆ|ç§æœ‰|å­˜å‚¨nativeæ–¹æ³•ä¿¡æ¯|é€šå¸¸å›ºå®šå¤§å°|StackOverflowErroã€OutOfMemoryError\nå †|å…±äº«|å­˜å‚¨å¯¹è±¡å’Œæ•°ç»„|-Xms|åˆå§‹å †å€¼|-Xmxæœ€å¤§å †å€¼|OutOfMemoryError\næ–¹æ³•åŒº|å…±äº«|å­˜å‚¨ç±»ç»“æ„/å¸¸é‡/é™æ€å˜é‡|-XXå‚æ•°è®¾ç½®|OutOfMemoryError\nè¿è¡Œæ—¶å¸¸é‡æ± |å…±äº«|å¸¸é‡æ± è¿è¡Œæ—¶è¡¨ç¤º|ä»å±äºæ–¹æ³•åŒº|OutOfMemoryError\n\n## **3.JVMå†…å­˜å‚æ•°**\n- å †(Heap)\n    - å…±äº«ï¼Œå†…å­˜å¤§æˆ·ï¼Œå­˜å‚¨æ‰€æœ‰çš„å¯¹è±¡å’Œæ•°ç»„\n    - -Xms åˆå§‹å †å€¼ï¼Œ-Xmxæœ€å¤§å †å€¼\n- JVM æ ˆ(JVM Stack)\n    - çº¿ç¨‹ç§æœ‰ï¼Œå­˜å‚¨ç±»ä¸­æ¯ä¸ªæ–¹æ³•çš„å†…å®¹\n    - -Xss æœ€å¤§æ ˆå€¼\n- æ–¹æ³•åŒº (Method Area)\n    - å­˜å‚¨ç±»ä¿¡æ¯ã€å¸¸é‡æ± ç­‰\n    - 1.7åŠä»¥å‰ï¼Œæ°¸ä¹…åŒº(Perm)ï¼Œ-XX:PermSize, -XX:MaxPermSize\n    - 1.8åŠä»¥åï¼Œå…ƒæ•°æ®åŒºï¼Œ-XX:MetaspaceSize, -XX:MaxMetaspaceSize\n\n## **4.Javaå¯¹è±¡å¼•ç”¨**\n### **Javaå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸ**\n- å¯¹è±¡é€šè¿‡æ„é€ å‡½æ•°åˆ›å»ºï¼Œä½†æ˜¯æ²¡æœ‰ææ„å‡½æ•°å›æ”¶å†…å­˜\n- å¯¹è±¡å­˜æ´»åœ¨ç¦»å®ƒæœ€è¿‘çš„ä¸€å¯¹å¤§æ‹¬å·ä¸­\n\n### **å†…å­˜å›æ”¶API**\n- Objectçš„finalizeæ–¹æ³•ï¼Œåƒåœ¾æ”¶é›†å™¨åœ¨å›æ”¶å¯¹è±¡æ—¶è°ƒç”¨ï¼Œæœ‰ä¸”ä»…è¢«è°ƒ\nç”¨ä¸€æ¬¡\n- Systemçš„gcæ–¹æ³•ï¼Œè¿è¡Œåƒåœ¾æ”¶é›†å™¨\n\n- åŸºäºå¯¹è±¡å¼•ç”¨åˆ¤å®šæ— ç”¨å¯¹è±¡\n    - é›¶å¼•ç”¨ï¼Œäº’å¼•ç”¨ç­‰\n- å¯¹è±¡å¼•ç”¨é“¾\n    - é€šè¿‡ä¸€ç³»åˆ—çš„ç§°ä¸º\"GC Roots\"çš„å¯¹è±¡ä½œä¸ºèµ·å§‹ç‚¹ï¼Œä»è¿™äº›èŠ‚ç‚¹å¼€å§‹å‘ä¸‹æœç´¢ï¼Œæœç´¢æ‰€èµ°è¿‡çš„è·¯å¾„ç§°ä¸ºå¼•ç”¨é“¾ï¼ˆReference Chainï¼‰ï¼Œå½“ä¸€ä¸ªå¯¹è±¡åˆ°GC Rootsæ²¡æœ‰ä»»ä½•å¼•ç”¨é“¾ç›¸è¿ï¼ˆç”¨å›¾è®ºçš„è¯æ¥è¯´ï¼Œå°±æ˜¯ä»GC Rootsåˆ°è¿™ä¸ªå¯¹è±¡ä¸å¯è¾¾ï¼‰æ—¶ï¼Œåˆ™è¯æ˜æ­¤å¯¹è±¡æ˜¯ä¸å¯ç”¨çš„\n- GC Rootså¯¹è±¡åŒ…æ‹¬\n    - è™šæ‹Ÿæœºæ ˆä¸­å¼•ç”¨çš„å¯¹è±¡\n    - æ–¹æ³•åŒºä¸­ç±»é™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡\n    - æ–¹æ³•åŒºä¸­å¸¸é‡å¼•ç”¨çš„å¯¹è±¡\n    - æœ¬åœ°æ–¹æ³•æ ˆä¸­å¼•ç”¨çš„å¯¹è±¡\n\n- å¼ºå¼•ç”¨\n    - ä¾‹å¦‚Object obj = new Object(); Object obj2 = obj;\n    - åªè¦å¼ºå¼•ç”¨è¿˜å­˜åœ¨ï¼Œå¯¹è±¡å°±ä¸ä¼šè¢«å›æ”¶ï¼Œå“ªæ€•å‘ç”ŸOOMå¼‚å¸¸\n- è½¯å¼•ç”¨\n    - æè¿°æœ‰ç”¨ä½†å¹¶éå¿…éœ€çš„å¯¹è±¡\n    - åœ¨ç³»ç»Ÿå°†è¦å‘ç”Ÿå†…å­˜æº¢å‡ºå¼‚å¸¸ä¹‹å‰ï¼Œä¼šæŠŠè¿™äº›å¯¹è±¡åˆ—ä¸ºå¯å›æ”¶\n    - JDKæä¾›äº†SoftReferenceç±»æ¥å®ç°è½¯å¼•ç”¨\n    ```java\n    SoftReference<StringBuilder> s2 = new SoftReference<StringBuilder>(s1);\n    ```\n- å¼±å¼•ç”¨\n    - æè¿°éå¿…éœ€å¯¹è±¡ï¼Œæ¯”è½¯å¼•ç”¨å¼ºåº¦æ›´å¼±äº›\n    - è¢«å¼±å¼•ç”¨å…³è”çš„å¯¹è±¡åªèƒ½ç”Ÿå­˜åˆ°ä¸‹ä¸€æ¬¡åƒåœ¾æ”¶é›†å‘ç”Ÿä¹‹å‰\n    - JDKæä¾›äº†WeakReferenceç±»æ¥å®ç°å¼±å¼•ç”¨\n    ```java\n    SoftReference<StringBuilder> s2 = new SoftReference<StringBuilder>(s1);\n    ```\n- è™šå¼•ç”¨\n    - æœ€å¼±çš„å¼•ç”¨å…³ç³»ï¼ŒJDKæä¾›PhantomReferenceå®ç°è™šå¼•ç”¨\n    - ä¸ºä¸€ä¸ªå¯¹è±¡è®¾ç½®è™šå¼•ç”¨å…³è”çš„å”¯ä¸€ç›®çš„å°±æ˜¯èƒ½åœ¨è¿™ä¸ªå¯¹è±¡è¢«æ”¶é›†å™¨å›æ”¶æ—¶æ”¶åˆ°ä¸€ä¸ªç³»ç»Ÿé€šçŸ¥ï¼Œç”¨äºå¯¹è±¡å›æ”¶è·Ÿè¸ª\n    ```java\n    PhantomReference<StringBuilder> s2 = new PhantomReference<StringBuilder>(s1);\n    ```\n\n|å¼•ç”¨ç±»å‹|å¼ºå¼•ç”¨|è½¯å¼•ç”¨|å¼±å¼•ç”¨|è™šå¼•ç”¨|\n|-|-|-|-|-|\n|ç±»å‹|æ­£å¸¸èµ‹å€¼|SoftReference|WeakReference|PhantomReference\n|å›æ”¶æ—¶é—´|ä¸å›æ”¶|å†…å­˜ç´§å¼ æ—¶å›æ”¶|GCå°±å›æ”¶|éšæ—¶å¯èƒ½è¢«å›æ”¶\n\n\n## **5.åƒåœ¾æ”¶é›†ç®—æ³•**\n### **å¼•ç”¨è®¡æ•°æ³•**\n- ä¸€ç§å¤è€çš„ç®—æ³•\n- æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªå¼•ç”¨è®¡æ•°å™¨\n- æœ‰å¼•ç”¨ï¼Œè®¡æ•°å™¨åŠ ä¸€ï¼Œå½“å¼•ç”¨å¤±æ•ˆï¼Œè®¡æ•°å™¨å‡ä¸€\n- è®¡æ•°å™¨ä¸º0çš„å¯¹è±¡ï¼Œå°†è¢«å›æ”¶\n- ä¼˜ç‚¹\n    - ç®€å•ï¼Œæ•ˆç‡é«˜\n- ç¼ºç‚¹\n    - æ— æ³•è¯†åˆ«å¯¹è±¡ä¹‹é—´ç›¸äº’å¾ªç¯å¼•ç”¨\n\n### **æ ‡è®°-æ¸…é™¤**\n- æ ‡è®°é˜¶æ®µï¼šæ ‡è®°å‡ºæ‰€æœ‰éœ€è¦å›æ”¶çš„å¯¹è±¡\n- å›æ”¶é˜¶æ®µï¼šç»Ÿä¸€å›æ”¶æ‰€æœ‰è¢«æ ‡è®°çš„å¯¹è±¡\n- ä¼˜ç‚¹\n    - ç®€å•\n- ç¼ºç‚¹\n    - æ•ˆç‡ä¸é«˜\n    - å†…å­˜ç¢ç‰‡\n\n### **å¤åˆ¶ç®—æ³•**\n- å°†å¯ç”¨å†…å­˜æŒ‰å®¹é‡åˆ’åˆ†ä¸ºå¤§å°ç›¸ç­‰çš„ä¸¤å—ï¼Œæ¯æ¬¡åªä½¿ç”¨å…¶ä¸­çš„ä¸€å—\n- å½“è¿™ä¸€å—çš„å†…å­˜ç”¨å®Œäº†ï¼Œå°±å°†è¿˜å­˜æ´»ç€çš„å¯¹è±¡å¤åˆ¶åˆ°å¦å¤–ä¸€å—ä¸Šé¢\n- ç„¶åå†æŠŠå·²ä½¿ç”¨è¿‡çš„å†…å­˜ç©ºé—´ä¸€æ¬¡æ¸…ç†æ‰\n- ä¼˜ç‚¹\n    - ç®€å•ã€é«˜æ•ˆ\n- ç¼ºç‚¹\n    - å¯ç”¨å†…å­˜å‡å°‘\n    - å¯¹è±¡å­˜æ´»ç‡é«˜æ—¶å¤åˆ¶æ“ä½œè¾ƒå¤š\n\n### **æ ‡è®°-æ•´ç†**\n- æ ‡è®°é˜¶æ®µï¼šä¸â€œæ ‡è®°-æ¸…é™¤â€ç®—æ³•ä¸€æ ·\n- æ•´ç†é˜¶æ®µï¼šè®©æ‰€æœ‰å­˜æ´»çš„å¯¹è±¡éƒ½å‘ä¸€ç«¯ç§»åŠ¨ï¼Œç„¶åç›´æ¥æ¸…ç†æ‰ç«¯è¾¹ç•Œä»¥å¤–çš„å†…å­˜\n- ä¼˜ç‚¹\n    - é¿å…ç¢ç‰‡äº§ç”Ÿ\n    - æ— éœ€ä¸¤å—ç›¸åŒå†…å­˜\n- ç¼ºç‚¹\n    - è®¡ç®—ä»£ä»·å¤§ï¼Œæ ‡è®°æ¸…é™¤+ç¢ç‰‡æ•´ç†s â€“æ›´æ–°å¼•ç”¨åœ°å€\n\n### **åˆ†ä»£æ”¶é›†**\n- Javaå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸä¸åŒï¼Œæœ‰é•¿æœ‰çŸ­\n- æ ¹æ®å¯¹è±¡å­˜æ´»å‘¨æœŸï¼Œå°†å†…å­˜åˆ’åˆ†æ–°ç”Ÿä»£å’Œè€å¹´ä»£\n- æ–°ç”Ÿä»£(Young Generation)\n    - ä¸»è¦å­˜æ”¾çŸ­æš‚ç”Ÿå‘½å‘¨æœŸçš„å¯¹è±¡\n    - æ–°åˆ›å»ºçš„å¯¹è±¡éƒ½å…ˆæ”¾å…¥æ–°ç”Ÿä»£ï¼Œå¤§éƒ¨åˆ†æ–°å»ºå¯¹è±¡åœ¨ç¬¬ä¸€æ¬¡gcæ—¶è¢«å›æ”¶\n- è€å¹´ä»£(Tenured Generation)\n    - ä¸€ä¸ªå¯¹è±¡ç»è¿‡å‡ æ¬¡gcä»å­˜æ´»ï¼Œåˆ™æ”¾å…¥è€å¹´ä»£\n    - è¿™äº›å¯¹è±¡å¯ä»¥æ´»å¾ˆé•¿æ—¶é—´ï¼Œæˆ–è€…ä¼´éšç¨‹åºä¸€ç”Ÿï¼Œéœ€è¦å¸¸é©»å†…å­˜çš„ï¼Œå¯ä»¥å‡å°‘å›æ”¶æ¬¡æ•°\n\n### **åˆ†ä»£æ”¶é›†**\n- é’ˆå¯¹å„ä¸ªå¹´ä»£ç‰¹ç‚¹é‡‡ç”¨åˆé€‚çš„æ”¶é›†ç®—æ³•\n    - æ–°ç”Ÿä»£ å¤åˆ¶ç®—æ³•\n    - è€å¹´ä»£ æ ‡è®°æ¸…é™¤æˆ–æ ‡è®°æ•´ç†\n\n## **6.JVMå †å†…å­˜å‚æ•°è®¾ç½®**\n- -Xmsåˆå§‹å †å¤§å°\n- -Xmxæœ€å¤§å †å¤§å°\n- -Xmnæ–°ç”Ÿä»£å¤§å°\n- -XX:SurvivorRatioè®¾ç½®edenåŒº/from(to)çš„æ¯”ä¾‹\n- -XX:NewRatioè®¾ç½®è€å¹´ä»£/æ–°ç”Ÿä»£æ¯”ä¾‹\n- -XX:+PrintGC/-XX:+PrintGCDetails æ‰“å°GCçš„è¿‡ç¨‹ä¿¡æ¯\n\n### **HotSpotç°æœ‰åƒåœ¾æ”¶é›†å™¨(JDK 13)**\n- ä¸²è¡Œæ”¶é›†å™¨(Serial Collector)\n- å¹¶è¡Œæ”¶é›†å™¨(Parallel Collector)\n- CMSæ”¶é›†å™¨(Concurrent Mark Sweep Collector)\n- G1æ”¶é›†å™¨(Garbage-First Collector)\n- Zæ”¶é›†å™¨(Z Garbage Collector)\n","tags":["Java"],"categories":["Java","Javaé«˜é˜¶"]},{"title":"Java ç±»åŠ è½½å™¨","url":"/20210922/java-classloader/","content":"## **1.ç±»åŠ è½½æœºåˆ¶**\n### **ç±»åŠ è½½å™¨ClassLoader**\n- è´Ÿè´£æŸ¥æ‰¾ã€åŠ è½½ã€æ ¡éªŒå­—èŠ‚ç çš„åº”ç”¨ç¨‹åº\n- java.lang.ClassLoader\n    - load(String className) æ ¹æ®åå­—åŠ è½½ä¸€ä¸ªç±»ï¼Œè¿”å›ç±»çš„å®ä¾‹\n    - defineClass(String name, byte[] b, int off, int len) å°†ä¸€ä¸ªå­—èŠ‚æµå®šä¹‰ä¸€ä¸ªç±»\n    - findClass(String name) æŸ¥æ‰¾ä¸€ä¸ªç±»\n    - findLoadedClass(String name) åœ¨å·²åŠ è½½çš„ç±»ä¸­ï¼ŒæŸ¥æ‰¾ä¸€ä¸ªç±»\n    - **æˆå‘˜å˜é‡ ClassLoader parent**\n\n### **JVMå››çº§ç±»åŠ è½½å™¨**\n- **å¯åŠ¨ç±»åŠ è½½å™¨(Bootstrap)ï¼Œç³»ç»Ÿç±»rt.jar**\n- **æ‰©å±•ç±»åŠ è½½å™¨(Extension)ï¼Œjre/lib/ext**\n- **åº”ç”¨ç±»åŠ è½½å™¨(App)ï¼Œclasspath**\n- ç”¨æˆ·è‡ªå®šä¹‰åŠ è½½å™¨(Plugin)ï¼Œç¨‹åºè‡ªå®šä¹‰\n\n### **ç±»åŠ è½½å™¨åŒäº²å§”æ‰˜**\n- é¦–å…ˆåˆ¤æ–­æ˜¯å¦å·²ç»åŠ è½½\n- è‹¥æ— ï¼Œæ‰¾çˆ¶åŠ è½½å™¨åŠ è½½\n- è‹¥å†æ— ï¼Œç”±å½“å‰åŠ è½½å™¨åŠ è½½\n\n## **2.åŒäº²å§”æ‰˜åŠ è½½æ‰©å±•**\n- Javaä¸¥æ ¼æ‰§è¡ŒåŒäº²å§”æ‰˜æœºåˆ¶\n    - ç±»ä¼šç”±æœ€é¡¶å±‚çš„åŠ è½½å™¨æ¥åŠ è½½ï¼Œå¦‚æ²¡æœ‰ï¼Œæ‰ç”±ä¸‹çº§åŠ è½½å™¨åŠ è½½\n    - å§”æ‰˜æ˜¯å•å‘çš„ï¼Œç¡®ä¿ä¸Šå±‚æ ¸å¿ƒçš„ç±»çš„æ­£ç¡®æ€§\n    - **ä½†æ˜¯ä¸Šçº§ç±»åŠ è½½å™¨æ‰€åŠ è½½çš„ç±»ï¼Œæ— æ³•è®¿é—®ä¸‹çº§ç±»åŠ è½½å™¨æ‰€åŠ è½½çš„ç±»**\n        - ä¾‹å¦‚ï¼Œjava.lang.String æ— æ³•è®¿é—®è‡ªå®šä¹‰çš„ä¸€ä¸ªTestç±» \n        - Javaæ˜¯ä¸€ä¸ªéµå¾ªå¥‘çº¦è®¾è®¡çš„ç¨‹åºè¯­è¨€ï¼Œæ ¸å¿ƒç±»åº“æä¾›æ¥å£ï¼Œåº”ç”¨å±‚æä¾›å®ç°\n        - æ ¸å¿ƒç±»åº“æ˜¯BootstrapClassLoaderåŠ è½½\n        - åº”ç”¨å±‚æ˜¯AppClassLoaderåŠ è½½\n        - å…¸å‹ä¾‹å­æ˜¯JDBCå’ŒXML Parserç­‰\n\n### **åŒäº²å§”æ‰˜çš„è¡¥å……**\n- æ‰§è¡ŒJavaï¼Œæ·»åŠ è™šæ‹Ÿæœºå‚æ•°-Xbootclasspath/a:pathï¼Œå°†ç±»è·¯å¾„é…ç½®ä¸ºBootstrapç­‰çº§\n- ä½¿ç”¨ServiceLoader.loadæ–¹æ³•ï¼Œæ¥åŠ è½½(åº•å±‚åŠ è½½å™¨æ‰€åŠ è½½çš„ç±»)\n\n### **ServiceLoader**\n- JDK 6å¼•å…¥çš„ä¸€ç§æ–°ç‰¹æ€§ï¼Œæ˜¯ç”¨äºåŠ è½½æœåŠ¡çš„ä¸€ç§å·¥å…·\n- æœåŠ¡æœ‰æ¥å£å®šä¹‰å’Œå…·ä½“çš„å®ç°ç±»(æœåŠ¡æä¾›è€…) \n- **SPIæœºåˆ¶**ï¼ŒService Provider Interface\n- ä¸€ä¸ªæœåŠ¡æä¾›è€…ä¼šåœ¨jaråŒ…ä¸­æœ‰META-INF/servicesç›®å½•ï¼Œé‡Œé¢æ”¾ä¸€ä¸ªæ–‡ä»¶ï¼Œåå­—åŒæ¥å£åå­—ã€‚å†…å®¹çš„æ¯ä¸€è¡Œéƒ½æ˜¯æ¥å£çš„ä¸€ä¸ªå®ç°ç±»\n- loadæ–¹æ³•ï¼Œå¯ä»¥ç”¨**å½“å‰çº¿ç¨‹çš„ç±»åŠ è½½å™¨**æ¥è·å–æŸæ¥å£çš„æ‰€æœ‰å®ç°ï¼Œå½“ç„¶ä¹Ÿéƒ½æ˜¯è½¬ä¸ºæ¥å£ç±»æ¥ä½¿ç”¨\n- **æ³¨æ„ï¼šæ­¤æœåŠ¡å’ŒJava 9æ¨¡å—ç³»ç»Ÿçš„æœåŠ¡ç•¥æœ‰å·®åˆ«ï¼Œä½†æ˜¯éƒ½èƒ½é€šè¿‡ServiceLoaderè¿›è¡ŒåŠ è½½**\n\n## **3.è‡ªå®šä¹‰ç±»åŠ è½½è·¯å¾„**\n### **è‡ªå®šä¹‰ç±»åŠ è½½å™¨**\n- è‡ªå®šä¹‰åŠ è½½è·¯å¾„\n    - å¼¥è¡¥ç±»æœç´¢è·¯å¾„é™æ€çš„ä¸è¶³\n    - URLClassLoader, ä»å¤šä¸ªURL(jaræˆ–è€…ç›®å½•)ä¸­åŠ è½½ç±»\n- è‡ªå®šä¹‰ç±»åŠ è½½å™¨\n    - ç»§æ‰¿ClassLoaderç±» \n    - é‡å†™findClass(String className)æ–¹æ³•\n\n### **è‡ªå®šä¹‰åŠ è½½è·¯å¾„**\n- å¼¥è¡¥ç±»æœç´¢è·¯å¾„é™æ€çš„ä¸è¶³\n- å‰3ä¸ªåŠ è½½çš„è·¯å¾„éƒ½æ˜¯è¿è¡Œå‰ç¡®å®šçš„\n- Javaæä¾›URLClassLoader\n    - ç¨‹åºè¿è¡Œæ—¶ä¿®æ”¹ç±»çš„åŠ è½½è·¯å¾„\n    - å¯ä»å¤šä¸ªæ¥æºä¸­åŠ è½½ç±»\n\n### **URLClassLoader**\n- ç»§æ‰¿äºClassLoader\n- ç¨‹åºè¿è¡Œæ—¶å¢åŠ æ–°çš„ç±»åŠ è½½è·¯å¾„\n- å¯ä»å¤šä¸ªæ¥æºä¸­åŠ è½½ç±»\n    - ç›®å½•\n    - jaråŒ… \n    - ç½‘ç»œ\n- addURLæ·»åŠ è·¯å¾„\n- closeæ–¹æ³•å…³é—­\n```java\n//URLæ”¯æŒhttp, https, file, jar å››ç§åè®®\nURL url = new URL(\"file:E:/java/source/PMOOC11-03-First/bin/\");\n//URL url = new URL(\"file:C:/Users/Tom/Desktop/PMOOC11-03-First.jar\");\n\n//ç¨‹åºè¿è¡Œæ—¶ï¼Œæ·»åŠ ä¸€ä¸ªclasspathè·¯å¾„\nURLClassLoader loader = new URLClassLoader(new URL[]{url});\nClass<?> c = loader.loadClass(\"edu.ecnu.Hello\");\n\n//é‡‡ç”¨åå°„è°ƒç”¨\nMethod m = c.getMethod(\"say\");\nm.invoke(c.newInstance());\n```\n\n## **4.è‡ªå®šä¹‰ç±»åŠ è½½å™¨**\n- ç»§æ‰¿ClassLoaderç±» \n- **é‡å†™findClass(String className)æ–¹æ³•**\n- ä½¿ç”¨æ—¶ï¼Œé»˜è®¤å…ˆè°ƒç”¨loadClass(className)æ¥æŸ¥çœ‹æ˜¯å¦å·²ç»åŠ è½½è¿‡ï¼Œç„¶åå§”æ‰˜åŒäº²åŠ è½½ï¼Œå¦‚æœéƒ½æ²¡æœ‰ï¼Œå†é€šè¿‡findClassåŠ è½½è¿”å›\n    - åœ¨findClassä¸­ï¼Œé¦–å…ˆè¯»å–å­—èŠ‚ç æ–‡ä»¶\n    - ç„¶åï¼Œè°ƒç”¨defineClass(className, bytes, off, len) å°†ç±»æ³¨å†Œåˆ°è™šæ‹Ÿæœºä¸­\n    - å¯ä»¥é‡å†™loadClassæ–¹æ³•æ¥çªç ´åŒäº²åŠ è½½\n- åŒä¸€ä¸ªç±»å¯ä»¥è¢«ä¸åŒå±‚çº§çš„åŠ è½½å™¨åŠ è½½ï¼Œä¸”ä½œä¸º2ä¸ªç±»å¯¹å¾…\n```java\nclass CryptoClassLoader extends ClassLoader \n{\n   private int key = 3; \n   \n   public Class<?> findClass(String name) throws ClassNotFoundException\n   {\n      try\n      {\n         byte[] classBytes = null;\n         //è¯»å–Hello.caesaræ–‡ä»¶ï¼Œå¾—åˆ°æ‰€æœ‰å­—èŠ‚æµ\n         classBytes = loadClassBytes(name);\n         //è°ƒç”¨defineClassæ–¹æ³•äº§ç”Ÿä¸€ä¸ªç±»ï¼Œå¹¶åœ¨VMä¸­æ³¨å†Œ\n         Class<?> cl = defineClass(name, classBytes, 0, classBytes.length);\n         if (cl == null) throw new ClassNotFoundException(name);\n         return cl;\n      }\n      catch (IOException e)\n      {\n         throw new ClassNotFoundException(name);\n      }\n   }\n\n   /**\n    * Loads and decrypt the class file bytes.\n    * @param name the class name\n    * @return an array with the class file bytes\n    */\n   private byte[] loadClassBytes(String name) throws IOException\n   {\n      String cname = \"E:/java/source/PMOOC11-04/bin/edu/ecnu/Hello.caesar\";\n      byte[] bytes = Files.readAllBytes(Paths.get(cname));\n      for (int i = 0; i < bytes.length; i++)\n         bytes[i] = (byte) (bytes[i] - key);\n      return bytes;\n   }\n}\n```\n","tags":["Java"],"categories":["Java","Javaé«˜é˜¶"]},{"title":"Java å­—èŠ‚ç ","url":"/20210922/java-bytecode/","content":"## **1.å­—èŠ‚ç æ¦‚è¿°**\n- classæ–‡ä»¶ï¼šå­—èŠ‚ç (bytecode)æ–‡ä»¶\n    - classæ–‡ä»¶æ˜¯Javaâ€œä¸€æ¬¡ç¼–è¯‘ï¼Œåˆ°å¤„è¿è¡Œâ€çš„åŸºç¡€\n    - classæ–‡ä»¶å…·å¤‡å¹³å°æ— å…³æ€§ï¼Œç”±JVMæ‰§è¡Œ\n    - æ¯ä¸ªclassæ–‡ä»¶åŒ…å«äº†ä¸€ä¸ªç±»æˆ–æ¥å£æˆ–æ¨¡å—çš„å®šä¹‰\n    - classæ–‡ä»¶æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç”±JVMå®šä¹‰classæ–‡ä»¶çš„è§„èŒƒ\n    - ä»»ä½•æ»¡è¶³è¿™ç§è§„èŒƒçš„classæ–‡ä»¶éƒ½ä¼šè¢«JVMåŠ è½½è¿è¡Œ\n    - classæ–‡ä»¶å¯ä»¥ç”±å…¶ä»–è¯­è¨€ç¼–è¯‘ç”Ÿæˆï¼Œç”šè‡³ä¸ç”¨ç¨‹åºè¯­è¨€ç›´æ¥ç”Ÿæˆ\n    - JDKç‰ˆæœ¬ä¸åŒï¼Œæ‰€ç¼–è¯‘å‡º.classæ–‡ä»¶ç•¥æœ‰ä¸åŒ\n\n## **2.å­—èŠ‚ç æ–‡ä»¶æ„æˆ**\n### **classæ–‡ä»¶æ„æˆ**\n- é‡‡ç”¨ç±»ä¼¼äºCè¯­è¨€ç»“æ„ä½“çš„ç»“æ„æ¥è¡¨ç¤ºæ•°æ®\n- åŒ…æ‹¬ä¸¤ç§æ•°æ®ç±»å‹\n    - å®šé•¿æ•°æ®ï¼šæ— ç¬¦å·æ•°ï¼Œu1, u2, u4 (åˆ†åˆ«ä»£è¡¨1ä¸ªå­—èŠ‚ã€2ä¸ªå­—èŠ‚ã€4ä¸ªå­—èŠ‚çš„æ— ç¬¦å·æ•°) \n    - ä¸å®šé•¿æ•°æ®ï¼šç”±å¤šä¸ªæ— ç¬¦å·æ•°ç»„æˆï¼Œé€šå¸¸åœ¨æ•°æ®çš„å‰é¢ç»™å‡ºå…¶é•¿åº¦\n\n### **é­”æ•°**\n- å‰4ä¸ªå­—èŠ‚ä¸ºé­”æ•°ï¼Œåå…­è¿›åˆ¶è¡¨ç¤ºä¸º0xCAFEBABEï¼Œæ ‡è¯†è¯¥æ–‡ä»¶ä¸ºclassæ–‡ä»¶\n\n### **ç‰ˆæœ¬å·**\n- ç¬¬5ã€6å­—èŠ‚è¡¨ç¤ºæ¬¡ç‰ˆæœ¬å·\n- 7ã€8å­—èŠ‚è¡¨ç¤ºä¸»ç‰ˆæœ¬å·\n- ä¸»ç‰ˆæœ¬å·ä¸JDKç‰ˆæœ¬æœ‰æ˜ å°„å…³ç³»\n\n### **å¸¸é‡æ± **\n- å¸¸é‡æ± ä¸»è¦å­˜æ”¾ä¸¤å¤§ç±»å¸¸é‡\n- å­—é¢é‡\n    - å¦‚æ–‡æœ¬å­—ç¬¦ä¸²ã€finalçš„å¸¸é‡å€¼ç­‰\n- ç¬¦å·å¼•ç”¨\n    - ç±»å’Œæ¥å£çš„å…¨é™å®šå\n    - å­—æ®µçš„åç§°å’Œæè¿°ç¬¦\n    - æ–¹æ³•çš„åç§°å’Œæè¿°ç¬¦\n\n### **è®¿é—®æ ‡å¿—**\n- å¸¸é‡æ± ç»“æŸä¹‹åçš„ä¸¤ä¸ªå­—èŠ‚ï¼Œæè¿°è¯¥Classæ˜¯ç±»è¿˜æ˜¯æ¥å£ï¼Œä»¥åŠæ˜¯å¦è¢«publicã€abstractã€finalç­‰ä¿®é¥°ç¬¦ä¿®é¥°\n\n### **ç±»ç´¢å¼•ã€çˆ¶ç±»ç´¢å¼•ä¸æ¥å£ç´¢å¼•é›†åˆ**\n- ç±»ç´¢å¼•\n    - è®¿é—®æ ‡å¿—åçš„ä¸¤ä¸ªå­—èŠ‚ï¼Œæè¿°çš„æ˜¯å½“å‰ç±»çš„å…¨é™å®šå\n    - è¿™ä¸¤ä¸ªå­—èŠ‚ä¿å­˜çš„å€¼ä¸ºå¸¸é‡æ± ä¸­çš„ç´¢å¼•å€¼ï¼Œæ ¹æ®ç´¢å¼•å€¼å°±èƒ½åœ¨å¸¸é‡æ± ä¸­æ‰¾åˆ°è¿™ä¸ªç±»çš„å…¨é™å®šå\n- çˆ¶ç±»ç´¢å¼•\n    -å½“å‰ç±»ååçš„ä¸¤ä¸ªå­—èŠ‚ï¼Œæè¿°çˆ¶ç±»çš„å…¨é™å®šåï¼ŒåŒä¸Šï¼Œä¿å­˜çš„ä¹Ÿæ˜¯å¸¸é‡æ± ä¸­çš„ç´¢å¼•å€¼\n- æ¥å£ç´¢å¼•é›†åˆ\n    - çˆ¶ç±»åç§°åä¸ºä¸¤å­—èŠ‚çš„æ¥å£è®¡æ•°å™¨ï¼Œæè¿°äº†è¯¥ç±»æˆ–çˆ¶ç±»å®ç°çš„æ¥å£æ•°é‡\n    - ç´§æ¥ç€çš„nä¸ªå­—èŠ‚æ˜¯æ‰€æœ‰æ¥å£åç§°çš„å­—ç¬¦ä¸²å¸¸é‡çš„ç´¢å¼•å€¼\n\n### **å­—æ®µè¡¨**\n- å­—æ®µè¡¨ç”¨äºæè¿°ç±»å’Œæ¥å£ä¸­å£°æ˜çš„å˜é‡ï¼ŒåŒ…å«ç±»çº§åˆ«çš„å˜é‡ä»¥åŠå®ä¾‹å˜é‡ï¼Œä½†æ˜¯ä¸åŒ…å«æ–¹æ³•å†…éƒ¨å£°æ˜çš„å±€éƒ¨å˜é‡\n- å­—æ®µè¡¨ä¹Ÿåˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œç¬¬ä¸€éƒ¨åˆ†ä¸ºä¸¤ä¸ªå­—èŠ‚ï¼Œæè¿°å­—æ®µä¸ªæ•°ï¼›ç¬¬äºŒéƒ¨åˆ†æ˜¯æ¯ä¸ªå­—æ®µçš„è¯¦ç»†ä¿¡æ¯fields_info\n- æ–¹æ³•éƒ¨åˆ†å±æ€§\n    - Codeï¼Œæºä»£ç å¯¹åº”çš„JVMæŒ‡ä»¤æ“ä½œç \n    - LineNumberTableï¼Œè¡Œå·è¡¨ï¼Œå°†CodeåŒºçš„æ“ä½œç å’Œæºä»£ç ä¸­çš„è¡Œå·å¯¹åº”\n\n### **æ–¹æ³•è¡¨**\n- å­—æ®µè¡¨ç»“æŸåä¸ºæ–¹æ³•è¡¨ï¼Œæ–¹æ³•è¡¨ä¹Ÿæ˜¯ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œç¬¬ä¸€éƒ¨åˆ†ä¸ºä¸¤ä¸ªå­—èŠ‚æè¿°æ–¹æ³•çš„ä¸ªæ•°\n- ç¬¬äºŒéƒ¨åˆ†ä¸ºæ¯ä¸ªæ–¹æ³•çš„è¯¦ç»†ä¿¡æ¯ã€‚æ–¹æ³•çš„è¯¦ç»†ä¿¡æ¯è¾ƒä¸ºå¤æ‚ï¼ŒåŒ…æ‹¬æ–¹æ³•çš„è®¿é—®æ ‡å¿—ã€æ–¹æ³•åã€æ–¹æ³•çš„æè¿°ç¬¦ä»¥åŠæ–¹æ³•çš„å±æ€§\n\n### **é™„åŠ å±æ€§**\n- å­—èŠ‚ç çš„æœ€åä¸€éƒ¨åˆ†ï¼Œè¯¥é¡¹å­˜æ”¾äº†åœ¨è¯¥æ–‡ä»¶ä¸­ç±»æˆ–æ¥å£æ‰€å®šä¹‰å±æ€§çš„åŸºæœ¬ä¿¡æ¯\n- å±æ€§ä¿¡æ¯ç›¸å¯¹çµæ´»ï¼Œç¼–è¯‘å™¨å¯è‡ªç”±å†™å…¥å±æ€§ä¿¡æ¯ï¼ŒJVMä¼šå¿½ç•¥ä¸è®¤è¯†çš„å±æ€§ä¿¡æ¯\n\n## **3.å­—èŠ‚ç æŒ‡ä»¤åˆ†ç±»**\n### **å­—èŠ‚ç åˆ†ç±»**\n- åŠ è½½å’Œå­˜å‚¨æŒ‡ä»¤\n    - ç”¨äºå°†æ•°æ®åœ¨æ ˆå¸§ä¸­çš„å±€éƒ¨å˜é‡è¡¨å’Œæ“ä½œæ•°æ ˆä¹‹é—´æ¥å›ä¼ è¾“\n    - å°†ä¸€ä¸ªå±€éƒ¨å˜é‡åŠ è½½åˆ°æ“ä½œæ ˆï¼šiloadã€lloadã€floadã€dloadã€aloadç­‰ \n    - å°†ä¸€ä¸ªæ•°å€¼ä»æ“ä½œæ•°æ ˆå­˜å‚¨åˆ°å±€éƒ¨å˜é‡è¡¨ï¼šistoreã€lstoreã€fstoreã€dstoreã€astoreç­‰ \n    - å°†ä¸€ä¸ªå¸¸é‡åŠ è½½åˆ°æ“ä½œæ•°æ ˆï¼šbipushã€sipushã€ldcã€ldc_wã€ldc2_wã€aconst_nullã€iconst_m1ç­‰\n- è¿ç®—æŒ‡ä»¤\n    - iaddã€isubã€imulã€idivç­‰ \n- ç±»å‹è½¬æ¢æŒ‡ä»¤\n    - i2bã€i2lã€i2sç­‰ \n- å¯¹è±¡/æ•°ç»„åˆ›å»ºä¸è®¿é—®æŒ‡ä»¤\n    - newã€newarrayã€getfieldç­‰ \n- æ“ä½œæ•°æ ˆç®¡ç†æŒ‡ä»¤\n    - popã€dupç­‰\n- æ§åˆ¶è½¬ç§»æŒ‡ä»¤\n    - Ifeqã€gotoç­‰ \n- æ–¹æ³•è°ƒç”¨å’Œè¿”å›æŒ‡ä»¤\n    - invokevirtualã€ireturnç­‰ \n- å¼‚å¸¸å¤„ç†æŒ‡ä»¤\n    - athrow\n- åŒæ­¥æ§åˆ¶æŒ‡ä»¤\n    - monitorenterã€monitorexit\n\n### **å­—èŠ‚ç æŒ‡ä»¤ç®€ä»‹**\n- JVMæŒ‡ä»¤ç”±æ“ä½œç å’Œé›¶è‡³å¤šä¸ªæ“ä½œæ•°ç»„æˆ\n    - æ“ä½œç ï¼ˆOpCodeï¼Œä»£è¡¨ç€æŸç§ç‰¹å®šæ“ä½œå«ä¹‰çš„æ•°å­—ï¼‰\n    - æ“ä½œæ•°ï¼ˆOperandï¼Œæ“ä½œæ‰€éœ€å‚æ•°ï¼‰\n- JVMçš„æŒ‡ä»¤é›†æ˜¯åŸºäºæ ˆè€Œä¸æ˜¯å¯„å­˜å™¨\n    - å­—èŠ‚ç æŒ‡ä»¤æ§åˆ¶çš„æ˜¯JVMæ“ä½œæ•°æ ˆ\n\n## **4.å­—èŠ‚ç æ“ä½œASM**\n- å­—èŠ‚ç æ“ä½œï¼šæŒ‡ä»¤å±‚æ¬¡è¾ƒä¸ºå¤æ‚\n- å¾ˆå¤šç¬¬ä¸‰æ–¹å­—èŠ‚ç å·¥å…·åŒ…\n    - https://www.open-open.com/project/tag/zijie-ma-caozuo.html\n- ASMæ˜¯ç”Ÿæˆã€è½¬æ¢ã€åˆ†æclassæ–‡ä»¶çš„å·¥å…·åŒ…\n    - https://asm.ow2.io/\n    - ä½“ç§¯å°ã€è½»é‡ã€å¿«é€Ÿã€æ–‡æ¡£å®Œå–„ï¼Œè¢«ä¼—å¤šå¼€æºé¡¹ç›®é‡‡ç”¨\n        - Groovy/Kotlin Compiler\n        - Gradle\n        - Jacoco //ä»£ç è¦†ç›–ç‡ç»Ÿè®¡\n        - Mockito // Java Test Mockæ¡†æ¶\n\n### **ASM API**\n- Core API\n    - ç±»æ¯”è§£æXMLæ–‡ä»¶ä¸­çš„SAXæ–¹å¼\n    - ä¸éœ€è¦è¯»å–ç±»çš„æ•´ä¸ªç»“æ„ï¼Œä½¿ç”¨æµå¼çš„æ–¹æ³•æ¥å¤„ç†å­—èŠ‚ç æ–‡ä»¶\n    - éå¸¸èŠ‚çº¦å†…å­˜ï¼Œä½†æ˜¯ç¼–ç¨‹éš¾åº¦è¾ƒå¤§\n    - å‡ºäºæ€§èƒ½è€ƒè™‘ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ç¼–ç¨‹éƒ½ä½¿ç”¨Core API\n- Tree API\n    - ç±»æ¯”è§£æXMLæ–‡ä»¶ä¸­çš„DOMæ–¹å¼ï¼ŒæŠŠæ•´ä¸ªç±»çš„ç»“æ„è¯»å–åˆ°å†…å­˜ä¸­\n    - æ¶ˆè€—å†…å­˜å¤šï¼Œä½†æ˜¯ç¼–ç¨‹æ¯”è¾ƒç®€å•\n    - é€šè¿‡å„ç§Nodeç±»æ¥æ˜ å°„å­—èŠ‚ç çš„å„ä¸ªåŒºåŸŸ\n\n### **ASM API æ ¸å¿ƒç±»**\n- æ ¸å¿ƒç±»\n    - ClassReader ç”¨äºè¯»å–å·²ç»ç¼–è¯‘å¥½çš„.classæ–‡ä»¶\n    - ClassWriter ç”¨äºé‡æ–°æ„å»ºç¼–è¯‘åçš„ç±»\n        - å¦‚ä¿®æ”¹ç±»åã€å±æ€§ä»¥åŠæ–¹æ³•ï¼Œä¹Ÿå¯ä»¥ç”Ÿæˆæ–°çš„ç±»çš„å­—èŠ‚ç æ–‡ä»¶\n- Visitorç±» \n    - CoreAPIæ ¹æ®å­—èŠ‚ç ä»ä¸Šåˆ°ä¸‹ä¾æ¬¡å¤„ç†\n    - å¯¹äºå­—èŠ‚ç æ–‡ä»¶ä¸­ä¸åŒçš„åŒºåŸŸæœ‰ä¸åŒçš„Visitor\n        -  MethodVisitor ç”¨äºè®¿é—®ç±»æ–¹æ³•\n        -  FieldVisitor è®¿é—®ç±»å˜é‡\n        -  AnnotationVisitor ç”¨äºè®¿é—®æ³¨è§£\n```java\n//ä¿®æ”¹å­—èŠ‚ç æ–‡ä»¶\npublic class MyClassVisitor extends ClassVisitor implements Opcodes {\n    private static String methodName;\n\n    public MyClassVisitor(ClassVisitor cv) {\n        super(ASM5, cv);\n    }\n\n    @Override\n    public void visit(int version, int access, String name, String signature, String superName, String[] interfaces) {\n        cv.visit(version, access, name, signature, superName, interfaces);\n    }\n\n    @Override\n    public MethodVisitor visitMethod(int access, String name, String desc, String signature, String[] exceptions) {\n        MethodVisitor mv = cv.visitMethod(access, name, desc, signature, exceptions);\n        // å¿½ç•¥æ„é€ æ–¹æ³•\n        if (!name.equals(\"<init>\") && mv != null) {\n            methodName = name;\n            mv = new MyMethodVisitor(mv);\n        }\n        return mv;\n    }\n\n    class MyMethodVisitor extends MethodVisitor implements Opcodes {\n        public MyMethodVisitor(MethodVisitor mv) {\n            super(Opcodes.ASM5, mv);\n        }\n        \n        public void visitCode() {\n            super.visitCode();\n            //æ–¹æ³•è¿›å…¥æ—¶æ‰“å°ä¿¡æ¯\n            //æ‹¿åˆ°java.lang.Systemç±»çš„.out staticå­—æ®µï¼Œå¹¶æ”¾å…¥æ ˆé¡¶\n            mv.visitFieldInsn(GETSTATIC, \"java/lang/System\", \"out\", \"Ljava/io/PrintStream;\");\n            // å°†å¾…è¾“å‡ºä¿¡æ¯æ”¾å…¥æ ˆé¡¶\n            mv.visitLdcInsn(\"method \" + methodName + \" is starting\");\n            //è°ƒç”¨printlnæ–¹æ³•\n            mv.visitMethodInsn(INVOKEVIRTUAL, \"java/io/PrintStream\", \"println\", \"(Ljava/lang/String;)V\", false);\n        }\n\n        public void visitInsn(int opcode) {\n            // åˆ¤æ–­returnæˆ–æŠ›å‡ºå¼‚å¸¸\n            if ((opcode >= Opcodes.IRETURN && opcode <= Opcodes.RETURN) || opcode == Opcodes.ATHROW) {\n                mv.visitFieldInsn(GETSTATIC, \"java/lang/System\", \"out\", \"Ljava/io/PrintStream;\");\n                mv.visitLdcInsn(\"method \" + methodName + \" is ending\");\n                mv.visitMethodInsn(INVOKEVIRTUAL, \"java/io/PrintStream\", \"println\", \"(Ljava/lang/String;)V\", false);\n            }\n            mv.visitInsn(opcode);\n        }\n    }\n}\n```\n\n```java\n//ç”Ÿæˆå­—èŠ‚ç æ–‡ä»¶\npublic class Generator {\n\n    public static void main(String[] args) throws Exception {\n        modifyGreeting();\n        createAsmGreeting();\n    }\n\n    public static void modifyGreeting() throws IOException {\n        // è¯»å–\n        ClassReader classReader = new ClassReader(\"com/test/Greeting\");\n        ClassWriter classWriter = new ClassWriter(ClassWriter.COMPUTE_MAXS);\n        // å¤„ç†\n        ClassVisitor classVisitor = new MyClassVisitor(classWriter);\n        classReader.accept(classVisitor, ClassReader.SKIP_DEBUG);\n        byte[] data = classWriter.toByteArray();\n        // è¾“å‡º\n        File f = new File(\"target/classes/com/test/Greeting.class\");\n        FileOutputStream fout = new FileOutputStream(f);\n        fout.write(data);\n        fout.close();\n        System.out.println(\"Modify Greeting Class success!!!!!\");\n    }\n\n    public static void createAsmGreeting() throws Exception {\n\n        ClassWriter cw = new ClassWriter(0);\n        MethodVisitor mv;\n        //ä¸»ç‰ˆæœ¬å·è®¾ä¸º49ï¼ŒJDK5ä¹‹åéƒ½å¯ä»¥è¿è¡Œ\n        cw.visit(49, Opcodes.ACC_PUBLIC + Opcodes.ACC_SUPER, \"com/test/AsmGreeting\", null, \"java/lang/Object\", null);\n\n        cw.visitSource(\"AsmGreeting.java\", null);\n\n        // æ— å‚æ„é€ æ–¹æ³•\n        mv = cw.visitMethod(Opcodes.ACC_PUBLIC, \"<init>\", \"()V\", null, null);\n        mv.visitVarInsn(Opcodes.ALOAD, 0); // å°†thisæ”¾å…¥æ ˆé¡¶\n        \n        //è°ƒç”¨super()\n        mv.visitMethodInsn(Opcodes.INVOKESPECIAL, \"java/lang/Object\", \"<init>\", \"()V\", false);\n        mv.visitInsn(Opcodes.RETURN);\n        mv.visitMaxs(1, 1);\n        mv.visitEnd();\n\n        // helloæ–¹æ³•ï¼Œæ— å‚æ— è¿”å›å€¼\n        mv = cw.visitMethod(Opcodes.ACC_PUBLIC + Opcodes.ACC_STATIC, \"hello\", \"()V\", null, null);\n        mv.visitFieldInsn(Opcodes.GETSTATIC, \"java/lang/System\", \"out\", \"Ljava/io/PrintStream;\");\n        mv.visitLdcInsn(\"Hello, this class is genrated by ASM\");\n        mv.visitMethodInsn(Opcodes.INVOKEVIRTUAL, \"java/io/PrintStream\", \"println\", \"(Ljava/lang/String;)V\", false);\n        mv.visitInsn(Opcodes.RETURN);\n        mv.visitMaxs(2, 1);\n        mv.visitEnd();\n\n        cw.visitEnd();\n        \n        \n        File f = new File(\"target/classes/com/test/AsmGreeting.class\");\n        FileOutputStream fout = new FileOutputStream(f);\n        fout.write(cw.toByteArray());\n        fout.close();\n        System.out.println(\"Create AsmGreeting success!!!!!\");\n    }\n}\n```\n\n## **5.å­—èŠ‚ç å¢å¼º**\n- å­—èŠ‚ç æ“ä½œï¼šé€šå¸¸åœ¨å­—èŠ‚ç ä½¿ç”¨ä¹‹å‰å®Œæˆ\n    - æºç ã€ç¼–è¯‘ã€(å­—èŠ‚ç æ“ä½œ)ã€è¿è¡Œ\n- å­—èŠ‚ç å¢å¼ºï¼šè¿è¡Œæ—¶å¯¹å­—èŠ‚ç è¿›è¡Œä¿®æ”¹/è°ƒæ¢\n    - Java ClassLoaderç±»åŠ è½½å™¨\n    - **Java Instrument**\n\n### **Java Instrument**\n- JDK 5 å¼•å…¥ï¼Œjava.lang.instrumentåŒ…\n- å¯¹ç¨‹åºçš„æ›¿æ¢ï¼Œéƒ½æ˜¯é€šè¿‡ä»£ç†ç¨‹åº(javaagent)è¿›è¡Œ\n- premainï¼šæ”¯æŒåœ¨mainå‡½æ•°ä¹‹å‰ï¼Œå¯¹ç±»çš„å­—èŠ‚ç è¿›è¡Œä¿®æ”¹/æ›¿æ¢\n- agentmainï¼šæ”¯æŒåœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ï¼Œå¯¹å­—èŠ‚ç è¿›è¡Œæ›¿æ¢\n\n### **Java è¿è¡Œå‰ä»£ç†**\n- **åœ¨mainå‡½æ•°è¿è¡Œä¹‹å‰ï¼Œä¿®æ”¹/æ›¿æ¢æŸç±»çš„å­—èŠ‚ç **\n- å¯åŠ¨Javaç¨‹åºæ—¶ï¼Œç»™java.exeå¢åŠ ä¸€ä¸ªå‚æ•°**javaagent:someone.jar**\n- åœ¨**someone.jar**çš„æ¸…å•æ–‡ä»¶(manifest)æŒ‡å®šäº†**Premain-Class:SomeAgent**\n- **SomeAgent**ç±»ä¸­ï¼Œæœ‰ä¸€ä¸ª**premain**æ–¹æ³•ï¼Œæ­¤æ–¹æ³•å…ˆäºmainè¿è¡Œ\n- **premain**æ–¹æ³•æœ‰ä¸€ä¸ª**Instrumentation**çš„å½¢å‚ï¼Œå¯ä»¥è°ƒç”¨**addTransformer**æ–¹æ³•ï¼Œå¢åŠ ä¸€ä¸ª**ClassTransformer**è½¬æ¢ç±»\n- è‡ªå®šä¹‰ä¸€ä¸ª**ClassTransformer**ç±» ï¼Œé‡å†™**tranform**æ–¹æ³•ï¼Œä¿®æ”¹/æ›¿æ¢å­—èŠ‚ç \n\n### **Java è¿è¡Œæ—¶ä»£ç†**\n- **åœ¨mainå‡½æ•°è¿è¡Œæ—¶ï¼Œä¿®æ”¹æŸç±»çš„å­—èŠ‚ç **\n    - Testè°ƒç”¨Greetingç±»å·¥ä½œ\n- ç¼–å†™**AttachToTest**ç±»ï¼Œå¯¹Testè¿›ç¨‹é™„åŠ ä¸€ä¸ª**agent(jar)**\n- åœ¨jarä¸­ï¼Œåˆ©ç”¨**Instrumentå¯¹Greeting**ç±»è¿›è¡Œ**retransformClasses**ï¼Œé‡æ–°åŠ è½½\n- å¯¹è¿›ç¨‹é™„åŠ agentï¼Œæ˜¯JVMTIçš„æŠ€æœ¯\n    - JVM Tool Interface\n\n### **ç±»æ›¿æ¢çš„æ³¨æ„äº‹é¡¹**\n- å¯ä»¥ä¿®æ”¹æ–¹æ³•ä½“å’Œå¸¸é‡æ± \n- ä¸å¯ä»¥å¢åŠ ã€ä¿®æ”¹æˆå‘˜å˜é‡/æ–¹æ³•å®šä¹‰\n- ä¸å¯ä»¥ä¿®æ”¹ç»§æ‰¿å…³ç³»\n- æœªæ¥ç‰ˆæœ¬è¿˜ä¼šå¢åŠ é™åˆ¶æ¡ä»¶\n\n## **6.å­—èŠ‚ç æ··æ·†**\n### **Javaå­—èŠ‚ç çš„å¼±ç‚¹**\n - Java å­—èŠ‚ç æ–‡ä»¶æœºåˆ¶\n- .javaæ–‡ä»¶æ˜¯ç¨‹åºæºç ï¼Œæ˜¯ç¨‹åºå‘˜æ™ºæ…§åŠ³åŠ¨çš„ç»“æ™¶ï¼Œéœ€è¦ä¿æŠ¤\n- å­—èŠ‚ç æ–‡ä»¶æ˜¯ç¨‹åºè¿è¡Œçš„ä¸»ä½“ï¼Œéµå®ˆJVMçš„è§„èŒƒï¼Œä¸”è¢«åˆ†å‘ä½¿ç”¨\n- ä¸ºäº†å„ç§éœ€è¦ï¼Œäº§ç”Ÿå‡ºå¾ˆå¤šåç¼–è¯‘å·¥å…·ï¼Œä»å­—èŠ‚ç æ¢å¤æºç \n    - javapï¼Œ JDKè‡ªå¸¦çš„ï¼Œå¯ä»¥è§£æå‡º(å¯é˜…è¯»çš„)å­—èŠ‚ç \n    - Jad, https://varaneckas.com/jad/, å†å²æœ€è€\n    - JD(Java Decompiler, http://java-decompiler.github.io/) \n    - Procyon, https://bitbucket.org/mstrobel/procyon/src/default/\n        - Luyten, GUIç‰ˆæœ¬ï¼Œhttps://github.com/deathmarine/Luyten\n    - CRFï¼Œ http://www.benf.org/other/cfr/\n\n### **Javaå­—èŠ‚ç çš„ä¿æŠ¤**\n- å­—èŠ‚ç ä¿æŠ¤\n    - å­—èŠ‚ç åŠ å¯†\n        - å¯¹å­—èŠ‚ç è¿›è¡ŒåŠ å¯†ï¼Œä¸å†éµå¾ªJVMåˆ¶å®šçš„è§„èŒƒ\n        - JVMåŠ è½½ä¹‹å‰ï¼Œå¯¹å­—èŠ‚ç è§£å¯†åï¼Œå†åŠ è½½\n- **å­—èŠ‚ç æ··æ·†**\n    - **è¢«æ··æ·†çš„ä»£ç ä¾ç„¶éµå¾ªJVMåˆ¶å®šçš„è§„èŒƒ**\n    - **å˜é‡å‘½åå’Œç¨‹åºæµç¨‹ä¸Šè¿›è¡Œç­‰æ•ˆæ›¿æ¢ï¼Œä½¿å¾—ç¨‹åºçš„å¯è¯»æ€§å˜å·®**\n    - **ä»£ç éš¾ä»¥è¢«ç†è§£å’Œé‡ç”¨ï¼Œè¾¾åˆ°ä¿æŠ¤ä»£ç çš„æ•ˆæœ**\n\n### **ProGuard**\n- æœ€è‘—åçš„Javaå­—èŠ‚ç æ··æ·†å™¨\n- https://www.guardsquare.com/en/products/proguard\n- é™¤äº†æ··æ·†ï¼Œä¹Ÿå…·æœ‰ä»£ç å‹ç¼©ã€ä¼˜åŒ–ã€é¢„æ£€ç­‰åŠŸèƒ½\n- å¯ä»¥å‘½ä»¤è¡Œè¿è¡Œï¼Œä¹Ÿå¯ä»¥é›†æˆåˆ°Eclipseç­‰IDEä¸­ä½¿ç”¨\n- ä¸ä»…å¯ä»¥å¤„ç†Javaä»£ç ï¼Œä¹Ÿå¯ä»¥å¤„ç†Androidçš„ä»£ç \n- ProGuardæ ¸å¿ƒé…ç½®æ–‡ä»¶\n    - ignorewarnings è·³è¿‡è­¦å‘Š\n    -  -verbose æ˜¾ç¤ºæ‰€æœ‰æ—¥å¿—\n    - -injars éœ€è¦è½¬åŒ–çš„å¯¹è±¡åœ°å€\n    - -outjars è¾“å‡ºçš„åœ°å€\n    - -libraryjars <java.home>/lib/rt.jar ç”¨åˆ°çš„æ”¯æŒåº“\n    - -printmapping proguard.map æŒ‡å®šè‡ªå®šä¹‰çš„æ··æ·†ç”¨çš„æ˜ å°„æ–‡ä»¶\n    - -dontshrink ä¸å‹ç¼©ï¼Œä¿æŒé¡¹ç›®åŸæœ‰ç±»å’Œæ–¹æ³•ï¼Œä»…å¯¹å‘½ååŠå†…å®¹è¿›è¡Œæ··æ·†\n    -  -keepclassmembers public class * {void set*(*** );*** name;}\n        - **ä¸æ··æ·†æŒ‡å®šåŒ¹é…çš„å†…å®¹ï¼ŒåŒ¹é…åˆ°çš„å†…å®¹æ‰€å±ç±»åä¾æ—§ä¼šè¢«æ··æ·†**\n    - -keepclasseswithmembers\n        - **ä¸ä¸Šé¢å¯¹åº”ï¼Œè¿™ä¸€é¡¹ä¼šè®©åŒ¹é…åˆ°çš„å†…å®¹æ‰€å±ç±»åä¹Ÿä¸è¢«æ··æ·†**\n    - -keep public class Proguard { void main(java.lang.String[]);}\n        - **ä¸æ··æ·†æŒ‡å®šç±»åŠæŒ‡å®šå…¶ä¸­çš„æˆå‘˜åŠæ–¹æ³•**\n\n### **ProGuardæ³¨æ„äº‹é¡¹**\n- åå°„è°ƒç”¨ç±»æˆ–è€…æ–¹æ³•ï¼Œå¯èƒ½å¤±è´¥\n- å¯¹å¤–æ¥å£çš„ç±»å’Œæ–¹æ³•ï¼Œä¸è¦æ··æ·†ï¼Œå¦åˆ™è°ƒç”¨å¤±è´¥\n- åµŒå¥—ç±»æ··æ·†ï¼Œå¯¼è‡´è°ƒç”¨å¤±è´¥\n- nativeçš„æ–¹æ³•ä¸è¦æ··æ·†\n- æšä¸¾ç±»ä¸è¦æ··æ·†\n- ......","tags":["Java"],"categories":["Java","Javaé«˜é˜¶"]},{"title":"Java æ¨¡å—åŒ–","url":"/20210922/java-modularization/","content":"## **1.æ¨¡å—åŒ–æ¦‚è¿°**\n### **Jar Hell**\n- jaræ–‡ä»¶æ— æ³•æ§åˆ¶åˆ«äººè®¿é—®å…¶å†…éƒ¨çš„publicçš„ç±»\n- æ— æ³•æ§åˆ¶ä¸åŒjaråŒ…ä¸­ï¼Œç›¸åŒçš„ç±»å(åŒ…å+ç±»å) \n- Javaè¿è¡Œæ—¶ï¼Œæ— æ³•åˆ¤å®šclasspathè·¯å¾„ä¸Šçš„jarä¸­æœ‰å¤šå°‘ä¸ªä¸åŒç‰ˆæœ¬çš„æ–‡ä»¶ã€‚JavaåŠ è½½ç¬¬ä¸€ä¸ªç¬¦åˆåå­—çš„ç±»\n- Javaè¿è¡Œæ—¶ï¼Œæ— æ³•é¢„åˆ¤classpathè·¯å¾„ä¸Šæ˜¯å¦ç¼ºå¤±äº†ä¸€äº›å…³é”®ç±»\n\n### **æ¨¡å—åŒ–ç³»ç»Ÿ**\n- æ¨¡å—åŒ–å¿…é¡»éµå¾ªçš„ä¸‰ä¸ªåŸåˆ™\n    - å¼ºå°è£…æ€§ï¼šä¸€ä¸ªæ¨¡å—å¿…é¡»èƒ½å¤Ÿå¯¹å…¶ä»–æ¨¡å—éšè—å…¶éƒ¨åˆ†ä»£ç \n    - å®šä¹‰è‰¯å¥½çš„æ¥å£ï¼šæ¨¡å—å¿…é¡»å‘å…¶ä»–æ¨¡å—å…¬å¼€å®šä¹‰è‰¯å¥½ä¸”ç¨³å®šçš„æ¥å£\n    - æ˜¾å¼ä¾èµ–ï¼šæ˜ç¡®ä¸€ä¸ªæ¨¡å—éœ€è¦å“ªäº›æ¨¡å—çš„æ”¯æŒæ‰èƒ½å®Œæˆå·¥ä½œ\n\n### **Jigsaw æ‹¼å›¾**\n- Java 9å¼€å§‹å¼•å…¥æ–°çš„æ¨¡å—åŒ–ç³»ç»Ÿï¼šJigsaw æ‹¼å›¾\n- **ä»¥æ¨¡å—(module)ä¸ºä¸­å¿ƒ**\n- å¯¹JDK æœ¬èº«è¿›è¡Œæ¨¡å—åŒ–\n- æä¾›ä¸€ä¸ªåº”ç”¨ç¨‹åºå¯ä»¥ä½¿ç”¨çš„æ¨¡å—ç³»ç»Ÿ\n- ä¼˜ç‚¹\n    - å¯é çš„é…ç½®\n    - å¼ºå°è£…æ€§\n    - å¯æ‰©å±•å¼€å‘\n    - å®‰å…¨æ€§\n    - æ€§èƒ½ä¼˜åŒ–\n\n## **2.æ¨¡å—åˆ›å»ºå’Œè¿è¡Œ**\n### **Java Jigsaw**\n- è‡ªJava 9 æ¨å‡ºï¼Œä»¥æ¨¡å—ä¸ºä¸­å¿ƒ\n- åœ¨æ¨¡å—ä¸­ï¼Œä»ä»¥åŒ…-ç±»æ–‡ä»¶ç»“æ„å­˜åœ¨\n- æ¯ä¸ªæ¨¡å—ä¸­ï¼Œéƒ½æœ‰ä¸€ä¸ªmodule-info.java\n    -  è¯´æ˜è¿™ä¸ªæ¨¡å—ä¾èµ–å“ªäº›å…¶ä»–çš„æ¨¡å—ï¼Œè¾“å‡ºæœ¬æ¨¡å—ä¸­å“ªäº›å†…å®¹\n```java\nmodule java.prefs {\n    requires java.xml;\n    \n    exports java.util.prefs;\n}\n```\n\n### **å‘½ä»¤è¡Œåˆ›å»º**\n- æ–°å»ºä¸€ä¸ªé¡¹ç›®ä¸»ç›®å½•ï¼Œå¦‚F:\\temp\\JavaModuleTest\n- åˆ›å»ºsrcç›®å½•(æ”¾java)ï¼Œmodulesç›®å½•(æ”¾class)ï¼Œlibç›®å½•(æ”¾jar)\n- åœ¨srcä¸‹é¢å»ºç«‹ä¸€ä¸ªç›®å½•module.hello(**æ¨¡å—åå­—ï¼Œå¯è‡ªç”±å®š**) \n- åœ¨module.helloç›®å½•ä¸‹ï¼Œå»ºç«‹cn\\helloç›®å½•ï¼Œå†å»ºç«‹HelloWorld.java\n- åœ¨module.helloç›®å½•ä¸‹ï¼Œå»ºç«‹ä¸€ä¸ªmodule-info.java\n- ç¼–è¯‘/è¿è¡Œ/æ‰“åŒ…\n- é“¾æ¥jlinkï¼Œåˆ¶ä½œè‡ªå®šä¹‰è¿è¡Œæ—¶æ˜ åƒ(custom runtime image)\n    -  èˆå¼ƒæ— ç”¨åºå¤§çš„JDKåº“ \n    -  é€‚åˆåœ¨å®¹å™¨ä¸­å¿«é€Ÿéƒ¨ç½²è¿è¡Œ\n\n### **Eclipseåˆ›å»º**\n- æ–°å»ºä¸€ä¸ªJava Projecté¡¹ç›®ä¸»ç›®å½•\n    - å¯ä»¥åœ¨åˆ›å»ºçš„æ—¶å€™ï¼Œç›´æ¥é€‰æ‹©åˆ›å»ºmodule-info.java\n    - æˆ–è€…é€‰ä¸­é¡¹ç›®ï¼Œå³é”®configureé€‰æ‹©Create module-info.java\n- åˆ›å»ºcn.hello.HelloWorld.java\n    - å¯ä»¥é€‰æ‹©åœ¨é»˜è®¤srcç›®å½•ä¸‹\n    - å¯ä»¥æ–°å»ºä¸€ä¸ªsource folderï¼Œå–åmodule.helloï¼Œå†åˆ›å»ºåŒ…ç»“æ„å’Œç±»æ–‡ä»¶\n- ä¿®æ”¹module-info.java\n- ç¼–è¯‘/è¿è¡Œ/æ‰“åŒ…\n\n### **æ³¨æ„äº‹é¡¹**\n- Java Moduleå’ŒMaven Multi Module ä¸ä¸€æ ·\n- ä½¿ç”¨JDK 9+ï¼Œä¸å¼ºåˆ¶åˆ›å»ºJava Moduleï¼Œå³ä¸åˆ›å»ºmodule-info.java\n- Moduleçš„å‘½åæ˜¯ç”±module-info.javaæ¥æ§åˆ¶\n    - requires\n    - exports\n\n## **3.æ¨¡å—ä¿¡æ¯æ–‡ä»¶**\n### **module-info.java**\n- æ¨¡å—å®‰å…¨æ§åˆ¶çš„æ ¸å¿ƒ\n- æ˜¯æ¨¡å—å’Œå¤–ç•Œæ²Ÿé€šçš„æ€»è´Ÿè´£\n- åå­—å’Œå†…å®¹ç»„æˆ\n- æ¨¡å—åå­—\n    - æ¨¡å—åç§°å¿…é¡»å”¯ä¸€\n    - å¯ä»¥ä¸å’ŒåŒ…åç›¸åŒ\n    - ä½¿ç”¨æœ‰ä»£è¡¨æ€§çš„è¯è¯­\n    - ä¸éœ€è¦åŒ…æ‹¬ç‰ˆæœ¬å·\n\n### **requiresè°ƒç”¨å…¶ä»–çš„æ¨¡å—**\n- java --list-modulesæŸ¥çœ‹ç³»ç»Ÿæä¾›çš„æ¨¡å—\n- java --describe-moduleçœ‹æŸä¸€ä¸ªæ¨¡å—\n- requireså¯ä»¥æ·»åŠ å¤šä¸ª\n- å•çº¯requiresï¼Œæ¨¡å—ä¾èµ–ä¸ä¼šä¼ é€’\n- **requires N, ç¼–è¯‘å’Œè¿è¡Œéƒ½ä¾èµ–äºN**\n- **requires transitive Nï¼Œç¼–è¯‘å’Œè¿è¡Œéƒ½ä¼ é€’ä¾èµ–äºN** \n- **requires static Nï¼Œç¼–è¯‘ä¾èµ–äºNï¼Œè¿è¡Œå¯é€‰**\n- **requires transitive static Nï¼Œç¼–è¯‘ä¼ é€’ä¾èµ–äºNï¼Œè¿è¡Œå¯é€‰**\n\n### **exportsè¾“å‡ºå½“å‰æ¨¡å—**\n- åªæœ‰è¾“å‡ºï¼Œåˆ«äººæ‰èƒ½ä½¿ç”¨\n- exportså¯ä»¥æŒ‡å®šæŸäº›åŒ…è¾“å‡º\n    - exports \\<package> \n- é™å®šè¾“å‡ºåˆ°ç‰¹å®šçš„æ¨¡å—ä½¿ç”¨\n    - exports \\<package> to \\<module1>, \\<module2>;\n\n### **openså°†å½“å‰æ¨¡å—å¼€æ”¾ç”¨äºåå°„**\n- exportså¯¼å‡ºçš„åŒ…çš„publicéƒ¨åˆ†å¯ä»¥åå°„ï¼Œå…¶ä»–æƒé™ä¿®é¥°çš„å†…å®¹å’Œæœªå¯¼å‡ºçš„å†…å®¹æ— æ³•åå°„(setAccessible(true)ä¹Ÿæ— æ•ˆ) \n- openså¯ä»¥æ‰“å¼€ä¸€äº›åŒ…ï¼Œå…¶ä»–æ¨¡å—å¯ä»¥åå°„è°ƒç”¨è¿™äº›åŒ…åŠå†…å®¹\n- open module æ‰“å¼€æ•´ä¸ªæ¨¡å—\n- æ‰“å¼€ä¸€ä¸ªåŒ…\n    - opens \\<package>\n- ä»…å¯¹æŸäº›æ¨¡å—æ‰“å¼€ä¸€ä¸ªåŒ…\n    - opens \\<package> to \\<module1>, \\<module2>;\n\n## **4.æœåŠ¡**\n- Java æ¨¡å—ç³»ç»Ÿå¼•å…¥çš„æ–°åŠŸèƒ½ï¼Œå®ç°è§£è€¦\n- **æ¨¡å—å¯¹å¤–åªæš´éœ²æ¥å£ï¼Œéšè—å®ç°ç±»**\n- providesæä¾›æ¥å£ï¼Œwithå®ç°ç±»(ä¸å¯¼å‡º) \n- usesæ¶ˆè´¹æ¥å£\n- ServiceLoaderåŠ è½½æ¥å£çš„å®ç°ç±»\n```java\nmodule module.first {\n    exprots first.p1;\n    provides first.p1.Shoe with first.p2.DoubleStar;\n}\n\nmodule module.second {\n    requires module.first;\n    uses first.p1.Shoe;\n}\n\nServiceLoader<Shoe> objs = ServerLoader.load(Shoe.class);\nfor(Shoe obj : objs) {\n    obj.walk();\n}\n```\n\n- ServiceLoaderé€šè¿‡loadåŠ è½½æ¥å£çš„å®ç°ç±»(withè¯­å¥æä¾›) \n- æ¯æ¬¡loadï¼Œ(é»˜è®¤æƒ…å†µä¸‹)éƒ½ä¼šäº§ç”Ÿæ–°çš„å„è‡ªç‹¬äº«çš„å®ä¾‹ï¼Œæ²¡æœ‰å”¯ä¸€çš„æœåŠ¡å®ä¾‹\n- å¯ä»¥è°ƒç”¨reloadè¿›è¡Œåˆ·æ–°\n\n- Java æ¨¡å—ç³»ç»Ÿæä¾›ä¸¤ç§æ–¹æ³•åˆ›å»ºæœåŠ¡å®ä¾‹\n    - æœåŠ¡å®ç°ç±»æœ‰publicçš„æ— å‚æ„é€ å‡½æ•°\n    - ä½¿ç”¨å•ç‹¬çš„é™æ€æä¾›è€…æ–¹æ³•\n        - ä¸€ä¸ªåä¸ºproviderçš„public static æ— å‚æ•°æ–¹æ³•\n        - è¿”å›æœåŠ¡æ¥å£æˆ–å­ç±»\n```java\nprovides first.p1.Shoe with first.p1.ShoeFactory;\n\npublic class ShoeFactory {\n    public static Shoe provider() {\n        Shoe result = new Shoe();\n        return result;\n    }\n}\n```\n\n## **5.Javaæ¨¡å—åŒ–åº”ç”¨**\n- Java æ¨¡å—åŒ–ç³»ç»Ÿ(Java 9+)\n    - ä»æ ¹æºä¸Šå¯¹JDKè¿›è¡Œæ¨¡å—åŒ–ï¼Œé™ä½æœ€ç»ˆç¨‹åºè¿è¡Œæ—¶è´Ÿè½½\n    - åœ¨jarå±‚ä¸Šå¢åŠ ä¸€ä¸ªmoduleæœºåˆ¶\n    - å¼•å…¥exports/requires/opensæ˜ç¡®æ¨¡å—è¾¹ç•Œå’Œä¾èµ–å…³ç³»ï¼Œç¨‹åºæ›´éšç§å®‰å…¨\n    - å¼•å…¥æœåŠ¡provides/usesä½¿å¾—ç¨‹åºæ›´è§£è€¦\n    - jlinkåˆ¶ä½œè¿è¡Œæ—¶æ˜ åƒï¼Œä½¿è¿ç»´æ›´é«˜æ•ˆ\n\n- å‘Java æ¨¡å—åŒ–ç³»ç»Ÿè¿ç§»çš„åˆ¶çº¦å› ç´ \n    - Javaæ¨¡å—åŒ–ç³»ç»Ÿå°šæœªæˆç†Ÿï¼Œå­˜åœ¨è¾ƒå¤šå˜åŒ–\n        - åªæœ‰11æ˜¯LTSï¼Œ9/10/12/13å‡æ˜¯STS\n    - Java 9+ JDKç‰ˆæƒæ”¶è´¹ï¼Œå¾ˆå¤šç¨‹åºå‘˜å’Œå‚å•†è¿˜æ˜¯ä½¿ç”¨Java 8\n    - å·²æœ‰çš„åºå¤§çš„ç¬¬ä¸‰æ–¹åº“ï¼ŒåŸºæœ¬ä¸æ˜¯åŸºäºæ¨¡å—å¼€å‘çš„ï¼Œå®Œå…¨èå…¥æˆ–ä½¿ç”¨æ¨¡å—é‡æ–°å¼€å‘æœ‰å›°éš¾\n    - æ„å»ºå·¥å…·å’Œå¼€å‘å·¥å…·IDEå°šæœªå¤§åŠ›æ”¯æŒ\n\n- å·²æœ‰çš„æ¨¡å—ç³»ç»ŸOSGi\n    - OSGi, Open Service Gateway Initiative, https://www.osgi.org/\n    - åœ¨OSGiå®¹å™¨é‡Œé¢è¿è¡Œbundleï¼Œé€šè¿‡ç±»åŠ è½½å™¨æ¥æ§åˆ¶ç±»çš„å¯è§æ€§\n- Javaæ¨¡å—åŒ– vs OSGi\n    - Java æ›´åæºå¤´æ§åˆ¶ï¼Œä»JDKå¼€å§‹åˆ†æ¨¡å—å¼€å‘å’Œéƒ¨ç½²\n    - OSGiæ›´ååŠ¨æ€æ€§æ§åˆ¶ï¼Œå¯¹bundleè¿›è¡Œå…¨ç”Ÿå‘½å‘¨æœŸæ§åˆ¶\n    - Javaæ¨¡å—åŒ–æ›´å¹´è½»ï¼Œå°šæœªæˆç†Ÿï¼ŒOSGiå·²ç»å‘å±•å¤šå¹´ï¼Œæ›´å®Œæ•´\n    - ä¸¤è€…äº’ç›¸å€Ÿé‰´å’Œäº’æ“ä½œ\n    - https://www.infoq.com/articles/java9-osgi-future-modularity/","tags":["Java"],"categories":["Java","Javaé«˜é˜¶"]},{"title":"Java Streamæµ","url":"/20210922/java-stream/","content":"## **1.æµçš„æ¦‚è¿°**\na sequence of elements from source that supports aggregate operations\n- sequence of elements: ä¸€ä¸ªæµå¯¹å¤–æä¾›ä¸€ä¸ªæ¥å£ï¼Œå¯ä»¥è®¿é—®åˆ°ä¸€ä¸²ç‰¹å®šçš„æ•°æ®ã€‚**æµä¸å­˜å‚¨å…ƒç´ **ï¼Œä½†æ˜¯å¯ä»¥æ ¹æ®éœ€è¦è¿›è¡Œè®¡ç®—è½¬åŒ–\n- sourceï¼šæ•°æ®æ¥æºï¼Œå¦‚æ•°æ®ç»“æ„ï¼Œæ•°ç»„ï¼Œæ–‡ä»¶ç­‰\n- aggregate operationï¼šèšåˆæ“ä½œï¼Œæµæ”¯æŒåƒSQLæ“ä½œæˆ–è€…å…¶ä»–å‡½æ•°å¼è¯­è¨€çš„æ“ä½œï¼Œå¦‚filter/map/reduce/find/match/sortedç­‰\n- pipelining: å¾ˆå¤šæµæ“ä½œä¹Ÿæ˜¯è¿”å›ä¸€ä¸ªæµ\n- Internal Iteration: æµæ“ä½œè¿›è¡Œè¿­ä»£ï¼Œç”¨æˆ·æ„ŸçŸ¥ä¸åˆ°å¾ªç¯éå†\n\n### **Streamè¯­æ³•**\n- ç±»ä¼¼SQLè¯­å¥ï¼Œéµå¾ªâ€œåšä»€ä¹ˆè€Œéæ€ä¹ˆåšâ€åŸåˆ™\n\n### **æµçš„å·¥ä½œæµç¨‹**\n- æµçš„åˆ›å»º\n- æµçš„è½¬æ¢ï¼Œå°†æµè½¬æ¢ä¸ºå…¶ä»–æµçš„ä¸­é—´æ“ä½œï¼Œå¯åŒ…æ‹¬å¤šä¸ªæ­¥éª¤(æƒ°æ€§æ“ä½œ) \n- æµçš„è®¡ç®—ç»“æœã€‚è¿™ä¸ªæ“ä½œä¼šå¼ºåˆ¶æ‰§è¡Œä¹‹å‰çš„æƒ°æ€§æ“ä½œã€‚è¿™ä¸ªæ­¥éª¤ä»¥åï¼Œæµå°±å†ä¹Ÿä¸ç”¨äº†\n\n## **2.æµçš„åˆ›å»º**\n- Collectionæ¥å£çš„streamæ–¹æ³•\n    ```java\n    Stream<String> a1 = new ArrayList<String>().stream();\n    Stream<String> a2 = new HashSet<String>().stream();\n    ```\n    - è¿˜æœ‰å…¶ä»–çš„å­ç±»ï¼Œå¦‚LinkedList, LinkedSet, TreeSet, Vectorç­‰ \n- Arrays.streamå¯ä»¥å°†æ•°ç»„è½¬ä¸ºStream\n    ```java\n    Stream<String> b1 = Arrays.stream(\"a,b,c,d,e\".split(\",\"), 3, 5);\n    ```\n- åˆ©ç”¨Streamç±»è¿›è¡Œè½¬åŒ–\n    - of æ–¹æ³•ï¼Œç›´æ¥å°†æ•°ç»„è½¬åŒ–\n    ```java\n    Stream<Integer> c1 = Stream.of(new Integer[5]);\n    Stream<String> c2 = Stream.of(\"a,b,c\".split(\",\"));\n    Stream<String> c3 = Stream.of(\"a\", \"b\", \"c\");\n    ```\n    - emptyæ–¹æ³•ï¼Œäº§ç”Ÿä¸€ä¸ªç©ºæµ\n    ```java\n    Stream<String> d1 = Stream.empty();\n    ```\n- åˆ©ç”¨Streamç±»è¿›è¡Œè½¬åŒ–\n    - generate æ–¹æ³•ï¼Œæ¥æ”¶ä¸€ä¸ªLambdaè¡¨è¾¾å¼\n    ```java\n    Stream<String> e1 = Stream.generate(()->\"hello\");\n    Stream<Double> e2 = Stream.generate(Math::random);\n    ```\n    - iterateæ–¹æ³•ï¼Œæ¥æ”¶ä¸€ä¸ªç§å­ï¼Œå’Œä¸€ä¸ªLambdaè¡¨è¾¾å¼\n    ```java\n    Stream<BigInteger> e3 = Stream.iterate(BigInteger.ZERO, n -> n.add(BigInteger.ONE));\n    ```\n- å…¶ä»–ç±»/æ–¹æ³•äº§ç”ŸStreamæµ \n    - Files.linesæ–¹æ³•\n    ```java\n    Stream<String> contents = Files.lines(Paths.get(\"C:/abc.txt\")); \n    ```\n    - Patternçš„splitAsStreamæ–¹æ³•\n    ```java\n    Stream<String> words = Pattern.compile(\",\").splitAsStream(\"a,b,c\");\n    ```\n\n### **åŸºæœ¬ç±»å‹æµ**\n- IntStreamï¼ŒLongStreamï¼ŒDoubleStream\n```java\nIntStream s1 = IntStream.of(1,2,3,4,5);\n\ns1 = Arrays.stream(new int[] {1,2,3});        \ns1 = IntStream.generate(()->(int)(Math.random() * 100));        \ns1 = IntStream.range(1,5); //1,2,3,4  step 1        \ns1 = IntStream.rangeClosed(1,5); //1,2,3,4,5\n\nIntStream s2 = IntStream.of(1,2,3,4,5);\nStream<Integer> s3 = s2.boxed();\nIntStream s5 = s3.mapToInt(Integer::intValue);\n```\n\n### **å¹¶è¡Œæµ**\n- ä½¿å¾—æ‰€æœ‰çš„ä¸­é—´è½¬æ¢æ“ä½œéƒ½å°†è¢«å¹¶è¡ŒåŒ–\n- Collections.parallelStream()å°†ä»»ä½•é›†åˆè½¬ä¸ºå¹¶è¡Œæµ\n- Stream.parallel()æ–¹æ³•ï¼Œäº§ç”Ÿä¸€ä¸ªå¹¶è¡Œæµ\n```java\nIntStream s1 = IntStream.range(1,10000000);\nlong evenNum = s1.parallel().filter(n->n%2==0).count();\nSystem.out.println(evenNum);\n```\n- **æ³¨æ„ï¼šéœ€è¦ä¿è¯ä¼ ç»™å¹¶è¡Œæµçš„æ“ä½œä¸å­˜åœ¨ç«äº‰**\n\n## **3.Streamçš„è½¬æ¢**\n### **è¿‡æ»¤filter**\n- filter(Predicate\\<? super T> predicate)\n- æ¥æ”¶ä¸€ä¸ªLambdaè¡¨è¾¾å¼ï¼Œå¯¹æ¯ä¸ªå…ƒç´ è¿›è¡Œåˆ¤å®šï¼Œç¬¦åˆæ¡ä»¶ç•™ä¸‹\n```java\nStream<Integer> s1 = Stream.of(1, 2, 3, 4, 5);\nStream<Integer> s2 = s1.filter(n -> n>2);\ns2.forEach(System.out::println);\n//3, 4, 5\n```\n\n### **å»é‡distinct**\n- distinct()\n- å¯¹æµçš„å…ƒç´ è¿›è¡Œè¿‡æ»¤ï¼Œå»é™¤é‡å¤ï¼Œåªç•™ä¸‹ä¸é‡å¤çš„å…ƒç´ \n```java\n//åŸºæœ¬ç±»å‹åŒ…è£…ç±»å¯¹è±¡å»é‡\nStream<Integer> s1 = Stream.of(1, 1, 2, 2, 3, 3);\nStream<Integer> s2 = s1.distinct();\ns2.forEach(System.out::println);\n// 1, 2, 3\n\n//è‡ªå®šä¹‰å¯¹è±¡çš„å»é‡\nArrayList<Student> students = new ArrayList<Student>();\nstudents.add(new Student(\"Tom\", 20));\nstudents.add(new Student(\"Tom\", 20));\nstudents.add(new Student(\"Jerry\", 20));\nstudents.add(new Student(\"Jerry\", 18));\n\n// å…ˆå¯¹è±¡çš„hashCodeå†è°ƒç”¨equalsæ–¹æ³•è¿›è¡Œåˆ¤é‡\nStream<Student> s3 = students.stream().distinct();\ns3.forEach(System.out::println);\n```\n\n### **æ’åºsorted**\n- sorted()\n- å¯¹æµçš„åŸºæœ¬ç±»å‹åŒ…è£…ç±»å…ƒç´ è¿›è¡Œæ’åº\n```java\nStream<Integer> s1 = Stream.of(3,2,4,1,5);\nStream<Integer> s2 = s1.sorted();\ns2.forEach(System.out::println);\n//1, 2, 3, 4, 5\n```\n- æä¾›Comparatorï¼Œå¯¹æµçš„å…ƒç´ è¿›è¡Œæ’åº\n```java\nString[] planets = new String[] { \n        \"Mercury\", \"Venus\", \"Earth\", \n        \"Mars\", \"Jupiter\", \"Saturn\", \n        \"Uranus\", \"Neptune\" };\n\nStream<String> s3 = Stream.of(planets).sorted(\n        Comparator.comparing(String::length));\ns3.forEach(System.out::println);\n```\n- å¯¹æµçš„è‡ªå®šä¹‰å¯¹è±¡å…ƒç´ è¿›è¡Œæ’åºï¼Œè°ƒç”¨å¯¹è±¡çš„compareToæ–¹æ³•\n```java\nArrayList<Cat> cats = new ArrayList<>();\ncats.add(new Cat(3));\ncats.add(new Cat(2));\ncats.add(new Cat(5));\ncats.add(new Cat(1));\ncats.add(new Cat(4));\nStream<Cat> s4 = cats.stream().sorted();\ns4.forEach(System.out::println);\n```\n\n### **è½¬åŒ–map**\n- åˆ©ç”¨æ–¹æ³•å¼•ç”¨å¯¹æµæ¯ä¸ªå…ƒç´ è¿›è¡Œå‡½æ•°è®¡ç®—\n```java\nStream<Double> s1 = Stream.of(-1.5, 2.5, -3.5);\nStream<Double> s2 = s1.map(Math::abs);\ns2.forEach(System.out::println);\n```\n- åˆ©ç”¨Lambdaè¡¨è¾¾å¼å¯¹æµæ¯ä¸ªå…ƒç´ è¿›è¡Œå‡½æ•°è®¡ç®—\n```java\nStream<Integer> s3 = Stream.of(1,2,3,4,5);\nStream<Integer> s4 = s3.map(n->n*n);\ns4.forEach(System.out::println);\n```\n- åˆ©ç”¨æ–¹æ³•å¼•ç”¨ï¼Œå¯¹æµæ¯ä¸ªå…ƒç´ è¿›è¡Œå‡½æ•°è®¡ç®—è¿”å›Stream\n```java\nString[] planets = new String[] { \n        \"Mercury\", \"Venus\", \"Earth\"};\n\nStream<String> allLetters2 = \n        Stream.of(planets).flatMap(word -> letters(word));\nallLetters2.forEach(System.out::print);\n//flatMap æ‰§è¡Œä¸€å¯¹å¤šçš„è½¬æ¢ï¼Œç„¶åå°†æ‰€æœ‰çš„Mapéƒ½å±•å¼€\n//['M','e','r','c','u','r','y',\n// 'V','e','n','u','s',\n// 'E','a','r','t','h']\n\npublic static Stream<String> letters(String word)\n{\n    List<String> result = new ArrayList<>();\n    for(int i=0;i<word.length();i++)\n    {\n        result.add(word.substring(i, i+1));\n    }\n    return result.stream();\n}\n```\n- åˆ©ç”¨æ–¹æ³•å¼•ç”¨ï¼Œå¯¹æµæ¯ä¸ªå…ƒç´ è¿›è¡Œå‡½æ•°è®¡ç®—è¿”å›Streamï¼Œå¹¶åˆå¹¶\n```java\nStream<Stream<String>> allLetters = \n        Stream.of(planets).map(word -> letters(word));\nallLetters.forEach(System.out::print);\n//[['M','e','r','c','u','r','y'],\n// ['V','e','n','u','s'],\n// ['E','a','r','t','h']]\n```\n\n### **æŠ½å–limit**\n```java\n//è·å–å‰nä¸ªå…ƒç´ \nStream<Integer> s1 = Stream.of(1,2,3,4,5,6,7,8,9,10);\nStream<Integer> s2 = s1.limit(3);\ns2.forEach(System.out::println);\n```\n\n### **è·³è¿‡skip**\n```java\n//è·³è¿‡å‰nä¸ªå…ƒç´ \nStream<Integer> s3 = Stream.of(1,2,3,4,5,6,7,8,9,10);\nStream<Integer> s4 = s3.skip(8);\ns4.forEach(System.out::println);\n```\n\n### **è¿æ¥concat**\n```JAVA\n//è¿æ¥ä¸¤ä¸ªæµ\nStream<String> s5 = Stream.concat(letters(\"hello\"), letters(\"world\"));\ns5.forEach(System.out::println);\n```\n\n### **é¢å¤–è°ƒè¯•peek**\n```java\nStream<Double> s1 = Stream.iterate(1.0, n -> n*2)\n        .peek(n -> System.out.println(\"number:\" + n)).limit(5);\ns1.forEach(System.out::println);\n```\n\n## **4.Optionalç±»å‹**\n- ä¸€ä¸ªåŒ…è£…å™¨å¯¹è±¡\n- è¦ä¹ˆåŒ…è£…äº†ç±»å‹Tçš„å¯¹è±¡ï¼Œè¦ä¹ˆæ²¡æœ‰åŒ…è£…ä»»ä½•å¯¹è±¡(**è¿˜æ˜¯null**)\n- **å¦‚æœTæœ‰å€¼ï¼Œé‚£ä¹ˆç›´æ¥è¿”å›Tçš„å¯¹è±¡**\n- **å¦‚æœTæ˜¯nullï¼Œé‚£ä¹ˆå¯ä»¥è¿”å›ä¸€ä¸ªæ›¿ä»£ç‰©**\n```java\nOptional<String> s1 = Optional.of(new String(\"abc\"));\nString s2 = s1.get();\nSystem.out.println(\"s2: \" + s2); //abc\n\nOptional<String> s3 = Optional.empty();\nString s4 = s3.orElse(\"def\"); \nSystem.out.println(\"s4: \" + s4); //def\n```\n\n### **Optional\\<T>åˆ›å»º**\n- ofæ–¹æ³•\n- emptyæ–¹æ³•\n- **ofNullableæ–¹æ³•ï¼Œå¯¹äºå¯¹è±¡æœ‰å¯èƒ½ä¸ºnullæƒ…å†µä¸‹ï¼Œå®‰å…¨åˆ›å»º**\n```java\nOptional<String> s5 = Optional.of(new String(\"abc\"));\nOptional<String> s6 = Optional.empty();\nString s7 = null;\nOptional<String> s8 = Optional.ofNullable(s7); \n//s7ä¸ä¸ºNullï¼Œs8å°±æ˜¯s7, å¦åˆ™s8å°±ä¸ºOptional.empty()\n```\n\n### **Optional\\<T>ä½¿ç”¨**\n- getæ–¹æ³•ï¼Œè·å–å€¼ï¼Œä¸å®‰å…¨çš„ç”¨æ³•\n-orElseæ–¹æ³•ï¼Œè·å–å€¼ï¼Œå¦‚æœä¸ºnullï¼Œé‡‡ç”¨æ›¿ä»£ç‰©çš„å€¼\n- orElseGetæ–¹æ³•ï¼Œè·å–å€¼ï¼Œå¦‚æœä¸ºnullï¼Œé‡‡ç”¨Lambdaè¡¨è¾¾å¼å€¼è¿”å›\n- orElseThrowæ–¹æ³•ï¼Œè·å–å€¼ï¼Œå¦‚æœä¸ºnullï¼ŒæŠ›å‡ºå¼‚å¸¸\n- ifPresentæ–¹æ³•ï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºç©ºï¼Œä¸ä¸ºç©ºè¿”å›true\n- isPresent(Consumer), åˆ¤æ–­æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ä¸ºç©ºï¼Œåˆ™è¿›è¡Œåç»­Consumeræ“ä½œ,å¦‚æœä¸ºç©ºï¼Œåˆ™ä¸åšä»»ä½•äº‹æƒ…\n- map(Function), å°†å€¼ä¼ é€’ç»™Functionå‡½æ•°è¿›è¡Œè®¡ç®—ã€‚å¦‚æœä¸ºç©ºï¼Œåˆ™ä¸è®¡ç®—\n\n### **Optional\\<T>æ³¨æ„äº‹é¡¹**\n- ç›´æ¥ä½¿ç”¨getï¼Œå¾ˆå®¹æ˜“å¼•å‘NoSuchElementExceptionå¼‚å¸¸\n- ä½¿ç”¨isPresentåˆ¤æ–­å€¼æ˜¯å¦å­˜åœ¨ï¼Œè¿™å’Œåˆ¤æ–­nullæ˜¯ä¸€æ ·çš„ä½æ•ˆ\n\n## **5.æµçš„è®¡ç®—ç»“æœ**\n### **ç®€å•çº¦ç®€(èšåˆå‡½æ•°)**\n- count(), è®¡æ•°\n```java\nStream<Integer> s1 = Stream.of(a);\nlong countResult = s1.filter(n-> n>0).count();\n```\n- max(Comparator)ï¼Œæœ€å¤§å€¼ï¼Œéœ€è¦æ¯”è¾ƒå™¨\n```java\nStream<Integer> s2 = Stream.of(a);\nOptional<Integer> maxResult = s2.max((n1,n2)->n1-n2);\n```\n- min(Comparator)ï¼Œæœ€å°å€¼ï¼Œéœ€è¦æ¯”è¾ƒå™¨\n```java\nStream<Integer> s3 = Stream.of(a);\nOptional<Integer> minResult = s3.min((n1,n2)->n1-n2);\n```\n- findFirst(), æ‰¾åˆ°ç¬¬ä¸€ä¸ªå…ƒç´ \n```java\nStream<Integer> s4 = Stream.of(a);\nOptional<Integer> first = s4.findFirst();\n```\n- findAny(), æ‰¾åˆ°ä»»æ„ä¸€ä¸ªå…ƒç´ \n```java\nStream<Integer> s5 = Stream.of(a);\nOptional<Integer> random = s5.findAny();\n```\n- anyMatch(Predicate)ï¼Œå¦‚æœ‰ä»»æ„ä¸€ä¸ªå…ƒç´ æ»¡è¶³Predicateï¼Œè¿”å›true\n```java\nStream<Integer> s6 = Stream.of(a);\nSystem.out.println(s6.anyMatch(n -> n>6));\n```\n- allMatch(Predicate)ï¼Œå¦‚æ‰€æœ‰å…ƒç´ æ»¡è¶³Predicateï¼Œè¿”å›true\n```java\nStream<Integer> s7 = Stream.of(a);\nSystem.out.println(s7.allMatch(n -> n>6));\n```\n- noneMatch(Predicate)ï¼Œå¦‚æ²¡æœ‰ä»»ä½•å…ƒç´ æ»¡è¶³Predicateï¼Œè¿”å›true\n```java\nStream<Integer> s8 = Stream.of(a);\nSystem.out.println(s8.noneMatch(n->n>100));\n```\n\n### **è‡ªå®šä¹‰çº¦ç®€**\n- reduceï¼Œä¼ é€’ä¸€ä¸ªäºŒå…ƒå‡½æ•°BinaryOperatorï¼Œå¯¹æµå…ƒç´ è¿›è¡Œè®¡ç®—\n- å¦‚æ±‚å’Œã€æ±‚ç§¯ã€å­—ç¬¦ä¸²è¿æ¥ç­‰\n```java\nInteger[] a = new Integer[] {2,4,6,8};\n        \nStream<Integer> s1 = Stream.of(a);\nOptional<Integer> sum = s1.reduce(Integer::sum);\nSystem.out.println(sum.get());\n\nStream<Integer> s2 = Stream.of(a);\nOptional<Integer> product = s2.reduce((x,y)->x*y);\nSystem.out.println(product.get());\n\nStream<Integer> s3 = Stream.of(a);\nInteger product3 = s3.reduce(1,(x,y)->x*y);\nSystem.out.println(product3);\n\nString[] b = new String[] {\"abc\",\"def\",\"ghi\"};\nStream<String> s4 = Stream.of(b);\nString bigStr = s4.reduce(\"\",(x,y)->x+y);\nSystem.out.println(bigStr);\n```\n\n### **æŸ¥çœ‹/éå†å…ƒç´ **\n- iterator()ï¼Œéå†å…ƒç´ \n- forEach(Consumer)ï¼Œåº”ç”¨ä¸€ä¸ªå‡½æ•°åˆ°æ¯ä¸ªå…ƒç´ ä¸Š\n```java\nInteger[] a = new Integer[] {2,4,6,8};\n        \nStream<Integer> s1 = Stream.of(a);\nIterator<Integer> it1 = s1.filter(n->n>2).iterator();\nwhile(it1.hasNext()) {\n    System.out.println(it1.next());\n}\n\nStream<Integer> s2 = Stream.of(a);\ns2.filter(n->n>2).forEach(System.out::println);\n```\n\n### **å­˜æ”¾åˆ°æ•°æ®ç»“æ„ä¸­**\n- toArray()ï¼Œå°†ç»“æœè½¬ä¸ºæ•°ç»„\n- collect(Collectors.toList()),å°†ç»“æœè½¬ä¸ºList\n```java\n//List\nStream<Integer> s1 = Stream.of(a);\nList<Integer> list1 = s1.collect(Collectors.toList());\n\n//Linkedlist\nStream<Integer> s2 = Stream.of(a);\nList<Integer> list2 = s2.collect(Collectors.toCollection(LinkedList::new));\n```\n- collect(Collectors.toSet()),å°†ç»“æœè½¬ä¸ºSet\n```java\nStream<Integer> s3 = Stream.of(a);\nSet<Integer> set1 = s3.collect(Collectors.toSet());\n```\n- collect(Collectors.toMap()), å°†ç»“æœè½¬ä¸ºMap\n```java\nList<Person> persons = new ArrayList<Person>();\npersons.add(new Person(1, \"Jerry\"));\npersons.add(new Person(2, \"Tom\"));\n\n//å°†æµå­˜å‚¨ä¸ºMap\nStream<Person> s6 = persons.stream();\nMap<Integer, String> map1 = s6.collect(Collectors.toMap(Person::getId, Person::getName));\n```\n- collect(Collectors.joining()), å°†ç»“æœè¿æ¥èµ·æ¥\n```java\n//å°†æµå˜æ¢ä¸ºå­—ç¬¦æµï¼Œå¹¶è¿æ¥èµ·æ¥\nStream<Integer> s4 = Stream.of(a);\nString result = s4.map(String::valueOf).collect(Collectors.joining());\nSystem.out.println(result); //2468\n\n//å°†æµå˜æ¢ä¸ºå­—ç¬¦æµï¼Œå¹¶è¿æ¥èµ·æ¥\nStream<Integer> s5 = Stream.of(a);\nString result2 = s5.map(String::valueOf).collect(Collectors.joining(\",\"));\nSystem.out.println(result2); //2,4,6,8\n```\n\n### **æµçš„é«˜é˜¶è®¡ç®—**\n- åˆ†ç»„groupingByå’Œåˆ†åŒºpartitionBy\n- åˆ†ç»„åçš„çº¦ç®€\n    - counting\n    - summing\n    - maxBy\n    - minBy\n- ä»¥ä¸Šæ–¹æ³•å‡åœ¨java.util.stream.Collectorsä¸­\n\n## **6.æµçš„åº”ç”¨**\n### **Java Streamçš„ä¼˜ç‚¹**\n- ç»Ÿä¸€è½¬æ¢å…ƒç´ \n- è¿‡æ»¤å…ƒç´ \n- åˆ©ç”¨å•ä¸ªæ“ä½œåˆå¹¶å…ƒç´ \n- å°†å…ƒç´ åºåˆ—å­˜æ”¾åˆ°æŸä¸€ä¸ªé›†åˆä¸­\n- æœç´¢æ»¡è¶³æŸäº›æ¡ä»¶çš„å…ƒç´ çš„åºåˆ—\n- **ç±»ä¼¼SQLæ“ä½œï¼Œéµå¾ªâ€œåšä»€ä¹ˆè€Œéæ€ä¹ˆåšâ€åŸåˆ™**\n- **ç®€åŒ–äº†ä¸²è¡Œ/å¹¶è¡Œçš„å¤§æ‰¹é‡æ“ä½œ**\n\n### **Java Stream vs å¾ªç¯è¿­ä»£ä»£ç **\n- Streamå¹¿æ³›ä½¿ç”¨Lambdaè¡¨è¾¾å¼ï¼Œåªèƒ½è¯»å–å¤–å›´çš„finalæˆ–è€…effectively finalå˜é‡ï¼Œå¾ªç¯è¿­ä»£ä»£ç å¯ä»¥è¯»å–/ä¿®æ”¹ä»»æ„çš„å±€éƒ¨å˜é‡ã€‚\n- åœ¨å¾ªç¯è¿­ä»£ä»£ç å—ä¸­ï¼Œå¯ä»¥éšæ„break/continue/returnï¼Œæˆ–è€…æŠ›å‡ºå¼‚å¸¸ï¼Œè€ŒLambdaè¡¨è¾¾å¼æ— æ³•å®Œæˆè¿™äº›äº‹æƒ…ã€‚\n- **Streamæµä¸æ˜¯æ·˜æ±°å¾ªç¯è¿­ä»£ä»£ç ï¼Œåº”è¯¥æ˜¯ä¸¤è€…ç›¸äº’æ­é…ä½¿ç”¨**\n\n### **Streamåº”ç”¨æ³¨æ„äº‹é¡¹**\n- ä¸€ä¸ªæµï¼Œä¸€æ¬¡åªèƒ½ä¸€ä¸ªç”¨é€”ï¼Œä¸èƒ½å¤šä¸ªç”¨é€”ï¼Œç”¨äº†ä¸èƒ½å†ç”¨\n- é¿å…åˆ›å»ºæ— é™æµ\n- æ³¨æ„æ“ä½œé¡ºåº\n- è°¨æ…ä½¿ç”¨å¹¶è¡Œæµ\n    - åº•å±‚ä½¿ç”¨Fork-Join Poolï¼Œå¤„ç†è®¡ç®—å¯†é›†å‹ä»»åŠ¡\n    - æ•°æ®é‡è¿‡å°ä¸ç”¨\n    - æ•°æ®ç»“æ„ä¸å®¹æ˜“åˆ†è§£çš„æ—¶å€™ä¸ç”¨ï¼Œå¦‚LinkedListç­‰ â€“æ•°æ®é¢‘ç¹æ‹†ç®±è£…ç®±ä¸ç”¨\n    - æ¶‰åŠfindFirstæˆ–è€…limitçš„æ—¶å€™ä¸ç”¨\n\n### **Stream vs Collection**\n- Streamå’ŒCollectionä¸¤è€…å¯ä»¥äº’ç›¸è½¬åŒ–\n- å¦‚æœæ•°æ®å¯èƒ½æ— é™ï¼Œç”¨Stream\n- å¦‚æœæ•°æ®å¾ˆå¤§å¾ˆå¤§ï¼Œç”¨Stream\n- å¦‚æœè°ƒç”¨è€…å°†ä½¿ç”¨æŸ¥æ‰¾/è¿‡æ»¤/èšåˆç­‰æ“ä½œï¼Œç”¨Stream\n- å½“è°ƒç”¨è€…ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œå‘ç”Ÿæ•°æ®æ”¹å˜ï¼Œè€Œè°ƒç”¨è€…éœ€è¦å¯¹æ•°æ®ä¸€è‡´æ€§æœ‰è¾ƒé«˜è¦æ±‚ï¼Œç”¨Collection","tags":["Java"],"categories":["Java","Javaé«˜é˜¶"]},{"title":"Java Lambdaè¡¨è¾¾å¼","url":"/20210922/java-lambda/","content":"## **1.Lambdaè¡¨è¾¾å¼åŸºç¡€**\n- ç±»ä¼¼äºåŒ¿åæ–¹æ³•ï¼Œä¸€ä¸ªæ²¡æœ‰åå­—çš„æ–¹æ³•\n- å‚æ•°ï¼Œç®­å¤´ï¼Œè¡¨è¾¾å¼è¯­å¥\n- å¯ä»¥å¿½ç•¥å†™å‚æ•°ç±»å‹\n- **åšå†³ä¸å£°æ˜è¿”å›å€¼ç±»å‹**\n- æ²¡æœ‰public/protected/private/static/finalç­‰ä¿®é¥°ç¬¦\n- å•å¥è¡¨è¾¾å¼ï¼Œå°†ç›´æ¥è¿”å›å€¼ï¼Œä¸ç”¨å¤§æ‹¬å·\n- å¸¦returnè¯­å¥ï¼Œ ç®—å¤šå¥ï¼Œå¿…é¡»ç”¨å¤§æ‹¬å·\n\n- æ— å‚æ•°ï¼Œ**ä»…ä¿ç•™æ‹¬å·**ï¼Œç®­å¤´ï¼Œè¡¨è¾¾å¼\n```java\nnew Thread(\n            ()->\n                {\n                    int sum=0;\n                    for(int i=1;i<=100;i++)\n                    {\n                        sum = sum + i;\n                    }\n                    System.out.println(\"æ€»å’Œ:\" + sum);\n                }\n            ).start();\n```\n- ä¸€ä¸ªå‚æ•°ï¼Œ**å¯çœç•¥æ‹¬å·**ï¼Œç®­å¤´ï¼Œè¡¨è¾¾å¼\n```java\nAdder  c1 = \n                x -> \n                {\n                    x++;\n                };\n```\n- **å¦‚æœæœ‰è¿”å›å€¼ï¼Œè¿”å›å€¼ç±»å‹ä¼šåœ¨ä¸Šä¸‹æ–‡æ¨æ–­å‡ºæ¥çš„ï¼Œæ— éœ€å£°æ˜**\n- åªåœ¨æŸå‡ ä¸ªåˆ†æ”¯æœ‰è¿”å›å€¼ï¼Œè¿™æ ·æ˜¯ä¸åˆæ³•çš„\n```java\nAdder  c2 =\n                x ->\n                {\n                    if(x>0)\n                        return x+1;//wrong\n                };\n```\n## **2.å‡½æ•°å¼æ¥å£**\n- **æ˜¯ä¸€ä¸ªæ¥å£ï¼Œç¬¦åˆJavaæ¥å£çš„å®šä¹‰**\n- **åªåŒ…å«ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æ¥å£**\n- å¯ä»¥åŒ…æ‹¬å…¶ä»–çš„defaultæ–¹æ³•ã€staticæ–¹æ³•ã€privateæ–¹æ³•\n- ç”±äºåªæœ‰ä¸€ä¸ªæœªå®ç°çš„æ–¹æ³•ï¼Œæ‰€ä»¥Lambdaè¡¨è¾¾å¼å¯ä»¥è‡ªåŠ¨å¡«ä¸Šè¿™ä¸ªå°šæœªå®ç°çš„æ–¹æ³•\n- é‡‡ç”¨Lambdaè¡¨è¾¾å¼ï¼Œå¯ä»¥è‡ªåŠ¨åˆ›å»ºå‡ºä¸€ä¸ª(**ä¼ª**)åµŒå¥—ç±»çš„å¯¹è±¡(**æ²¡æœ‰å®é™…çš„åµŒå¥—ç±»classæ–‡ä»¶äº§ç”Ÿ**)ï¼Œç„¶åä½¿ç”¨ï¼Œæ¯”çœŸæ­£åµŒå¥—ç±»**æ›´åŠ è½»é‡**ï¼Œæ›´åŠ ç®€æ´é«˜æ•ˆ\n\n### **ç³»ç»Ÿè‡ªå¸¦çš„å‡½æ•°å¼æ¥å£**\n- æ¶µç›–å¤§éƒ¨åˆ†å¸¸ç”¨çš„åŠŸèƒ½ï¼Œå¯ä»¥é‡å¤ä½¿ç”¨\n- ä½äºjava.util.functionåŒ…ä¸­\n#### **Predicate\\<T>: æ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼**\n```java\nPredicate<String> oddLength = s -> \n    s.length()%2 == 0 ? false:true;\n\nfor(String p : planets)    {\n    if(oddLength.test(p)) {\n        System.out.println(p);\n    }\n}\n```\n#### **Consumer\\<T>ï¼šæ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œåšæ“ä½œï¼Œæ— è¿”å›**\n```java\nConsumer<String> printer = s -> \n    System.out.println(\"Planet :\" + s);\n\nfor(String p : planets)    {\n    printer.accept(p);\n}            \n```\n#### **Supplier\\<T>ï¼šæ— è¾“å…¥å‚æ•°ï¼Œè¿”å›ä¸€ä¸ªæ•°æ®**\n```java\nSupplier<String> planetFactory = () -> \n    planets[(int) floor(random() * 8)];\n\nfor (int i = 0; i < 5; i++) {\n    System.out.println(planetFactory.get());\n}\n```\n#### **Function\\<T>ï¼šæ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªå‚æ•°**\n```java\nFunction<String, String> upper = s -> \n    {\n        //å¯ä»¥åšæ›´å¤æ‚çš„æ“ä½œ\n        return s.toUpperCase();\n    };\n\nfor(String p : planets)    {\n    System.out.println(upper.apply(p));\n}\n```\n\n## **3.æ–¹æ³•å¼•ç”¨**\n- Lambdaè¡¨è¾¾å¼æ”¯æŒä¼ é€’ç°æœ‰çš„ç±»åº“å‡½æ•°\n\n- Class::staticMethodï¼Œå¦‚ Math::absæ–¹æ³•\n- Class::instanceMethodï¼Œå¦‚String::compareToIgnoreCaseæ–¹æ³•\n- object::instanceMethodï¼Œå¦‚System.out::printlnæ–¹æ³•\n    - æ”¯æŒthis::instanceMethod è°ƒç”¨\n    - æ”¯æŒsuper::instanceMethodè°ƒç”¨\n- Class::newï¼Œè°ƒç”¨æŸç±»æ„é€ å‡½æ•°ï¼Œæ”¯æŒå•ä¸ªå¯¹è±¡æ„å»º\n- Class[]::newï¼Œè°ƒç”¨æŸç±»æ„é€ å‡½æ•°ï¼Œæ”¯æŒæ•°ç»„å¯¹è±¡æ„å»º\n\n### **Class::staticMethod**\n- ç­‰ä»·äºæä¾›æ–¹æ³•å‚æ•°çš„Lambdaè¡¨è¾¾å¼\n- Math::abs ç­‰ä»·äº x -> Math.abs(x)\\\n```java\npublic class ClassStaticMethodTest {\n    public static double worker(NumFunction nf, double num)\n    {\n        return nf.calculate(num);\n    }\n    public static void main(String[] args) {\n        double a = -5.3;\n        double b = worker(Math::abs, a);\n        System.out.println(b);\n        \n        double c = worker(Math::floor, a);\n        System.out.println(c);\n    }    \n}\n\ninterface NumFunction {\n    double calculate(double num);\n}\n```\n\n### **Class::instanceMethod**\n- ç¬¬ä¸€ä¸ªå‚æ•°å°†å˜æˆæ–¹æ³•çš„æ‰§è¡Œä½“\n- String::compareToIgnoreCaseç­‰ä»·äº(x,y)->x.compareToIgnoreCase(y)\n```java\nString[] planets = new String[] { \n        \"Mercury\", \"Venus\", \"Earth\", \"Mars\", \n        \"Jupiter\", \"Saturn\", \"Uranus\",\n        \"Neptune\" };    \n\nArrays.sort(planets, String::compareToIgnoreCase);\nSystem.out.println(Arrays.toString(planets));        \n```\n\n### **object::instanceMethod**\n- ç­‰ä»·äºæä¾›æ–¹æ³•å‚æ•°çš„Lambdaè¡¨è¾¾å¼\n- System.out::printlnç­‰ä»·äºx->System.out.println(x)\n```java\npublic class ObjectInstanceMethodTest {\n\n    public static void worker(PrintFunction pf, String s) {\n        pf.exec(s);\n    }\n    \n    public static void main(String[] args) {\n        String a = \"abc\";\n        worker(System.out::println, a);\n    }\n}\n\ninterface PrintFunction {\n    public void exec(String s);\n}\n```\n- æ”¯æŒthis::instanceMethod\n```java\npublic class ThisInstanceMethodTest {\n    public static void main(String[] args) {\n        ThisInstanceMethodTest obj = new ThisInstanceMethodTest();\n        obj.test();\n    }    \n    \n    public void test()    {\n        String[] planets = new String[] { \n                \"Mercury\", \"Venus\", \"Earth\", \"Mars\", \n                \"Jupiter\", \"Saturn\", \"Uranus\", \"Neptune\" };    \n                \n        Arrays.sort(planets, this::lengthCompare);\n        System.out.println(Arrays.toString(planets));    \n    }\n    \n    public int lengthCompare(String first, String second){\n        return first.length() - second.length();\n    }\n}\n```\n- æ”¯æŒsuper::instanceMethod\n```java\npublic class SuperInstanceMethodTest extends Father{\n    public static void main(String[] args) {\n        SuperInstanceMethodTest obj = new SuperInstanceMethodTest();\n        obj.test();\n    }    \n    \n    public void test()    {\n        String[] planets = new String[] { \n                \"Mercury\", \"Venus\", \"Earth\", \"Mars\", \n                \"Jupiter\", \"Saturn\", \"Uranus\", \"Neptune\" };    \n                \n        Arrays.sort(planets, super::lengthCompare);\n        System.out.println(Arrays.toString(planets));    \n    }\n}\n\nclass Father {\n    public int lengthCompare(String first, String second){\n        return first.length() - second.length();\n    }\n}\n```\n\n### **Class::new**\n```java\nSupplier<Person> s = Person::new;\nPerson p = s.get();\n```\n\n### **Class[]::new**\n```java\nIntFunction<int[]> intArray = int[]::new;        \nint[] nums = intArray.apply(10); \n\nFunction<Integer, Person[]> personArray = Person[]::new;\nPerson[] persons = personArray.apply(5);\n```\n\n## **4.Lambdaè¡¨è¾¾å¼åº”ç”¨**\n- Lambdaè¡¨è¾¾å¼**æ²¡æœ‰å­˜å‚¨ç›®æ ‡ç±»å‹(target type)çš„ä¿¡æ¯**\n- é‡è½½è°ƒç”¨ï¼Œä¾æ®é‡è½½çš„è§„åˆ™å’Œç±»å‹å‚æ•°æ¨ç†\n\n### **å˜é‡é®è”½**\n- **Lambdaè¡¨è¾¾å¼å’ŒåŒ¿åå†…éƒ¨ç±»/å±€éƒ¨å†…éƒ¨ç±»ä¸€æ ·ï¼Œå¯ä»¥æ•è·å˜é‡(capture variables)ï¼Œå³è®¿é—®å¤–éƒ¨åµŒå¥—å—çš„å˜é‡**\n    - ä½†æ˜¯å˜é‡è¦æ±‚æ˜¯finalæˆ–è€…æ˜¯effectively finalçš„ \n- **Lambdaè¡¨è¾¾å¼æ²¡æœ‰å˜é‡é®è”½é—®é¢˜ï¼Œå› ä¸ºå®ƒçš„å†…å®¹å’ŒåµŒå¥—å—æœ‰ç€ç›¸åŒçš„ä½œç”¨åŸŸ**\n    - åœ¨Lambdaè¡¨è¾¾å¼ä¸­ï¼Œä¸å¯ä»¥å£°æ˜ä¸(å¤–éƒ¨åµŒå¥—å—)å±€éƒ¨å˜é‡åŒåçš„å‚æ•°æˆ–è€…å±€éƒ¨å˜é‡\n- è¡¨è¾¾å¼ä¸­çš„thisï¼Œå°±æ˜¯åˆ›å»ºè¿™ä¸ªè¡¨è¾¾å¼çš„æ–¹æ³•çš„thiså‚æ•°\n\n### **ä¼˜å…ˆçº§**\n- Lambdaè¡¨è¾¾å¼ä¼˜å…ˆçº§æ¯”åµŒå¥—ç±»è¦é«˜\n    - çŸ­å°ç²¾å¹²ï¼Œæœ¬èº«å¯ä»¥è‡ªæè¿°çš„\n    - æ— æ³•åˆ›å»ºå‘½åå®ä¾‹ï¼Œæ— æ³•è·å–è‡ªèº«çš„å¼•ç”¨(this)\n- æ–¹æ³•å¼•ç”¨æ¯”è‡ªå®šä¹‰Lambdaè¡¨è¾¾å¼çš„ä¼˜å…ˆçº§é«˜\n    - ç³»ç»Ÿè‡ªå¸¦çš„æ–¹æ³•å¼•ç”¨æ›´ç®€æ´é«˜æ•ˆ\n    - å¯¹äºå¤æ‚çš„Lambdaè¡¨è¾¾å¼ï¼Œé‡‡ç”¨æ–¹æ³•å¼•ç”¨æ¯”å†…åµŒLambdaè¡¨è¾¾å¼æ›´æ¸…æ™°ï¼Œæ›´å®¹æ˜“ç»´æŠ¤\n- åšæŒä½¿ç”¨æ ‡å‡†çš„å‡½æ•°å¼æ¥å£\n    - æ›´å®¹æ˜“å­¦ä¹ ï¼Œæé«˜äº’æ“ä½œæ€§","tags":["Java"],"categories":["Java","Javaé«˜é˜¶"]},{"title":"Java åµŒå¥—ç±»","url":"/20210922/java-nested-class/","content":"## **1.åµŒå¥—ç±»åŸºç¡€**\n- ä¸€ä¸ªç±»å®šä¹‰åœ¨åˆ«çš„ç±»çš„å†…éƒ¨\n\n### **åµŒå¥—ç±»**\n- é™æ€åµŒå¥—ç±»ï¼šStatic nested classes,å³ç±»å‰é¢æœ‰staticä¿®é¥°ç¬¦\n```java\npublic class Outer {\n    String name;\n    \n    static class Inner {\n        String name;\n    }\n}\n```\n- éé™æ€åµŒå¥—ç±»ï¼šNon-static nested classes, åˆå**å†…éƒ¨ç±»ï¼ŒInner classes**\n    - æ™®é€šå†…éƒ¨ç±»(äº¦ç¿»è¯‘ä¸º:æˆå‘˜å†…éƒ¨ç±») \n    ```java\n    public class Outer {\n        String name;\n\n        public class Inner {\n            Stirng name;\n        }\n    }\n    ```\n    - å±€éƒ¨å†…éƒ¨ç±»(Local classes)\n    ```java\n    public class Outer {\n        String name;\n        \n        public void f1() {\n            class Inner {\n                String name;\n            }\n        }\n    }\n    ```\n    - åŒ¿åå†…éƒ¨ç±»(Anonymous classes)\n    ```java\n    public class Outer {\n        String name;\n\n        public void f1() {\n            new Thread(new Runnable(){\n                public void run() {\n                    System.out.println(\"hello\");\n                }\n            }).start;\n        }\n    }\n    ```\n\n## **2.åŒ¿åå†…éƒ¨ç±»å’Œå±€éƒ¨å†…éƒ¨ç±»**\n### **åŒ¿åå†…éƒ¨ç±»**\n- **æ²¡æœ‰ç±»å**çš„å†…éƒ¨ç±»ï¼Œå¿…é¡»ç»§æ‰¿**ä¸€ä¸ª**çˆ¶ç±»/å®ç°**ä¸€ä¸ª**çˆ¶æ¥å£\n- åœ¨å®ä¾‹åŒ–ä»¥åï¼Œè¿…é€Ÿè½¬å‹ä¸º**çˆ¶ç±»/çˆ¶æ¥å£**\n- è¿™ç§ç±»å‹çš„å¯¹è±¡ï¼Œåªèƒ½newä¸€ä¸ªå¯¹è±¡ï¼Œä¹‹åä»¥å¯¹è±¡åå­—æ“ä½œ\n- å¯åœ¨æ™®é€šè¯­å¥å’Œæˆå‘˜å˜é‡èµ‹å€¼æ—¶ä½¿ç”¨å†…éƒ¨ç±»\n- æ²¡æœ‰**æ­£å¼ç±»å**çš„å†…éƒ¨ç±»\n    - ç¼–è¯‘å™¨äº§ç”Ÿå†…éƒ¨åå­—ï¼šç±»å+$+æ•°å­—ç¼–å·\n- æ²¡æœ‰ç±»åï¼Œ**æ²¡æœ‰æ„é€ å‡½æ•°**ï¼Œèƒ½ç”¨çˆ¶ç±»/çˆ¶æ¥å£çš„æ„é€ å‡½æ•°(å¯å¸¦å‚æ•°) \n- å¯ä»¥**ç»§æ‰¿ã€æ”¹å†™ã€è¡¥å……**çˆ¶ç±»/çˆ¶æ¥å£çš„æ–¹æ³•\n- å†…éƒ¨ä¸å¯ä»¥**æ–°å®šä¹‰**é™æ€æˆå‘˜(å˜é‡+æ–¹æ³•)ï¼Œå¸¸é‡é™¤å¤–\n- å¯ä»¥è®¿é—®å¤–éƒ¨åŒ…å›´ç±»çš„æˆå‘˜å˜é‡å’Œæ–¹æ³•(åŒ…æ‹¬private)\n- **å¦‚æœå®šä¹‰åœ¨é™æ€æ–¹æ³•ä¸­ï¼Œä¹Ÿåªèƒ½è®¿é—®å¤–éƒ¨åŒ…å›´ç±»çš„é™æ€æˆå‘˜**\n- æ²¡æœ‰ç±»åï¼Œ**å¤–éƒ¨åŒ…å›´ç±»å’Œå…¶ä»–ç±»ä¹Ÿæ— æ³•è®¿é—®åˆ°åŒ¿åå†…éƒ¨ç±»**\n\n### **å±€éƒ¨å†…éƒ¨ç±»**\n- å®šä¹‰åœ¨ä»£ç å—ä¸­çš„éé™æ€çš„ç±»ï¼Œå¦‚æ–¹æ³•ï¼Œforå¾ªç¯ï¼Œifè¯­å¥ç­‰\n- å®šä¹‰åï¼Œå³å¯åˆ›å»ºå¯¹è±¡ä½¿ç”¨\n- åªèƒ½æ´»åœ¨è¿™ä¸ªä»£ç å—ä¸­ï¼Œä»£ç å—ç»“æŸåï¼Œ**å¤–ç•Œæ— æ³•ä½¿ç”¨è¯¥ç±»**\n- ç¼–è¯‘ååç§°ï¼šå¤–éƒ¨ç±»å+$+åºå·+å†…éƒ¨ç±»å\n- å¯ä»¥ç»§æ‰¿å…¶ä»–ç±»ï¼Œæˆ–è€…å®ç°å…¶ä»–æ¥å£\n- éé™æ€çš„ç±»ï¼Œä¸èƒ½åŒ…å«é™æ€æˆå‘˜(å˜é‡å’Œæ–¹æ³•)ï¼Œé™¤äº†å¸¸é‡\n- å¯ä»¥è®¿é—®å¤–éƒ¨åŒ…å›´ç±»çš„æˆå‘˜\n- å¦‚æœå®šä¹‰åœ¨é™æ€æ–¹æ³•ä¸­ï¼Œåªèƒ½è®¿é—®åŒ…å›´ç±»çš„é™æ€æˆå‘˜\n- å±€éƒ¨å†…éƒ¨ç±»ä¸èƒ½æ˜¯ä¸€ä¸ªæ¥å£ï¼Œå³æ¥å£ä¸èƒ½å®šä¹‰åœ¨ä»£ç å—ä¸­\n\n## **3.æ™®é€šå†…éƒ¨ç±»å’Œé™æ€åµŒå¥—ç±»**\n### **æ™®é€šå†…éƒ¨ç±»**\n- éstaticçš„ç±»ï¼Œå®šä¹‰åœ¨æŸä¸ªç±»çš„æˆå‘˜å˜é‡ä½ç½®\n- å®šä¹‰åï¼Œåœ¨ç±»é‡Œé¢å‡å¯ä»¥ä½¿ç”¨\n- ç¼–è¯‘ååç§°ï¼šå¤–éƒ¨ç±»å+$+å†…éƒ¨ç±»å\n- å¯ä»¥ç»§æ‰¿å…¶ä»–ç±»ï¼Œæˆ–è€…å®ç°å…¶ä»–æ¥å£\n- å¯ä»¥ç”¨private/package private(ä¸å†™)/protected/publicæ§åˆ¶å¤–ç•Œè®¿é—®\n- éé™æ€çš„ç±»ï¼Œä¸èƒ½åŒ…å«é™æ€å˜é‡/æ–¹æ³•ï¼Œé™¤äº†å¸¸é‡\n- å’Œå¤–éƒ¨åŒ…å›´ç±»çš„å®ä¾‹ç›¸å…³ï¼Œ**ä¸€ä¸ªæ™®é€šå†…éƒ¨ç±»å®ä¾‹**è‚¯å®šæ˜¯åœ¨**ä¸€ä¸ªå¤–éƒ¨åŒ…å›´ç±»çš„å®ä¾‹ä¸­**ï¼Œä¸”å¯ä»¥è®¿é—®å¤–éƒ¨åŒ…å›´ç±»çš„æ‰€æœ‰æˆå‘˜\n- **åœ¨ç¬¬ä¸‰æ–¹ç±»ä¸­ï¼Œéœ€è¦å…ˆåˆ›å»ºå¤–éƒ¨åŒ…å›´ç±»å®ä¾‹ï¼Œæ‰èƒ½åˆ›å»ºæ™®é€šå†…éƒ¨ç±»çš„å®ä¾‹ï¼Œä¸å…è®¸å•ç‹¬çš„æ™®é€šå†…éƒ¨ç±»å¯¹è±¡å­˜åœ¨ï¼ï¼ï¼**\n\n### **é™æ€åµŒå¥—ç±»**\n- å±‚çº§å’ŒåŒ…å›´ç±»(enclosing class)çš„æˆå‘˜å˜é‡/æ–¹æ³•ä¸€æ ·\n- ç¬¬ä¸‰æ–¹éœ€è¦é€šè¿‡å¤–éƒ¨åŒ…å›´ç±»æ‰å¯ä»¥è®¿é—®åˆ°é™æ€åµŒå¥—ç±»\n    - Outer1.Inner1 obj = new Outer1.Inner1();\n- **éœ€è¦åŠ ä¿®é¥°ç¬¦static**\n- **å¯ä»¥å®šä¹‰é™æ€æˆå‘˜å’Œéé™æ€æˆå‘˜**\n- **ä¸èƒ½ç›´æ¥è®¿é—®åŒ…å›´ç±»çš„éé™æ€æˆå‘˜ï¼Œå¯ç›´æ¥è®¿é—®åŒ…å›´ç±»çš„é™æ€æˆå‘˜**\n    - **å¯é€šè¿‡åŒ…å›´ç±»çš„å¯¹è±¡è¿›è¡Œè®¿é—®éé™æ€æˆå‘˜**\n- å¤–ç•Œå¯ä»¥é€šè¿‡é™æ€åµŒå¥—ç±»åè®¿é—®å…¶é™æ€æˆå‘˜ï¼Œé€šè¿‡å¯¹è±¡è®¿é—®å…¶éé™æ€æˆå‘˜\n- **å¤–ç•Œéœ€è¦é€šè¿‡åŒ…å›´ç±»æ‰å¯ä»¥è®¿é—®åˆ°é™æ€åµŒå¥—ç±»ï¼Œå¹¶åˆ›å»ºå…¶å¯¹è±¡ï¼Œä¸éœ€è¦å¤–éƒ¨åŒ…å›´ç±»çš„å®ä¾‹**\n\n## **4.åµŒå¥—ç±»å¯¹æ¯”**\n||ä½ç½®|åå­—|ä½œç”¨èŒƒå›´|åŸºæœ¬ä¿¡æ¯|\n|-|-|-|-|-|\n|åŒ¿åå†…éƒ¨ç±»|æˆå‘˜å˜é‡æˆ–è€…æˆå‘˜æ–¹æ³•å†…|å¤–éƒ¨ç±»å+$+æ•°å­—ç¼–å·|è·Ÿéšè¢«èµ‹å€¼å˜é‡çš„ä½œç”¨èŒƒå›´ï¼Œå¤–ç•Œæ— æ³•è®¿é—®|æ²¡æœ‰ç±»åï¼Œæ²¡æœ‰æ„é€ å‡½æ•°ï¼Œæ²¡æœ‰staticæ²¡æœ‰private/ default/ protected/ public ä¿®é¥°|\n|å±€éƒ¨å†…éƒ¨ç±»|æˆå‘˜æ–¹æ³•å†…|å¤–éƒ¨ç±»å+$+åºå·+å†…éƒ¨ç±»å|æ‰€åœ¨çš„æ–¹æ³•å†…ï¼Œå¤–ç•Œæ— æ³•è®¿é—®|æœ‰ç±»åï¼Œæœ‰æ„é€ å‡½æ•°ï¼Œæ²¡æœ‰staticï¼Œæ²¡æœ‰private/ default/ protected/ public ä¿®é¥°|\n|æ™®é€šå†…éƒ¨ç±»|æˆå‘˜å˜é‡|å¤–éƒ¨ç±»å+$+å†…éƒ¨ç±»å|åŒ…å›´ç±»å†…å¯ä»¥è®¿é—®ï¼Œå¤–ç•Œå¯ä»¥è®¿é—®|æœ‰ç±»åï¼Œæœ‰æ„é€ å‡½æ•°ï¼Œæ²¡æœ‰staticæœ‰private/ default/ protected/ public ä¿®é¥°|\n|é™æ€åµŒå¥—ç±»|æˆå‘˜å˜é‡|å¤–éƒ¨ç±»å+$+å†…éƒ¨ç±»å|åŒ…å›´ç±»å†…å¯ä»¥è®¿é—®ï¼Œå¤–ç•Œå¯ä»¥è®¿é—®|æœ‰ç±»åï¼Œæœ‰æ„é€ å‡½æ•°ï¼Œæœ‰staticæœ‰private/ default/ protected/ public ä¿®é¥°|\n\n\n||åµŒå¥—ç±»å†…éƒ¨çš„å†…å®¹|å¯è®¿é—®çš„å¤–éƒ¨åŒ…å›´ç±»å†…å®¹|å’Œå¤–éƒ¨ç±»å…³ç³»|\n|-|-|-|-|\n|åŒ¿åå†…éƒ¨ç±»|ä¸èƒ½å¸¦é™æ€æˆå‘˜ï¼Œé™¤äº†å¸¸é‡|è®¿é—®å¤–éƒ¨çš„æ‰€æœ‰æˆå‘˜|åœ¨å¤–éƒ¨ç±»å¯¹è±¡å†…éƒ¨|\n|å±€éƒ¨å†…éƒ¨ç±»|ä¸èƒ½å¸¦é™æ€æˆå‘˜ï¼Œé™¤äº†å¸¸é‡|è®¿é—®å¤–éƒ¨çš„æ‰€æœ‰æˆå‘˜|åœ¨å¤–éƒ¨ç±»å¯¹è±¡å†…éƒ¨|\n|æ™®é€šå†…éƒ¨ç±»|ä¸èƒ½å¸¦é™æ€æˆå‘˜ï¼Œé™¤äº†å¸¸é‡|è®¿é—®å¤–éƒ¨çš„æ‰€æœ‰æˆå‘˜|å¤–ç•Œå¯ä»¥newï¼Œä½†æ˜¯å¯¹è±¡å¿…é¡»ä¾é™„äºä¸€ä¸ªå¤–éƒ¨åŒ…å›´ç±»å¯¹è±¡|\n|é™æ€åµŒå¥—ç±»|å¯ä»¥å®šä¹‰é™æ€æˆå‘˜å˜é‡å’Œæ–¹æ³•|è®¿é—®å¤–éƒ¨çš„æ‰€æœ‰é™æ€æˆå‘˜|å¤–ç•Œå¯ä»¥newï¼Œå¯ç‹¬ç«‹è¿›è¡Œå·¥ä½œ|\n\n\n### **å¤–éƒ¨è®¿é—®è§„åˆ™**\n- æ™®é€šå†…éƒ¨ç±»å’Œé™æ€åµŒå¥—ç±»å¯ä»¥è¢«å¤–éƒ¨è®¿é—®\n- å¤–éƒ¨è®¿é—®æ™®é€šå†…éƒ¨ç±»å’Œé™æ€åµŒå¥—ç±»ï¼Œå’Œæ™®é€šç±»ä¹‹é—´è®¿é—®è§„åˆ™**ä¸€æ ·**\n\n||åŒä¸€ä¸ªç±»|åŒä¸€ä¸ªåŒ…|ä¸åŒåŒ…çš„å­ç±»|ä¸åŒåŒ…çš„éå­ç±»|\n|-|-|-|-|-|\n|private|âˆš\n|default|âˆš|âˆš\n|protected|âˆš|âˆš|âˆš\n|public|âˆš|âˆš|âˆš|âˆš\n\n\n### **å˜é‡é®è”½ï¼šShadowing**\n- åµŒå¥—ç±»å˜é‡å’Œå¤–éƒ¨åŒ…å›´ç±»çš„å˜é‡é‡å\n    - ä»¥ç¦»å¾—è¿‘ä½œä¸ºä¼˜å…ˆåŸåˆ™\n    - ä¼˜å…ˆçº§é«˜çš„å˜é‡ä¼šé®è”½ä¼˜å…ˆçº§ä½çš„å˜é‡\n    - **å¤–éƒ¨åŒ…å›´ç±».this.å˜é‡å**ï¼Œå¯ä»¥è®¿é—®åˆ°å¤–éƒ¨åŒ…å›´ç±»çš„æˆå‘˜å˜é‡\n    - é™æ€åµŒå¥—ç±»ä¸èƒ½è®¿é—®éé™æ€å˜é‡\n    - Java 7åŠä»¥å‰ï¼ŒåŒ¿åå†…éƒ¨ç±»å’Œå±€éƒ¨å†…éƒ¨ç±»åªèƒ½è®¿é—®å¤–éƒ¨åŒ…å›´ç±»çš„finalæˆå‘˜å˜é‡\n    - Java 8åŠä»¥åï¼ŒåŒ¿åå†…éƒ¨ç±»å’Œå±€éƒ¨å†…éƒ¨ç±»å¯è®¿é—®å¤–éƒ¨åŒ…å›´ç±»çš„finalæˆå‘˜å˜é‡å’Œ**äº‹å®æ„ä¹‰ä¸Šçš„finalå˜é‡(effectively final, ä¸€ä¸ªå˜é‡å®šå€¼åï¼Œå†ä¹Ÿæ²¡æœ‰æ”¹è¿‡å€¼)**\n\n## **5.åµŒå¥—ç±»åº”ç”¨**\n### **åŒ¿åå†…éƒ¨ç±»**\n- **æ— éœ€ç±»åï¼Œç”¨è¿‡å³ç„šï¼Œä½¿ç”¨å¹¿æ³›**\n- è¯¥ç±»çš„å¯¹è±¡åªè¦ä¸€ä¸ªï¼Œä¸”æ–¹æ³•åªæœ‰ä¸€ä¸ªï¼Œä»£ç çŸ­\n    - Androidä¸­å¸¸ç”¨åŒ¿åå†…éƒ¨ç±»\n\n### **å±€éƒ¨å†…éƒ¨ç±»**\n- å®šä¹‰åœ¨æ–¹æ³•ä½“å†…ï¼Œåªèƒ½åœ¨å½“å‰æ–¹æ³•å†…ä½¿ç”¨ï¼Œä»£ç çŸ­\n- ä½¿ç”¨è¾ƒå°‘\n- **ä»‹äºåŒ¿åå†…éƒ¨ç±»å’Œæ™®é€šå†…éƒ¨ç±»ä¹‹é—´**\n    - åªç”¨ä¸€æ¬¡ï¼Œå°±ç”¨åŒ¿åå†…éƒ¨ç±»ï¼Œç®€ä¾¿\n    - ä½¿ç”¨å¤šæ¬¡ï¼Œé‚£å°±ä¸Šå‡åˆ°æ™®é€šå†…éƒ¨ç±»ï¼Œæ•´ä¸ªç±»éƒ½å¯ä»¥ä½¿ç”¨\n- ç»§æ‰¿æŸä¸€ä¸ªç±»æˆ–æ¥å£ï¼Œé‡æ–°å®šä¹‰æ–¹æ³•ï¼Œå¹¶å½“ä½œè¿”å›å€¼åœ¨å¤–éƒ¨ä½¿ç”¨\n- å¦‚java.util.regex.Patternçš„splitAsStreamæ–¹æ³•çš„å±€éƒ¨å†…éƒ¨ç±»\n\n### **æ™®é€šå†…éƒ¨ç±»**\n- å¹¿æ³›ä½¿ç”¨åœ¨å…·æœ‰æ¯å­ç»“æ„çš„ç±»ï¼Œå†…éƒ¨ç±»å¯¹è±¡å’Œå¤–å›´ç±»ä¿æŒè”ç³»\n- å¦‚Mapå’ŒMap.Entryï¼ŒZipFileå’ŒZipFile.ZipEntryIteratorç­‰\n\n### **é™æ€åµŒå¥—ç±»**\n- **å’Œæ™®é€šç±»ä¸€è‡´**ï¼Œåªæ˜¯â€œ**ç¢°å·§**â€å£°æ˜åœ¨ä¸€ä¸ªå¤–å›´ç±»çš„å†…éƒ¨\n- å’Œå¤–å›´ç±»æ²¡æœ‰å¤ªå¤šçš„è”ç³»ï¼Œå¯ä»¥è„±ç¦»å¤–å›´ç±»å¯¹è±¡å­˜åœ¨ï¼Œä¹Ÿå¯ä»¥è®¿é—®å¤–å›´ç±»çš„é™æ€æˆå‘˜\n- å¦‚æœä¸éœ€è¦è®¿é—®å¤–å›´ç±»çš„éé™æ€æˆå‘˜ï¼Œå°½é‡å°†æ™®é€šå†…éƒ¨ç±»å˜æ›´ä¸ºé™æ€åµŒå¥—ç±»\n    - èŠ‚çœæ™®é€šå†…éƒ¨ç±»å’Œå¤–å›´ç±»çš„è”ç³»å¼€é”€\n    - ä½¿å¾—å¤–å›´ç±»å¯¹è±¡æ›´å®¹æ˜“è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶","tags":["Java"],"categories":["Java","Javaé«˜é˜¶"]},{"title":"Java æ³¨è§£","url":"/20210922/java-annotation/","content":"## **1.æ³¨è§£åŸºç¡€**\n- ä»JDK 1.5 å¼•å…¥\n- ä½äºæºç ä¸­(**ä»£ç /æ³¨é‡Š/æ³¨è§£**)ï¼Œä½¿ç”¨å…¶ä»–å·¥å…·è¿›è¡Œå¤„ç†çš„æ ‡ç­¾\n- æ³¨è§£ç”¨æ¥ä¿®é¥°ç¨‹åºçš„å…ƒç´ ï¼Œä½†ä¸ä¼šå¯¹è¢«ä¿®é¥°çš„å¯¹è±¡æœ‰ç›´æ¥çš„å½±å“\n- åªæœ‰é€šè¿‡**æŸç§é…å¥—çš„å·¥å…·**æ‰ä¼šå¯¹æ³¨è§£ä¿¡æ¯è¿›è¡Œè®¿é—®å’Œå¤„ç†\n- ä¸»è¦ç”¨é€”\n    - æä¾›ä¿¡æ¯ç»™ç¼–è¯‘å™¨/IDEå·¥å…·\n    - å¯ç”¨äºå…¶ä»–å·¥å…·æ¥äº§ç”Ÿé¢å¤–çš„ä»£ç /é…ç½®æ–‡ä»¶ç­‰\n    - æœ‰ä¸€äº›æ³¨è§£å¯åœ¨ç¨‹åºè¿è¡Œæ—¶è®¿é—®ï¼Œå¢åŠ ç¨‹åºçš„åŠ¨æ€æ€§\n\n### **JDKé¢„å®šä¹‰çš„æ™®é€šæ³¨è§£(éƒ¨åˆ†)** \n- @Override è¡¨ç¤ºç»§æ‰¿å’Œæ”¹å†™    è‡ªå¸¦æ³¨è§£\n- @Deprecated è¡¨ç¤ºåºŸå¼ƒ è‡ªå¸¦æ³¨è§£\n- @SuppressWarnings è¡¨ç¤ºå‹åˆ¶è­¦å‘Š è‡ªå¸¦æ³¨è§£\n- @SafeVarargs ä¸ä¼šå¯¹ä¸å®šé¡¹å‚æ•°åšå±é™©æ“ä½œ è‡ªå¸¦æ³¨è§£\n- @FunctionInterface å£°æ˜åŠŸèƒ½æ€§æ¥å£ è‡ªå¸¦æ³¨è§£\n\n### **JDKé¢„å®šä¹‰çš„å…ƒæ³¨è§£(éƒ¨åˆ†)** \n- @Target è®¾ç½®ç›®æ ‡èŒƒå›´ å…ƒæ³¨è§£\n- @Retention è®¾ç½®ä¿æŒæ€§ å…ƒæ³¨è§£\n- @Documented æ–‡æ¡£ å…ƒæ³¨è§£\n- @Inherited æ³¨è§£ç»§æ‰¿ å…ƒæ³¨è§£\n- @Repeatable æ­¤æ³¨è§£å¯ä»¥é‡å¤ä¿®é¥° å…ƒæ³¨è§£\n\n## **2.é¢„å®šä¹‰çš„æ™®é€šæ³¨è§£**\n### **@Override**\n- ä¿®é¥°æ–¹æ³•ï¼Œæ£€æŸ¥è¯¥æ–¹æ³•æ˜¯çˆ¶ç±»çš„æ–¹æ³•\n- å¼ºåˆ¶è¯¥å‡½æ•°ä»£ç å¿…é¡»ç¬¦åˆçˆ¶ç±»ä¸­è¯¥æ–¹æ³•çš„å®šä¹‰\n- é¿å…ä»£ç é”™è¯¯\n\n### **@Deprecated**\n- ä¿®é¥°ç±»/ç±»çš„å…ƒç´ /åŒ… \n- æ ‡æ³¨ä¸ºåºŸé™¤ï¼Œå»ºè®®ç¨‹åºå‘˜ä¸å†ä½¿ç”¨è¿™ä¸ªç±»/å…ƒç´ /åŒ…\n\n### **@SuppressWarnings**\n- å¯ä»¥ä¿®é¥°å˜é‡/æ–¹æ³•/æ„é€ å‡½æ•°/ç±»ç­‰\n- å‹åˆ¶å„ç§ä¸åŒç±»å‹çš„è­¦å‘Šä¿¡æ¯ï¼Œä½¿å¾—ç¼–è¯‘å™¨ä¸æ˜¾ç¤ºè­¦å‘Š\n- å„ç§ä¸åŒç±»å‹æ˜¯å åŠ ï¼Œå¦‚ä¿®é¥°ç±»çš„è­¦å‘Šç±»å‹ï¼Œå’Œä¿®é¥°æ–¹æ³•çš„è­¦å‘Šç±»å‹ï¼Œå¯¹äºæ–¹æ³•æ¥è¯´ï¼Œæ˜¯å åŠ çš„\n- **è­¦å‘Šç±»å‹åç§°æ˜¯ç¼–è¯‘å™¨/IDEå·¥å…·è‡ªå·±å®šçš„ï¼ŒJavaè§„èŒƒæ²¡æœ‰å¼ºåˆ¶è¦æ±‚å“ªäº›åç§°**ã€‚ç¼–è¯‘å™¨å‚å•†éœ€è¦è‡ªè¡Œåå•†ï¼Œä¿è¯åŒåè­¦å‘Šç±»å‹åœ¨å„ä¸ªç¼–è¯‘å™¨ä¸Šä¸€æ ·å·¥ä½œ\n- @SuppressWarnings\n    - @SuppressWarnings(â€œuncheckedâ€) å¿½ç•¥uncheckedè­¦å‘Šä¿¡æ¯\n    - @SuppressWarnings(â€œdeprecatedâ€) å¿½ç•¥è¿‡æ—¶æ–¹æ³•çš„è­¦å‘Šä¿¡æ¯\n    - @SuppressWarnings({â€œuncheckedâ€ï¼Œâ€œdeprecatedâ€}) å¿½ç•¥ä¸¤ç§è­¦å‘Šä¿¡æ¯\n    - @ SuppressWarnings(values={â€œuncheckedâ€ï¼Œâ€œdeprecatedâ€}) åŒä¸Š\n    - @ SuppressWarnings( â€œallâ€) å¿½ç•¥æ‰€æœ‰çš„è­¦å‘Šä¿¡æ¯\n- JLS åªè§„å®šäº†deprecatedå’Œuncheckedä¸¤ç§\n- å…¶ä»–çš„è­¦å‘Šç±»å‹\n    - allï¼Œå¿½ç•¥æ‰€æœ‰çš„è­¦å‘Š\n    - castï¼Œå¿½ç•¥ç±»è½¬å‹è­¦å‘Š\n    - serialï¼Œå¿½ç•¥å®ç°Serializableæ¥å£çš„ï¼Œæ²¡æœ‰å®šä¹‰serialVersionUID\n    - ä½¿ç”¨**javac -X** å¯ä»¥çœ‹å½“å‰çš„ç¼–è¯‘å™¨ä½¿ç”¨å“ªäº›è­¦å‘Šç±»å‹\n\n## **3.è‡ªå®šä¹‰æ³¨è§£**\n- æ³¨è§£å®šä¹‰ï¼šæ‰©å±•java.lang.annotation.Annotationæ³¨è§£æ¥å£\n- æ³¨è§£å¯ä»¥åŒ…æ‹¬çš„ç±»å‹\n    - 8ç§åŸºæœ¬ç±»å‹(int/short/long/float/double/byte/char/boolean) â€“String\n    - Class\n    - enumç±»å‹\n    - æ³¨è§£ç±»å‹\n    - ç”±å‰é¢ç±»å‹ç»„æˆçš„æ•°ç»„\n```java\npublic @interface BugReport {\n    enum Status {UNCONFIRMED, CONFIRMED, FIXED, NOTABUG};\n    boolean showStopper() default true;\n    String assiganedTo() default \"[none]\";\n    Status status() default Status.UNCONFIRMED;\n    String[] reportedBy();\n}\n```\n\n### **æ³¨è§£ä½¿ç”¨**\n- @Test\n```java\npublic @interface Test {\n    \n}\n```\n- @SingleTest\n- @SingleTest(5)\n- @SingleTest(value=5)\n```java\npublic @interface SingleTest {\n    int value() default 0;\n}\n```\n- @MultipleTest\n- @MultipleTest(a=1)\n- @MultipleTest(a=1,b=2)\n- @MultipleTest(b=2,a=1)\n- **@MultipleTest(1,2)æ˜¯é”™è¯¯å†™æ³•**\n```java\npublic @interface MultipleTest {\n    int a() default 0;\n    int b() default 0;\n}\n```\n\n### **æ³¨è§£ä½¿ç”¨çš„ä½ç½®**\n- @Targetå¯ä»¥é™å®šä½ç½®\n```java\n@Retention(RetentionPolicy.RUNTIME)\n//è¡¨ç¤ºè¯¥æ³¨è§£ä¼šä¿ç•™åœ¨classæ–‡ä»¶ä¸­\n@Target(ElementType.METHOD)   \n//è¡¨ç¤ºè¯¥æ³¨è§£åªèƒ½ç”¨äºæ–¹æ³•\n```\n- å…è®¸çš„ä½ç½®\n    - åŒ…\n    - ç±»\n    - æ¥å£\n    - æ–¹æ³•\n    - æ„é€ å™¨\n    - æˆå‘˜å˜é‡\n    - å±€éƒ¨å˜é‡/å½¢å‚å˜é‡/ç±»å‹å‚æ•°\n\n### **æ³¨è§£ä½œä¸ºå•å…ƒæµ‹è¯•**\n```java\npublic class Foo {\n    @SingleTest(1)\n    public static void m1(int a) {\n        if(a<0)\n        {\n            throw new RuntimeException(\"Crash\");\n        }\n    }\n\n    public static void m2() {\n    }\n\n    @SingleTest(value=-2)\n    public static void m3(int a) {\n        if(a<0)\n        {\n            throw new RuntimeException(\"Crash\");\n        }\n    }\n}\n\npublic static void main(String[] args) throws Exception {\n    int passed = 0, failed = 0;\n    String className = \"annotations.single.Foo\";\n    for (Method m : Class.forName(className).getMethods()) {\n\n        if (m.isAnnotationPresent(SingleTest.class)) {\n            System.out.println(m.getName());\n            SingleTest st = m.getAnnotation(SingleTest.class);                \n            try {\n                m.invoke(null,st.value());\n                passed++;\n            } catch (Throwable ex) {\n                System.out.printf(\"Test %s failed: %s %n\", m, ex.getCause());\n                failed++;\n            }\n        }\n    }\n    System.out.printf(\"Passed: %d, Failed %d%n\", passed, failed);\n}\n```\n\n## **4.é¢„å®šä¹‰çš„å…ƒæ³¨è§£**\n### **Retention** \n- ç¤ºä¾‹@Retention(RetentionPolicy.RUNTIME)\n- è¿™ä¸ªæ³¨è§£ç”¨æ¥ä¿®é¥°å…¶ä»–æ³¨è§£çš„å­˜åœ¨èŒƒå›´\n- RetentionPolicy.SOURCE æ³¨è§£ä»…å­˜åœ¨æºç ï¼Œä¸åœ¨classæ–‡ä»¶\n- RetentionPolicy.CLASS **é»˜è®¤çš„æ³¨è§£ä¿ç•™ç­–ç•¥**  æ³¨è§£å­˜åœ¨äº.classæ–‡ä»¶ï¼Œä½†æ˜¯ä¸èƒ½è¢«JVMåŠ è½½\n- RetentionPolicy.RUNTIME è¿™ç§ç­–ç•¥ä¸‹ï¼Œæ³¨è§£å¯ä»¥è¢«JVMè¿è¡Œæ—¶è®¿é—®åˆ°ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œå¯ä»¥ç»“åˆåå°„æ¥åšä¸€äº›äº‹æƒ…\n### **Target**\n- é™å®šç›®æ ‡æ³¨è§£ä½œç”¨äºä»€ä¹ˆä½ç½®@Target({ElementType.METHOD})\n- ElementType.ANNOTATION_TYPEï¼ˆæ³¨ï¼šä¿®é¥°æ³¨è§£ï¼‰\n- ElementType.CONSTRUCTOR\n- ElementType.FIELD\n- ElementType.LOCAL_VARIABLE\n- ElementType.METHOD\n- ElementType.PACKAGE\n- ElementType.PARAMETER\n- ElementType.TYPEï¼ˆæ³¨ï¼šä»»ä½•ç±»å‹ï¼Œå³ä¸Šé¢çš„çš„ç±»å‹éƒ½å¯ä»¥ä¿®é¥°ï¼‰\n### **Inherited**\n- è®©ä¸€ä¸ªç±»å’Œå®ƒçš„å­ç±»éƒ½åŒ…å«æŸä¸ªæ³¨è§£\n- æ™®é€šçš„æ³¨è§£æ²¡æœ‰ç»§æ‰¿åŠŸèƒ½\n### **Repeatable**\n- è‡ªJDK1.8å¼•å…¥\n- è¡¨ç¤ºè¢«ä¿®é¥°çš„æ³¨è§£å¯ä»¥é‡å¤åº”ç”¨æ ‡æ³¨\n- éœ€è¦å®šä¹‰æ³¨è§£å’Œ**å®¹å™¨æ³¨è§£**\n```java\n//æ™®é€šæ³¨è§£\n@Retention(RetentionPolicy.RUNTIME)\n@Repeatable(RepeatableAnnotations.class)\npublic @interface RepeatableAnnotation {\n    \n    int a() default 0;\n    int b() default 0;\n    int c() default 0;\n}\n\n//å®¹å™¨æ³¨è§£\n@Retention(RetentionPolicy.RUNTIME)\npublic @interface RepeatableAnnotations {\n    RepeatableAnnotation[] value();\n}\n```\n### **Documented**\n- æŒ‡æ˜è¿™ä¸ªæ³¨è§£å¯ä»¥è¢«Javadocå·¥å…·è§£æï¼Œå½¢æˆå¸®åŠ©æ–‡æ¡£\n\n## **5.æ³¨è§£çš„è§£æ**\n### **RetentionPolicy.RUNTIME**\n- æ³¨è§£åœ¨classæ–‡ä»¶ä¸­ï¼Œè¢«JVMåŠ è½½ï¼Œå¯ç”¨**åå°„è§£ææ³¨è§£**\n    - Class.getAnnotations()\n    - Class.isAnnotation()\n    - Class. .isAnnotationPresent(Class annotationClass)\n    - Method.getAnnotations()\n    - Method.isAnnotationPresent(Class annotationClass)\n    - Field.getAnnotations()\n    - Field.isAnnotationPresent(Class annotationClass)\n    - Constructor.getAnnotations()\n    - Constructor.isAnnotationPresent(Class annotationClass)\n\n### **RetentionPolicy.CLASS**\n- æ³¨è§£åœ¨classæ–‡ä»¶ä¸­ï¼Œä½†JVMæ²¡æœ‰åŠ è½½\n- åªèƒ½é‡‡ç”¨å­—èŠ‚ç å·¥å…·è¿›è¡Œç‰¹æ®Šå¤„ç†\n    - å¦‚ASMå·¥å…·ï¼Œhttps://asm.ow2.io/\n\n### **RetentionPolicy.SOURCE**\n- æ³¨è§£åœ¨javaæ–‡ä»¶ä¸­ï¼Œä¸åœ¨classæ–‡ä»¶ä¸­ï¼Œä¹Ÿä¸ä¼šè¢«JVMåŠ è½½\n- åªæœ‰åœ¨æºç çº§åˆ«è¿›è¡Œæ³¨è§£å¤„ç†\n- Javaæä¾›**æ³¨è§£å¤„ç†å™¨**æ¥è§£æå¸¦æ³¨è§£çš„æºç ï¼Œäº§ç”Ÿæ–°çš„æ–‡ä»¶\n    - æ³¨è§£å¤„ç†å™¨ç»§æ‰¿AbstractProcessorï¼Œé‡å†™processæ–¹æ³•\n    - javac â€“processor Processor1, Processor2, â€¦ sourceJavaFile\n    - ç¼–è¯‘å™¨å®šä½æºæ–‡ä»¶çš„æ³¨è§£ï¼Œç„¶åä¾æ¬¡å¯åŠ¨æ³¨è§£å¤„ç†å™¨æ‰§è¡Œå¤„ç†ã€‚å¦‚æœæŸä¸ªæ³¨è§£å¤„ç†å™¨äº§ç”Ÿæ–°çš„æºæ–‡ä»¶ï¼Œé‚£ä¹ˆå°†é‡å¤æ‰§è¡Œè¿™ä¸ªå¤„ç†è¿‡ç¨‹ã€‚ \n    - æ³¨è§£å¤„ç†å™¨åªèƒ½äº§ç”Ÿæ–°æ–‡ä»¶ï¼Œä¸ä¼šä¿®æ”¹å·²æœ‰çš„æºæ–‡ä»¶\n\n### **Java 5/6æä¾›çš„APTå·¥å…·**\n- ä¸€ä¸ªå¯ä»¥å¤„ç†æ³¨è§£çš„å‘½ä»¤è¡Œå·¥å…·\n    - https://docs.oracle.com/javase/6/docs/technotes/guides/apt/\n- åŒ…å«åœ¨com.sun.mirroråŒ…ä¸­\n- äºJava 7è¢«æ ‡è®°ä¸ºDeprecatedï¼Œè®¡åˆ’äºå°†æ¥ç‰ˆæœ¬ä¸­åºŸé™¤\n\n## **6.RUNTIMEæ³¨è§£çš„å®ç°æœ¬è´¨**\n- æ³¨è§£é‡‡ç”¨**æ¥å£ä¸­çš„æ–¹æ³•**æ¥è¡¨ç¤ºå˜é‡\n- Javaä¸ºæ³¨è§£äº§ç”Ÿä¸€ä¸ªä»£ç†ç±»ã€‚è¿™ä¸ªä»£ç†ç±»åŒ…æ‹¬ä¸€ä¸ªAnnotationInvocationHandleræˆå‘˜å˜é‡\n- AnnotationInvocationHandleræœ‰ä¸€ä¸ªMapçš„æˆå‘˜å˜é‡ï¼Œç”¨æ¥å­˜å‚¨æ‰€æœ‰çš„æ³¨è§£çš„å±æ€§èµ‹å€¼\n- åœ¨ç¨‹åºä¸­ï¼Œè°ƒç”¨**æ³¨è§£æ¥å£çš„æ–¹æ³•**ï¼Œå°†ä¼šè¢«**ä»£ç†ç±»**æ¥ç®¡ï¼Œç„¶åæ ¹æ®**æ–¹æ³•åå­—**ï¼Œåˆ°**Map**é‡Œé¢æ‹¿**ç›¸åº”çš„Value**å¹¶è¿”å›\n- ä¼ ç»Ÿçš„æ¥å£ä¸­çš„å˜é‡ï¼Œéƒ½æ˜¯public final static\n- æ³¨è§£éœ€è¦éšæ„èµ‹å€¼\n    - æ³¨è§£æ–¹æ³•è¡¨ç¤ºå˜é‡\n    - é‡‡ç”¨**ä»£ç†ç±»**æ‹¦æˆª**æ³¨è§£æ–¹æ³•è®¿é—®**\n    - æ‰€æœ‰çš„æ³¨è§£çš„èµ‹å€¼ï¼Œéƒ½æ”¾åœ¨Mapä¸­ï¼Œè®¿é—®é€Ÿåº¦å¿«","tags":["Java"],"categories":["Java","Javaé«˜é˜¶"]},{"title":"Java ä»£ç†","url":"/20210922/java-proxy/","content":"## **1.ä»£ç†æ¨¡å¼å’Œé™æ€ä»£ç†**\n### **ä»£ç†æ¨¡å¼**\n- Proxy Pattern, 23ä¸ªç»å…¸æ¨¡å¼çš„ä¸€ç§ï¼Œåˆç§°å§”æ‰˜æ¨¡å¼\n- ä¸ºç›®æ ‡å¯¹è±¡æä¾›(åŒ…è£…)äº†ä¸€ä¸ªä»£ç†ï¼Œè¿™ä¸ªä»£ç†å¯ä»¥æ§åˆ¶å¯¹ç›®æ ‡å¯¹è±¡çš„è®¿é—®\n- å¤–ç•Œä¸ç”¨ç›´æ¥è®¿é—®ç›®æ ‡å¯¹è±¡ï¼Œè€Œæ˜¯è®¿é—®ä»£ç†å¯¹è±¡ï¼Œç”±ä»£ç†å¯¹è±¡å†è°ƒç”¨ç›®æ ‡å¯¹è±¡\n- ä»£ç†å¯¹è±¡ä¸­å¯ä»¥æ·»åŠ ç›‘æ§å’Œå®¡æŸ¥å¤„ç†\n### **é™æ€ä»£ç†**\n- ä»£ç†å¯¹è±¡æŒæœ‰ç›®æ ‡å¯¹è±¡çš„å¥æŸ„\n- æ‰€æœ‰è°ƒç”¨ç›®æ ‡å¯¹è±¡çš„æ–¹æ³•ï¼Œéƒ½è°ƒç”¨ä»£ç†å¯¹è±¡çš„æ–¹æ³•\n- ä»£ç†ç±»å’Œè¢«ä»£ç†ç±»åº”è¯¥å…±åŒå®ç°ä¸€ä¸ªæ¥å£ï¼Œæˆ–è€…æ˜¯å…±åŒç»§æ‰¿æŸä¸ªç±»\n- å¯¹æ¯ä¸ªæ–¹æ³•ï¼Œéœ€è¦é™æ€ç¼–ç (ç†è§£ç®€å•ï¼Œä½†ä»£ç **ç¹ç**)\n```java\n//å¯¹å¤–æ¥å£\npublic interface Subject{\n    public void request();\n}\n\n//ç›®æ ‡å¯¹è±¡\nclass SubjectImpl implements Subject{\n  @Override\n  public void request(){\n      System.out.println(\"I am dealing the request.\");\n  }\n}\n\n//ä»£ç†å¯¹è±¡\nclass StaticProxy implements Subject{\n    //å®é™…ç›®æ ‡å¯¹è±¡\n    private Subject subject;\n    \n    public StaticProxy(Subject subject){\n        this.subject = subject;\n    }\n    \n    @Override\n    public void request(){\n        System.out.println(\"PreProcess\");\n        subject.request();\n        System.out.println(\"PostProcess\");\n    }\n}\n\n//é™æ€ä»£ç†æ¨¡å¼\npublic class StaticProxyDemo {\n    public static void main(String args[]){\n        //åˆ›å»ºå®é™…å¯¹è±¡\n        SubjectImpl subject = new SubjectImpl();\n        \n        //æŠŠå®é™…å¯¹è±¡å°è£…åˆ°ä»£ç†å¯¹è±¡ä¸­\n        StaticProxy p = new StaticProxy(subject);\n        p.request();\n    }\n}\n```\n\n## **2.åŠ¨æ€ä»£ç†**\n- å¯¹ç›®æ ‡å¯¹è±¡çš„æ–¹æ³•æ¯æ¬¡è¢«è°ƒç”¨ï¼Œè¿›è¡ŒåŠ¨æ€æ‹¦æˆª\n```mermaid\n    sequenceDiagram\n    participant å®¢æˆ·ç«¯\n    participant ä»£ç†å¯¹è±¡\n    participant ä»£ç†å¤„ç†å™¨\n    participant ç›®æ ‡å¯¹è±¡\n    å®¢æˆ·ç«¯->>ä»£ç†å¯¹è±¡:è°ƒç”¨æ–¹æ³•\n    ä»£ç†å¯¹è±¡->>ä»£ç†å¤„ç†å™¨:è½¬å‘ä»£ç†å¤„ç†å™¨<br>Invoke()æ–¹æ³•\n    ä»£ç†å¤„ç†å™¨->>ç›®æ ‡å¯¹è±¡:åˆ¤æ–­Method<br>è°ƒç”¨ç›®æ ‡å¯¹è±¡çš„æ–¹æ³•\n    ç›®æ ‡å¯¹è±¡->>ä»£ç†å¤„ç†å™¨:è¿”å›ç»“æœ\n    ä»£ç†å¤„ç†å™¨->>ä»£ç†å¯¹è±¡:è¿”å›ç»“æœ\n    ä»£ç†å¯¹è±¡->>å®¢æˆ·ç«¯:è¿”å›ç»“æœ\n```\n\n### **ä»£ç†å¤„ç†å™¨**\n- æŒæœ‰ç›®æ ‡å¯¹è±¡çš„å¥æŸ„\n- å®ç°InvocationHandleræ¥å£\n    - å®ç°invokeæ–¹æ³•\n    - æ‰€æœ‰çš„ä»£ç†å¯¹è±¡æ–¹æ³•è°ƒç”¨ï¼Œéƒ½ä¼šè½¬å‘åˆ°invokeæ–¹æ³•æ¥\n    - invokeçš„å½¢å‚methodï¼Œå°±æ˜¯æŒ‡ä»£ç†å¯¹è±¡æ–¹æ³•çš„è°ƒç”¨\n    - åœ¨invokeå†…éƒ¨ï¼Œå¯ä»¥æ ¹æ®methodï¼Œä½¿ç”¨ç›®æ ‡å¯¹è±¡ä¸åŒçš„æ–¹æ³•æ¥å“åº”è¯·æ±‚\n```java\nclass ProxyHandler implements InvocationHandler{\n    private Subject subject;\n    public ProxyHandler(Subject subject){\n        this.subject = subject;\n    }\n    \n    //æ­¤å‡½æ•°åœ¨ä»£ç†å¯¹è±¡è°ƒç”¨ä»»ä½•ä¸€ä¸ªæ–¹æ³•æ—¶éƒ½ä¼šè¢«è°ƒç”¨ã€‚\n    @Override\n    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {\n        //å®šä¹‰é¢„å¤„ç†çš„å·¥ä½œï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥æ ¹æ® method çš„ä¸åŒè¿›è¡Œä¸åŒçš„é¢„å¤„ç†å·¥ä½œ\n        System.out.println(\"====before====\");\n        Object result = method.invoke(subject, args);\n        System.out.println(\"====after====\");\n        return result;\n    }\n}\n```\n\n### **ä»£ç†å¯¹è±¡**\n- æ ¹æ®ç»™å®šçš„æ¥å£ï¼Œç”±Proxyç±»è‡ªåŠ¨ç”Ÿæˆçš„å¯¹è±¡\n- ç±»å‹ com.sun.proxy.$Proxy0ï¼Œç»§æ‰¿è‡ªjava.lang.reflect.Proxy\n- é€šå¸¸å’Œç›®æ ‡å¯¹è±¡å®ç°åŒæ ·çš„æ¥å£(å¯å¦å®ç°å…¶ä»–çš„æ¥å£) \n- å®ç°å¤šä¸ªæ¥å£\n    - æ¥å£çš„æ’åºéå¸¸é‡è¦\n    - å½“å¤šä¸ªæ¥å£é‡Œé¢æœ‰æ–¹æ³•åŒåï¼Œåˆ™é»˜è®¤ä»¥ç¬¬ä¸€ä¸ªæ¥å£çš„æ–¹æ³•\n```java\n//1.åˆ›å»ºç›®æ ‡å¯¹è±¡\nSubjectImpl realSubject = new SubjectImpl();    \n\n//2.åˆ›å»ºè°ƒç”¨å¤„ç†å™¨å¯¹è±¡\nProxyHandler handler = new ProxyHandler(realSubject); \n\n//3.åŠ¨æ€ç”Ÿæˆä»£ç†å¯¹è±¡\nSubject proxySubject = \n        (Subject)Proxy.newProxyInstance\n          (SubjectImpl.class.getClassLoader(),\n           SubjectImpl.class.getInterfaces(), handler); \n//proxySubjectçœŸå®ç±»å‹com.sun.proxy.$Proxy0\n//proxySubjectç»§æ‰¿Proxyç±»ï¼Œå®ç°Subjectæ¥å£\n//newProxyInstanceçš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œå°±æ˜¯æŒ‡å®šä»£ç†å¯¹è±¡çš„æ¥å£\n\n//4.å®¢æˆ·ç«¯é€šè¿‡ä»£ç†å¯¹è±¡è°ƒç”¨æ–¹æ³•\n//æœ¬æ¬¡è°ƒç”¨å°†è‡ªåŠ¨è¢«ä»£ç†å¤„ç†å™¨çš„invokeæ–¹æ³•æ¥æ”¶\nproxySubject.request();    \n```\n\n## **3.AOPç¼–ç¨‹**\n- AOPï¼šAspect Oriented Programming\n### **é¢å‘åˆ‡é¢ç¼–ç¨‹ vs é¢å‘å¯¹è±¡ç¼–ç¨‹** \n- é¢å‘å¯¹è±¡ï¼šå°†éœ€æ±‚åŠŸèƒ½åˆ’åˆ†ä¸ºä¸åŒçš„ã€ç‹¬ç«‹ï¼Œå°è£…è‰¯å¥½çš„ç±»ï¼Œå¹¶è®©å®ƒä»¬\né€šè¿‡ç»§æ‰¿å’Œå¤šæ€å®ç°ç›¸åŒå’Œä¸åŒè¡Œä¸ºã€‚\n- é¢å‘åˆ‡é¢ï¼šå°†é€šç”¨éœ€æ±‚åŠŸèƒ½ä»ä¼—å¤šç±»ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œä½¿å¾—å¾ˆå¤šç±»å…±äº«ä¸€ä¸ª\nè¡Œä¸ºï¼Œä¸€æ—¦å‘ç”Ÿå˜åŒ–ï¼Œä¸å¿…ä¿®æ”¹å¾ˆå¤šç±»ï¼Œè€Œåªéœ€è¦ä¿®æ”¹è¿™ä¸ªè¡Œä¸ºå³å¯\n```xml\n//aops.xmlé…ç½®æ–‡ä»¶ç¤ºä¾‹\n<aops>\n    <aop>\n        <method>washHand</method>\n        <type>before</type>\n        <method>eat</method>\n    </aop>\n</aops>\n```\n```java\n//ä½¿ç”¨åŠ¨æ€ä»£ç†è¿›è¡Œç®€å•AOPç¼–ç¨‹\npublic static void initXml(){\n    //çœç•¥ä¸¤ç±»çš„ä»£ç å®ç°\n    \n    //è¯»å–aopé…ç½®æ–‡ä»¶\n    XmlReader.readXml(\"aops.xml\");\n    //ResourceListenerç›‘å¬ç›®å½•å˜åŒ–\n    ResourceListener.addListener(\"E:/java/source/PMOOC04-03/\");\n}    \n\npublic static void main(String[] args) throws Exception{\n    Main.initXml();        \n\n    Person action = new PersonImpl();\n    ProxyHandler mh = new ProxyHandler(action);\n    ClassLoader cl = Main.class.getClassLoader();\n    Class<?> proxyClass = Proxy.getProxyClass(cl, new Class<?>[]{Person.class});\n    Person proxy = (Person) proxyClass.getConstructor(new Class[]{InvocationHandler.class}).\n            newInstance(new Object[]{mh});\n\n    while(true){\n        proxy.eat();\n        try{\n            Thread.sleep(3000);\n        }\n        catch(Exception e){\n            e.printStackTrace();\n        }\n    }\n}\n\n//ä»£ç†å¤„ç†å™¨\npublic class ProxyHandler implements InvocationHandler {\n    \n    static String beforeMethod = \"\";\n    static String afterMethod = \"\";\n    \n    private Person receiverObject;\n    \n    public ProxyHandler(Person object){\n        this.receiverObject = object;\n    }\n    \n    @Override\n    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {\n        //å¤„ç†beforeæ–¹æ³•\n        if(beforeMethod!=null&&beforeMethod.length()>0){\n            ClassLoader cl = ProxyHandler.class.getClassLoader();\n            Class<?> c = cl.loadClass(receiverObject.getClass().getName());\n            Method m=c.getMethod(beforeMethod);\n            Object obj = c.newInstance();\n            m.invoke(obj);\n        }\n        \n        //å¤„ç†ç›®æ ‡æ–¹æ³•\n        Object result = method.invoke(receiverObject, args);\n        \n        //å¤„ç†afteræ–¹æ³•\n        if(afterMethod!=null&&afterMethod.length()>0){\n            method.invoke(receiverObject, args);\n            ClassLoader cl = ProxyHandler.class.getClassLoader();\n            Class<?> c = cl.loadClass(receiverObject.getClass().getName());\n            Method m=c.getMethod(afterMethod);\n            Object obj = c.newInstance();\n            m.invoke(obj);\n        }\n        return result;\n    }\n}\n//\n```\n\n### **é¢å‘åˆ‡é¢ç¼–ç¨‹**\n- ä¸€ä¸ªæ¦‚å¿µ/è§„èŒƒï¼Œæ²¡æœ‰é™å®šè¯­è¨€\n- **ä¸æ˜¯å–ä»£OOPç¼–ç¨‹ï¼Œè€Œæ˜¯OOPçš„è¡¥å……ï¼Œå’Œæ•°æ®åº“çš„è§¦å‘å™¨æœ‰ç‚¹ç›¸ä¼¼**\n- ä¸»è¦å†…å®¹\n    - Aspect ï¼šé…ç½®æ–‡ä»¶ï¼ŒåŒ…æ‹¬ä¸€äº›Pointcutå’Œç›¸åº”çš„Advice\n    - Joint pointï¼šåœ¨ç¨‹åºä¸­æ˜ç¡®å®šä¹‰çš„ç‚¹ï¼Œå¦‚æ–¹æ³•è°ƒç”¨ã€å¯¹ç±»æˆå‘˜è®¿é—®ç­‰\n    - Pointcutï¼šä¸€ç»„joint point, å¯ä»¥é€šè¿‡é€»è¾‘å…³ç³»/é€šé…ç¬¦/æ­£åˆ™ç­‰ç»„åˆèµ·æ¥ï¼Œå®šä¹‰äº†ç›¸åº”adviceå°†è¦å‘ç”Ÿçš„åœ°æ–¹\n    - Adviceï¼šå®šä¹‰äº†åœ¨pointcutå¤„è¦å‘ç”Ÿçš„åŠ¨ä½œ,é€šè¿‡before/after/around/æ¥å…³è”\n    - weavingï¼šadviceä»£ç åœ¨å…·ä½“joint pointçš„å…³è”æ–¹å¼\n\n### **Javaçš„AOPå®ç°**\n- AspectJ(Eclipse)ï¼Œ https://www.eclipse.org/aspectj/\n- Spring AOPï¼Œhttps://spring.io/projects/spring-framework","tags":["Java"],"categories":["Java","Javaé«˜é˜¶"]},{"title":"Java åå°„","url":"/20210922/java-reflection/","content":"## **1.åå°„åŸºç¡€**\n- åå°„ï¼šreflection\n    - ç¨‹åºå¯ä»¥è®¿é—®ã€æ£€æµ‹å’Œä¿®æ”¹å®ƒæœ¬èº«çŠ¶æ€æˆ–è¡Œä¸ºçš„èƒ½åŠ›ï¼Œå³è‡ªæè¿°\n    å’Œè‡ªæ§åˆ¶ã€‚\n    - å¯ä»¥åœ¨è¿è¡Œæ—¶åŠ è½½ã€æ¢çŸ¥å’Œä½¿ç”¨ç¼–è¯‘æœŸé—´å®Œå…¨æœªçŸ¥çš„ç±»ã€‚\n    - ç»™Javaæ’ä¸ŠåŠ¨æ€è¯­è¨€ç‰¹æ€§çš„ç¿…è†€ï¼Œå¼¥è¡¥å¼ºç±»å‹è¯­è¨€çš„ä¸è¶³ã€‚\n    - java.lang.reflectåŒ…ï¼Œåœ¨Java 2æ—¶ä»£å°±æœ‰ï¼Œåœ¨Java 5å¾—åˆ°å®Œå–„\n\n### **åå°„åŠŸèƒ½**\n- åœ¨è¿è¡Œä¸­åˆ†æç±»çš„èƒ½åŠ›\n- åœ¨è¿è¡Œä¸­æŸ¥çœ‹å’Œæ“ä½œå¯¹è±¡\n    - **åŸºäºåå°„è‡ªç”±åˆ›å»ºå¯¹è±¡**\n    - åå°„æ„å»ºå‡ºæ— æ³•ç›´æ¥è®¿é—®çš„ç±»\n    - setæˆ–è€…getåˆ°æ— æ³•è®¿é—®çš„æˆå‘˜å˜é‡\n    - è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•\n- å®ç°é€šç”¨çš„æ•°ç»„æ“ä½œä»£ç \n- ç±»ä¼¼å‡½æ•°æŒ‡é’ˆçš„åŠŸèƒ½\n\n### **åˆ›å»ºå¯¹è±¡**\n- æ–¹æ³•1ï¼šé™æ€ç¼–ç &ç¼–è¯‘\n```java\nA obj1 = new A();\n```\n- æ–¹æ³•2ï¼šå…‹éš†(clone)\n```java\npublic class B implements Cloneable {\n    \n    protected Object clone() throws CloneNotSupportedException\n    {\n        return super.clone();\n    }\n}\n//obj3 æ˜¯obj2çš„å…‹éš†å¯¹è±¡  æ²¡æœ‰è°ƒç”¨æ„é€ å‡½æ•°\nB obj2 = new B();\nB obj3 = (B) obj2.clone();\n```\n- æ–¹æ³•3ï¼šåºåˆ—åŒ–(serialization)å’Œååºåˆ—åŒ–(deserialization)\n```java\npublic class C implements Serializable {\n    private static final long serialVersionUID = 1L;\n\n}\n\n//æ²¡æœ‰è°ƒç”¨æ„é€ å‡½æ•°\n//åºåˆ—åŒ–ä¼šå¼•å‘å®‰å…¨æ¼æ´ï¼Œæœªæ¥å°†è¢«ç§»é™¤å‡ºJDKï¼Œè¯·è°¨æ…ä½¿ç”¨ï¼ï¼ï¼\nC obj4  = new C();\nObjectOutputStream out = new ObjectOutputStream(new FileOutputStream(\"data.obj\"));   \nout.writeObject(obj4);   \nout.close();   \n\nObjectInputStream in = new ObjectInputStream(new FileInputStream(\"data.obj\"));   \nC obj5 = (C) in.readObject();   \nin.close();   \n```\n- æ–¹æ³•4å’Œ5ï¼šåå°„\n```java\npublic class A {\n    public void hello()\n    {\n        System.out.println(\"hello from A\");\n    }\n}\n\n//ç¬¬å››ç§  newInstance  è°ƒç”¨æ„é€ å‡½æ•°        \nObject obj6 = Class.forName(\"A\").newInstance();        \nMethod m = Class.forName(\"A\").getMethod(\"hello\");\nm.invoke(obj6);\n\nA obj7 = (A) Class.forName(\"A\").newInstance();\n\n//ç¬¬äº”ç§  newInstance  è°ƒç”¨æ„é€ å‡½æ•°\nConstructor<A> constructor = A.class.getConstructor();   \nA obj8 = constructor.newInstance();\nobj8.hello();    \n```\n\n## **2.åå°„å…³é”®ç±»**\n- Classï¼šç±»å‹æ ‡è¯†\n    - JVMä¸ºæ¯ä¸ªå¯¹è±¡éƒ½ä¿ç•™å…¶ç±»å‹æ ‡è¯†ä¿¡æ¯(Runtime Type Identification)\n    - ä¸‰ç§è·å–æ–¹å¼\n```java\nString s1 = \"abc\";\nClass c1 = s1.getClass();\nSystem.out.println(c1.getName());\n\nClass c2 = Class.forName(\"java.lang.String\");\nSystem.out.println(c2.getName());\n\nClass c3 = String.class;\nSystem.out.println(c3.getName());    \n```\n\n### **è·å–è¯¦ç»†ä¿¡æ¯**\n- getFields()\n    - è¿”å›æœ¬ç±»å’Œæ‰€æœ‰çˆ¶ç±»æ‰€æœ‰çš„publicæˆå‘˜å˜é‡\n- getDeclareFields()\n    - è¿”å›æœ¬ç±»è‡ªå·±å®šä¹‰çš„æˆå‘˜å˜é‡ï¼ŒåŒ…æ‹¬privateå˜é‡ï¼Œä¸åŒ…æ‹¬çˆ¶ç±»å˜é‡\n```java\nA obj = new A(20, \"Tom\");\nClass c = obj.getClass();\n\n//è·å–æœ¬ç±»åŠçˆ¶ç±»æ‰€æœ‰çš„publicå­—æ®µ\nField[] fs = c.getFields(); \nSystem.out.println(fs[0].getName() + \":\" + fs[0].get(obj));\n\n//è·å–æœ¬ç±»æ‰€æœ‰å£°æ˜çš„å­—æ®µ\nField[] fs2 = c.getDeclaredFields();\nfor(Field f : fs2)\n{\n    f.setAccessible(true);\n    System.out.println(f.getName() + \":\" + f.get(obj));\n}\n```\n- getMethods()\n    - è¿”å›æœ¬ç±»å’Œæ‰€æœ‰çˆ¶ç±»æ‰€æœ‰çš„publicæ–¹æ³•\n- getDeclareMethods()\n    - è¿”å›æœ¬ç±»è‡ªå·±å®šä¹‰çš„æ–¹æ³•ï¼ŒåŒ…æ‹¬privateæ–¹æ³•ï¼Œä¸åŒ…æ‹¬çˆ¶ç±»æ–¹æ³•\n```java\nB obj = new B();\nClass c = obj.getClass();\n\n// è·å–publicæ–¹æ³• åŒ…æ‹¬çˆ¶ç±»å’Œçˆ¶æ¥å£\nMethod[] ms = c.getMethods();\nfor (Method m : ms) {\n    if (\"f1\".equals(m.getName())) {\n        m.invoke(obj, null);//ä¼ å‚è°ƒç”¨æ–¹æ³•\n    }\n}\n\n// è·å¾—è¯¥ç±»çš„æ‰€æœ‰æ–¹æ³•\nMethod[] ms2 = c.getDeclaredMethods();\nfor (Method m : ms2) {\n    if (\"f2\".equals(m.getName())) {\n        m.setAccessible(true);\n        String result = (String) m.invoke(obj, \"abc\");//ä¼ å‚è·å¾—ç»“æœ\n        System.out.println(result);\n    }\n}\n```\n- getPackage()\n    - è¿”å›æœ¬ç±»æ‰€åœ¨åŒ…\n- getModifiers()\n    - è¿”å›æœ¬ç±»å‰ç¼€ä¿®é¥°ç¬¦\n- getInterfaces()\n    - è¿”å›æœ¬ç±»ç»§æ‰¿çš„æ¥å£\n- getSuperClass()\n    - è¿”å›æœ¬ç±»çš„çˆ¶ç±»\n```java\nSon son = new Son();\nClass c = son.getClass();\n\nClass father = c.getSuperclass();\nSystem.out.println(father.getName());\n\nClass[] inters = c.getInterfaces();\nfor(Class inter : inters)\n{\n    System.out.println(inter.getName());\n}\n```\n- getConstructors()\n    - è¿”å›æœ¬ç±»æ‰€æœ‰çš„æ„é€ å‡½æ•°\n```java\nD d = new D();\nClass c = d.getClass();\n\nConstructor[] cons = c.getConstructors();\nfor (Constructor con : cons) {\n    if (con.getParameterCount() > 0) {\n        // æœ‰å‚æ„é€ å‡½æ•°\n        D obj = (D) con.newInstance(100);\n        obj.printNum();\n    } else {\n        // æ— å‚æ„é€ å‡½æ•°\n        D obj = (D) con.newInstance();\n        obj.printNum();\n    }\n}\n```\n- getAnnotations()\n    - è¿”å›æœ¬ç±»çš„æ³¨è§£\n\n## **3.åå°„åº”ç”¨**\n### **æ•°æ®åº“è¿æ¥**\n- JDBC\n    - Connectionï¼Œè¿æ¥åˆ°å„ä¸ªä¸åŒæ•°æ®åº“\n```java\ntry{            \n    Class.forName(\"com.mysql.jdbc.Driver\");\n    //Class.forName(className, true, currentLoader) \n    //é€šçŸ¥ç±»åŠ è½½å™¨åŠ è½½æ­¤ç±»çš„classæ–‡ä»¶\n}catch(ClassNotFoundException e1){\n    e1.printStackTrace();\n    return;\n}\n```\n\n### **æ•°ç»„æ‰©å……å™¨**\n- ç»™å®šä¸€ä¸ªæ•°ç»„(ä»»æ„ç±»å‹)ï¼Œå°†å…¶é•¿åº¦æ‰©å¤§ä¸€å€\n    - Javaçš„æ•°ç»„ä¸€æ—¦åˆ›å»ºï¼Œå…¶é•¿åº¦æ˜¯ä¸å†æ›´æ”¹çš„\n    - æ–°å»ºä¸€ä¸ªå¤§æ•°ç»„(**ç›¸åŒç±»å‹**)ï¼Œç„¶åå°†æ—§æ•°ç»„çš„å†…å®¹æ‹·è´è¿‡å»\n```java\npublic static void main(String[] args) {\n    int[] a = { 1, 2, 3, 4, 5 };\n    a = (int[]) goodCopy(a, 10);\n    for (int i : a) {\n        System.out.println(i);\n    }\n}\n\npublic static Object goodCopy(Object oldArray, int newLength) {\n    // Arrayç±»å‹\n    Class c = oldArray.getClass();\n\n    // è·å–æ•°ç»„ä¸­çš„å•ä¸ªå…ƒç´ ç±»å‹\n    Class componentType = c.getComponentType();\n\n    // æ—§æ•°ç»„é•¿åº¦\n    int oldLength = Array.getLength(oldArray);\n\n    // æ–°æ•°ç»„\n    Object newArray = Array.newInstance(componentType, newLength);\n\n    // æ‹·è´æ—§æ•°æ®\n    System.arraycopy(oldArray, 0, newArray, 0, oldLength);\n    return newArray;\n}\n```\n\n### **åŠ¨æ€æ‰§è¡Œæ–¹æ³•**\n- ç»™å®šç±»åã€æ–¹æ³•åï¼Œå³å¯æ‰§è¡Œ\n    - åŠ ä¸Šå®šæ—¶å™¨ï¼Œå³å¯åšå®šæ—¶ä»»åŠ¡æ‰§è¡Œ\n```java\nTimer timer = new Timer();\n\nCalendar now = Calendar.getInstance();\nnow.set(Calendar.SECOND, \n        now.get(Calendar.SECOND) + 1);\nDate runDate = now.getTime();\n\nMyTask task2 = new MyTask();\ntimer.scheduleAtFixedRate(task2, runDate, 3000); \n// å›ºå®šé€Ÿç‡\n\nThread.sleep(15000);\ntimer.cancel(); // å–æ¶ˆå®šæ—¶å™¨\n\nclass MyTask extends TimerTask {\n    public void run() {\n        try {\n            Method m = Class.forName(\"Worker\")\n                    .getClass().getMethod(\"hello\");\n            m.invoke(null);// é™æ€æ–¹æ³•å¯ä»¥ä¸ç”¨newå¯¹è±¡\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n}\n\nclass Worker {\n    public static void hello() {\n        System.out.println(\"Hello java!\");\n    }\n}\n```\n\n### **Jsonå’ŒJavaå¯¹è±¡äº’è½¬**\n- Jsonï¼š {â€œname\":\"Jo\",\"email\":\"a@b.com\"}\n```java\nGson gson = new Gson();\nString s =  \"{\\\"name\\\":\\\"Jo\\\"\"\n        + \",\\\"email\\\":\\\"a@b.com\\\"}\";\nPerson p = gson.fromJson(s, Person.class);\n\nSystem.out.println(p.getName());\nSystem.out.println(p.getEmail());\n```\n\n### **Tomcatçš„Servletå¯¹è±¡åˆ›å»º**\n\n### **MyBatisçš„OR/M**\n\n### **Springçš„Beanå®¹å™¨**\n\n### **org.reflectionsåŒ…ä»‹ç»**\n- Reflectionçš„å¢å¼ºå·¥å…·åŒ…\n    - https://github.com/ronmamo/reflections\n        - Java runtime metadata analysis \n        - è·å–æŸç±»çš„æ‰€æœ‰å­ç±»å‹\n        - è·å–æœ‰ç‰¹æ®Šannotationçš„ç±»å‹æˆ–è€…æˆå‘˜å˜é‡/æ–¹æ³•\n        - æ ¹æ®æ­£åˆ™è¡¨è¾¾å¼è·å–èµ„æº(ç±»/æˆå‘˜å˜é‡/æ–¹æ³•) â€¢ æ ¹æ®ç»„åˆæ¡ä»¶æŸ¥è¯¢ç›¸åº”çš„æ–¹æ³•\n        -  â€¦â€¦\n\n## **ç¼–è¯‘å™¨API**\n- å¯¹.javaæ–‡ä»¶å³æ—¶ç¼–è¯‘\n- å¯¹å­—ç¬¦ä¸²å³æ—¶ç¼–è¯‘\n- ç›‘å¬åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­äº§ç”Ÿçš„è­¦å‘Šå’Œé”™è¯¯\n- åœ¨ä»£ç ä¸­è¿è¡Œç¼–è¯‘å™¨(å¹¶éï¼šRuntimeå‘½ä»¤è¡Œè°ƒç”¨javacå‘½ä»¤)\n\n### **JavaCompiler**\n- è‡ªJava 1.6 æ¨å‡ºï¼Œä½äºjavax.toolsåŒ…ä¸­\n- å¯ç”¨åœ¨ç¨‹åºæ–‡ä»¶ä¸­çš„Javaç¼–è¯‘å™¨æ¥å£(ä»£æ›¿javac.exe)\n- åœ¨ç¨‹åºä¸­ç¼–è¯‘javaæ–‡ä»¶ï¼Œäº§ç”Ÿclassæ–‡ä»¶\n- runæ–¹æ³•(ç»§æ‰¿è‡ªjava.tools.Tools)ï¼šè¾ƒç®€å•ã€‚å¯ä»¥ç¼–è¯‘javaæºæ–‡ä»¶ï¼Œç”Ÿæˆclassæ–‡ä»¶ï¼Œä½†ä¸èƒ½æŒ‡å®šè¾“å‡ºè·¯å¾„,ç›‘æ§é”™è¯¯ä¿¡æ¯, è°ƒç”¨åå°±åœ¨æºç æ‰€åœ¨ç›®å½•ç”Ÿæˆclassæ–‡ä»¶\n```java\nJavaCompiler compiler = ToolProvider.getSystemJavaCompiler();\n// ç¬¬ä¸€ä¸ªå‚æ•°ï¼šè¾“å…¥æµï¼Œnullè¡¨ç¤ºé»˜è®¤ä½¿ç”¨system.in\n// ç¬¬äºŒä¸ªå‚æ•°ï¼šè¾“å‡ºæµï¼Œnullè¡¨ç¤ºé»˜è®¤ä½¿ç”¨system.out\n// ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šé”™è¯¯æµï¼Œnullè¡¨ç¤ºé»˜è®¤ä½¿ç”¨system.err\n// ç¬¬å››ä¸ªå‚æ•°ï¼šString... éœ€è¦ç¼–è¯‘çš„æ–‡ä»¶å\n// è¿”å›å€¼ï¼š0è¡¨ç¤ºæˆåŠŸï¼Œå…¶ä»–é”™è¯¯\nint result = compiler.run(null, null, null, \"F:/temp/Hello1.java\", \"F:/temp/Hello2.java\");\nSystem.out.println(0 == result ? \"Success\" : \"Fail\");\n```\n- getTaskæ–¹æ³•ï¼šæ›´å¼ºå¤§çš„åŠŸèƒ½ã€‚å¯ä»¥ç¼–è¯‘javaæºæ–‡ä»¶ï¼ŒåŒ…æ‹¬åœ¨å†…å­˜ä¸­çš„javaæ–‡ä»¶(å­—ç¬¦ä¸²)ï¼Œç”Ÿæˆclassæ–‡ä»¶\n```java\npublic static void compileJavaFromString() {\n        \n    StringBuilder sb = new StringBuilder();\n    String className = \"Hello\";\n\n    //sb.append(\"package com.test;\\n\");\n    sb.append(\"public class Hello{\\n\");\n    sb.append(\"public static void main(String[]args){\\n\");\n    sb.append(\"System.out.print(\\\"hello world\\\"); \\n\");\n    sb.append(\"}\\n\");\n    sb.append(\"}\");\n\n    //å°†ä¸Šè¿°æºç ç¼–è¯‘\n    Class<?> c = compile(className, sb.toString());\n    try {\n        // ç”Ÿæˆå¯¹è±¡\n        Object obj = c.newInstance();\n        // è°ƒç”¨mainæ–¹æ³•\n        Method m = c.getMethod(\"main\", String[].class);\n        m.invoke(obj, new Object[] { new String[] {} });\n    } catch (Exception e) {\n        e.printStackTrace();\n    }\n\n}\n\nprivate static Class<?> compile(String className, String javaCodes) {\n\n    //å°†å­—ç¬¦ä¸²åŒ…è£…ä¸ºSimpleJavaFileObjectå¯¹è±¡\n    JavaSourceFromString srcObject = new JavaSourceFromString(className, javaCodes);        \n    System.out.println(srcObject.getCode());\n    Iterable<? extends JavaFileObject> fileObjects = Arrays.asList(srcObject);\n\n\n    JavaCompiler compiler = ToolProvider.getSystemJavaCompiler();\n    StandardJavaFileManager fileManager = compiler.getStandardFileManager(null, null, null);\n    DiagnosticCollector<JavaFileObject> diagnosticCollector = new DiagnosticCollector<JavaFileObject>();  \n\n    //è®¾ç½®ç¼–è¯‘çš„è¾“å‡ºç›®å½•ï¼Œå¹¶åŒ…è£…åœ¨optionsä¸­\n    String flag = \"-d\";\n    String outDir = \"\";\n    try {\n        File classPath = new File(Thread.currentThread().getContextClassLoader().getResource(\"\").toURI());\n        outDir = classPath.getAbsolutePath() + File.separator;\n        System.out.println(outDir);\n    } catch (URISyntaxException e1) {\n        e1.printStackTrace();\n    }        \n    Iterable<String> options = Arrays.asList(flag, outDir);\n\n    //JavaCompiler.getTaskæ–¹æ³•ï¼šä»¥futureçš„ä»»åŠ¡å½¢å¼(å¤šçº¿ç¨‹)ï¼Œæ¥æ‰§è¡Œç¼–è¯‘ä»»åŠ¡\n\n    // ç¬¬ä¸€ä¸ªå‚æ•°ï¼šé¢å¤–è¾“å‡ºæµï¼Œnullè¡¨ç¤ºé»˜è®¤ä½¿ç”¨system.err\n    // ç¬¬äºŒä¸ªå‚æ•°ï¼šæ–‡ä»¶ç®¡ç†å™¨ï¼Œnullè¡¨ç¤ºç¼–è¯‘å™¨æ ‡å‡†æ–‡ä»¶ç®¡ç†å™¨\n    // ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šè¯Šæ–­ç›‘å¬å™¨ï¼Œnullè¡¨ç¤ºä½¿ç”¨ç¼–è¯‘å™¨é»˜è®¤æ–¹æ³•æ¥æŠ¥å‘Šè¯Šæ–­ä¿¡æ¯\n    // ç¬¬å››ä¸ªå‚æ•°ï¼šç¼–è¯‘å™¨å‚æ•°ï¼Œnullè¡¨ç¤ºæ— å‚æ•°\n    // ç¬¬äº”ä¸ªå‚æ•°ï¼šéœ€è¦ç»è¿‡annotationå¤„ç†çš„ç±»åï¼Œnullè¡¨ç¤ºæ²¡æœ‰ç±»éœ€è¦annotationå¤„ç†\n    // ç¬¬å…­ä¸ªå‚æ•°ï¼šå¾…ç¼–è¯‘çš„ç±»\n\n    JavaCompiler.CompilationTask task = \n            compiler.getTask(null, fileManager, diagnosticCollector, options, null, fileObjects);\n\n    //ç­‰å¾…ç¼–è¯‘ç»“æŸ\n    boolean result = task.call();\n    if (result == true) {\n        try {\n            return Class.forName(className);\n        } catch (ClassNotFoundException e) {\n            e.printStackTrace();\n        }\n    }\n    else            \n    {\n        //print the Diagnostic's information   \n        for  (Diagnostic diagnostic : diagnosticCollector  \n                .getDiagnostics())  \n        {  \n            System.out.println(\"Error on line: \"   \n                    + diagnostic.getLineNumber() + \"; URI: \"   \n                    + diagnostic.getSource().toString());  \n        }  \n    }\n    return null;\n}\n```\n\n### **Javaç¼–è¯‘å™¨APIä½œç”¨**\n- Java EEçš„JSPç¼–è¯‘\n- åœ¨çº¿ç¼–ç¨‹ç¯å¢ƒ\n- åœ¨çº¿ç¨‹åºè¯„åˆ¤ç³»ç»Ÿ(Online Judgeç³»ç»Ÿ) \n- è‡ªåŠ¨åŒ–çš„æ„å»ºå’Œæµ‹è¯•å·¥å…·\n- â€¦â€¦\n\n### **åŸºäºJavaCompilerçš„é›†æˆå·¥å…·**\n- Janinoï¼Œhttp://janino-compiler.github.io/janino\n- InMemoryJavaCompileï¼Œhttps://github.com/trung/InMemoryJavaCompiler\n- Java-Runtime-Compiler, https://github.com/OpenHFT/Java-Runtime-Compiler\n-  Apache Commons JCI(Java Compiler Interface), http://commons.apache.org/proper/commons-jci/index.html é€‚ç”¨äºJDK1.5åŠä»¥å‰çš„ç‰ˆæœ¬","tags":["Java"],"categories":["Java","Javaé«˜é˜¶"]},{"title":"Java æ³›å‹","url":"/20210922/java-generic/","content":"## **1.æ³›å‹åŸºç¡€**\n- æ³›å‹ï¼šGeneric Programmingï¼ŒJDK1.5æ¨å‡ºçš„ç‰¹æ€§\n- æ³›å‹ç±»ï¼š ArrayListï¼ŒHashSetï¼ŒHashMapç­‰ \n- æ³›å‹æ–¹æ³•ï¼šCollections.binarySearchï¼ŒArrays.sort ç­‰ \n- æ³›å‹æ¥å£ï¼šList, Iterator ç­‰\n\n## **2.è‡ªå®šä¹‰æ³›å‹è®¾è®¡**\n### **æ³›å‹ç±»**\n- å…·æœ‰æ³›å‹å˜é‡çš„ç±»\n- åœ¨ç±»ååç”¨\\<T>ä»£è¡¨å¼•å…¥ç±»å‹\n    - å¤šä¸ªå­—æ¯è¡¨ç¤ºå¤šä¸ªå¼•å…¥ç±»å‹å¦‚\\<T, U>ç­‰ \n    - å¼•å…¥ç±»å‹å¯ä»¥ä¿®é¥°æˆå‘˜å˜é‡/å±€éƒ¨å˜é‡/å‚æ•°/è¿”å›å€¼\n    - æ²¡æœ‰ä¸“é—¨çš„templateå…³é”®å­—\n```java\npublic class Interval<T> {\n    private T lower;\n    private T upper;\n\n    public Interval(T lower, T upper) {\n        this.lower = lower;\n        this.upper = upper;\n    }\n    //Getter and Setter\n}\nInterval<Integer> v1 = new Interval<Integer>(1,2);\n```\n\n### **æ³›å‹æ–¹æ³•**\n- å…·æœ‰æ³›å‹å‚æ•°çš„æ–¹æ³•\n- è¯¥æ–¹æ³•å¯åœ¨æ™®é€šç±»/æ³›å‹ç±»ä¸­\n- **\\<T>åœ¨ä¿®é¥°ç¬¦åï¼Œè¿”å›ç±»å‹å‰**\n```java\npublic class ArrayUtil {\n    public static <T> T getMiddle(T... a)\n    {\n        return a[a.length/2];\n    }\n}\n\npublic static void main(String[] args) {\nString s1 = ArrayUtil.<String>getMiddle(\"abc\", \"def\", \"ghi\");\nInteger i1 = ArrayUtil.getMiddle(1,2,3);\n\n//null is ok\nString s2 = ArrayUtil.<String>getMiddle(\"abc\", \"def\", null);\n\n//error å¯»æ‰¾å…±åŒè¶…ç±»ï¼Œå†è½¬å‹\nInteger i2 = ArrayUtil.getMiddle(1,2.5f,3L);\n\n}\n```\n\n### **æ³›å‹æ¥å£**\n- å’Œæ³›å‹ç±»ç›¸ä¼¼ï¼Œåœ¨ç±»åååŠ \\<T>\n- Tç”¨æ¥æŒ‡å®šæ–¹æ³•è¿”å›å€¼å’Œå‚æ•°\n- å®ç°æ¥å£æ—¶ï¼ŒæŒ‡å®šç±»å‹\n- Tä¹Ÿå¯ä»¥å†æ˜¯ä¸€ä¸ªæ³›å‹ç±»\n```java\npublic interface Calculator<T> {\n    public T add(T operand1, T operand2);\n}\n```\n","tags":["Java"],"categories":["Java","Javaé«˜é˜¶"]},{"title":"Java è¯­æ³•ç³–","url":"/20210922/java-syntactic-sugar/","content":"## **1.for-eachå’Œæšä¸¾**\n### **for vs for-each**\n- for-each ä»JDK5.0å¼€å§‹å¼•å…¥\n- for-each è¯­æ³•æ›´ç®€æ´\n- for-each é¿å…è¶Šç•Œé”™è¯¯\n- **for å¯ä»¥åˆ é™¤å…ƒç´ ï¼Œfor-eachä¸å¯ä»¥åˆ é™¤/æ›¿æ¢å…ƒç´ **\n- **for-eachéå†çš„æ—¶å€™ï¼Œæ˜¯ä¸çŸ¥é“å½“å‰å…ƒç´ çš„å…·ä½“ä½ç½®ç´¢å¼•**\n- **for-eachåªèƒ½æ­£å‘éå†ï¼Œä¸èƒ½åå‘éå†**\n- **for-eachä¸èƒ½åŒæ—¶éå†2ä¸ªé›†åˆ**\n- forå’Œfor-eachæ€§èƒ½æ¥è¿‘\n\n### **æšä¸¾ç±»å‹**\n- æšä¸¾å˜é‡ï¼šå˜é‡çš„å–å€¼åªåœ¨ä¸€ä¸ªæœ‰é™çš„é›†åˆå†…\n- Java5æ¨å‡ºenumç±»å‹\n    - enumå…³é”®å­—å£°æ˜æšä¸¾ç±»ï¼Œä¸”éƒ½æ˜¯Enumçš„å­ç±»(**ä½†ä¸éœ€å†™extends**)\n    - enumå†…éƒ¨æœ‰å¤šå°‘ä¸ªå€¼ï¼Œ**å°±æœ‰å¤šå°‘ä¸ªå®ä¾‹å¯¹è±¡**\n    - **ä¸èƒ½ç›´æ¥newæšä¸¾ç±»å¯¹è±¡**\n```java\npublic enum Size {\n    SMALL,MEDIUM,LARGE,EXTRA_LARGE;\n}\n\nSize s1=Size.SMALL;\nSize s2=Size.SMALL;\nSystem.out.println(s1 == s2); //true\n```\n- é™¤äº†æšä¸¾çš„å†…å®¹ï¼Œè¿˜å¯ä»¥æ·»åŠ å±æ€§/æ„é€ å‡½æ•°/æ–¹æ³•\n- æ„é€ å‡½æ•°åªèƒ½æ˜¯package-private(default)æˆ–è€…privateï¼Œå†…éƒ¨è°ƒç”¨\n```java\nenum Fruit\n{\n    APPLE(10), ORANGE(8);\n    private int price;\n    \n    Fruit(int price) {\n        this.price = price;\n    }\n    \n    public int getPrice() {\n        return this.price;\n    }\n}\n```\n- æ‰€æœ‰çš„enumç±»å‹éƒ½æ˜¯Enumçš„å­ç±»ï¼Œä¹Ÿç»§æ‰¿äº†ç›¸åº”æ–¹æ³•\n    - ordinal()è¿”å›æšä¸¾å€¼æ‰€åœ¨çš„ç´¢å¼•ä½ç½®, ä»0å¼€å§‹\n    - compareTo()æ¯”è¾ƒä¸¤ä¸ªæšä¸¾å€¼çš„ç´¢å¼•ä½ç½®å¤§å°\n    - toString()è¿”å›æšä¸¾å€¼çš„å­—ç¬¦ä¸²è¡¨ç¤º\n    - valueOf()å°†å­—ç¬¦ä¸²åˆå§‹åŒ–ä¸ºæšä¸¾å¯¹è±¡\n    - values()è¿”å›æ‰€æœ‰çš„æšä¸¾å€¼\n```java\nenum Day\n{\n    MONDAY, TUESDAY, WEDNESDAY, THURSDAY, FRIDAY, SATURDAY, SUNDAY;\n}\nDay d1 = Day.MONDAY;\nDay d2 = Enum.valueOf(Day.class, \"MONDAY\");\nSystem.out.println(d1 == d2);    //true\n\nDay d3 = Enum.valueOf(Day.class, \"TUESDAY\");\nSystem.out.println(d1.compareTo(d3)); //MONDAY<TUESDAY\n\n//éå†æ‰€æœ‰çš„æšä¸¾å€¼\nfor(Day item : Day.values())\n{\n    System.out.println(item.toString() + \",\" + item.ordinal());\n}        \n```\n\n## **2.ä¸å®šé¡¹å‚æ•°å’Œé™æ€å¯¼å…¥**\n### **ä¸å®šé¡¹å‚æ•°**\n- JDK 5æä¾›äº†ä¸å®šé¡¹å‚æ•°(å¯å˜å‚æ•°)åŠŸèƒ½\n- ç±»å‹åé¢åŠ 3ä¸ªç‚¹ï¼Œå¦‚int.../double.../String.../\n- å¯å˜å‚æ•°ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªæ•°ç»„\n```java\npublic static void print(String... args) {\n    System.out.println(args.length);\n    for (String arg : args) {\n        System.out.println(arg);\n    }\n}\nprint();\nprint(\"aaa\");\nprint(\"aaa\", \"bbb\");\nprint(\"aaa\", \"bbb\", \"ccc\");\n```\n- ä¸€ä¸ªæ–¹æ³•åªèƒ½æœ‰**ä¸€ä¸ªä¸å®šé¡¹å‚æ•°**ï¼Œä¸”å¿…é¡»ä½äºå‚æ•°åˆ—è¡¨çš„æœ€å\n```java\n//é”™è¯¯ï¼šä¸€ä¸ªæ–¹æ³•ä¸å¯ä»¥æœ‰å¤šä¸ªå¯å˜å‚æ•°\npublic static void print(String... args, int... irgs) {\n        \n}\n```\n- é‡è½½çš„ä¼˜å…ˆçº§è§„åˆ™1ï¼š**å›ºå®šå‚æ•°çš„æ–¹æ³•ï¼Œæ¯”å¯å˜å‚æ•°ä¼˜å…ˆçº§æ›´é«˜**\n```java\n//å½“åªæœ‰ä¸€ä¸ªå‚æ•°æ—¶ï¼Œæœ¬æ–¹æ³•ä¼˜å…ˆçº§æ›´é«˜\npublic static void print(String s)\n{\n     System.out.println(\"I am another method\");\n}\n```\n- é‡è½½çš„ä¼˜å…ˆçº§è§„åˆ™2ï¼š**è°ƒç”¨è¯­å¥ï¼ŒåŒæ—¶ä¸ä¸¤ä¸ªå¸¦å¯å˜å‚æ•°çš„æ–¹æ³•åŒ¹é…ï¼Œåˆ™æŠ¥é”™**\n```java\n//é”™è¯¯ï¼šä¸€ä¸ªè°ƒç”¨è¯­å¥ä¸èƒ½åŒæ—¶æœ‰2ä¸ªå¸¦å¯å˜å‚æ•°çš„æ–¹æ³•é€‚é…\npublic static void print(String s1, String... args)\n{\n\n}\n```\n\n### **é™æ€å¯¼å…¥**\n- import å¯¼å…¥ç¨‹åºæ‰€éœ€è¦çš„ç±»\n```java\nimport static java.lang.Math.pow;\nimport static java.lang.Math.sqrt;\nimport static java.lang.System.out;\n\npublic class ImportStaticTest {\n    public static void importMath()    {\n        int a=3, b=4, c=0;\n        c = (int) sqrt(pow(a,2)+pow(b,2));\n        out.println(\"c is \" + c);\n    }\n}\n```\n- import static å¯¼å…¥ä¸€ä¸ªç±»çš„**é™æ€æ–¹æ³•å’Œé™æ€å˜é‡**(JDK5å¼•å…¥)\n    - å°‘ä½¿ç”¨ * é€šé…ç¬¦ï¼Œä¸æ»¥ç”¨ï¼Œæœ€å¥½å…·ä½“åˆ°é™æ€å˜é‡æˆ–æ–¹æ³•\n    - é™æ€æ–¹æ³•åå…·æœ‰æ˜ç¡®ç‰¹å¾ï¼Œå¦‚æœ‰é‡åï¼Œéœ€è¦è¡¥å……ç±»å\n\n## **3.è‡ªåŠ¨æ‹†è£…ç®±ï¼Œå¤šå¼‚å¸¸å¹¶åˆ—ï¼Œæ•°å€¼ç±»å‹èµ‹å€¼ä¼˜åŒ–**\n### **è‡ªåŠ¨è£…ç®±å’Œæ‹†ç®±(auto-boxing/auto-unboxing)**\n- ä»JDK5.0å¼€å§‹å¼•å…¥ï¼Œç®€åŒ–åŸºæœ¬ç±»å‹å’Œå¯¹è±¡è½¬æ¢çš„å†™æ³•\n- åŸºæœ¬ç±»å‹ï¼šboolean/byte/char/int/short/long/float/double\n- å¯¹è±¡ï¼šBoolean/Byte/Character/Integer/Short/Long/Float/Double\n```java\nInteger obj1 = 5;  //è‡ªåŠ¨è£…ç®±\nInteger obj2 = Integer.valueOf(5);\n\nint a1 = obj1;     //è‡ªåŠ¨æ‹†ç®±\nint a2 = obj1.intValue();\n```\n### **æ³¨æ„äº‹é¡¹**\n- è£…ç®±å’Œæ‹†ç®±æ˜¯ç¼–è¯‘å™¨çš„å·¥ä½œï¼Œåœ¨classä¸­å·²ç»æ·»åŠ è½¬åŒ–ã€‚è™šæ‹Ÿæœºæ²¡æœ‰è‡ªåŠ¨è£…ç®±å’Œæ‹†ç®±çš„è¯­å¥\n- ==ï¼šåŸºæœ¬ç±»å‹æ˜¯å†…å®¹ç›¸åŒï¼Œå¯¹è±¡æ˜¯æŒ‡é’ˆæ˜¯å¦ç›¸åŒ(å†…å­˜åŒä¸€ä¸ªåŒºåŸŸ) \n- **åŸºæœ¬ç±»å‹æ²¡æœ‰ç©ºå€¼ï¼Œå¯¹è±¡æœ‰nullï¼Œå¯èƒ½è§¦å‘NullPointerException**\n- å½“ä¸€ä¸ªåŸºç¡€æ•°æ®ç±»å‹ä¸å°è£…ç±»è¿›è¡Œ ==ã€+ã€-ã€* ã€/è¿ç®—æ—¶ï¼Œä¼šå°†å°è£…ç±»è¿›è¡Œæ‹†ç®±ï¼Œå¯¹åŸºç¡€æ•°æ®ç±»å‹è¿›è¡Œè¿ç®—\n- **è°¨æ…ä½¿ç”¨å¤šä¸ªéåŒç±»çš„æ•°å€¼ç±»å¯¹è±¡è¿›è¡Œè¿ç®—**\n\n### **å¤šå¼‚å¸¸å¹¶åˆ—**\n- å¤šä¸ªå¼‚å¸¸å¹¶åˆ—åœ¨ä¸€ä¸ªcatchä¸­ \n    - ä»JDK7.0å¼€å§‹å¼•å…¥ï¼Œç®€åŒ–å†™æ³•\n```java\ntry {\n    test();\n}\ncatch(IOException | SQLException ex) {\n    //JDK7å¼€å§‹ï¼Œæ”¯æŒä¸€ä¸ªcatchå†™å¤šä¸ªå¼‚å¸¸\n    //å¼‚å¸¸å¤„ç†\n}\n```\n- å¤šä¸ªå¼‚å¸¸ä¹‹é—´ä¸èƒ½æœ‰(ç›´æ¥/é—´æ¥)**ç»§æ‰¿å…³ç³»**ï¼Œå¦‚æœæœ‰ï¼Œåˆ™æŠ¥é”™\n```java\ntry {\n    test2();\n}\ncatch(IOException | FileNotFoundException ex) {\n    //å¼‚å¸¸å¤„ç†\n}\n```\n\n### **æ•°å€¼ç±»å‹èµ‹å€¼ä¼˜åŒ–**\n- Java 7çš„æ–°è¯­æ³•ï¼šæ•´æ•°ç±»å‹ç”¨äºŒè¿›åˆ¶æ•°èµ‹å€¼\n    - é¿å…äºŒè¿›åˆ¶è®¡ç®—\n    - byte/short/int/long\n```java\nbyte a1 = (byte) 0b00100001;\nshort a2 = (short) 0b1010000101000101;\nint a4 = 0b101;\nint a5 = 0B101; //Bå¯ä»¥å¤§å°å†™\nlong a6 = 0b1010000101000101101000010100010110100001010001011010000101000101L;\n```\n - Java 7çš„æ–°è¯­æ³•ï¼šåœ¨æ•°å€¼å­—é¢é‡(literal)ä¸­ä½¿ç”¨ä¸‹åˆ’çº¿\n    - å¢åŠ æ•°å­—çš„å¯è¯»æ€§å’Œçº é”™åŠŸèƒ½\n    - short/int/long/float/double\n    - ä¸‹åˆ’çº¿åªèƒ½å‡ºç°æ•°å­—ä¸­é—´ï¼Œå‰åå¿…é¡»æœ‰æ•°å­—\n    - å…è®¸åœ¨äºŒ/å…«/å/åå…­è¿›åˆ¶çš„æ•°å­—ä¸­ä½¿ç”¨\n```java\nint a3 = 0b0111_1011_0001; //äºŒè¿›åˆ¶, 0bå¼€å¤´\nint a4 = 0_214;           //å…«è¿›åˆ¶, 0å¼€å¤´\nint a5 = 123___45;         //å¯ä»¥å¤šä¸ªä¸‹åˆ’çº¿\nint a6 = 0x7_B_1;          //åå…­è¿›åˆ¶\nfloat a7 = 3.56_78f;       //float\ndouble a8 = 1.3_45__67;    //double\n\nint b1 = 0b_123_4;  //_å¿…é¡»åœ¨æ•°å­—ä¹‹é—´\nint b2 = 0123_4_;   //_ä¸èƒ½åœ¨æœ«å°¾\nint b3 = _123;      //_ä¸èƒ½åœ¨å¼€å¤´\nint b4 = 0_x_123;   //ä¸èƒ½æ‹†å¼€0x\nint b5 = 0x_51;     //_å¿…é¡»åœ¨æ•°å­—ä¹‹é—´\nlong b6 = 1000_L;   //_å¿…é¡»åœ¨æ•°å­—ä¹‹é—´\nfloat b7 = 1.34f_;  //_ä¸èƒ½åœ¨æœ«å°¾\n```\n\n## **4.æ¥å£æ–¹æ³•**\n- Java 8æ¨å‡ºæ¥å£çš„é»˜è®¤æ–¹æ³•/é™æ€æ–¹æ³•(éƒ½å¸¦å®ç°çš„)ï¼Œä¸ºLambdaè¡¨è¾¾å¼æä¾›æ”¯æŒ\n### **æ¥å£çš„é»˜è®¤æ–¹æ³•**\n- ä»¥**default**å…³é”®å­—æ ‡æ³¨ï¼Œå…¶ä»–çš„å®šä¹‰å’Œæ™®é€šå‡½æ•°ä¸€æ ·\n- è§„åˆ™1ï¼šé»˜è®¤æ–¹æ³•**ä¸èƒ½é‡å†™**Objectä¸­çš„æ–¹æ³•\n- è§„åˆ™2ï¼šå®ç°ç±»å¯ä»¥**ç»§æ‰¿/é‡å†™**çˆ¶æ¥å£çš„é»˜è®¤æ–¹æ³•\n- è§„åˆ™3ï¼šæ¥å£å¯ä»¥**ç»§æ‰¿/é‡å†™**çˆ¶æ¥å£çš„é»˜è®¤æ–¹æ³•\n- è§„åˆ™4ï¼šå½“çˆ¶ç±»å’Œçˆ¶æ¥å£éƒ½æœ‰(åŒååŒå‚æ•°)é»˜è®¤æ–¹æ³•ï¼Œ**å­ç±»ç»§æ‰¿çˆ¶ç±»çš„é»˜è®¤æ–¹æ³•**ï¼Œè¿™æ ·å¯ä»¥å…¼å®¹JDK7åŠä»¥å‰çš„ä»£ç \n- è§„åˆ™5ï¼šå­ç±»å®ç°äº†2ä¸ªæ¥å£(å‡æœ‰åŒååŒå‚æ•°çš„é»˜è®¤æ–¹æ³•)ï¼Œ**é‚£ä¹ˆç¼–è¯‘å¤±è´¥ï¼Œå¿…é¡»åœ¨å­ç±»ä¸­é‡å†™è¿™ä¸ªdefaultæ–¹æ³•**\n```java\npublic interface NewAnimal {\n    public default void move() {\n        System.out.println(\"I can move.\");\n    }\n}\n```\n\n### **æ¥å£çš„é™æ€æ–¹æ³•**\n- è¯¥é™æ€æ–¹æ³•å±äºæœ¬æ¥å£çš„ï¼Œ**ä¸å±äºå­ç±»/å­æ¥å£**\n- å­ç±»(å­æ¥å£)æ²¡æœ‰ç»§æ‰¿è¯¥é™æ€æ–¹æ³•ï¼Œåªèƒ½é€šè¿‡**æ‰€åœ¨çš„æ¥å£å**æ¥è°ƒç”¨\n```java\npublic interface StaticAnimal {\n    public static void move() {\n        System.out.println(\"I can move\");\n    }\n}\n```\n\n### **æ¥å£çš„ç§æœ‰æ–¹æ³•**\n- Java 9æ¨å‡ºï¼Œå¸¦å®ç°\n- è§£å†³å¤šä¸ªé»˜è®¤æ–¹æ³•/é™æ€æ–¹æ³•çš„å†…å®¹é‡å¤é—®é¢˜\n- ç§æœ‰æ–¹æ³•å±äºæœ¬æ¥å£ï¼Œåªåœ¨æœ¬æ¥å£å†…ä½¿ç”¨ï¼Œ**ä¸å±äºå­ç±»/å­æ¥å£**\n- å­ç±»(å­æ¥å£)æ²¡æœ‰ç»§æ‰¿è¯¥ç§æœ‰æ–¹æ³•ï¼Œä¹Ÿæ— æ³•è°ƒç”¨\n- é™æ€ç§æœ‰æ–¹æ³•å¯ä»¥è¢«é™æ€/é»˜è®¤æ–¹æ³•è°ƒç”¨ï¼Œéé™æ€ç§æœ‰æ–¹æ³•è¢«é»˜è®¤æ–¹æ³•è°ƒç”¨\n```java\npublic interface PrivateAnimal {\n    private void move() {\n        //éé™æ€çš„ç§æœ‰æ–¹æ³•\n        System.out.println(\"I can move\");\n        System.out.println(\"I am growing\");\n    }\n    private static void move2() {\n        //é™æ€çš„ç§æœ‰æ–¹æ³•\n        System.out.println(\"I can move\");\n        System.out.println(\"I am growing\");\n    }\n}\n```\n\n### **æ¥å£ vs æŠ½è±¡ç±»**\n- ç›¸åŒç‚¹(æˆªæ­¢è‡³Java 12ä»¥å‰ï¼Œæ¥å£å’ŒæŠ½è±¡ç±»å¯¹æ¯”) \n    - éƒ½æ˜¯æŠ½è±¡çš„ï¼Œéƒ½ä¸èƒ½è¢«å®ä¾‹åŒ–ï¼Œå³ä¸èƒ½è¢«new\n    - éƒ½å¯ä»¥æœ‰å®ç°æ–¹æ³•\n    - éƒ½å¯ä»¥ä¸éœ€è¦ç»§æ‰¿è€…å®ç°æ‰€æœ‰çš„æ–¹æ³•\n- ä¸åŒç‚¹(æˆªæ­¢è‡³Java 12ä»¥å‰ï¼Œæ¥å£å’ŒæŠ½è±¡ç±»å¯¹æ¯”) ã€\n    - æŠ½è±¡ç±»æœ€å¤šåªèƒ½ç»§æ‰¿ä¸€ä¸ªï¼Œæ¥å£å¯ä»¥å®ç°å¤šä¸ª\n    - æ¥å£çš„å˜é‡é»˜è®¤æ˜¯public static finalï¼Œä¸”å¿…é¡»æœ‰åˆå€¼ï¼Œå­ç±»ä¸èƒ½ä¿®æ”¹ï¼›è€ŒæŠ½è±¡ç±»çš„å˜é‡é»˜è®¤æ˜¯defaultï¼Œå­ç±»å¯ä»¥ç»§æ‰¿ä¿®æ”¹\n    - æ¥å£æ²¡æœ‰æ„é€ å‡½æ•°ï¼ŒæŠ½è±¡ç±»æœ‰æ„é€ å‡½æ•°\n    - æ¥å£æ²¡æœ‰mainå‡½æ•°ï¼ŒæŠ½è±¡ç±»å¯ä»¥æœ‰mainå‡½æ•°\n    - æ¥å£æœ‰public/default/private çš„æ–¹æ³•ï¼ŒæŠ½è±¡ç±»æœ‰public/private/protected/ä¸å†™å…³é”®å­—çš„(default)çš„æ–¹æ³•\n\n## **5.try-with-resourceå’ŒResource Bundleæ–‡ä»¶åŠ è½½**\n### **try-with-resource**\n- JDK7æä¾›try-with-resourceï¼Œæ¯”try-catch-finallyæ›´ç®€ä¾¿\n    - èµ„æºè¦æ±‚å®šä¹‰åœ¨tryä¸­ã€‚è‹¥å·²ç»åœ¨å¤–é¢å®šä¹‰ï¼Œåˆ™éœ€è¦ä¸€ä¸ªæœ¬åœ°å˜é‡\n- JDK9ä¸å†è¦æ±‚å®šä¹‰ä¸´æ—¶å˜é‡ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨å¤–éƒ¨èµ„æºå˜é‡\n```java\nString line;\n//try-resource è¯­å¥ï¼Œè‡ªåŠ¨å…³é—­èµ„æº\ntry (BufferedReader in = new BufferedReader(new InputStreamReader(new FileInputStream(\"c:/temp/abc.txt\")))) {\n    while ((line = in.readLine()) != null) {\n        System.out.println(line);\n    }\n} catch(Exception ex) {\n    ex.printStackTrace();\n}\n```\n- try-with-resourceåŸç†\n    - èµ„æºå¯¹è±¡å¿…é¡»å®ç° **AutoCloseableæ¥å£**ï¼Œå³å®ç°**closeæ–¹æ³•**\n```java\npublic class MyTryWithResourceTest {\n    public static void main(String[] args) {\n        //å°†ä¼šè‡ªåŠ¨è°ƒç”¨connçš„closeæ–¹æ³•\n        try(MyConnection conn = new MyConnection()){\n            conn.sendData();\n        } catch(Exception ex) {\n            ex.printStackTrace();\n        }\n    }\n}\n\nclass MyConnection implements AutoCloseable {\n     public void sendData() throws Exception {\n         System.out.println(\"Send Data....\");\n     }\n     public void close() throws Exception {\n         System.out.println(\"Close....\");\n     }\n}\n```\n\n### **ResourceBundleæ–‡ä»¶åŠ è½½**\n- Java 8åŠä»¥å‰ï¼ŒResourceBundleé»˜è®¤ä»¥ISO-8859-1æ–¹å¼åŠ è½½Propertiesæ–‡ä»¶\n    - **éœ€è¦åˆ©ç”¨native2asciiå·¥å…·(JDKè‡ªå¸¦)å¯¹æ–‡ä»¶è¿›è¡Œè½¬ä¹‰**\n- JDK9åŠä»¥åï¼Œ ResourceBundleé»˜è®¤ä»¥UTF-8æ–¹å¼åŠ è½½Propertiesæ–‡ä»¶\n    - **JDK9åŠä»¥åï¼Œå·²ç»åˆ é™¤native2asciiå·¥å…·**\n    - **æ–°çš„Propertiesæ–‡ä»¶å¯ä»¥ç›´æ¥ä»¥UTF-8ä¿å­˜**\n    - å·²åˆ©ç”¨native2asciiå·¥å…·è½¬åŒ–åçš„æ–‡ä»¶ï¼Œä¸å—å½±å“ã€‚å³ResourceBundle è‹¥è§£ææ–‡ä»¶ä¸æ˜¯æœ‰æ•ˆçš„UTF-8ï¼Œåˆ™ä»¥ISO-8859-1æ–¹å¼åŠ è½½\n\n## **6.varç±»å‹å’Œswitch**\n### **varç±»å‹**\n- Javaä»¥å‰ä¸€ç›´æ˜¯ä¸€ç§å¼ºç±»å‹çš„ç¨‹åºè¯­è¨€\n    - æ¯ä¸ªå˜é‡åœ¨å®šä¹‰æ—¶å°±ç¡®å®šäº†ç±»å‹\n    - ç±»å‹å›ºå®šäº†ï¼Œå°±ä¸èƒ½æ›´æ”¹\n- Java 10æ¨å‡ºvarï¼šå±€éƒ¨å˜é‡æ¨æ–­\n    - é¿å…ä¿¡æ¯å†—ä½™\n    - å¯¹é½äº†å˜é‡å\n    - æ›´å®¹æ˜“é˜…è¯»\n    - æœ¬è´¨ä¸Šè¿˜æ˜¯å¼ºç±»å‹è¯­è¨€ï¼Œç¼–è¯‘å™¨è´Ÿè´£æ¨æ–­ç±»å‹ï¼Œå¹¶å†™å…¥å­—èŠ‚ç æ–‡ä»¶ã€‚å› æ­¤æ¨æ–­åä¸èƒ½æ›´æ”¹ï¼ï¼ï¼\n- varçš„é™åˆ¶\n    - **å¯ä»¥ç”¨åœ¨å±€éƒ¨å˜é‡ä¸Šï¼Œéç±»æˆå‘˜å˜é‡**\n    - **å¯ä»¥ç”¨åœ¨for/for-eachå¾ªç¯ä¸­**\n    - **å£°æ˜æ—¶å¿…é¡»åˆå§‹åŒ–**\n    - **ä¸èƒ½ç”¨åœ¨æ–¹æ³•(å½¢å¼)å‚æ•°å’Œè¿”å›ç±»å‹**\n    - **å¤§é¢ç§¯æ»¥ç”¨ä¼šä½¿ä»£ç æ•´ä½“é˜…è¯»æ€§å˜å·®**\n    - **varåªåœ¨ç¼–è¯‘æ—¶èµ·ä½œç”¨ï¼Œæ²¡æœ‰åœ¨å­—èŠ‚ç ä¸­å¼•å…¥æ–°çš„å†…å®¹ï¼Œä¹Ÿæ²¡æœ‰ä¸“é—¨çš„JVMæŒ‡ä»¤å¤„ç†var**\n\n### **switch**\n- æ”¯æŒçš„ç±»å‹ï¼šbyte/Byte, short/Short, int/Integer, char/Character, **String(7.0), Enumæšä¸¾(5.0)**\n- **ä¸æ”¯æŒlong/float/double**\n- å¤šåˆ†æ”¯åˆå¹¶ï¼Œé‡‡ç”¨->ç›´æ¥è¿æ¥åˆ¤å®šæ¡ä»¶å’ŒåŠ¨ä½œ(**JDK12æ”¯æŒ**)\n```java\npublic static int judgeMonthDay12(String month) {\n    //this method works based on Java 12.\n    int result = 0;\n    switch(month) {\n        case \"Jan\",\"Mar\",\"May\",\"July\",\"Aug\",\"Oct\",\"Dec\" -> result = 31;            \n        case \"Apr\",\"June\",\"Sep\",\"Nov\" -> result = 30;\n        case \"Feb\" -> result = 28;\n        default -> result = -1;\n    }\n    return result;\n}\n```\n- switchç›´æ¥åœ¨è¡¨è¾¾å¼èµ‹å€¼(**JDK12æ”¯æŒ**)\n```java\npublic static void testSwitchReturn() {\n    int num = 1;\n    int days = switch (num) {\n        case 1,3,5,7,8,10,12 -> 31;\n        case 4,6,9,11 -> 30;\n        default -> {\n            int result = 28;\n            break result;  //ä»£ç å—ä¸­breakè¿”å›ç»“æœ\n        }\n    };\n    System.out.println(days);\n}\n```","tags":["Java"],"categories":["Java","Javaé«˜é˜¶"]},{"title":"Java æ··åˆç¼–ç¨‹","url":"/20210922/java-hybrid-programming/","content":"## **1.RMI**\n- RMIï¼šRemote Method Invocation è¿œç¨‹æ–¹æ³•è°ƒç”¨\n- ä¸¤ä¸ªä½äºä¸åŒJVMè™šæ‹Ÿæœºçš„Javaç¨‹åºäº’ç›¸è¯·æ±‚è®¿é—®\n\n### **RMIçš„å‚æ•°å’Œè¿”å›å€¼**\n-  (**è‡ªåŠ¨åŒ–**) ä¼ é€’è¿œç¨‹å¯¹è±¡(å®ç°Remoteæ¥å£) \n    - å½“ä¸€ä¸ªå¯¹è¿œç¨‹å¯¹è±¡çš„å¼•ç”¨ä»ä¸€ä¸ªJVMä¼ é€’åˆ°å¦ä¸€ä¸ªJVMï¼Œè¯¥è¿œç¨‹å¯¹è±¡çš„å‘é€è€…å’Œæ¥æ”¶è€…å°†æŒæœ‰**åŒä¸€ä¸ªå®ä½“å¯¹è±¡çš„å¼•ç”¨**ã€‚è¿™ä¸ªå¼•ç”¨å¹¶éæ˜¯ä¸€ä¸ªå†…å­˜ä½ç½®ï¼Œè€Œæ˜¯ç”±ç½‘ç»œåœ°å€å’Œè¯¥è¿œç¨‹å¯¹è±¡çš„å”¯ä¸€æ ‡è¯†ç¬¦æ„æˆçš„ã€‚\n**###ä¸¤ä¸ªJVMæ‹¥æœ‰åŒä¸€ä¸ªå¯¹è±¡###**\n- (**è‡ªåŠ¨åŒ–**) ä¼ é€’å¯åºåˆ—åŒ–å¯¹è±¡(å®ç°Serializableæ¥å£) \n    - JVMä¸­çš„ä¸€ä¸ªå¯¹è±¡ç»è¿‡åºåˆ—åŒ–åçš„å­—èŠ‚ï¼Œé€šè¿‡ç½‘ç»œï¼Œå…¶å‰¯æœ¬ä¼ é€’åˆ°å¦ä¸€ä¸ªJVMä¸­ï¼Œå¹¶é‡æ–°è¿˜åŸä¸ºä¸€ä¸ªJavaå¯¹è±¡ã€‚\n**###æ¯ä¸ªJVMæ‹¥æœ‰è‡ªå·±çš„å¯¹è±¡###**\n\n```java\n//Client\nContext namingContext = new InitialContext();\n      \n//å¼€å§‹æŸ¥æ‰¾RMIæ³¨å†Œè¡¨ä¸Šæœ‰å“ªäº›ç»‘å®šçš„æœåŠ¡\nEnumeration<NameClassPair> e = namingContext.list(\"rmi://127.0.0.1:8001/\");\nwhile (e.hasMoreElements())\n    System.out.println(e.nextElement().getName());\n\n//è·å–æŸä¸€ä¸ªåœ°å€ä¸Šçš„æœåŠ¡ç±»\nString url = \"rmi://127.0.0.1:8001/warehouse1\";      \nWarehouse centralWarehouse = (Warehouse) namingContext.lookup(url);\n/*\n//æ¥å£ç±»\npublic interface Warehouse extends Remote\n{  \n   double getPrice(String description) throws RemoteException;\n}\n*/\n\n//è¾“å…¥å‚æ•°  å–å¾—ç»“æœ\nString descr = \"é¢åŒ…æœº\";\ndouble price = centralWarehouse.getPrice(descr);\nSystem.out.println(descr + \": \" + price);\n\n//Server\nSystem.out.println(\"äº§ç”ŸæœåŠ¡å™¨å¯¹è±¡\");\nWarehouseImpl centralWarehouse = new WarehouseImpl();\n\nSystem.out.println(\"å°†æœåŠ¡å™¨å¯¹è±¡ç»‘å®šåœ¨8001ç«¯å£ï¼Œå¯¹å¤–æä¾›æœåŠ¡\");\nLocateRegistry.createRegistry(8001);//å®šä¹‰ç«¯å£å·\nNaming.rebind(\"rmi://127.0.0.1:8001/warehouse1\", centralWarehouse);\n\n//å®ç°ç±»\npublic class WarehouseImpl extends UnicastRemoteObject implements Warehouse\n{\n   private Map<String, Double> prices;\n\n   public WarehouseImpl() throws RemoteException\n   {\n      //ç‰©å“åˆ—è¡¨\n      prices = new HashMap<>();\n      prices.put(\"é¢åŒ…æœº\", 24.95);\n      prices.put(\"å¾®æ³¢ç‚‰\", 49.95);\n   }\n\n   public double getPrice(String description) throws RemoteException\n   {\n      Double price = prices.get(description);\n      return price == null ? 0 : price;\n   }\n}\n//æ¥å£ç±»\npublic interface Warehouse extends Remote\n{  \n   double getPrice(String description) throws RemoteException;\n}\n```\n\n- RMIä¼˜ç‚¹\n    - è·¨å¹³å°åˆ†å¸ƒå¼å¯¹è±¡è°ƒç”¨\n    - å®Œå…¨å¯¹è±¡æ”¯æŒ\n    - å®‰å…¨ç­–ç•¥\n- RMIç¼ºç‚¹\n    - åŒæ–¹å¿…é¡»æ˜¯Javaè¯­è¨€å®ç°\n    - ä¸å¦‚æ¶ˆæ¯ä¼ é€’åä½œæ–¹ä¾¿\n\n## **2.JNI**\n- JNIï¼ŒJava Native Interface\n- Javaå’Œæœ¬åœ°Cä»£ç è¿›è¡Œäº’æ“ä½œ\n    - Javaè°ƒç”¨Cç¨‹åºå®Œæˆä¸€äº›éœ€è¦å¿«é€Ÿè®¡ç®—çš„åŠŸèƒ½(**å¸¸è§ï¼Œé‡ç‚¹**) \n    - Cè°ƒç”¨Javaç¨‹åº(åŸºäºåå°„çš„æ–¹æ³•)\n\n### **åŸºæœ¬æ­¥éª¤**\n- åœ¨Javaç±»ä¸­å£°æ˜ä¸€ä¸ªæœ¬åœ°æ–¹æ³•ï¼Œä½¿ç”¨nativeå‡½æ•°\n```java\nclass HelloNative {\n    public static native void greeting();\n}\n```\n- è°ƒç”¨javac.exeç¼–è¯‘ï¼Œå¾—åˆ°HelloNative.class\n- è°ƒç”¨javah.exeå¾—åˆ°åŒ…å«è¯¥æ–¹æ³•(Java_HelloNative_greeting)çš„å¤´æ–‡ä»¶HelloNative.h\n- å®ç°.cæ–‡ä»¶(å¯¹åº”HelloNative.h)\n```c\n#include \"HelloNative.h\"\n\nJNIEXPORT void JNICALL Java_HelloNative_greeting(JNIEnv* env, jclass cl) {\n    printf(\"Hello Native World\\n\");\n}\n```\n- å°†.cå’Œ.hæ–‡ä»¶ï¼Œæ•´åˆä¸ºå…±äº«åº“(DLL)æ–‡ä»¶\n- åœ¨Javaç±»ä¸­ï¼ŒåŠ è½½ç›¸åº”çš„å…±äº«åº“æ–‡ä»¶\n```java\nHelloNative.greeting();\nstatic {\n    System.loadLibrary(\"HelloNative\"); //dllåå­—\n}\n```\n\n## **3.Nashorn**\n- è„šæœ¬å¼•æ“ï¼ŒScriptEngine\n    - Nashornï¼ŒJDK 8è‡ªå¸¦çš„JSè§£é‡Šå™¨(JDK6/7æ˜¯Rhinoè§£é‡Šå™¨) \n```java\nScriptEngine engine = new ScriptEngineManager().getEngineByName(â€œnashornâ€)\n```\n- ä¸»è¦æ–¹æ³•\n    - evalï¼Œæ‰§è¡Œä¸€æ®µjsè„šæœ¬. eval(String str), eval(Reader reader)\n    - putï¼Œè®¾ç½®ä¸€ä¸ªå˜é‡\n    - getï¼Œè·å–ä¸€ä¸ªå˜é‡\n    - createBindings, åˆ›å»ºä¸€ä¸ªBindings\n    - setBindings, è®¾ç½®è„šæœ¬å˜é‡ä½¿ç”¨çš„èŒƒå›´\n\n```java\n//Test1\nScriptEngine engine = new ScriptEngineManager().getEngineByName(\"nashorn\"); \n\nengine.put(\"a\", 100);\nengine.put(\"b\", 200);\nengine.eval(\"var c = a+b\");\nString result = engine.get(\"c\").toString();\n\nSystem.out.println(result);\n//Test2\nScriptEngine engine = new ScriptEngineManager().getEngineByName(\"nashorn\"); \nSimpleBindings simpleBindings = new SimpleBindings(); // ä¼ é€’å‚æ•°åˆ°js\nsimpleBindings.put(\"a\", 100); \nsimpleBindings.put(\"b\", 200); \n\nObject result = engine.eval(\"load('src/edu/ecnu/sum2.js')\", simpleBindings);\n/*\nsrc/edu/ecnu/sum2.js\nc = a + b;\n*/\nSystem.out.println(result);\n//Test3\nScriptEngine engine = new ScriptEngineManager().getEngineByName(\"nashorn\"); \nFileReader scriptFile = new FileReader(\"src/edu/ecnu/sum3.js\");\n/*\nsrc/edu/ecnu/sum3.js\nfunction sum(a, b)\n{\n   return a + b;\n}\n*/\nengine.eval(scriptFile);\n\nInvocable in = (Invocable) engine;\nString result = in.invokeFunction(\"sum\",100,200).toString();\nSystem.out.println(result);\n```\n\n### **JDKæ”¯æŒçš„è„šæœ¬å¼•æ“å·¥å‚**\n\n|å¼•æ“|åå­—|MIMEç±»å‹|æ–‡ä»¶æ‰©å±•|\n|-|-|-|-|\n|Nashorn|nashorn,js|text/javascript|js|\n|Groovy|groovy|æ— |groovy|\n|Renjin|Renjin|text/x-R|R,r,S,s|\n|SISC Scheme|sisc|æ— |scheme,sisc|\n\n## **4.Jython**\n- Jythonæ˜¯Pythonè¯­è¨€åœ¨Javaå¹³å°çš„å®ç°\n- Jythonæ˜¯åœ¨JVMä¸Šå®ç°çš„Pythonï¼Œç”±Javaç¼–å†™\n- Jythonå°†Pythonæºç ç¼–è¯‘æˆJVMå­—èŠ‚ç ï¼Œç”±JVMæ‰§è¡Œå¯¹åº”çš„å­—èŠ‚ç ï¼Œå› æ­¤èƒ½å¾ˆå¥½çš„ä¸JVMé›†æˆ\n- **Jythonå¹¶ä¸æ˜¯Javaå’ŒPythonçš„è¿æ¥å™¨**\n\n### **å…³é”®ç±»**\n- PythonInterpreter\n    - exec æ‰§è¡Œè¯­å¥\n    - set è®¾ç½®å˜é‡å€¼\n    - get è·å–å˜é‡å€¼\n    - execfileæ‰§è¡Œä¸€ä¸ªpythonæ–‡ä»¶\n- PyObject\n- PyFunction\n```java\n// æ‰§è¡ŒPythonç¨‹åºè¯­å¥\nPythonInterpreter pi = new PythonInterpreter();\npi.exec(\"import sys\");\npi.set(\"a\", new PyInteger(42));\npi.exec(\"print a\");\npi.exec(\"x = 2+2\");\nPyObject x = pi.get(\"x\");\nSystem.out.println(\"x: \" + x);\n\n//æ‰§è¡ŒPythonæ–‡ä»¶\nPythonInterpreter pi = new PythonInterpreter();\npi.execfile(\"src/main/java/edu/ecnu/hello.py\");\npi.cleanup();\npi.close();\n\n//æ‰§è¡ŒPythonæ–‡ä»¶å¹¶ä¼ å‚\ntry (PythonInterpreter pi = new PythonInterpreter()) {\n    pi.set(\"cnt\", 5);\n    pi.execfile(\"src/main/java/edu/ecnu/randomSum.py\");\n    PyObject sum = pi.get(\"sum\");\n    System.out.println(\"Sum is: \" + sum);\n}\n/*\nsrc/main/java/edu/ecnu/randomSum.py\nfrom java.util import Random\nr = Random()\nsum = 0\nfor i in xrange(cnt):\n    randomNum = r.nextInt()\n    print randomNum\n    sum += randomNum\n*/\n\n//è°ƒç”¨Pythonç¨‹åºä¸­çš„å‡½æ•°\nPythonInterpreter pi = new PythonInterpreter();        \npi.execfile(\"src/main/java/edu/ecnu/calculator1.py\");\nPyFunction pf = pi.get(\"power\", PyFunction.class);\nPyObject result = pf.__call__(Py.newInteger(2), Py.newInteger(3)); //2^3\nSystem.out.println(result);\npi.cleanup();\npi.close();\n/*\nsrc/main/java/edu/ecnu/calculator1.py\nimport math\n\ndef power(x, y):\n    return math.pow(x, y)\n*/\n\n//è°ƒç”¨Pythonç¨‹åºä¸­çš„ç±»\nPythonInterpreter pi = new PythonInterpreter();\npi.execfile(\"src/main/java/edu/ecnu/calculator2.py\");\n\n//åœ¨Javaä¸­è°ƒç”¨Pythonå¯¹è±¡å®ä¾‹çš„æ–¹æ³•\nString pythonClassName = \"Calculator\";  // pythonç±»å        \nString pythonObjName = \"cal\"; // pythonå¯¹è±¡å    \npi.exec(pythonObjName + \"=\" + pythonClassName + \"()\"); // å®ä¾‹åŒ–pythonå¯¹è±¡        \nPyObject pyObj = pi.get(pythonObjName); // è·å–å®ä¾‹åŒ–çš„pythonå¯¹è±¡\n\n// è°ƒç”¨pythonå¯¹è±¡æ–¹æ³•,ä¼ é€’å‚æ•°å¹¶æ¥æ”¶è¿”å›å€¼\nPyObject result = pyObj.invoke(\"power\", new PyObject[] {Py.newInteger(2), Py.newInteger(3)}); \ndouble power = Py.py2double(result);\nSystem.out.println(power);\npi.cleanup();\npi.close();\n/*\nimport math\n\nclass Calculator(object):\n\n    def power(self, x, y):\n        return math.pow(x,y)\n*/\n```\n\n## **5.Web Service**\n- ç”±ä¸‡ç»´ç½‘è”ç›Ÿ(W3C, World Wide Web Consortium)æå‡º\n- æ¶ˆé™¤è¯­è¨€å·®å¼‚ã€å¹³å°å·®å¼‚ã€åè®®å·®å¼‚å’Œæ•°æ®ç»“æ„å·®å¼‚ï¼Œæˆä¸ºä¸åŒæ„ä»¶æ¨¡å‹å’Œå¼‚æ„ç³»ç»Ÿä¹‹é—´çš„é›†æˆæŠ€æœ¯\n- Web Serviceæ˜¯ä¸ºå®ç°è·¨ç½‘ç»œæ“ä½œè€Œè®¾è®¡çš„è½¯ä»¶ç³»ç»Ÿï¼Œæä¾›äº†ç›¸å…³çš„æ“ä½œæ¥å£ï¼Œå…¶ä»–åº”ç”¨å¯ä»¥ä½¿ç”¨SOAPæ¶ˆæ¯ï¼Œä»¥é¢„å…ˆæŒ‡å®šçš„æ–¹å¼æ¥ä¸Web Serviceè¿›è¡Œäº¤äº’\n\n### **wsimport å·¥å…·**\n- %JAVA_HOME%\\binç›®å½•ä¸‹\n- æ ¹æ®wsdlæ–‡æ¡£ï¼Œè‡ªåŠ¨äº§ç”Ÿå®¢æˆ·ç«¯ä¸­é—´ä»£ç \n```cmd \nwsimport -keep -verbose http://ws.webxml.com.cn/WebServices/MobileCodeWS.asmx?WSDL\n```\n\n### **åŸºæœ¬æ­¥éª¤**\n- è°ƒç”¨wsimportæ‰€äº§ç”Ÿå®¢æˆ·ç«¯ä¸­é—´ä»£ç \n- æä¾›ç›¸åº”å‚æ•°\n- è·å–è¿”å›ç»“æœ\n```java\n/**\n* use wsimport to parse wsdl\n* wsimport -keep -verbose http://ws.webxml.com.cn/WebServices/MobileCodeWS.asmx?WSDL\n* copy the generated class to this project, and invoke them\n* \n* è°ƒç”¨æ‰‹æœºå·æŸ¥è¯¢web service\n* @param args\n*/\nMobileCodeWS mobileCodeWS = new MobileCodeWS();\nMobileCodeWSSoap  mobileCodeWSSoap = mobileCodeWS.getMobileCodeWSSoap();\nString tel=mobileCodeWSSoap.getMobileCodeInfo(\"13722222222\",null); //ä¿®æ”¹ä¸ºæœ‰æ•ˆå·ç \nSystem.out.println(tel);\n```\n\n- Java è°ƒç”¨ Web Service å…¶ä»–åŠæ³•\n    - Axis/Axis2 (axis.apache.org)\n    - é‡‡ç”¨URLConnectionè®¿é—® Web Service\n    - é‡‡ç”¨HttpClientè®¿é—®Web Service\n\n## **6.å‘½ä»¤è¡Œ**\n### **Runtime**\n- Javaæä¾›Runtimeç±» \n    - exec ä»¥ä¸€ä¸ªç‹¬ç«‹è¿›ç¨‹æ‰§è¡Œå‘½ä»¤command, å¹¶è¿”å›Processå¥æŸ„\n    - å½“ç‹¬ç«‹è¿›ç¨‹å¯åŠ¨åï¼Œéœ€è¦å¤„ç†è¯¥è¿›ç¨‹çš„è¾“å‡ºæµ/é”™è¯¯æµ\n        - è°ƒç”¨Process.getInputStream å¯ä»¥è·å–è¿›ç¨‹çš„è¾“å‡ºæµ\n        - è°ƒç”¨Process.getErrorStreamå¯ä»¥è·å–è¿›ç¨‹çš„é”™è¯¯è¾“å‡ºæµ\n    - è°ƒç”¨Process.waitFor ç­‰å¾…ç›®æ ‡è¿›ç¨‹çš„ç»ˆæ­¢(å½“å‰è¿›ç¨‹é˜»å¡)\n\n```java\nProcess p;\nString cmd = \"ipconfig /all\";  //æŸ¥çœ‹ipåœ°å€\n\ntry {\n    // æ‰§è¡Œå‘½ä»¤\n    p = Runtime.getRuntime().exec(cmd);\n    // å–å¾—å‘½ä»¤ç»“æœçš„è¾“å‡ºæµ\n    InputStream fis = p.getInputStream();\n    // ç”¨ä¸€ä¸ªè¯»è¾“å‡ºæµç±»å»è¯»\n    InputStreamReader isr = new InputStreamReader(fis);\n    // ç”¨ç¼“å†²å™¨è¯»è¡Œ\n    BufferedReader br = new BufferedReader(isr);\n    String line = null;\n    // ç›´åˆ°è¯»å®Œä¸ºæ­¢\n    while ((line = br.readLine()) != null) {\n        System.out.println(line);\n    }\n\n    System.out.println(\"\");\n    int exitVal = p.waitFor(); //è·å–è¿›ç¨‹æœ€åè¿”å›çŠ¶æ€\n    System.out.println(\"Process exitValue: \" + exitVal);\n\n} catch (Exception e) {\n    e.printStackTrace();\n}\n```","tags":["Java"],"categories":["Java","Javaé«˜é˜¶"]},{"title":"Java æ•°æ®åº“ç¼–ç¨‹","url":"/20210922/java-sql-programming/","content":"## **1.æ•°æ®åº“å’ŒSQL**\n- DBï¼ˆæ–‡ä»¶é›†åˆï¼Œç±»ä¼¼.doc,.docxæ–‡ä»¶ï¼‰ \n- DBMS: Database Management Systemï¼ˆç±»ä¼¼Office/WPSï¼‰ \n    - æ“çºµå’Œç®¡ç†æ•°æ®åº“çš„è½¯ä»¶ï¼Œå¯å»ºç«‹ã€ä½¿ç”¨å’Œç»´æŠ¤æ•°æ®åº“\n- DBç§ç±»\n    - æ–‡æœ¬æ–‡ä»¶/äºŒè¿›åˆ¶æ–‡ä»¶\n    - Xlsæ–‡ä»¶\n    - Accessï¼ˆåŒ…å«åœ¨officeé‡Œé¢ï¼Œæ”¶è´¹ï¼Œåªèƒ½è¿è¡Œåœ¨Windowsä¸Šã€‚32å’Œ64ä½ï¼Œoffice95/97/2000/2003/2007/2010/â€¦ï¼‰\n    - **Mysql** /Postgresql/Berkely DB (å…è´¹, ä½†ä¹Ÿæœ‰æ”¶è´¹ç‰ˆã€‚å¤šå¹³å°ï¼Œ32å’Œ64ä½åŒºåˆ†ã€‚) \n    - **SQL Server**ï¼ˆæ”¶è´¹ï¼Œåªèƒ½è¿è¡ŒWindowsï¼Œ32ä½å’Œ64ä½ï¼Œä¸­æ–‡æ–‡æ¡£ã€‚SQL Server 2000/2005/2008/2012/â€¦,ä¹Ÿæœ‰å…è´¹ç‰ˆï¼Œä½†æœ‰CPUå’Œå†…å­˜é™åˆ¶ï¼‰\n    - **Oracle**/DB2ï¼ˆæ”¶è´¹ï¼Œå…¨å¹³å°ï¼Œ32å’Œ64ä½ï¼Œè‹±æ–‡æ–‡æ¡£ï¼Œä¹Ÿæœ‰å…è´¹ç‰ˆï¼Œä½†æœ‰CPUå’Œå†…å­˜é™åˆ¶ï¼‰ \n    - SQLite (å…è´¹,æ‰‹æœºä¸Šä½¿ç”¨)\n\n### **è¡¨**\n- è¡¨ï¼štable, å®ä½“\n    -  åˆ—ï¼šåˆ—ã€å±æ€§ã€å­—æ®µ\n    -  è¡Œï¼šè®°å½•ã€å…ƒç»„tupleï¼Œæ•°æ®\n- æ•°æ®å€¼åŸŸï¼šæ•°æ®çš„å–å€¼èŒƒå›´\n- å­—æ®µç±»å‹\n    - int :æ•´æ•° -2147483648~2147483647ï¼Œ4ä¸ªå­—èŠ‚\n    - doubleï¼šå°æ•°ï¼Œ8ä¸ªå­—èŠ‚\n    - datetime ï¼šæ—¶é—´ï¼Œ7ä¸ªå­—èŠ‚\n    - varcharï¼šå­—ç¬¦ä¸²ï¼Œå¯å˜å­—èŠ‚\n\n### **SQL**\n- ç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€(Structured Query Language)ï¼Œç®€ç§°SQL\n    - æ˜¯ä¸€ç§ç‰¹æ®Šç›®çš„çš„ç¼–ç¨‹è¯­è¨€ï¼Œæ˜¯ä¸€ç§æ•°æ®åº“æŸ¥è¯¢å’Œç¨‹åºè®¾è®¡è¯­è¨€ï¼Œç”¨äºå­˜å–æ•°æ®ä»¥åŠæŸ¥è¯¢ã€æ›´æ–°å’Œç®¡ç†å…³ç³»æ•°æ®åº“ç³»ç»Ÿï¼›åŒæ—¶ä¹Ÿæ˜¯æ•°æ®åº“è„šæœ¬æ–‡ä»¶çš„æ‰©å±•åã€‚ \n-  SQLæ ‡å‡†\n    - SQL-86/SQL-89/SQL-92\n    - SQL:1999/ SQL:2003/ SQL:2008/ SQL:2011/ SQL:2016\n    - åŸºç¡€çš„éƒ¨åˆ†ï¼Œæ‰€æœ‰æ ‡å‡†éƒ½ä¸€æ ·\n    - æ ‡å‡†ä»…ä»…æ˜¯æ ‡å‡†ï¼Œæ¯ä¸ªå‚å•†çš„æ•°æ®åº“å®ç°å¯èƒ½æœ‰ä¸€äº›ä¸ä¸€è‡´\n\n### **å¸¸è§„è¯­å¥**\n```SQL\ncreate table t1(a int, b varchar(20));\ninsert into t1(a,b) values(1,â€™abcâ€™);\nselect a from t1;\nselect a,b from t1 where a > 1;\ndelete from t1 where a = 10 and b=â€˜abâ€™;\nupdate t1 set a=2, b = â€˜cdâ€™ where a=1 and b=â€˜abâ€™;\ndrop table t1;\n```\n\n## **2.JDBCåŸºæœ¬æ“ä½œ**\n- java.sql/ javax.sql ï¼ˆæ¥å£ç±»ï¼‰\n    - æ ¹æ®æ•°æ®åº“ç‰ˆæœ¬å’ŒJDBCç‰ˆæœ¬åˆç†é€‰æ‹©\n    - ä¸€èˆ¬æ•°æ®åº“å‘è¡ŒåŒ…éƒ½ä¼šæä¾›jaråŒ…ï¼ŒåŒæ—¶ä¹Ÿè¦æ³¨æ„åŒºåˆ†32ä½å’Œ64ä½\n- è¿æ¥å­—ç¬¦ä¸²ï¼ˆæ ·ä¾‹ï¼‰ \n    - jdbc:oracle:thin:@127.0.0.1:1521:dbname\n    - jdbc:mysql://localhost:3306/mydb\n    - jdbc:sqlserver://localhost:1433; DatabaseName=dbname\n\n### **æ“ä½œæ­¥éª¤**\n- æ„å»ºè¿æ¥ï¼ˆæ­æ¡¥ï¼‰ \n    - æ³¨å†Œé©±åŠ¨ï¼Œå¯»æ‰¾æè´¨, class.forName(\"...\")\n    - ç¡®å®šå¯¹å²¸ç›®æ ‡ , å»ºæ¡¥ Connection\n- æ‰§è¡Œæ“ä½œï¼ˆæ´¾ä¸ªäººè¿‡æ¡¥, æç€ç¯®å­ï¼Œå»æ‹¿æ•°æ®ï¼‰ \n    -  Statement (æ‰§è¡Œè€…) \n    -  ResultSet(ç»“æœé›†) \n-  é‡Šæ”¾è¿æ¥ï¼ˆæ‹†æ¡¥ï¼‰ \n    -  connection.close();\n\n### **Statement**\n- Statement æ‰§è¡Œè€…ç±»\n    - ä½¿ç”¨executeQuery()æ‰§è¡Œselectè¯­å¥ï¼Œè¿”å›ç»“æœæ”¾åœ¨ResultSet\n    - ä½¿ç”¨executeUpdate()æ‰§è¡Œinsert/update/deleteï¼Œè¿”å›ä¿®æ”¹çš„è¡Œæ•°\n    - ä¸€ä¸ªStatementå¯¹è±¡ä¸€æ¬¡åªèƒ½æ‰§è¡Œä¸€ä¸ªå‘½ä»¤\n- ResultSet ç»“æœå¯¹è±¡\n    - next() åˆ¤æ–­æ˜¯å¦è¿˜æœ‰ä¸‹ä¸€æ¡è®°å½•\n    - getInt/getString/getDouble/â€¦â€¦\n        - å¯ä»¥æŒ‰ç´¢å¼•ä½ç½®ï¼Œå¯ä»¥æŒ‰ç…§åˆ—å\n\n```java\n//æ„å»ºJavaå’Œæ•°æ®åº“ä¹‹é—´çš„æ¡¥æ¢ä»‹è´¨\ntry{            \n    Class.forName(\"com.mysql.jdbc.Driver\");\n}catch(ClassNotFoundException e1){\n    //æ³¨å†Œå¤±è´¥\n    e1.printStackTrace();\n    return;\n}\n\nString url=\"jdbc:mysql://localhost:3306/test\";        \nConnection conn = null;\ntry {\n    //æ„å»ºJavaå’Œæ•°æ®åº“ä¹‹é—´çš„æ¡¥æ¢ï¼šURLï¼Œç”¨æˆ·åï¼Œå¯†ç \n    conn = DriverManager.getConnection(url, \"root\", \"123456\");\n\n    //æ„å»ºæ•°æ®åº“æ‰§è¡Œè€…\n    Statement stmt = conn.createStatement(); \n    System.out.println(\"åˆ›å»ºStatementæˆåŠŸï¼\");      \n\n    //æ‰§è¡ŒSQLè¯­å¥å¹¶è¿”å›ç»“æœåˆ°ResultSet\n    ResultSet rs = stmt.executeQuery(\"select bookid, bookname, price from t_book order by bookid\");\n\n    //update\n    int result = stmt.executeUpdate(\"update t_book set price = 300 where bookid = 1\");\n    result = stmt.executeUpdate(\"insert into t_book(bookid, bookname, price) values(4, 'ç¼–è¯‘åŸç†', 90)\");\n    result = stmt.executeUpdate(\"delete from t_book where id = 4\");\n    \n    //å¼€å§‹éå†ResultSetæ•°æ®\n    while(rs.next()) {\n        System.out.println(rs.getInt(1) + \",\" + rs.getString(2) + \",\" + rs.getInt(\"price\"));\n    }\n    rs.close();\n    stmt.close();\n\n} catch (SQLException e){\n    e.printStackTrace();\n} finally {\n    try {\n        if(null != conn){\n            conn.close();\n        }\n    }\n    catch (SQLException e){\n        e.printStackTrace();\n    }            \n}\n```\n### **æ³¨æ„äº‹é¡¹**\n- ResultSetä¸èƒ½å¤šä¸ªåšç¬›å¡å°”ç§¯è¿æ¥\n- ResultSetæœ€å¥½ä¸è¦è¶…è¿‡ç™¾æ¡ï¼Œå¦åˆ™æå…¶å½±å“æ€§èƒ½\n- ResultSetä¹Ÿä¸æ˜¯ä¸€å£æ°”åŠ è½½æ‰€æœ‰çš„selectç»“æœæ•°æ®\n- Connection å¾ˆæ˜‚è´µï¼Œéœ€è¦åŠæ—¶close\n- Connectionæ‰€ç”¨çš„jaråŒ…å’Œæ•°æ®åº“è¦åŒ¹é…\n\n## **3.JDBCé«˜çº§æ“ä½œ**\n### **äº‹åŠ¡**\n- æ•°æ®åº“äº‹åŠ¡ï¼ŒDatabase Transactionã€‚\n-ä½œä¸ºå•ä¸ªé€»è¾‘å·¥ä½œå•å…ƒæ‰§è¡Œçš„ä¸€ç³»åˆ—æ“ä½œï¼Œ**è¦ä¹ˆå®Œå…¨åœ°æ‰§è¡Œï¼Œè¦ä¹ˆå®Œå…¨åœ°ä¸æ‰§è¡Œ**\n- äº‹åŠ¡ï¼Œå¿…é¡»æ»¡è¶³æ‰€è°“çš„ACIDï¼ˆ**åŸå­æ€§ã€ä¸€è‡´æ€§ã€éš”ç¦»æ€§å’ŒæŒä¹…æ€§**ï¼‰å±æ€§\n- äº‹åŠ¡æ˜¯æ•°æ®åº“è¿è¡Œä¸­çš„é€»è¾‘å·¥ä½œå•ä½ï¼Œç”±DBMSä¸­çš„äº‹åŠ¡ç®¡ç†å­ç³»ç»Ÿè´Ÿè´£äº‹åŠ¡çš„å¤„ç†\n\n### **JDBCäº‹åŠ¡**\n- å…³é—­è‡ªåŠ¨æäº¤ï¼Œå®ç°å¤šè¯­å¥åŒä¸€äº‹åŠ¡ï¼š\n    -  connection.setAutoCommit(false);\n    - connection.commit(); æäº¤äº‹åŠ¡\n    - connection.rollback(); å›æ»šäº‹åŠ¡\n- ä¿å­˜ç‚¹æœºåˆ¶\n    - connection.setSavepoint()\n    - connection.rollback(Savepoint)\n```java\nconn.setAutoCommit(false);\ninsertBook(conn, \"insert into t_book values(101, 'aaaa', 10)\");\ninsertBook(conn, \"insert into t_book values(102, 'bbbb', 10)\");\ninsertBook(conn, \"insert into t_book values(103, 'cccc', 10)\");\nSavepoint phase1 = conn.setSavepoint(); //è®¾ç½®ä¸€ä¸ªä¿å­˜ç‚¹\ninsertBook(conn, \"insert into t_book values(104, 'cccc', 10)\");\ninsertBook(conn, \"insert into t_book values(105, 'cccc', 10)\");\nconn.rollback(phase1);  //å›æ»šåˆ°phase1ä¿å­˜ç‚¹ï¼Œå³ä¸Šé¢2è¡Œæ— æ•ˆ\nconn.commit();\n\npublic static void insertBook(Connection conn, String sql) {\n    try {\n        // æ„å»ºæ•°æ®åº“æ‰§è¡Œè€…\n        Statement stmt = conn.createStatement();\n\n        // æ‰§è¡ŒSQLè¯­å¥\n        int result = stmt.executeUpdate(sql);\n        stmt.close();\n    } catch (SQLException e) {\n        e.printStackTrace();\n    }\n}\n```\n\n### **PreparedStatement**\n- Javaæä¾›PreparedStatementï¼Œæ›´ä¸ºå®‰å…¨æ‰§è¡ŒSQL\n- å’ŒStatementåŒºåˆ«æ˜¯ä½¿ç”¨â€œ?â€ ä»£æ›¿å­—ç¬¦ä¸²æ‹¼æ¥\n- ä½¿ç”¨setXXX(int,Object)çš„å‡½æ•°æ¥å®ç°å¯¹äº?çš„æ›¿æ¢\n    - æ³¨ï¼šä¸éœ€è¦è€ƒè™‘å­—ç¬¦ä¸²çš„ä¸¤ä¾§å•å¼•å·\n    - å‚æ•°èµ‹å€¼ï¼Œæ¸…æ™°æ˜äº†ï¼Œæ‹’ç»æ‹¼æ¥é”™è¯¯\n```java\n//æ„å»ºJavaå’Œæ•°æ®åº“ä¹‹é—´çš„æ¡¥æ¢ï¼šURLï¼Œç”¨æˆ·åï¼Œå¯†ç \nConnection conn = DriverManager.getConnection(url, \"root\", \"123456\");\n\n//ä½¿ç”¨â€œ?â€ ä»£æ›¿å­—ç¬¦ä¸²æ‹¼æ¥\nString sql = \"insert into t_book(bookid,bookname,price) values(?,?,?)\";\n\n//æ„å»ºæ•°æ®åº“æ‰§è¡Œè€…\nPreparedStatement pstmt = conn.prepareStatement(sql);\n\n//æ‰§è¡ŒSQLè¯­å¥\nint bookid = 10;\nString bookName = \"Effective Java',50);delete from t_book;insert into t_book values(101, 'faked book\";\nint price = 50;\n\n//è®¾å®švalueå‚æ•°\npstmt.setInt(1, bookid);\npstmt.setString(2, bookName);\npstmt.setInt(3, price);\n\nint result = pstmt.executeUpdate();\n\npstmt.close();\n```\n- æä¾›addBatchæ‰¹é‡æ›´æ–°åŠŸèƒ½\n- Selectè¯­å¥ä¸€æ ·ç”¨ResultSetæ¥æ”¶ç»“æœ\n- ä½¿ç”¨PreparedStatementçš„å¥½å¤„ï¼š \n    -  é˜²æ­¢æ³¨å…¥æ”»å‡»\n    - é˜²æ­¢ç¹ççš„å­—ç¬¦ä¸²æ‹¼æ¥å’Œé”™è¯¯\n    - ç›´æ¥è®¾ç½®å¯¹è±¡è€Œä¸éœ€è¦è½¬æ¢ä¸ºå­—ç¬¦ä¸²\n    - PreparedStatementä½¿ç”¨é¢„ç¼–è¯‘é€Ÿåº¦ç›¸å¯¹Statementå¿«å¾ˆå¤š\n```java\nConnection conn = DriverManager.getConnection(url, \"root\", \"123456\");\n            \nString sql = \"insert into t_book(bookid,bookname,price) values(?,?,?)\";\n\n//æ„å»ºæ•°æ®åº“æ‰§è¡Œè€…\nPreparedStatement pstmt = conn.prepareStatement(sql);\n\n//æ‰§è¡ŒSQLè¯­å¥\nString bookName = \"aaaaaaaaaaaaaaaa\";\nint price = 50;\n\n//values(1, 'Effective Java', 50)\nfor(int i=200;i<210;i++)\n{\n    pstmt.setInt(1, i);\n    pstmt.setString(2, bookName);\n    pstmt.setInt(3, price);\n    pstmt.addBatch();\n}            \npstmt.executeBatch();\n\npstmt.close();  \n```\n\n### **ResultSetMetaData**\n- ResultSetå¯ä»¥ç”¨æ¥æ‰¿è½½æ‰€æœ‰çš„selectè¯­å¥è¿”å›çš„ç»“æœé›†\n- ResultSetMetaDataæ¥è·å–ResultSetè¿”å›çš„å±æ€§ï¼ˆå¦‚ï¼Œæ¯ä¸€è¡Œçš„åå­—ç±»å‹ç­‰ï¼‰ \n    - getColumnCount()ï¼Œè¿”å›ç»“æœçš„åˆ—æ•°\n    - getColumnClassName(i)ï¼Œè¿”å›ç¬¬iåˆ—çš„æ•°æ®çš„Javaç±»å\n    - getColumnTypeName(i)ï¼Œè¿”å›ç¬¬iåˆ—çš„æ•°æ®åº“ç±»å‹åç§°\n    - getColumnType(i)ï¼Œè¿”å›ç¬¬iåˆ—çš„SQLç±»å‹\n- ä½¿ç”¨ResultSetMetaDataè§£æResultSet\n```java\n//æ„å»ºJavaå’Œæ•°æ®åº“ä¹‹é—´çš„æ¡¥æ¢ï¼šURLï¼Œç”¨æˆ·åï¼Œå¯†ç \nConnection conn = DriverManager.getConnection(url, \"root\", \"123456\");\n\n//æ„å»ºæ•°æ®åº“æ‰§è¡Œè€…\nStatement stmt = conn.createStatement();    \n\n//æ‰§è¡ŒSQLè¯­å¥å¹¶è¿”å›ç»“æœåˆ°ResultSet\nResultSet rs = stmt.executeQuery(\"select bookid, bookname, price from t_book order by bookid\");\n\n//è·å–ç»“æœé›†çš„å…ƒæ•°æ®\nResultSetMetaData meta = rs.getMetaData(); \nint cols = meta.getColumnCount(); \nfor(int i=1;i<=cols;i++)\n{\n    System.out.println(meta.getColumnName(i) + \",\" + meta.getColumnTypeName(i));\n}\n\nrs.close();\nstmt.close();\n```\n\n## **4.æ•°æ®åº“è¿æ¥æ± **\n### **äº«å…ƒæ¨¡å¼**\n- ç»å…¸23ä¸ªè®¾è®¡æ¨¡å¼çš„ä¸€ç§ï¼Œå±äºç»“æ„å‹æ¨¡å¼ã€‚ \n- ä¸€ä¸ªç³»ç»Ÿä¸­å­˜åœ¨å¤§é‡çš„ç›¸åŒçš„å¯¹è±¡ï¼Œç”±äºè¿™ç±»å¯¹è±¡çš„å¤§é‡ä½¿ç”¨ï¼Œä¼šé€ æˆç³»ç»Ÿå†…å­˜çš„è€—è´¹ï¼Œå¯ä»¥ä½¿ç”¨äº«å…ƒæ¨¡å¼æ¥å‡å°‘ç³»ç»Ÿä¸­å¯¹è±¡çš„æ•°é‡\n\n### **æ•°æ®åº“è¿æ¥æ± **\n- æ± Poolçš„æ¦‚å¿µ\n    - åˆå§‹æ•°ã€æœ€å¤§æ•°ã€å¢é‡ã€è¶…æ—¶æ—¶é—´ç­‰å‚æ•°ã€‚ \n- å¸¸ç”¨çš„æ•°æ®åº“è¿æ¥æ± \n    - DBCP (Apache, http://commons.apache.org/ï¼Œæ€§èƒ½è¾ƒå·®) \n    -  C3P0 (https://www.mchange.com/projects/c3p0/)\n    - Druid (Alibaba, https://github.com/alibaba/druid)\n\n### **C3P0è¿æ¥æ± **\n- é»˜è®¤é…ç½®\n```xml\n<default-config> <!-- é»˜è®¤é…ç½® --> \n    <property name=\"driverClass\">com.mysql.jdbc.Driver</property>\n    <property name=\"jdbcUrl\">jdbc:mysql://localhost:3306/test</property>\n    <property name=\"user\">root</property>\n    <property name=\"password\">123456</property>\n    <property name=\"initialPoolSize\">5</property>\n    <property name=\"maxPoolSize\">20</property>\n</default-config>\n```\n\n- driverClass é©±åŠ¨classï¼Œè¿™é‡Œä¸ºmysqlçš„é©±åŠ¨\n- jdbcUrl jdbcé“¾æ¥\n- user passwordæ•°æ®åº“ç”¨æˆ·åå¯†ç \n- initialPoolSize åˆå§‹æ•°é‡ï¼šä¸€å¼€å§‹åˆ›å»ºå¤šå°‘æ¡é“¾æ¥\n- maxPoolSize æœ€å¤§æ•°ï¼šæœ€å¤šæœ‰å¤šå°‘æ¡é“¾æ¥\n- acquireIncrement å¢é‡ï¼šç”¨å®Œæ¯æ¬¡å¢åŠ å¤šå°‘ä¸ª\n- maxIdleTimeæœ€å¤§ç©ºé—²æ—¶é—´ï¼šè¶…å‡ºçš„é“¾æ¥ä¼šè¢«æŠ›å¼ƒ\n```java\n//ä»c3p0è·å–\nconn = C3p0Factory.getConnection();\n//C3p0Factory\npublic class C3p0Factory {\n    private static ComboPooledDataSource dataSource = null;\n\n    public static void init() throws Exception {\n        \n        dataSource = new ComboPooledDataSource();\n        //é…ç½®æ–‡ä»¶å¯ä»¥æ”¾åœ¨xmlæ–‡ä»¶ä¸­\n        //dataSource ä¼šè‡ªåŠ¨åŠ è½½resourcesæ–‡ä»¶å¤¹ä¸­c3p0-config.xmlæ–‡ä»¶ï¼ˆå¦‚æœå­˜åœ¨ï¼‰\n        dataSource.setDriverClass( \"com.mysql.jdbc.Driver\" );            \n        dataSource.setJdbcUrl( \"jdbc:mysql://localhost:3306/test\" );\n        dataSource.setUser(\"root\");                                  \n        dataSource.setPassword(\"123456\");                               \n        \n        // the settings below are optional -- c3p0 can work with defaults\n        dataSource.setMinPoolSize(5);                                   \n        dataSource.setAcquireIncrement(5);\n        dataSource.setMaxPoolSize(20);\n    }\n    \n    public static Connection getConnection() throws Exception {\n        if(null == dataSource) {\n            init();\n        }\n       return dataSource.getConnection();\n    }\n}\n\n//ä»Druidè·å–\nconn = DruidFactory.getConnection();\npublic class DruidFactory1 {\n    private static DruidDataSource dataSource = null;\n\n    public static void init() throws Exception {\n        //é…ç½®æ–‡ä»¶å¯ä»¥æ”¾åœ¨propertiesæ–‡ä»¶ä¸­\n        //Properties properties = new Properties();\n        //InputStream in = DruidFactory2.class.getClassLoader().getResourceAsStream(\"druid.properties\");  \n        //properties.load(in);         \n        //dataSource = (DruidDataSource)DruidDataSourceFactory.createDataSource(properties);    \n        dataSource = new DruidDataSource();    \n        dataSource.setDriverClassName(\"com.mysql.jdbc.Driver\"); \n        dataSource.setUsername(\"root\");\n        dataSource.setPassword(\"123456\");\n        dataSource.setUrl(\"jdbc:mysql://127.0.0.1:3306/test\"); \n        dataSource.setInitialSize(5);\n        dataSource.setMinIdle(1); \n        dataSource.setMaxActive(10); \n        // å¯ç”¨ç›‘æ§ç»Ÿè®¡åŠŸèƒ½ dataSource.setFilters(\"stat\");// \n    }\n    \n    public static Connection getConnection() throws Exception {\n        if(null == dataSource) {\n            init();\n        }\n        return dataSource.getConnection();\n    }\n}\n\n//æ„å»ºæ•°æ®åº“æ‰§è¡Œè€…\nStatement stmt = conn.createStatement(); \n\n```","tags":["Java"],"categories":["Java","Javaè¿›é˜¶"]},{"title":"Java ç½‘ç»œç¼–ç¨‹ï¼ˆç»­ï¼‰","url":"/20210922/java-network-programming2/","content":" \n## **1.NIOç¼–ç¨‹**\n- Non-Blocking I/O\n- æä¾›éé˜»å¡é€šè®¯ç­‰æ–¹å¼\n- é¿å…åŒæ­¥I/Oé€šè®¯æ•ˆç‡è¿‡ä½\n- ä¸€ä¸ªçº¿ç¨‹å¯ä»¥ç®¡ç†å¤šä¸ªè¿æ¥\n- å‡å°‘çº¿ç¨‹å¤šçš„å‹åŠ›\n\n### **ä¸»è¦ç±»**\n- Buffer ç¼“å­˜åŒº\n- Channel é€šé“\n- Selectorå¤šè·¯é€‰æ‹©å™¨\n\n### **Buffer**\n- Buffer ç¼“å†²åŒºï¼Œä¸€ä¸ªå¯ä»¥è¯»å†™çš„å†…å­˜åŒºåŸŸ\n    - **ByteBuffer, CharBuffer**, DoubleBuffer, IntBuffer, LongBuffer, ShortBuffer **(StringBuffer ä¸æ˜¯Bufferç¼“å†²åŒº)** \n- å››ä¸ªä¸»è¦å±æ€§\n    - capacity å®¹é‡\n    - position è¯»å†™ä½ç½®\n    - limit ç•Œé™\n    - mark æ ‡è®°ï¼Œç”¨äºé‡å¤ä¸€ä¸ªè¯»/å†™æ“ä½œ\n- ä½¿ç”¨Bufferè¯»å†™æ•°æ®ä¸€èˆ¬éµå¾ªä»¥ä¸‹**å››ä¸ªæ­¥éª¤**ï¼š\n    - å†™å…¥æ•°æ®åˆ°Buffer\n    - è°ƒç”¨flip()æ–¹æ³•\n    - ä»Bufferä¸­è¯»å–æ•°æ®\n    - è°ƒç”¨clear()æ–¹æ³•æˆ–è€…compact()æ–¹æ³•\n- **Bufferçš„åˆ†é…**\n    - allocateæ–¹æ³•\n    ```java\n    ByteBuffer buf = ByteBuffer.allocate(48);\n    ```\n- **å‘Bufferä¸­å†™æ•°æ®**\n    - ä»Channelå†™åˆ°Buffer\n    ```java\n    int bytesRead = inChannel.read(buf);\n    ```\n    - é€šè¿‡Bufferçš„put()æ–¹æ³•å†™å…¥Buffer\n    ```java\n    buf.put(127);\n    ```\n- **flip()æ–¹æ³•**\n    - flipæ–¹æ³•å°†Bufferä»å†™æ¨¡å¼åˆ‡æ¢åˆ°è¯»æ¨¡å¼\n    - è°ƒç”¨flip()æ–¹æ³•ä¼šå°†positionè®¾å›0ï¼Œå¹¶å°†limitè®¾ç½®æˆä¹‹å‰positionçš„å€¼\n- **ä»Bufferä¸­è¯»æ•°æ®**\n    - ä»Bufferè¯»å–æ•°æ®åˆ°Channel\n    ```java\n    int bytesWritten = inChannel.write(buf);\n    ```\n    - ä½¿ç”¨get()æ–¹æ³•ä»Bufferä¸­è¯»å–æ•°æ®\n    ```java\n    byte aByte = buf.get();\n    ```\n- **clear()ä¸compact()æ–¹æ³•**\n    - clear()\n        - positionå°†è¢«è®¾å›0ï¼Œlimitè¢«è®¾ç½®æˆ capacityçš„å€¼\n        - Buffer è¢«æ¸…ç©ºäº†ï¼Œä½†Bufferä¸­çš„æ•°æ®å¹¶æœªæ¸…é™¤ï¼Œåªæ˜¯è¿™äº›æ ‡è®°å‘Šè¯‰æˆ‘ä»¬å¯ä»¥ä»å“ªé‡Œå¼€å§‹å¾€Bufferé‡Œå†™æ•°æ®\n    - compact()\n        - å°†æ‰€æœ‰æœªè¯»çš„æ•°æ®æ‹·è´åˆ°Bufferèµ·å§‹å¤„ï¼Œç„¶åå°†positionè®¾åˆ°æœ€åä¸€ä¸ªæœªè¯»å…ƒç´ æ­£åé¢\n        - limitå±æ€§ä¾ç„¶åƒclear()æ–¹æ³•ä¸€æ ·ï¼Œè®¾ç½®æˆcapacity\n        - ä¸ä¼šè¦†ç›–æœªè¯»çš„æ•°æ®\n\n### **Channel**\n- å…¨åŒå·¥çš„ï¼Œæ”¯æŒè¯»/å†™(**è€ŒStreamæµæ˜¯å•å‘çš„**) \n- æ”¯æŒå¼‚æ­¥è¯»å†™\n- å’ŒBufferé…åˆï¼Œæé«˜æ•ˆç‡\n- **ServerSocketChannel æœåŠ¡å™¨TCP Socket æ¥å…¥é€šé“ï¼Œæ¥æ”¶å®¢æˆ·ç«¯**\n- **SocketChannel TCP Socketé€šé“ï¼Œå¯æ”¯æŒé˜»å¡/éé˜»å¡é€šè®¯**\n- DatagramChannel UDP é€šé“\n- FileChannel æ–‡ä»¶é€šé“\n### **SocketChannel**\n- **æ‰“å¼€SocketChannel**\n```java\nSocketChannel socketChannel = SocketChannel.open();\nsocketChannel.connect(new InetSocketAddress(\"http://jenkov.com\", 80));\n```\n- **å…³é—­SocketChannel**\n    - close()\n    ```java\n    socketChannel.close();\n    ```\n- **è¯»å–SocketChannel **\n    - read()\n    ```java\n    ByteBuffer buf = ByteBuffer.allocate(48);\n    int bytesRead = socketChannel.read(buf);\n    ```\n- **å†™å…¥SocketChannel**\n    - write()\n    ```java\n    String newData = \"New String to write to file...\";\n    ByteBuffer buf = ByteBuffer.allocate(48);\n    buf.clear();\n    buf.put(newData.getBytes());\n    buf.flip();\n    while(buf.hasRemaining()) {\n        channel.write(buf);\n    }\n    ```\n\n### **Selector**\n- æ¯éš”ä¸€æ®µæ—¶é—´ï¼Œä¸æ–­è½®è¯¢æ³¨å†Œåœ¨å…¶ä¸Šçš„Channel\n- å¦‚æœæœ‰ä¸€ä¸ªChannelæœ‰æ¥å…¥ã€è¯»ã€å†™æ“ä½œï¼Œå°±ä¼šè¢«è½®è¯¢å‡ºæ¥\n- æ ¹æ®SelectionKeyå¯ä»¥è·å–ç›¸åº”çš„Channelï¼Œè¿›è¡Œåç»­IOæ“ä½œ\n- é¿å…è¿‡å¤šçš„çº¿ç¨‹\n- SelectionKeyå››ç§ç±»å‹\n    - OP_CONNECT (è¿æ¥å°±ç»ª æŸä¸ªChannelæˆåŠŸè¿æ¥åˆ°å¦ä¸€ä¸ªæœåŠ¡å™¨)\n    - OP_ACCEPT (æ¥æ”¶å°±ç»ª ä¸€ä¸ªServerSocketChannelå‡†å¤‡å¥½æ¥æ”¶æ–°è¿›å…¥çš„è¿æ¥)\n    - OP_READ (è¯»å°±ç»ª æœ‰æ•°æ®å¯è¯»çš„é€šé“)\n    - OP_WRITE (å†™å°±ç»ª ç­‰å¾…å†™æ•°æ®çš„é€šé“)\n- **Selectorçš„åˆ›å»º**\n    - Selector.open()æ–¹æ³•\n    ```java\n    Selector selector = Selector.open();\n    ```\n- **å‘Selectoræ³¨å†Œé€šé“**\n    - SelectableChannel.register()æ–¹æ³•\n    ```java\n    channel.configureBlocking(false);\n    SelectionKey key = channel.register(selector,Selectionkey.OP_READ);\n    ```\n- **é€šè¿‡Selectoré€‰æ‹©é€šé“**\n- ä¸€æ—¦å‘Selectoræ³¨å†Œäº†ä¸€æˆ–å¤šä¸ªé€šé“ï¼Œå°±å¯ä»¥è°ƒç”¨å‡ ä¸ªé‡è½½çš„select()æ–¹æ³•ã€‚è¿™äº›æ–¹æ³•è¿”å›ä½ æ‰€æ„Ÿå…´è¶£çš„äº‹ä»¶ï¼ˆå¦‚è¿æ¥ã€æ¥å—ã€è¯»æˆ–å†™ï¼‰å·²ç»å‡†å¤‡å°±ç»ªçš„é‚£äº›é€šé“\n    - select()  é˜»å¡åˆ°è‡³å°‘æœ‰ä¸€ä¸ªé€šé“åœ¨ä½ æ³¨å†Œçš„äº‹ä»¶ä¸Šå°±ç»ªäº†\n    - select(long timeout)  æœ€é•¿ä¼šé˜»å¡timeoutæ¯«ç§’(å‚æ•°)\n    - selectNow()   ä¸ä¼šé˜»å¡ï¼Œä¸ç®¡ä»€ä¹ˆé€šé“å°±ç»ªéƒ½ç«‹åˆ»è¿”å›\n- **è®¿é—®å·²é€‰æ‹©é”®é›†**\n- ä¸€æ—¦è°ƒç”¨äº†select()æ–¹æ³•ï¼Œå¹¶ä¸”è¿”å›å€¼è¡¨æ˜æœ‰ä¸€ä¸ªæˆ–æ›´å¤šä¸ªé€šé“å°±ç»ªäº†ï¼Œç„¶åå¯ä»¥é€šè¿‡è°ƒç”¨selectorçš„selectedKeys()æ–¹æ³•ï¼Œè®¿é—®â€œå·²é€‰æ‹©é”®é›†ï¼ˆselected key setï¼‰\n    - selectedKeys()\n    ```java\n    Set selectedKeys = selector.selectedKeys();\n\n    ```\n\n### **NIOç»“æ„**\n\n```mermaid\ngraph LR\np[Server]--c---s[Server<br>Socket<br>Channel]\ns--c---sr[Selector]\nsr--c---b01[Buffer]\nsr--c---b02[Buffer]\nsr--c---b03[Buffer]\nb01--c---s01[Selector]\nb02--c---s02[Selector]\nb03--c---s03[Selector]\ns01--c---c1[Client1]\ns02--c---c2[Client2]\ns03--c---c3[Client3]\n```\n```java\n//Server\n//Selectoræ„å»º\nSelector selector = Selector.open();\n//Channelæ„å»º\nServerSocketChannel servChannel = ServerSocketChannel.open();\nservChannel.configureBlocking(false); //è®¾ç½®éé˜»å¡æ¨¡å¼\nservChannel.socket().bind(new InetSocketAddress(8001), 1024);//è®¾å®š8001ç«¯å£\nservChannel.register(selector, SelectionKey.OP_ACCEPT); //selectorç»‘å®š\n\n//selectorä¸€æ¬¡éå†æ‰€æœ‰channel\nselector.select(1000); //æœ€å¤šç­‰å¾…å µå¡1000ms\nSet<SelectionKey> selectedKeys = selector.selectedKeys(); //è·å¾—æ‰€æœ‰æœ‰æ•°æ®å“åº”çš„key\nIterator<SelectionKey> it = selectedKeys.iterator();\nwhile (it.hasNext()) {\n    SelectionKey key = it.next();\n    it.remove();\n    try {\n        //Handle\n    } catch (Exception e) {\n        if (key != null) {\n            key.cancel();\n            if (key.channel() != null)\n                key.channel().close();\n        }\n    }\n}\n\n//Handle\nif(key.isValid()) {\n    if(key.isAcceptable()) {\n        // Accept the new connection\n        ServerSocketChannel ssc = (ServerSocketChannel) key.channel();\n        SocketChannel sc = ssc.accept();\n        sc.configureBlocking(false);\n        // Add the new connection to the selector\n        sc.register(selector, SelectionKey.OP_READ);\n    }\n    if(key.isReadable()) {\n        //Read the data\n    }\n}\n\n//Client\n//Selectoræ„å»º\nSelector selector = Selector.open();\n//Channelæ„å»º\nSocketChannel socketChannel = SocketChannel.open();\nsocketChannel.configureBlocking(false); //è®¾ç½®éé˜»å¡æ¨¡å¼\n\n// å¦‚æœç›´æ¥è¿æ¥æˆåŠŸï¼Œåˆ™æ³¨å†Œåˆ°å¤šè·¯å¤ç”¨å™¨ä¸Šï¼Œå‘é€è¯·æ±‚æ¶ˆæ¯ï¼Œè¯»åº”ç­”\nif (socketChannel.connect(new InetSocketAddress(\"127.0.0.1\", 8001))) {\n    socketChannel.register(selector, SelectionKey.OP_READ);\n    //doWrite\n} else {\n    socketChannel.register(selector, SelectionKey.OP_CONNECT);\n}\n\n//Handle\nif(key.isValid()) {\n    // åˆ¤æ–­æ˜¯å¦è¿æ¥æˆåŠŸ\n    SocketChannel sc = (SocketChannel) key.channel();\n    if(key.isConnectable()) {\n        if (sc.finishConnect()) {\n                    sc.register(selector, SelectionKey.OP_READ);                    \n                } \n    }\n    if(key.isReadable()) {\n        //Read the data\n    }\n}\n\n//doWrite\nbyte[] str = //TODO\nByteBuffer writeBuffer = ByteBuffer.allocate(str.length); //Bufferåˆ†é…å†…å­˜\nwriteBuffer.put(str); //strå†™å…¥Buffer\nwriteBuffer.flip(); //è¯»å†™æ¨¡å¼åˆ‡æ¢\nsc.write(writeBuffer); //Bufferæ•°å–æ•°æ®åˆ°Channel\n```\n\n## **2.AIOç¼–ç¨‹**\n- Asynchronous I/O, å¼‚æ­¥I/O\n- JDK 1.7å¼•å…¥ï¼Œä¸»è¦åœ¨java.nioåŒ…ä¸­\n- å¼‚æ­¥I/Oï¼Œé‡‡ç”¨å›è°ƒæ–¹æ³•è¿›è¡Œå¤„ç†è¯»å†™æ“ä½œ\n\n### **ä¸»è¦ç±»**\n- AsynchronousServerSocketChannel æœåŠ¡å™¨æ¥å—è¯·æ±‚é€šé“\n    - bind ç»‘å®šåœ¨æŸä¸€ä¸ªç«¯å£        accept æ¥å—å®¢æˆ·ç«¯è¯·æ±‚\n- AsynchronousSocketChannel Socketé€šè®¯é€šé“\n    - read è¯»æ•°æ®         write å†™æ•°æ®\n- **CompletionHandler å¼‚æ­¥å¤„ç†ç±»**\n    - **completed æ“ä½œå®Œæˆåå¼‚æ­¥è°ƒç”¨æ–¹æ³• failed æ“ä½œå¤±è´¥åå¼‚æ­¥è°ƒç”¨æ–¹æ³•**\n```java\n//æœåŠ¡å™¨é€šé“å»ºç«‹\nAsynchronousServerSocketChannel server = AsynchronousServerSocketChannel.open();\nserver.bind(new InetSocketAddress(\"localhost\", 8001));\n\n//æœåŠ¡å™¨æ¥å—å®¢æˆ·ç«¯è¯·æ±‚ï¼ŒæˆåŠŸæ¥æ”¶åè‡ªåŠ¨å›è°ƒ\nserver.accept(null, new CompletionHandler<AsynchronousSocketChannel, Object>() {\n    @Override\n    public void completed(AsynchronousSocketChannel channel, Object attachment) {\n        //TODO\n    }\n\n    @Override\n    public void failed(Throwable exc, Object attachment) {\n        //TODO\n    }\n});\n\n//å®¢æˆ·ç«¯é€šé“å»ºç«‹\nAsynchronousSocketChannel channel = AsynchronousSocketChannel.open();\n\n//è¿æ¥æˆåŠŸåè‡ªåŠ¨å›è°ƒ\nchannel.connect(new InetSocketAddress(\"localhost\", 8001), null, new CompletionHandler<Void, Void>() {\n    @Override\n    public void completed(Integer result, Object attachment) {\n        //TODO\n    }\n    @Override\n    public void failed(Throwable exc, Object attachment) {\n        //TODO\n    }\n});\n```\n\n### **ä¸‰ç§I/Oçš„åŒºåˆ«**\n\n|  |BIO|NIO|AIO|\n|--------|--| --|--|\n|é˜»å¡æ–¹å¼|é˜»å¡|éé˜»å¡|éé˜»å¡|\n|åŒæ­¥æ–¹å¼|åŒæ­¥|åŒæ­¥|å¼‚æ­¥|\n|ç¼–ç¨‹éš¾åº¦|ç®€å•|è¾ƒéš¾|å›°éš¾|\n|å®¢æˆ·æœº/æœåŠ¡å™¨çº¿ç¨‹å¯¹æ¯”|1:1|N:1|N:1|\n|æ€§èƒ½|ä½|é«˜|é«˜|\n\n## **3.Nettyç¼–ç¨‹**\n### **å…³é”®æŠ€æœ¯**\n- **é€šé“ Channel**\n    - ServerSocketChannel/NioServerSocketChannel/â€¦\n    - SocketChannel/NioSocketChannel\n- **äº‹ä»¶ EventLoop**\n    - ä¸ºæ¯ä¸ªé€šé“å®šä¹‰ä¸€ä¸ªEventLoopï¼Œå¤„ç†æ‰€æœ‰çš„I/Oäº‹ä»¶\n    - EventLoopæ³¨å†Œäº‹ä»¶\n    - EventLoopå°†äº‹ä»¶æ´¾å‘ç»™ChannelHandler\n    - EventLoopå®‰æ’è¿›ä¸€æ­¥æ“ä½œ\n- **äº‹ä»¶**\n    - äº‹ä»¶æŒ‰ç…§æ•°æ®æµå‘è¿›è¡Œåˆ†ç±»\n    - å…¥ç«™äº‹ä»¶ï¼šè¿æ¥æ¿€æ´»/æ•°æ®è¯»å–/â€¦â€¦\n    - å‡ºç«™äº‹ä»¶ï¼šæ‰“å¼€åˆ°è¿œç¨‹è¿æ¥/å†™æ•°æ®/â€¦â€¦\n- **äº‹ä»¶å¤„ç† ChannelHandler**\n    - Channelé€šé“å‘ç”Ÿæ•°æ®æˆ–çŠ¶æ€æ”¹å˜\n    - EventLoopä¼šå°†äº‹ä»¶åˆ†ç±»ï¼Œå¹¶è°ƒç”¨ChannelHandlerçš„å›è°ƒå‡½æ•°\n    - ç¨‹åºå‘˜éœ€è¦å®ç°ChannelHandlerå†…çš„å›è°ƒå‡½æ•°\n    - ChannelInboundHandler/ChannelOutboundHandler\n- **ChannelHandlerå·¥ä½œæ¨¡å¼ï¼šè´£ä»»é“¾**\n    - è´£ä»»é“¾æ¨¡å¼\n        - å°†è¯·æ±‚çš„æ¥æ”¶è€…è¿æˆä¸€æ¡é“¾\n        - åœ¨é“¾ä¸Šä¼ é€’è¯·æ±‚ï¼Œç›´åˆ°æœ‰ä¸€ä¸ªæ¥æ”¶è€…å¤„ç†è¯¥è¯·æ±‚\n        - é¿å…è¯·æ±‚è€…å’Œæ¥æ”¶è€…çš„è€¦åˆ\n    - ChannelHandlerå¯ä»¥æœ‰å¤šä¸ªï¼Œä¾æ¬¡è¿›è¡Œè°ƒç”¨\n    - ChannelPipelineä½œä¸ºå®¹å™¨ï¼Œæ‰¿è½½å¤šä¸ªChannelHandler\n- **ByteBuf** \n    - å¼ºå¤§çš„å­—èŠ‚å®¹å™¨ï¼Œæä¾›ä¸°å¯ŒAPIè¿›è¡Œæ“ä½œ\n\n```java\n//from BiliBili\n//Server\nEventLoopGroup bossGroup = new NioEventLoopGroup();\nEventLoopGroup workGroup = new NioEventLoopGroup();\n\nServerBootstrap bootstrap = new ServerBootstrap();\n//é“¾å¼ç¼–ç¨‹ï¼Œè®¾ç½®æœåŠ¡å™¨\nbootstrap.group(bossGroup,workGroup) //è®¾ç½®ä¸¤ä¸ªçº¿ç¨‹ç»„\n        .channel(NioServerSocketChannel.class) //ä½¿ç”¨NioServerSocketChannelä½œä¸ºæœåŠ¡å™¨é€šé“çš„å®ç°\n        .option(ChannelOption.SO_BACKLOG,128) //è®¾ç½®çº¿ç¨‹é˜Ÿåˆ—å¾—åˆ°è¿æ¥ä¸ªæ•°\n        .childOption(ChannelOption.SO_KEEPALIVE,true) //è®¾ç½®ä¿æŒæ´»åŠ¨è¿æ¥çŠ¶æ€\n        .childHandler(new ChannelInitializer<SocketChannel>() { //ç»™workGroupçš„EventLoopå¯¹åº”çš„ç®¡é“è®¾ç½®å¤„ç†å™¨\n            @Override\n            public void initChannel(SocketChannel ch) throws Exception {\n                ch.pipeline().addLast(new ServerHandler()); //æ·»åŠ å¤„ç†ç±»\n            }\n        });\n\n//ç»‘å®šä¸€ä¸ªç«¯å£å¹¶åŒæ­¥ï¼Œç”Ÿæˆäº†ä¸€ä¸ªChannelFutureå¯¹è±¡\nChannelFuture cf =bootstrap.bind(6668).sync();\n//å¯¹å…³é—­é€šé“è¿›è¡Œç›‘å¬\ncf.channel().closeFuture().sync();\n//ServerHandler extends ChannelInboundHandlerAdapter\n@Override\npublic void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception{\n    ByteBuf in = (ByteBuf) msg;\n    String content = in.toString(CharsetUtil.UTF_8);\n    System.out.println(\"Server received: \" + content);\n    System.out.println(\"Client address: \"+ctx.channel().remoteAddress());\n\n    ByteBuf out = ctx.alloc().buffer(1024);\n    out.writeBytes((content + \" 666\").getBytes());\n    ctx.write(out);\n}\n\n@Override\npublic void channelReadComplete(ChannelHandlerContext ctx) throws Exception {\n    ctx.writeAndFlush(Unpooled.EMPTY_BUFFER)\n            .addListener(ChannelFutureListener.CLOSE);\n}\n\n@Override\npublic void exceptionCaught(ChannelHandlerContext ctx, Throwable cause) {\n    cause.printStackTrace();\n    ctx.close();\n}\n//Client\nEventLoopGroup eventExecutors = new NioEventLoopGroup();\ntry {\n    Bootstrap bootstrap = new Bootstrap();\n    bootstrap.group(eventExecutors) //è®¾ç½®ä¸¤ä¸ªçº¿ç¨‹ç»„\n            .channel(NioSocketChannel.class) //ä½¿ç”¨NioSocketChannelä½œä¸ºæœåŠ¡å™¨é€šé“çš„å®ç°\n            .handler(new ChannelInitializer<SocketChannel>() { //ç»™eventExecutorsçš„EventLoopå¯¹åº”çš„ç®¡é“è®¾ç½®å¤„ç†å™¨\n                @Override\n                public void initChannel(SocketChannel ch) throws Exception {\n                    ch.pipeline().addLast(new ClientHandler()); //æ·»åŠ å¤„ç†ç±»\n                }\n            });\n    System.out.println(\"...å®¢æˆ·ç«¯ is ready...\");\n\n    //å¯åŠ¨å®¢æˆ·ç«¯è¿æ¥æœåŠ¡ç«¯\n    ChannelFuture channelFuture = bootstrap.connect(\"127.0.0.1\",6668).sync();\n    //ç»™å…³é—­é€šé“è¿›è¡Œç›‘å¬\n    channelFuture.channel().closeFuture().sync();\n}finally {\n    //ä¼˜é›…å…³é—­\n    eventExecutors.shutdownGracefully();\n}\n//ClientHandler extends ChannelInboundHandlerAdapter\n@Override\npublic void channelActive(ChannelHandlerContext ctx) throws Exception {\n    ctx.writeAndFlush(Unpooled.copiedBuffer(\"Netty rocks!\", CharsetUtil.UTF_8));\n}\n\n@Override\npublic void channelRead(ChannelHandlerContext ctx, Object msg) {\n    ByteBuf buf = (ByteBuf) msg;\n    System.out.println(\"Client received: \" + buf.toString(CharsetUtil.UTF_8));\n    System.out.println(\"Server address: \"+ctx.channel().remoteAddress());\n}\n\n@Override\npublic void exceptionCaught(ChannelHandlerContext ctx, Throwable cause) {\n    cause.printStackTrace();\n    ctx.close();\n}\n```\n\n## **4.é‚®ä»¶åŸºç¡€çŸ¥è¯†**\n### **ä¸»è¦åè®®(å‘é€ç«¯å£25, æ¥æ”¶ç«¯å£110)**\n- å‘é€, SMTP, Simple Mail Transfer Protocol\n- æ¥æ”¶, Pop3, Post Office Protocol 3, (POP)    \n- æ¥æ”¶, IMAP, Internet Message Access Protocol, IMAP4\n- æ‘˜è¦æµè§ˆ\n    - é€‰æ‹©ä¸‹è½½é™„ä»¶\n    - å¤šæ–‡ä»¶å¤¹\n    - ç½‘ç»œç¡¬ç›˜\n\n## **5.Mailç¼–ç¨‹**\n### **é‚®ä»¶æœåŠ¡å™¨æ”¯æŒ**\n- éœ€è¦åœ¨é‚®ä»¶æœåŠ¡å†…è®¾ç½®ï¼Œå¯ä»¥æŸ¥çœ‹ç›¸å…³é‚®ä»¶å¸®åŠ©\n- éœ€è¦çŸ¥é“popæœåŠ¡å™¨å’ŒsmtpæœåŠ¡å™¨ä¿¡æ¯\n### **javax.mail åŒ…å’Œjavax.mail.internet åŒ…**\n- https://javaee.github.io/javamail\n### **å…³é”®ç±»**\n- Session: é‚®ä»¶ä¼šè¯ **å’ŒHttpSessionä¸åŒ**\n- Store: é‚®ä»¶å­˜å‚¨ç©ºé—´\n- Folder: é‚®ä»¶æ–‡ä»¶å¤¹\n- Message: ç”µå­é‚®ä»¶\n- Address: é‚®ä»¶åœ°å€\n- Transport: å‘é€åè®®ç±»\n\n```java\n//Receive\npublic class MailClientRecv {\n  private Session session;\n  private Store store;\n  private String username = \"chenliangyu1980@126.com\";\n  private String password = \"1234567899\";\n  private String popServer = \"pop.126.com\";\n  \n  public void init()throws Exception\n  {\n    //è®¾ç½®å±æ€§\n    Properties  props = new Properties();\n    props.put(\"mail.store.protocol\", \"pop3\");\n    props.put(\"mail.imap.class\", \"com.sun.mail.imap.IMAPStore\");\n    props.put(\"mail.pop3.class\", \"com.sun.mail.pop3.POP3Store\");    \n\n    // åˆ›å»ºSessionå¯¹è±¡\n    session = Session.getInstance(props,null);\n    session.setDebug(false); //è¾“å‡ºè·Ÿè¸ªæ—¥å¿—\n\n    // åˆ›å»ºStoreå¯¹è±¡\n    store = session.getStore(\"pop3\");\n    \n    //è¿æ¥åˆ°æ”¶é‚®ä»¶æœåŠ¡å™¨\n    store.connect(popServer,username,password);\n  }  \n  \n  public void receiveMessage()throws Exception\n  {\n    String folderName = \"inbox\";\n    Folder folder=store.getFolder(folderName);\n    if(folder==null)\n    {\n        throw new Exception(folderName+\"é‚®ä»¶å¤¹ä¸å­˜åœ¨\");\n    }\n    //æ‰“å¼€ä¿¡ç®±\n    folder.open(Folder.READ_ONLY);\n    System.out.println(\"æ‚¨çš„æ”¶ä»¶ç®±æœ‰\"+folder.getMessageCount()+\"å°é‚®ä»¶.\");\n    System.out.println(\"æ‚¨çš„æ”¶ä»¶ç®±æœ‰\"+folder.getUnreadMessageCount()+\"å°æœªè¯»çš„é‚®ä»¶.\");\n\n    //è¯»é‚®ä»¶\n    Message[] messages=folder.getMessages();\n    //for(int i=1;i<=messages.length;i++)\n    for(int i=1;i<=3;i++)  \n    {\n      System.out.println(\"------ç¬¬\"+i+\"å°é‚®ä»¶-------\");\n      //æ‰“å°é‚®ä»¶ä¿¡æ¯\n      Message message = messages[i];\n      //folder.getMessage(i).writeTo(System.out);\n      System.out.println((message.getFrom())[0]);\n      System.out.println(message.getSubject());\n      System.out.println();\n    }\n    folder.close(false);  //å…³é—­é‚®ä»¶å¤¹\n  }\n  \n  public void close()throws Exception\n  {\n    store.close();\n  }\n  \n  public static void main(String[] args)throws Exception {\n    MailClientRecv client=new MailClientRecv();\n    //åˆå§‹åŒ–\n    client.init();\n    //æ¥æ”¶é‚®ä»¶\n    client.receiveMessage();\n    //å…³é—­è¿æ¥\n    client.close();\n  }\n}\n//Send\npublic class MailClientSend {\n  private Session session;\n  private Transport transport;\n  private String username = \"lychen@sei.ecnu.edu.cn\";\n  private String password = \"1234567899\";\n  private String smtpServer = \"webmail.ecnu.edu.cn\";\n  \n  public void init()throws Exception\n  {\n    //è®¾ç½®å±æ€§\n    Properties  props = new Properties();\n    props.put(\"mail.transport.protocol\", \"smtp\");\n    props.put(\"mail.smtp.class\", \"com.sun.mail.smtp.SMTPTransport\");\n    props.put(\"mail.smtp.host\", smtpServer); //è®¾ç½®å‘é€é‚®ä»¶æœåŠ¡å™¨\n    props.put(\"mail.smtp.port\", \"25\");\n    props.put(\"mail.smtp.auth\", \"true\"); //SMTPæœåŠ¡å™¨éœ€è¦èº«ä»½éªŒè¯    \n\n    // åˆ›å»ºSessionå¯¹è±¡\n    session = Session.getInstance(props,new Authenticator(){   //éªŒè´¦è´¦æˆ· \n        public PasswordAuthentication getPasswordAuthentication() { \n          return new PasswordAuthentication(username, password); \n        }            \n });\n    session.setDebug(true); //è¾“å‡ºè·Ÿè¸ªæ—¥å¿—\n    \n    // åˆ›å»ºTransportå¯¹è±¡\n    transport = session.getTransport();           \n  }\n  \n  public void sendMessage()throws Exception{\n    //åˆ›å»ºä¸€ä¸ªé‚®ä»¶\n    //Message msg = TextMessage.generate();\n    //Message msg = HtmlMessage.generate();\n    Message msg = AttachmentMessage.generate();\n    //å‘é€é‚®ä»¶    \n    transport.connect();\n    transport.sendMessage(msg, msg.getAllRecipients());\n    //æ‰“å°ç»“æœ\n    System.out.println(\"é‚®ä»¶å·²ç»æˆåŠŸå‘é€\");\n  } \n  \n  public void close()throws Exception\n  {\n    transport.close();\n  }\n  \n  public static void main(String[] args)throws Exception {\n      \n    MailClientSend client=new MailClientSend();\n    //åˆå§‹åŒ–\n    client.init();\n    //å‘é€é‚®ä»¶\n    client.sendMessage();\n    //å…³é—­è¿æ¥\n    client.close();\n  }\n}\n\n//Text\nString from = \"lychen@sei.ecnu.edu.cn \"; // å‘ä»¶äººåœ°å€\nString to = \"chenliangyu1980@126.com\"; // æ”¶ä»¶äººåœ°å€\nString subject = \"test\";\nString body = \"æ‚¨å¥½,è¿™æ˜¯æ¥è‡ªä¸€å°chenliangyuçš„æµ‹è¯•é‚®ä»¶\";\n\n// åˆ›å»ºSessionå®ä¾‹å¯¹è±¡\nSession session = Session.getDefaultInstance(new Properties());\n// åˆ›å»ºMimeMessageå®ä¾‹å¯¹è±¡\nMimeMessage message = new MimeMessage(session);\n// è®¾ç½®å‘ä»¶äºº\nmessage.setFrom(new InternetAddress(from));\n// è®¾ç½®æ”¶ä»¶äºº\nmessage.setRecipients(Message.RecipientType.TO, InternetAddress.parse(to));\n// è®¾ç½®å‘é€æ—¥æœŸ\nmessage.setSentDate(new Date());\n// è®¾ç½®é‚®ä»¶ä¸»é¢˜\nmessage.setSubject(subject);\n// è®¾ç½®çº¯æ–‡æœ¬å†…å®¹çš„é‚®ä»¶æ­£æ–‡\nmessage.setText(body);\n// ä¿å­˜å¹¶ç”Ÿæˆæœ€ç»ˆçš„é‚®ä»¶å†…å®¹\nmessage.saveChanges();\nreturn message;\n\n//Html\nString from = \"lychen@sei.ecnu.edu.cn \"; // å‘ä»¶äººåœ°å€\nString to = \"chenliangyu1980@126.com\"; // æ”¶ä»¶äººåœ°å€\nString subject = \"HTMLé‚®ä»¶\";\nString body = \"<a href=http://www.ecnu.edu.cn>\" \n  + \"<h4>æ¬¢è¿å¤§å®¶è®¿é—®æˆ‘ä»¬çš„ç½‘ç«™</h4></a></br>\" \n  + \"<img src=\\\"https://news.ecnu.edu.cn/_upload/article/images/2e/e2/6b554d034c9192101208c732195e/16a6ec66-6729-4469-a5f4-0435e0f2e66a.jpg\\\">\";\n\n// åˆ›å»ºSessionå®ä¾‹å¯¹è±¡\nSession session = Session.getDefaultInstance(new Properties());\n// åˆ›å»ºMimeMessageå®ä¾‹å¯¹è±¡\nMimeMessage message = new MimeMessage(session);\n// è®¾ç½®å‘ä»¶äºº\nmessage.setFrom(new InternetAddress(from));\n// è®¾ç½®æ”¶ä»¶äºº\nmessage.setRecipients(Message.RecipientType.TO, InternetAddress.parse(to));\n// è®¾ç½®å‘é€æ—¥æœŸ\nmessage.setSentDate(new Date());\n// è®¾ç½®é‚®ä»¶ä¸»é¢˜\nmessage.setSubject(subject);\n// è®¾ç½®HTMLæ ¼å¼çš„é‚®ä»¶æ­£æ–‡\nmessage.setContent(body, \"text/html;charset=gb2312\");\n// ä¿å­˜å¹¶ç”Ÿæˆæœ€ç»ˆçš„é‚®ä»¶å†…å®¹\nmessage.saveChanges();\nreturn message;\n\n//Attachment\nString from = \"lychen@sei.ecnu.edu.cn \"; // å‘ä»¶äººåœ°å€\nString to = \"chenliangyu1980@126.com\"; // æ”¶ä»¶äººåœ°å€\nString subject = \"å¤šé™„ä»¶é‚®ä»¶\";        //é‚®ä»¶ä¸»é¢˜\nString body = \"<a href=http://www.ecnu.edu.cn>\" +\n              \"æ¬¢è¿å¤§å®¶è®¿é—®æˆ‘ä»¬çš„ç½‘ç«™</a></br>\"; \n\n// åˆ›å»ºSessionå®ä¾‹å¯¹è±¡\nSession session = Session.getDefaultInstance(new Properties());\n// åˆ›å»ºMimeMessageå®ä¾‹å¯¹è±¡\nMimeMessage message = new MimeMessage(session);            \nmessage.setFrom(new InternetAddress(from));\nmessage.setRecipients(Message.RecipientType.TO,\n        InternetAddress.parse(to));\nmessage.setSubject(subject);\n\n//åˆ›å»ºä»£è¡¨é‚®ä»¶æ­£æ–‡å’Œé™„ä»¶çš„å„ä¸ªMimeBodyPartå¯¹è±¡\nMimeBodyPart contentPart = createContent(body);\nMimeBodyPart attachPart1 = createAttachment(\"c:/temp/ecnu4.jpg\");\nMimeBodyPart attachPart2 = createAttachment(\"c:/temp/ecnu5.jpg\");\n\n//åˆ›å»ºç”¨äºç»„åˆé‚®ä»¶æ­£æ–‡å’Œé™„ä»¶çš„MimeMultipartå¯¹è±¡\nMimeMultipart allMultipart = new MimeMultipart(\"mixed\");\nallMultipart.addBodyPart(contentPart);\nallMultipart.addBodyPart(attachPart1);\nallMultipart.addBodyPart(attachPart2);\n\n//è®¾ç½®æ•´ä¸ªé‚®ä»¶å†…å®¹ä¸ºæœ€ç»ˆç»„åˆå‡ºçš„MimeMultipartå¯¹è±¡\nmessage.setContent(allMultipart);\nmessage.saveChanges();\nreturn message;\n\npublic static MimeBodyPart createContent(String body) throws Exception {\n    MimeBodyPart htmlBodyPart = new MimeBodyPart();          \n    htmlBodyPart.setContent(body,\"text/html;charset=gb2312\");\n    return htmlBodyPart;\n}\n\npublic static MimeBodyPart createAttachment(String filename) throws Exception {\n    //åˆ›å»ºä¿å­˜é™„ä»¶çš„MimeBodyPartå¯¹è±¡ï¼Œå¹¶åŠ å…¥é™„ä»¶å†…å®¹å’Œç›¸åº”ä¿¡æ¯\n    MimeBodyPart attachPart = new MimeBodyPart();\n    FileDataSource fds = new FileDataSource(filename);\n    attachPart.setDataHandler(new DataHandler(fds));\n    attachPart.setFileName(fds.getName());\n    return attachPart;\n}\n```","tags":["Java"],"categories":["Java","Javaè¿›é˜¶"]},{"title":"Java ç½‘ç»œç¼–ç¨‹","url":"/20210922/java-network-programming/","content":"## **1.åŸºç¡€çŸ¥è¯†**\n### portï¼šç«¯å£,0-65535\n- 0~1023, OSå·²ç»å ç”¨äº†ï¼Œ80æ˜¯Webï¼Œ23æ˜¯telnet\n- 1024~65535ï¼Œä¸€èˆ¬ç¨‹åºå¯ä½¿ç”¨(è°¨é˜²å†²çª) \n- ä¸¤å°æœºå™¨é€šè®¯å°±æ˜¯åœ¨IP+Portä¸Šè¿›è¡Œçš„\n- åœ¨Windows/Linux/Macä¸Šéƒ½å¯ä»¥é€šè¿‡netstat -anæ¥æŸ¥è¯¢\n\n### é€šè®¯åè®®ï¼šTCPå’ŒUDP\n- TCP(Transmission Control Protocol) \n    - ä¼ è¾“æ§åˆ¶åè®®ï¼Œé¢å‘**è¿æ¥**çš„åè®®\n    - ä¸¤å°æœºå™¨çš„**å¯é æ— å·®é”™**çš„æ•°æ®ä¼ è¾“\n    - **åŒå‘**å­—èŠ‚æµä¼ é€’\n- UDP(User Datagram Protocol) \n    - ç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼Œé¢å‘**æ— è¿æ¥**åè®®\n    - **ä¸ä¿è¯å¯é **çš„æ•°æ®ä¼ è¾“\n    - é€Ÿåº¦å¿«ï¼Œä¹Ÿå¯ä»¥åœ¨è¾ƒå·®ç½‘ç»œä¸‹ä½¿ç”¨\n\n## **2.UDPç¼–ç¨‹**\n- UDPï¼šæ— è¿æ¥æ— çŠ¶æ€çš„é€šè®¯åè®®\n- å‘é€æ–¹å‘é€æ¶ˆæ¯ï¼Œå¦‚æœæ¥æ”¶æ–¹åˆšå¥½åœ¨ç›®çš„åœ°ï¼Œåˆ™å¯ä»¥æ¥å—ã€‚å¦‚æœä¸åœ¨ï¼Œé‚£è¿™ä¸ªæ¶ˆæ¯å°±ä¸¢å¤±äº†\n- å‘é€æ–¹ä¹Ÿæ— æ³•å¾—çŸ¥æ˜¯å¦å‘é€æˆåŠŸ\n- UDPçš„å¥½å¤„å°±æ˜¯ç®€å•ï¼ŒèŠ‚çœï¼Œç»æµ\n\n### **ä¸»è¦ç±»**\n- DatagramSocketï¼šé€šè®¯çš„æ•°æ®ç®¡é“\n    - send å’Œreceiveæ–¹æ³•\n    - (å¯é€‰ï¼Œå¤šç½‘å¡)ç»‘å®šä¸€ä¸ªIPå’ŒPort\n- DatagramPacket\n    - é›†è£…ç®±ï¼šå°è£…æ•°æ®\n    - åœ°å€æ ‡ç­¾ï¼šç›®çš„åœ°IP+Port\n- æ— ä¸»æ¬¡ä¹‹åˆ†\n-  æ¥æ”¶æ–¹å¿…é¡»æ—©äºå‘èµ·æ–¹æ‰§è¡Œ\n```java\n//æ„é€ æœ¬æœº3000ç«¯å£Socket\nDatagramSocket ds=new DatagramSocket(3000);\n//æ„é€ æœ¬æœºéšæœºç«¯å£Socket\nDatagramSocket ds=new DatagramSocket();\n//Socketå…³é—­\nds.close();\n\n//æ„é€ æ¥æ”¶Packet\nbyte [] buf=new byte[1024];\nDatagramPacket dp=new DatagramPacket(buf,1024);\n//æ„é€ å‘é€Packetï¼Œç›®æ ‡ä¸º127.0.0.1:3000\nString str=\"hello world\";\nDatagramPacket dp=new DatagramPacket(str.getBytes(),str.length(),\n                                     InetAddress.getByName(\"127.0.0.1\"),3000);\n\n//æ¥æ”¶æ¶ˆæ¯æ”¾å…¥dpï¼Œå¦åˆ™é˜»å¡\nds.receive(dp);\n//å‘é€dpæ¶ˆæ¯è‡³æŒ‡å®šç«¯å£\nds.send(dp);\n```\n\n## **3.TCPç¼–ç¨‹**\n- TCPåè®®ï¼šæœ‰é“¾æ¥ã€ä¿è¯å¯é çš„æ— è¯¯å·®é€šè®¯\n- â‘ æœåŠ¡å™¨ï¼šåˆ›å»ºä¸€ä¸ªServerSocketï¼Œç­‰å¾…è¿æ¥\n- â‘¡å®¢æˆ·æœºï¼šåˆ›å»ºä¸€ä¸ªSocketï¼Œè¿æ¥åˆ°æœåŠ¡å™¨\n- â‘¢æœåŠ¡å™¨ï¼šServerSocketæ¥æ”¶åˆ°è¿æ¥ï¼Œåˆ›å»ºä¸€ä¸ªSocketå’Œå®¢æˆ·çš„Socketå»ºç«‹ä¸“çº¿è¿æ¥ï¼Œåç»­æœåŠ¡å™¨å’Œå®¢æˆ·æœºçš„å¯¹è¯(è¿™ä¸€å¯¹Socket)ä¼šåœ¨ä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹ï¼ˆæœåŠ¡å™¨ç«¯ï¼‰ä¸Šè¿è¡Œ\n- â‘£æœåŠ¡å™¨çš„ServerSocketç»§ç»­ç­‰å¾…è¿æ¥ï¼Œè¿”å›â‘ \n```mermaid\ngraph LR\nc1[Client1<br>Socket]--å®¢æˆ·ç«¯å‘å‡ºè¿æ¥-->ss[ServerSocket]\nc2[Client2<br>Socket]--å®¢æˆ·ç«¯å‘å‡ºè¿æ¥-->ss[ServerSocket]\nss--æœåŠ¡å™¨æ¥å—è¯·æ±‚å¹¶åˆ›å»ºæ–°çš„Socket-->s1[ä¸ºClient1åˆ›<br>å»ºçš„Socket]\nss--æœåŠ¡å™¨æ¥å—è¯·æ±‚å¹¶åˆ›å»ºæ–°çš„Socket-->s2[ä¸ºClient2åˆ›<br>å»ºçš„Socket]\nc1--ä¸¤ä¸ªSocketé—´å»ºç«‹ä¸“çº¿è¿æ¥-->s1\nc2--ä¸¤ä¸ªSocketé—´å»ºç«‹ä¸“çº¿è¿æ¥-->s2\n```\n\n### **ä¸»è¦ç±»**\n- ServerSocket: æœåŠ¡å™¨ç å¤´\n    - éœ€è¦ç»‘å®šport\n    - å¦‚æœæœ‰å¤šå—ç½‘å¡ï¼Œéœ€è¦ç»‘å®šä¸€ä¸ªIPåœ°å€\n- Socket: è¿è¾“é€šé“\n    - å®¢æˆ·ç«¯éœ€è¦ç»‘å®šæœåŠ¡å™¨çš„åœ°å€å’ŒPort\n    - å®¢æˆ·ç«¯å¾€Socketè¾“å…¥æµå†™å…¥æ•°æ®ï¼Œé€åˆ°æœåŠ¡ç«¯\n    - å®¢æˆ·ç«¯ä»Socketè¾“å‡ºæµå–æœåŠ¡å™¨ç«¯è¿‡æ¥çš„æ•°æ®\n    - æœåŠ¡ç«¯åä¹‹äº¦ç„¶\n```java\n//åˆ›å»ºæœåŠ¡å™¨Socket\nServerSocket ss = new ServerSocket(8001); //é©»å®ˆåœ¨8001ç«¯å£\n//æœåŠ¡å™¨åˆ›å»ºSocket\nSocket s = ss.accept(); //é˜»å¡ï¼Œç­‰åˆ°æœ‰å®¢æˆ·ç«¯è¿æ¥ä¸Šæ¥\n//Socketå…³é—­\ns.close();\nss.close();\n\n//æœåŠ¡å™¨åˆ›å»ºæµ\nInputStream ips = s.getInputStream(); // æœ‰äººè¿ä¸Šæ¥ï¼Œæ‰“å¼€è¾“å…¥æµ\nOutputStream ops = s.getOutputStream(); // æ‰“å¼€è¾“å‡ºæµ\n//æµå…³é—­\nips.close();\nops.close();\n\n//æœåŠ¡å™¨å‘é€æ¶ˆæ¯\nops.write(\"Hello, Client!\".getBytes()); //è¾“å‡ºä¸€å¥è¯ç»™å®¢æˆ·ç«¯\n\n//æœåŠ¡å™¨æ¥æ”¶æ¶ˆæ¯\nBufferedReader br = new BufferedReader(new InputStreamReader(ips));\nSystem.out.println(\"Client said: \" + br.readLine());\n\n//******************************************************************************\n//å®¢æˆ·ç«¯å»ºç«‹è¿æ¥\nSocket s = new Socket(InetAddress.getByName(\"127.0.0.1\"), 8001); //éœ€è¦æœåŠ¡ç«¯å…ˆå¼€å¯\n//Socketå…³é—­\ns.close();\n\n//åŒä¸€ä¸ªé€šé“ï¼ŒæœåŠ¡ç«¯çš„è¾“å‡ºæµå°±æ˜¯å®¢æˆ·ç«¯çš„è¾“å…¥æµï¼›æœåŠ¡ç«¯çš„è¾“å…¥æµå°±æ˜¯å®¢æˆ·ç«¯çš„è¾“å‡ºæµ\nInputStream ips = s.getInputStream(); // å¼€å¯é€šé“çš„è¾“å…¥æµ\nBufferedReader brNet = new BufferedReader(new InputStreamReader(ips));\nSystem.out.println(brNet.readLine());\nbrNet.close();\n\nOutputStream ops = s.getOutputStream(); // å¼€å¯é€šé“çš„è¾“å‡ºæµ\nDataOutputStream dos = new DataOutputStream(ops);\ndos.writeBytes(strWord);\ndos.close();\n```\n\n### **å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯**\n- æœåŠ¡ç«¯ç­‰å¾…å“åº”æ—¶ï¼Œå¤„äºé˜»å¡çŠ¶æ€\n- æœåŠ¡ç«¯å¯ä»¥åŒæ—¶å“åº”å¤šä¸ªå®¢æˆ·ç«¯\n- æœåŠ¡ç«¯æ¯æ¥å—ä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œå°±å¯åŠ¨ä¸€ä¸ªç‹¬ç«‹çš„çº¿ç¨‹ä¸ä¹‹å¯¹åº”\n- å®¢æˆ·ç«¯æˆ–è€…æœåŠ¡ç«¯éƒ½å¯ä»¥é€‰æ‹©å…³é—­è¿™å¯¹Socketçš„é€šé“\n\n## **4.HTTPç¼–ç¨‹**\n### **ç½‘é¡µè®¿é—®**\n- ç½‘é¡µæ˜¯ç‰¹æ®Šçš„ç½‘ç»œæœåŠ¡(HTTP, Hypertext Transfer Protocol) \n    -  åœ¨æµè§ˆå™¨è¾“å…¥URLåœ°å€\n    - æµè§ˆå™¨å°†è¿æ¥åˆ°è¿œç¨‹æœåŠ¡å™¨ä¸Š(IP+80Port)\n    - è¯·æ±‚ä¸‹è½½ä¸€ä¸ªHTMLæ–‡ä»¶ä¸‹æ¥ï¼Œæ”¾åˆ°æœ¬åœ°ä¸´æ—¶æ–‡ä»¶å¤¹ä¸­\n    - åœ¨æµè§ˆå™¨æ˜¾ç¤ºå‡ºæ¥\n\n### **è®¿é—®æ–¹å¼**\n- **GETï¼šä»æœåŠ¡å™¨è·å–èµ„æºåˆ°å®¢æˆ·ç«¯**\n- **POSTï¼šä»å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€æ•°æ®**\n- PUTï¼šä¸Šä¼ æ–‡ä»¶\n- DELETEï¼šåˆ é™¤æ–‡ä»¶\n- HEADï¼šæŠ¥æ–‡å¤´éƒ¨\n- OPTIONSï¼šè¯¢é—®æ”¯æŒçš„æ–¹æ³•\n- TRACEï¼šè¿½è¸ªè·¯å¾„\n- CONNECTï¼šç”¨éš§é“åè®®è¿æ¥ä»£ç†\n\n ### **java.netåŒ…**\n- æ”¯æŒæ¨¡æ‹Ÿæˆæµè§ˆå™¨çš„æ–¹å¼å»è®¿é—®ç½‘é¡µ\n- URLConnection\n    - è·å–èµ„æºçš„è¿æ¥å™¨\n    - æ ¹æ®URLçš„openConnection()æ–¹æ³•è·å¾—URLConnection\n    - connectæ–¹æ³•ï¼Œå»ºç«‹å’Œèµ„æºçš„è”ç³»é€šé“\n    - getInputStreamæ–¹æ³•ï¼Œè·å–èµ„æºçš„å†…å®¹\n```java\n//å»ºç«‹è¿æ¥\nString urlName = \"http://www.baidu.com\";\nURL url = new URL(urlName);\nURLConnection connection = url.openConnection(); \nconnection.connect();\n\n//å¤´éƒ¨ä¿¡æ¯\nMap<String, List<String>> headers = connection.getHeaderFields();\n\n//åŸºç¡€å±æ€§\nSystem.out.println(\"getContentType: \" + connection.getContentType());\nSystem.out.println(\"getContentLength: \" + connection.getContentLength());\nSystem.out.println(\"getContentEncoding: \" + connection.getContentEncoding());\nSystem.out.println(\"getDate: \" + connection.getDate());\nSystem.out.println(\"getExpiration: \" + connection.getExpiration());\nSystem.out.println(\"getLastModifed: \" + connection.getLastModified());\n\n//è·å¾—HTMLæµ\nBufferedReader br = new BufferedReader(new InputStreamReader(connection.getInputStream(), \"UTF-8\"));\n```\n\n## **5.HTTPç¼–ç¨‹ï¼ˆåŸºäºHttpClientï¼‰**\n- JDK HTTP Client ï¼ˆJDKè‡ªå¸¦ï¼Œä»9å¼€å§‹)\n- Apache HttpComponentsçš„HttpClient (Apacheå‡ºå“)\n\n### **JDK HttpClient**\n- JDK 9 æ–°å¢ï¼ŒJDK10æ›´æ–°ï¼ŒJDK11æ­£å¼å‘å¸ƒ\n- java.net.httpåŒ… â€¢ å–ä»£URLConnection\n- æ”¯æŒHTTP/1.1å’ŒHTTP/2\n- å®ç°å¤§éƒ¨åˆ†HTTPæ–¹æ³•\n- ä¸»è¦ç±»\n    - HttpClient\n    - HttpRequest\n    - HttpResponse\n```java\n//è·å¾—HTMLæµ\nHttpClient client = HttpClient.newHttpClient();\nHttpRequest request = HttpRequest.newBuilder(URI.create(\"http://www.baidu.com\")).build();\nHttpResponse response = client.send(request, HttpResponse.BodyHandlers.ofString());\nSystem.out.println(response.body());\n```\n\n### **HttpComponents**\n- hc.apache.org, Apacheå‡ºå“\n- ä»HttpClientè¿›åŒ–è€Œæ¥\n- æ˜¯ä¸€ä¸ªé›†æˆçš„Java HTTPå·¥å…·åŒ…\n    - å®ç°æ‰€æœ‰HTTPæ–¹æ³•ï¼šget/post/put/delete\n    - æ”¯æŒè‡ªåŠ¨è½¬å‘\n    - æ”¯æŒhttpsåè®®\n    - æ”¯æŒä»£ç†æœåŠ¡å™¨ç­‰\n```java\n//è·å¾—HTMLæµ\nCloseableHttpClient httpClient = HttpClients.createDefault();\nHttpGet httpGet = new HttpGet(\"http://www.baidu.com\");\nString srtResult = \"\";\ntry {\n    HttpResponse httpResponse = httpClient.execute(httpGet);\n    if(httpResponse.getStatusLine().getStatusCode() == 200){\n        srtResult = EntityUtils.toString(httpResponse.getEntity(), \"UTF-8\");//è·å¾—è¿”å›çš„ç»“æœ                \n        System.out.println(srtResult);\n    }else\n    {\n        //Exception TODO\n    }\n} catch (IOException e) {\n    e.printStackTrace();\n}finally {\n    try {\n        httpClient.close();\n    } catch (IOException e) {\n        e.printStackTrace();\n    }\n}\n```","tags":["Java"],"categories":["Java","Javaè¿›é˜¶"]},{"title":"Java å¤šçº¿ç¨‹å’Œå¹¶å‘ç¼–ç¨‹ï¼ˆç»­ï¼‰","url":"/20210922/java-multithread2/","content":"## **1.å¹¶å‘æ¡†æ¶Executor**\n- JDK 5å¼€å§‹æä¾›Executor FrameWork (java.util.concurrent.*)\n    - åˆ†ç¦»ä»»åŠ¡çš„åˆ›å»ºå’Œæ‰§è¡Œè€…çš„åˆ›å»º\n    - **çº¿ç¨‹é‡å¤åˆ©ç”¨(newçº¿ç¨‹ä»£ä»·å¾ˆå¤§)** \n\n### **å…±äº«çº¿ç¨‹æ± **\n- é¢„è®¾å¥½çš„å¤šä¸ªThreadï¼Œå¯å¼¹æ€§å¢åŠ \n- å¤šæ¬¡æ‰§è¡Œå¾ˆå¤šå¾ˆå°çš„ä»»åŠ¡\n- ä»»åŠ¡åˆ›å»ºå’Œæ‰§è¡Œè¿‡ç¨‹è§£è€¦\n- **ç¨‹åºå‘˜æ— éœ€å…³å¿ƒçº¿ç¨‹æ± æ‰§è¡Œä»»åŠ¡è¿‡ç¨‹**\n\n### **ä¸»è¦ç±»**\n- Executors.newCachedThreadPool/newFixedThreadPool åˆ›å»ºçº¿ç¨‹æ± \n- ExecutorService çº¿ç¨‹æ± æœåŠ¡\n- Callable å…·ä½“çš„é€»è¾‘å¯¹è±¡(çº¿ç¨‹ç±»)\n    - **ï¼ˆRunnableçš„runæ–¹æ³•æ²¡æœ‰è¿”å›å€¼ï¼Œè€ŒCallableçš„callæ–¹æ³•å¯ä»¥æœ‰è¿”å›å€¼ï¼‰**\n- Future è¿”å›ç»“æœ\n```java\n//åˆ›å»ºå¯å˜çº¿ç¨‹æ± \nprivate ThreadPoolExecutor executor = (ThreadPoolExecutor)Executors.newCachedThreadPool();\n//åˆ›å»ºå›ºå®šçº¿ç¨‹æ± \nprivate ThreadPoolExecutor executor = (ThreadPoolExecutor)Executors.newFixedThreadPool(5);\n\n//å…³é—­çº¿ç¨‹æ± \nexecutor.shutdown();\n\n//æ‰§è¡Œä»»åŠ¡ï¼Œæ— è¿”å›å€¼\nexecutor.execute(task);\n//æ‰§è¡Œä»»åŠ¡ï¼Œæœ‰è¿”å›å€¼\nFuture<Integer> result=executor.submit(task);\n/*\npublic class Task implements Callable<Integer> {\n    @Override\n    public Integer call() throws Exception {\n        return null;\n    }\n}\n*/\n\n//çº¿ç¨‹æ± åŸºç¡€ä¿¡æ¯\nSystem.out.println(executor.getPoolSize());\nSystem.out.println(executor.getActiveCount());\nSystem.out.println(executor.getCompletedTaskCount());\n\n//Futureè¿”å›ç±»åŸºæœ¬æ“ä½œ\nresult.isDone() //åˆ¤æ–­ä»»åŠ¡æ˜¯å¦å®Œæˆ\nint sum=result.get(); //è·å¾—ç»“æœ\n```\n\n## **2.å¹¶å‘æ¡†æ¶Fork-join**\n- Java 7 æä¾›å¦ä¸€ç§å¹¶è¡Œæ¡†æ¶ï¼šåˆ†è§£ã€æ²»ç†ã€åˆå¹¶(**åˆ†æ²»ç¼–ç¨‹**) \n- é€‚åˆç”¨äºæ•´ä½“ä»»åŠ¡é‡ä¸å¥½ç¡®å®šçš„åœºåˆ(**æœ€å°ä»»åŠ¡å¯ç¡®å®š**)\n### **ä¸»è¦ç±»**\n- ForkJoinPool ä»»åŠ¡æ± \n- RecursiveAction\n- RecursiveTask\n```java\n//åˆ›å»ºæ‰§è¡Œçº¿ç¨‹æ± \nForkJoinPool pool = new ForkJoinPool();\nForkJoinPool pool = new ForkJoinPool(4); //å›ºå®šçº¿ç¨‹æ± \n\n//åˆ›å»ºä»»åŠ¡\nTask task = new Task(1, 10000000);\n/*\npublic class Task extends RecursiveTask<Integer> {\n    @Override\n    protected Integer compute() {\n        //ä»»åŠ¡è¶³å¤Ÿå°ï¼Œåˆ™ç›´æ¥æ‰§è¡Œ\n        //TODO\n        //ä»»åŠ¡å¤§äºé˜ˆå€¼ï¼Œåˆ†è£‚ä¸º2ä¸ªä»»åŠ¡\n        invokeAll(subTask1,subTask2);\n        Integer sum1 = subTask1.join();\n        Integer sum2 = subTask2.join();\n        // ç»“æœåˆå¹¶\n        sum = sum1 + sum2;\n        return sum;\n    }\n}\n*/\n\n//æäº¤ä»»åŠ¡\nForkJoinTask<Integer> result = pool.submit(task);\n\n//è¾“å‡ºç»“æœ\nSystem.out.println(result.get().toString());\n```\n\n## **3.å¹¶å‘æ•°æ®ç»“æ„**\n- å¸¸ç”¨çš„æ•°æ®ç»“æ„æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„\n    - ArrayList, HashMap, HashSet éåŒæ­¥çš„\n    - å¤šä¸ªçº¿ç¨‹åŒæ—¶è¯»å†™ï¼Œå¯èƒ½ä¼šæŠ›å‡ºå¼‚å¸¸æˆ–æ•°æ®é”™è¯¯\n- ä¼ ç»ŸVectorï¼ŒHashtableç­‰åŒæ­¥é›†åˆæ€§èƒ½è¿‡å·®\n- å¹¶å‘æ•°æ®ç»“æ„ï¼šæ•°æ®æ·»åŠ å’Œåˆ é™¤\n    - é˜»å¡å¼é›†åˆï¼šå½“é›†åˆä¸ºç©ºæˆ–è€…æ»¡æ—¶ï¼Œç­‰å¾…\n    - éé˜»å¡å¼é›†åˆï¼šå½“é›†åˆä¸ºç©ºæˆ–è€…æ»¡æ—¶ï¼Œä¸ç­‰å¾…ï¼Œè¿”å›nullæˆ–å¼‚å¸¸\n\n- List\n    - Vector åŒæ­¥å®‰å…¨ï¼Œå†™å¤šè¯»å°‘\n    - ArrayList ä¸å®‰å…¨\n    - Collections.synchronizedList(List list) åŸºäºsynchronizedï¼Œæ•ˆç‡å·®\n    - CopyOnWriteArrayList **è¯»å¤šå†™å°‘**ï¼ŒåŸºäºå¤åˆ¶æœºåˆ¶ï¼Œéé˜»å¡\n- Set \n    - HashSet ä¸å®‰å…¨\n    - Collections.synchronizedSet(Set set) åŸºäºsynchronizedï¼Œæ•ˆç‡å·®\n    - CopyOnWriteArraySet (åŸºäºCopyOnWriteArrayListå®ç°) **è¯»å¤šå†™å°‘**ï¼Œéé˜»å¡\n- Map \n    - Hashtable åŒæ­¥å®‰å…¨ï¼Œå†™å¤šè¯»å°‘\n    - HashMap ä¸å®‰å…¨\n    - Collections.synchronizedMap(Map map) åŸºäºsynchronizedï¼Œæ•ˆç‡å·®\n    - ConcurrentHashMap **è¯»å¤šå†™å°‘**ï¼Œéé˜»å¡\n- Queue & Deque **(é˜Ÿåˆ—ï¼ŒJDK 1.5 æå‡º)** \n    - ConcurrentLinkedQueue éé˜»å¡\n    - ArrayBlockingQueue/LinkedBlockingQueue é˜»å¡\n\n## **4.å¹¶å‘åä½œæ§åˆ¶**\n### **Lock**\n- Lockä¹Ÿå¯ä»¥å®ç°åŒæ­¥çš„æ•ˆæœ\n    - å®ç°æ›´å¤æ‚çš„ä¸´ç•ŒåŒºç»“æ„\n    - tryLockæ–¹æ³•å¯ä»¥é¢„åˆ¤é”æ˜¯å¦ç©ºé—²\n    - å…è®¸åˆ†ç¦»è¯»å†™çš„æ“ä½œï¼Œå¤šä¸ªè¯»ï¼Œä¸€ä¸ªå†™\n    - æ€§èƒ½æ›´å¥½\n- ReentrantLockç±»ï¼Œå¯é‡å…¥çš„äº’æ–¥é”\n- ReentrantReadWriteLockç±»ï¼Œå¯é‡å…¥çš„è¯»å†™é”\n- lockå’Œunlockå‡½æ•°\n```java\n//æ„é€ é”\nprivate static final ReentrantLock queueLock = new ReentrantLock(); //å¯é‡å…¥é”\nprivate static final ReentrantReadWriteLock orderLock = new ReentrantReadWriteLock(); //å¯é‡å…¥è¯»å†™é”\n\n//åŸºæœ¬å‡½æ•°\nqueueLock.tryLock()//å°è¯•åŠ é”(åŒ…å«lock)ï¼Œè¿”å›boolean\nqueueLock.lock() //åŠ é”\nqueueLock.unlock()//è§£é”\norderLock.writeLock().lock()/unlock() //å†™åŠ é”/è§£é”(å†™é”åªèƒ½ä¸€ä¸ªçº¿ç¨‹æ‹¥æœ‰)\norderLock.readLock().lock()/unlock() //è¯»åŠ é”/è§£é”(è¯»é”å¤šä¸ªçº¿ç¨‹å…±äº«)\n```\n\n### **Semaphore**\n- ä¿¡å·é‡ï¼šæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªè®¡æ•°å™¨\n- è®¡æ•°å™¨å¤§äº0ï¼Œå¯ä»¥ä½¿ç”¨ï¼Œç­‰äº0ä¸èƒ½ä½¿ç”¨\n- å¯ä»¥è®¾ç½®å¤šä¸ªå¹¶å‘é‡ï¼Œä¾‹å¦‚é™åˆ¶10ä¸ªè®¿é—®\n- Semaphore\n    - acquireè·å–\n    - releaseé‡Šæ”¾\n- æ¯”Lockæ›´è¿›ä¸€æ­¥ï¼Œå¯ä»¥æ§åˆ¶å¤šä¸ªåŒæ—¶è®¿é—®å…³é”®åŒº\n```java\n//æ„é€ ä¿¡å·é‡\nprivate final Semaphore placeSemaphore = new Semaphore(5);\n\n//è·å–ï¼ˆä¿¡å·é‡-1ï¼‰\nplaceSemaphore.acquire();\n//å°è¯•è·å–ï¼ˆåŒ…å«acquireï¼‰\nplaceSemaphore.tryAcquire()\n\n//é‡Šæ”¾ï¼ˆä¿¡å·é‡+1ï¼‰\nplaceSemaphore.release();\n```\n\n### **Latch**\n- ç­‰å¾…é”ï¼Œæ˜¯ä¸€ä¸ªåŒæ­¥è¾…åŠ©ç±»\n- ç”¨æ¥åŒæ­¥æ‰§è¡Œä»»åŠ¡çš„ä¸€ä¸ªæˆ–è€…å¤šä¸ªçº¿ç¨‹\n- ä¸æ˜¯ç”¨æ¥ä¿æŠ¤ä¸´ç•ŒåŒºæˆ–è€…å…±äº«èµ„æº\n- CountDownLatch\n    -  countDown() è®¡æ•°å‡1\n    -  await() ç­‰å¾…latchå˜æˆ0\n```java\n//æ„é€ ç­‰å¾…é”\nCountDownLatch startSignal = new CountDownLatch(1);\n\n//è®¡æ•°å‡1\nstartSignal.countDown();\n\n//ç­‰å¾…latchå˜æˆ0\nstartSignal.await();\n```\n\n### **Barrier**\n- é›†åˆç‚¹ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªåŒæ­¥è¾…åŠ©ç±»\n- å…è®¸å¤šä¸ªçº¿ç¨‹åœ¨æŸä¸€ä¸ªç‚¹ä¸Šè¿›è¡ŒåŒæ­¥\n- CyclicBarrier\n    - æ„é€ å‡½æ•°æ˜¯éœ€è¦åŒæ­¥çš„çº¿ç¨‹æ•°é‡\n    - awaitç­‰å¾…å…¶ä»–çº¿ç¨‹ï¼Œåˆ°è¾¾æ•°é‡åï¼Œå°±æ”¾è¡Œ\n```java\n//å½“æœ‰3ä¸ªçº¿ç¨‹åœ¨barrierä¸Šawaitï¼Œå°±æ‰§è¡ŒfinalResultCalculatorä¸­çš„runæ–¹æ³•\nCalculateFinalResult finalResultCalculator = new CalculateFinalResult(results);\nCyclicBarrier barrier = new CyclicBarrier(3, finalResultCalculator);\n//class CalculateFinalResult implements Runnable {}\n\n//ç­‰å¾…\nbarrier.await();\n```\n\n### **Phaser**\n- å…è®¸æ‰§è¡Œå¹¶å‘å¤šé˜¶æ®µä»»åŠ¡ï¼ŒåŒæ­¥è¾…åŠ©ç±»\n- åœ¨æ¯ä¸€ä¸ªé˜¶æ®µç»“æŸçš„ä½ç½®å¯¹çº¿ç¨‹è¿›è¡ŒåŒæ­¥ï¼Œå½“æ‰€æœ‰çš„çº¿ç¨‹éƒ½åˆ°è¾¾è¿™æ­¥ï¼Œå†è¿›è¡Œä¸‹ä¸€æ­¥\n- Phaser\n    - arrive()    \n    - arriveAndAwaitAdvance()\n```java\n//æ„é€ \nPhaser phaser = new Phaser(5);\n\n//ç­‰åˆ°5ä¸ªçº¿ç¨‹éƒ½åˆ°äº†ï¼Œæ‰æ”¾è¡Œ\nphaser.arriveAndAwaitAdvance(); \n```\n\n### **Exchanger**\n- å…è®¸åœ¨å¹¶å‘çº¿ç¨‹ä¸­äº’ç›¸äº¤æ¢æ¶ˆæ¯\n- å…è®¸åœ¨2ä¸ªçº¿ç¨‹ä¸­å®šä¹‰åŒæ­¥ç‚¹ï¼Œå½“ä¸¤ä¸ªçº¿ç¨‹éƒ½åˆ°è¾¾åŒæ­¥ç‚¹ï¼Œå®ƒä»¬äº¤æ¢æ•°æ®ç»“æ„\n- Exchanger\n    - exchange(), çº¿ç¨‹åŒæ–¹äº’ç›¸äº¤äº’æ•°æ®\n    - äº¤æ¢æ•°æ®æ˜¯åŒå‘çš„\n```java\n//æ„é€ ï¼Œäº¤æ¢ç±»å‹ä¸ºString\nExchanger<String> exchanger = new Exchanger<String>();\n\n//å¯¹å¤–äº¤æ¢null,è·å¾—å†…å®¹æ”¾å…¥itemä¸­\nString item = exchanger.exchange(null);\n```\n\n## **5.å®šæ—¶ä»»åŠ¡æ‰§è¡Œ**\n### **ç®€å•å®šæ—¶å™¨æœºåˆ¶**\n- è®¾ç½®è®¡åˆ’ä»»åŠ¡ï¼Œä¹Ÿå°±æ˜¯åœ¨æŒ‡å®šçš„æ—¶é—´å¼€å§‹æ‰§è¡ŒæŸä¸€ä¸ªä»»åŠ¡ã€‚ \n- TimerTask å°è£…ä»»åŠ¡\n- Timerç±» å®šæ—¶å™¨\n```java\n/*\nclass Task extends TimerTask {\n    public void run() {\n        //TODO\n    }\n}\n*/\n//å½“å‰æ—¶é—´1ç§’åï¼Œæ¯2ç§’æ‰§è¡Œä¸€æ¬¡\ntimer.schedule(task, 1000, 2000);\n\n//å–æ¶ˆå½“å‰çš„ä»»åŠ¡\ntask.cancel();\n//å–æ¶ˆå®šæ—¶å™¨\ntimer.cancel(); \n```\n\n### **Executor +å®šæ—¶å™¨æœºåˆ¶**\n- ScheduledExecutorService\n    - å®šæ—¶ä»»åŠ¡\n    - å‘¨æœŸä»»åŠ¡\n```java\n//å›ºå®šæ—¶é—´ï¼ˆ1såï¼‰å¯åŠ¨\nScheduledExecutorService executor = Executors.newScheduledThreadPool(1);\nexecutor.schedule(new MyTask(),1,TimeUnit.SECONDS);\n\n//å‘¨æœŸä»»åŠ¡ å›ºå®šé€Ÿç‡ æ˜¯ä»¥ä¸Šä¸€ä¸ªä»»åŠ¡å¼€å§‹çš„æ—¶é—´è®¡æ—¶ï¼Œperiodæ—¶é—´è¿‡å»åï¼Œæ£€æµ‹ä¸Šä¸€ä¸ªä»»åŠ¡æ˜¯å¦æ‰§è¡Œå®Œæ¯•\n//å¦‚æœä¸Šä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œåˆ™å½“å‰ä»»åŠ¡ç«‹å³æ‰§è¡Œï¼Œå¦‚æœä¸Šä¸€ä¸ªä»»åŠ¡æ²¡æœ‰æ‰§è¡Œå®Œæ¯•ï¼Œåˆ™éœ€è¦ç­‰ä¸Šä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæ¯•åç«‹å³æ‰§è¡Œ\nScheduledExecutorService executor = Executors.newScheduledThreadPool(1);\nexecutor.scheduleAtFixedRate(new MyTask(),1,3000,TimeUnit.MILLISECONDS);\n\n//å‘¨æœŸä»»åŠ¡ å›ºå®šå»¶æ—¶ æ˜¯ä»¥ä¸Šä¸€ä¸ªä»»åŠ¡ç»“æŸæ—¶å¼€å§‹è®¡æ—¶ï¼Œperiodæ—¶é—´è¿‡å»åï¼Œç«‹å³æ‰§è¡Œ\nScheduledExecutorService executor = Executors.newScheduledThreadPool(1);\nexecutor.scheduleWithFixedDelay(new MyTask(),1,3000,TimeUnit.MILLISECONDS);\n```\n\n### **Quartz**\n- Quartzæ˜¯ä¸€ä¸ªè¾ƒä¸ºå®Œå–„çš„ä»»åŠ¡è°ƒåº¦æ¡†æ¶\n- è§£å†³ç¨‹åºä¸­Timeré›¶æ•£ç®¡ç†çš„é—®é¢˜\n- åŠŸèƒ½æ›´åŠ å¼ºå¤§\n    - Timeræ‰§è¡Œå‘¨æœŸä»»åŠ¡ï¼Œå¦‚æœä¸­é—´æŸä¸€æ¬¡æœ‰å¼‚å¸¸ï¼Œæ•´ä¸ªä»»åŠ¡ç»ˆæ­¢æ‰§è¡Œ\n    - Quartzæ‰§è¡Œå‘¨æœŸä»»åŠ¡ï¼Œå¦‚æœä¸­é—´æŸä¸€æ¬¡æœ‰å¼‚å¸¸ï¼Œä¸å½±å“ä¸‹æ¬¡ä»»åŠ¡æ‰§è¡Œ\n    - â€¦â€¦\n```java\nimport org.quartz.JobDetail;\nimport org.quartz.Scheduler;\nimport org.quartz.Trigger;\nimport org.quartz.impl.StdSchedulerFactory;\n\nimport static org.quartz.JobBuilder.newJob;\nimport static org.quartz.SimpleScheduleBuilder.simpleSchedule;\nimport static org.quartz.TriggerBuilder.newTrigger;\n\n//åˆ›å»ºscheduler\nScheduler scheduler = StdSchedulerFactory.getDefaultScheduler();\n\n//å®šä¹‰ä¸€ä¸ªTrigger\nTrigger trigger = newTrigger().withIdentity(\"trigger1\", \"group1\") //å®šä¹‰name/group\n        .startNow()//ä¸€æ—¦åŠ å…¥schedulerï¼Œç«‹å³ç”Ÿæ•ˆ\n        .withSchedule(simpleSchedule() //ä½¿ç”¨SimpleTrigger\n                .withIntervalInSeconds(2) //æ¯éš”2ç§’æ‰§è¡Œä¸€æ¬¡\n                .repeatForever()) //ä¸€ç›´æ‰§è¡Œ\n        .build();\n\n//å®šä¹‰ä¸€ä¸ªJobDetail\nJobDetail job = newJob(HelloJob.class) //å®šä¹‰Jobç±»ä¸ºHelloQuartzç±»\n        .withIdentity(\"job1\", \"group1\") //å®šä¹‰name/group\n        .usingJobData(\"name\", \"quartz\") //å®šä¹‰å±æ€§\n        .build();\n\n/*\npublic class HelloJob implements Job {\n    @Override\n    public void execute(JobExecutionContext context) throws JobExecutionException {\n        //TODO\n    }\n}\n*/\n\n//åŠ å…¥è¿™ä¸ªè°ƒåº¦\nscheduler.scheduleJob(job, trigger);\n\n//å¯åŠ¨\nscheduler.start();\n\n//è¿è¡Œä¸€æ®µæ—¶é—´åå…³é—­\nThread.sleep(10000);\nscheduler.shutdown(true);\n```","tags":["Java"],"categories":["Java","Javaè¿›é˜¶"]},{"title":"Java å¤šçº¿ç¨‹å’Œå¹¶å‘ç¼–ç¨‹","url":"/20210922/java-multithread/","content":"## **1.æ¦‚å¿µ**\n- ä¸€ä¸ªç¨‹åºå¯ä»¥åŒ…æ‹¬å¤šä¸ªå­ä»»åŠ¡ï¼Œå¯ä¸²/å¹¶è¡Œ\n- æ¯ä¸ªå­ä»»åŠ¡å¯ä»¥ç§°ä¸ºä¸€ä¸ªçº¿ç¨‹\n- å¦‚æœä¸€ä¸ªå­ä»»åŠ¡é˜»å¡ï¼Œç¨‹åºå¯ä»¥å°†CPUè°ƒåº¦å¦å¤–ä¸€ä¸ªå­ä»»åŠ¡è¿›è¡Œå·¥ä½œã€‚è¿™æ ·CPUè¿˜æ˜¯ä¿ç•™åœ¨æœ¬ç¨‹åºä¸­ï¼Œè€Œä¸æ˜¯è¢«è°ƒåº¦åˆ°åˆ«çš„ç¨‹åº(è¿›ç¨‹)å»ã€‚è¿™æ ·ï¼Œæé«˜æœ¬ç¨‹åºæ‰€è·å¾—CPUæ—¶é—´å’Œåˆ©ç”¨ç‡\n\n## **2.å¤šçº¿ç¨‹å®ç°**\n### **å¤šçº¿ç¨‹åˆ›å»º**\n- java.lang.Thread\n    - çº¿ç¨‹ç»§æ‰¿Threadç±»ï¼Œå®ç°runæ–¹æ³•\n    ```java\n    public class Thread1 extends Thread {\n        public void run() {\n            System.out.println(\"run\");\n        }\n    }\n    ```\n- java.lang.Runnableæ¥å£\n    - çº¿ç¨‹å®ç°Runnableæ¥å£ï¼Œå®ç°runæ–¹æ³•\n    ```java\n    public class Thread2 implements Runnable {\n        public void run() {\n            System.out.println(\"run\");\n        }\n    }\n    ```\n\n### **å¤šçº¿ç¨‹å¯åŠ¨**\n- **startæ–¹æ³•ï¼Œä¼šè‡ªåŠ¨ä»¥æ–°è¿›ç¨‹è°ƒç”¨runæ–¹æ³•**\n```java\n//ç»§æ‰¿Threadç±»\nnew Thread1().start();\n\n//å®ç°Runnableæ¥å£,å¿…é¡»åŒ…è£…åœ¨Threadç±»ä¸­æ‰èƒ½å¯åŠ¨\nnew Thread(new Thread2()).start();\n```\n- **ç›´æ¥è°ƒç”¨runæ–¹æ³•ï¼Œå°†å˜æˆä¸²è¡Œæ‰§è¡Œ**\n- **åŒä¸€ä¸ªçº¿ç¨‹ï¼Œå¤šæ¬¡startä¼šæŠ¥é”™ï¼Œåªæ‰§è¡Œç¬¬ä¸€æ¬¡startæ–¹æ³•**\n- å¤šä¸ªçº¿ç¨‹å¯åŠ¨ï¼Œå…¶å¯åŠ¨çš„å…ˆåé¡ºåºæ˜¯éšæœºçš„\n- çº¿ç¨‹æ— éœ€å…³é—­ï¼Œåªè¦å…¶runæ–¹æ³•æ‰§è¡Œç»“æŸåï¼Œè‡ªåŠ¨å…³é—­\n- mainå‡½æ•°(çº¿ç¨‹)å¯èƒ½æ—©äºæ–°çº¿ç¨‹ç»“æŸï¼Œæ•´ä¸ªç¨‹åºå¹¶ä¸ç»ˆæ­¢\n- æ•´ä¸ªç¨‹åºç»ˆæ­¢æ˜¯ç­‰æ‰€æœ‰çš„çº¿ç¨‹éƒ½ç»ˆæ­¢(åŒ…æ‹¬mainå‡½æ•°çº¿ç¨‹)\n\n### **å®ç°å¯¹æ¯”**\n- Thread vs Runnable\n    - **Threadå æ®äº†çˆ¶ç±»çš„åé¢ï¼Œä¸å¦‚Runnableæ–¹ä¾¿**\n    - Thread ç±»å®ç°Runnable\n    - Runnableå¯åŠ¨æ—¶éœ€è¦Threadç±»çš„æ”¯æŒ\n    - Runnable æ›´å®¹æ˜“å®ç°å¤šçº¿ç¨‹ä¸­èµ„æºå…±äº«\n- ç»“è®ºï¼šå»ºè®®å®ç°Runnableæ¥å£æ¥å®Œæˆå¤šçº¿ç¨‹\n\n## **3.å¤šçº¿ç¨‹ä¿¡æ¯å…±äº«**\n- é€šè¿‡å…±äº«å˜é‡åœ¨å¤šä¸ªçº¿ç¨‹ä¸­å…±äº«æ¶ˆæ¯\n    - å¦‚æœç»§æ‰¿äº†Threadç±»ï¼Œåªèƒ½ä½¿ç”¨staticå˜é‡\n    - å¦‚æœå®ç°äº†Runnableæ¥å£ï¼Œå¯ä»¥ä½¿ç”¨åŒä¸€ä¸ªæˆå‘˜å˜é‡\n\n### **ä¿¡æ¯å…±äº«é—®é¢˜**\n- å·¥ä½œç¼“å­˜å‰¯æœ¬\n    - è§£å†³æ–¹æ³•\n        - é‡‡ç”¨**volatile**å…³é”®å­—ä¿®é¥°å˜é‡\n        ```java\n        private volatile boolean flag = false;\n        ```\n        - ä¿è¯ä¸åŒçº¿ç¨‹å¯¹å…±äº«å˜é‡æ“ä½œæ—¶çš„å¯è§æ€§\n- å…³é”®æ­¥éª¤ç¼ºä¹åŠ é”é™åˆ¶\n    - è§£å†³æ–¹æ³•ï¼šå…³é”®æ­¥éª¤åŠ é”é™åˆ¶\n        - äº’æ–¥ï¼šæŸä¸€ä¸ªçº¿ç¨‹è¿è¡Œä¸€ä¸ªä»£ç æ®µ(å…³é”®åŒº)ï¼Œå…¶ä»–çº¿ç¨‹ä¸èƒ½åŒæ—¶è¿è¡Œè¿™ä¸ªä»£ç æ®µ\n        - åŒæ­¥ï¼šå¤šä¸ªçº¿ç¨‹çš„è¿è¡Œï¼Œå¿…é¡»æŒ‰ç…§æŸä¸€ç§è§„å®šçš„å…ˆåé¡ºåºæ¥è¿è¡Œ\n        - äº’æ–¥æ˜¯åŒæ­¥çš„ä¸€ç§ç‰¹ä¾‹\n    - äº’æ–¥çš„å…³é”®å­—æ˜¯synchronized\n        - **synchronizedä»£ç å—/å‡½æ•°ï¼Œåªèƒ½ä¸€ä¸ªçº¿ç¨‹è¿›å…¥**\n        - synchronizedåŠ å¤§æ€§èƒ½è´Ÿæ‹…ï¼Œä½†æ˜¯ä½¿ç”¨ç®€ä¾¿\n        ```java\n        public synchronized void sale() {\n            //TODO\n        }\n        //ç­‰åŒäº\n        public void sale() {\n            synchronized(this) {\n                //TODO\n            }\n        }\n        ```\n\n## **4.å¤šçº¿ç¨‹ç®¡ç†**\n### **çº¿ç¨‹çŠ¶æ€**\n- NEW åˆšåˆ›å»º(new)\n- RUNNABLE å°±ç»ªæ€(start)\n- RUNNING è¿è¡Œä¸­(run)\n- BLOCK é˜»å¡(sleep)\n- TERMINATED ç»“æŸ\n\n- Threadçš„éƒ¨åˆ†APIå·²ç»åºŸå¼ƒ\n    - æš‚åœå’Œæ¢å¤ suspend/resume\n    - æ¶ˆäº¡ stop/destroy\n- çº¿ç¨‹é˜»å¡/å’Œå”¤é†’\n    - sleepï¼Œæ—¶é—´ä¸€åˆ°ï¼Œè‡ªå·±ä¼šé†’æ¥\n    - wait/notify/notifyAllï¼Œç­‰å¾…ï¼Œéœ€è¦åˆ«äººæ¥å”¤é†’\n    - joinï¼Œç­‰å¾…å¦å¤–ä¸€ä¸ªçº¿ç¨‹ç»“æŸ\n    - interruptï¼Œå‘å¦å¤–ä¸€ä¸ªçº¿ç¨‹å‘é€ä¸­æ–­ä¿¡å·ï¼Œè¯¥çº¿ç¨‹æ”¶åˆ°ä¿¡å·ï¼Œä¼šè§¦å‘InterruptedException(å¯è§£é™¤é˜»å¡)ï¼Œå¹¶è¿›è¡Œä¸‹ä¸€æ­¥å¤„ç†\n\n- çº¿ç¨‹è¢«åŠ¨åœ°æš‚åœå’Œç»ˆæ­¢\n    - ä¾é åˆ«çš„çº¿ç¨‹æ¥æ‹¯æ•‘è‡ªå·±\n    - æ²¡æœ‰åŠæ—¶é‡Šæ”¾èµ„æº\n- çº¿ç¨‹ä¸»åŠ¨æš‚åœå’Œç»ˆæ­¢\n    - å®šæœŸç›‘æµ‹å…±äº«å˜é‡\n    - å¦‚æœéœ€è¦æš‚åœæˆ–è€…ç»ˆæ­¢ï¼Œå…ˆé‡Šæ”¾èµ„æºï¼Œå†ä¸»åŠ¨åŠ¨ä½œ\n    - æš‚åœï¼šThread.sleep()ï¼Œä¼‘çœ \n    - ç»ˆæ­¢ï¼šrunæ–¹æ³•ç»“æŸï¼Œçº¿ç¨‹ç»ˆæ­¢\n\n- å¤šçº¿ç¨‹æ­»é”\n    - æ¯ä¸ªçº¿ç¨‹äº’ç›¸æŒæœ‰åˆ«äººéœ€è¦çš„é”\n    - **é¢„é˜²æ­»é”ï¼Œå¯¹èµ„æºè¿›è¡Œç­‰çº§æ’åº**\n- å®ˆæŠ¤(åå°)çº¿ç¨‹\n    - æ™®é€šçº¿ç¨‹çš„ç»“æŸï¼Œæ˜¯runæ–¹æ³•è¿è¡Œç»“æŸ\n    - å®ˆæŠ¤çº¿ç¨‹çš„ç»“æŸï¼Œæ˜¯runæ–¹æ³•è¿è¡Œç»“æŸï¼Œæˆ–mainå‡½æ•°ç»“æŸ\n    - **å®ˆæŠ¤çº¿ç¨‹æ°¸è¿œä¸è¦è®¿é—®èµ„æºï¼Œå¦‚æ–‡ä»¶æˆ–æ•°æ®åº“ç­‰**\n    ```java\n    Thread1 t = new Thread1();\n    t.setDaemon(true);\n    t.start();\n    ```\n- çº¿ç¨‹æŸ¥çœ‹å·¥å…· jvisualvm\n\n### **çº¿ç¨‹ç»„ç®¡ç†**\n- çº¿ç¨‹ç»„ThreadGroup\n    - çº¿ç¨‹çš„é›†åˆ\n    - æ ‘å½¢ç»“æ„ï¼Œå¤§çº¿ç¨‹ç»„å¯ä»¥åŒ…æ‹¬å°çº¿ç¨‹ç»„\n    - å¯ä»¥é€šè¿‡enumerateæ–¹æ³•éå†ç»„å†…çš„çº¿ç¨‹ï¼Œæ‰§è¡Œæ“ä½œ\n    - èƒ½å¤Ÿæœ‰æ•ˆç®¡ç†å¤šä¸ªçº¿ç¨‹ï¼Œä½†æ˜¯**ç®¡ç†æ•ˆç‡ä½**\n    - ä»»åŠ¡åˆ†é…å’Œæ‰§è¡Œè¿‡ç¨‹**é«˜åº¦è€¦åˆ**\n    - é‡å¤åˆ›å»ºçº¿ç¨‹ã€å…³é—­çº¿ç¨‹æ“ä½œï¼Œ**æ— æ³•é‡ç”¨çº¿ç¨‹**\n```java\n// åˆ›å»ºçº¿ç¨‹ç»„\nThreadGroup threadGroup = new ThreadGroup(\"Searcher\");\n\n//åˆ›å»ºçº¿ç¨‹\nSearcher searchTask=new Searcher();\nThread thread=new Thread(threadGroup, searchTask);\n//public class Searcher implements Runnable{}\n\n//è¿”å›çº¿ç¨‹ç»„ä¸­è¿˜å¤„äºactiveçš„çº¿ç¨‹æ•°ï¼ˆä¼°è®¡æ•°ï¼‰\nSystem.out.println(threadGroup.activeCount());\n\n//å°†çº¿ç¨‹ç»„ä¸­activeçš„çº¿ç¨‹æ‹·è´åˆ°æ•°ç»„ä¸­\nThread[] threads=new Thread[threadGroup.activeCount()];\nthreadGroup.enumerate(threads);\nfor (int i=0; i<threadGroup.activeCount(); i++) {\n            System.out.printf(\"Thread %s: %s\\n\",threads[i].getName(),threads[i].getState());\n}\n\n//æ‰“å°çº¿ç¨‹ç»„ä¸­æ‰€æœ‰çš„çº¿ç¨‹ä¿¡æ¯\nthreadGroup.list();\n        \n//å¯¹çº¿ç¨‹ç»„ä¸­çš„æ‰€æœ‰çº¿ç¨‹å‘å‡ºinterruptä¿¡å·\nthreadGroup.interrupt();\n```","tags":["Java"],"categories":["Java","Javaè¿›é˜¶"]},{"title":"Java é«˜çº§æ–‡ä»¶å¤„ç†","url":"/20210922/java-advanced-file-processing/","content":"## **1.XMLç®€ä»‹**\n- å¯æ‰©å±•æ ‡è®°è¯­è¨€ï¼šæ„ä¹‰+æ•°æ®\n-  æ ‡ç­¾å¯è‡ªè¡Œå®šä¹‰ï¼Œå…·æœ‰è‡ªæˆ‘æè¿°æ€§\n- çº¯æ–‡æœ¬è¡¨ç¤ºï¼Œè·¨ç³»ç»Ÿ/å¹³å°/è¯­è¨€\n- W3Cæ ‡å‡†(1998å¹´ï¼ŒW3Cå‘å¸ƒäº†XML1.0ï¼ŒåŒ…æ‹¬å‡ ä¹æ‰€æœ‰çš„Unicodeå­—ç¬¦)\n```xml\n<Student>\n    <name>Tom</name>\n    <age>20</age>    \n</Student>\n\n```\n\n### **XMLç»“æ„**\n- å¸¸è§„è¯­æ³•\n    - ä»»ä½•çš„èµ·å§‹æ ‡ç­¾éƒ½å¿…é¡»æœ‰ä¸€ä¸ªç»“æŸæ ‡ç­¾\n    - ç®€åŒ–å†™æ³•ï¼Œä¾‹å¦‚ï¼Œ\\<name>\\</name>å¯ä»¥å†™ä¸º\\<name/>\n    - å¤§å°å†™æ•æ„Ÿï¼Œå¦‚\\<name>å’Œ\\<Name>ä¸ä¸€æ ·\n    - æ¯ä¸ªæ–‡ä»¶éƒ½è¦æœ‰ä¸€ä¸ªæ ¹å…ƒç´ \n    - æ ‡ç­¾å¿…é¡»æŒ‰åˆé€‚çš„é¡ºåºè¿›è¡ŒåµŒå¥—ï¼Œä¸å¯é”™ä½\n    - æ‰€æœ‰çš„ç‰¹æ€§éƒ½å¿…é¡»æœ‰å€¼ï¼Œä¸”åœ¨å€¼çš„å‘¨å›´åŠ ä¸Šå¼•å·\n    - éœ€è¦è½¬ä¹‰å­—ç¬¦ï¼Œå¦‚â€œ<â€éœ€è¦ç”¨&lt;ä»£æ›¿ \n    - æ³¨é‡Šï¼š\\<!-- æ³¨é‡Šå†…å®¹ -->\n\n### **XMLæ‰©å±•**\n- DTD(Document Type Definition)\n    - å®šä¹‰ XML æ–‡æ¡£çš„ç»“æ„\n    - ä½¿ç”¨ä¸€ç³»åˆ—åˆæ³•çš„å…ƒç´ æ¥å®šä¹‰æ–‡æ¡£ç»“æ„\n    - å¯åµŒå¥—åœ¨xmlæ–‡æ¡£ä¸­ï¼Œæˆ–è€…åœ¨xmlä¸­å¼•ç”¨\n- XML Schema(XSDï¼ŒXML Schema Definition)\n    - å®šä¹‰ XML æ–‡æ¡£çš„ç»“æ„, DTDçš„ç»§ä»»è€…\n    - æ”¯æŒæ•°æ®ç±»å‹ï¼Œå¯æ‰©å±•ï¼ŒåŠŸèƒ½æ›´å®Œå–„ã€å¼ºå¤§\n    - é‡‡ç”¨xmlç¼–å†™\n- XSL\n    - æ‰©å±•æ ·å¼è¡¨è¯­è¨€(eXtensible Stylesheet Language)\n    - XSLä½œç”¨äºXMLï¼Œç­‰åŒäºCSSä½œç”¨äºHTML\n    - å†…å®¹\n        - XSLT: è½¬æ¢ XML æ–‡æ¡£\n        - XPath: åœ¨ XML æ–‡æ¡£ä¸­å¯¼èˆª\n        - XSL-FO: æ ¼å¼åŒ–XMLæ–‡æ¡£\n\n### **XMLè§£æ**\n- æ ‘ç»“æ„\n    - DOM: Document Object Model æ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼Œ**æ“…é•¿(å°è§„æ¨¡)è¯»/å†™**\n- æµç»“æ„\n    - SAX: Simple API for XML æµæœºåˆ¶è§£é‡Šå™¨(æ¨æ¨¡å¼)ï¼Œ**æ“…é•¿è¯»**\n    - Stax: The Streaming API for XML æµæœºåˆ¶è§£é‡Šå™¨(æ‹‰æ¨¡å¼)ï¼Œ**æ“…é•¿è¯»**ï¼ŒJDK 6 å¼•å…¥\n\n## **2.XMLè§£æï¼ˆåŸºäºDOMï¼‰**\n- DOM æ˜¯ W3C å¤„ç† XML çš„æ ‡å‡† API\n    - ç›´è§‚æ˜“ç”¨\n    - å…¶å¤„ç†æ–¹å¼æ˜¯å°† XML **æ•´ä¸ª**ä½œä¸ºç±»ä¼¼**æ ‘ç»“æ„**çš„æ–¹å¼**è¯»å…¥å†…å­˜**ä¸­ä»¥ä¾¿æ“ä½œåŠè§£æï¼Œæ–¹ä¾¿ä¿®æ”¹\n    - è§£æå¤§æ•°æ®é‡çš„ XML æ–‡ä»¶ï¼Œä¼šé‡åˆ°**å†…å­˜æ³„éœ²**åŠç¨‹åºå´©æºƒçš„é£é™©\n```xml\n<font>\n    <name>Helvetica</name>\n    <size>36</size>\n</font>\n```\n```mermaid\ngraph TB\n    Document---ele[Element<font>]\n    ele---tex[Text:whitespace]\n    ele---name[Element<name>]\n    ele---tex2[Text:whitespace]\n    ele---size[Element<size>]\n    ele---tex3[Text:whitespace]\n    name---tex4[Text:Helvetica]\n    size---tex5[Text:36]\n```\n\n### **DOMç±»**\n- DocumentBuilder è§£æç±»ï¼Œparseæ–¹æ³•\n- **Node èŠ‚ç‚¹ä¸»æ¥å£ï¼ŒgetChildNodesè¿”å›ä¸€ä¸ªNodeList**\n- **NodeList èŠ‚ç‚¹åˆ—è¡¨ï¼Œæ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªNode**\n- Document æ–‡æ¡£æ ¹èŠ‚ç‚¹\n- Element æ ‡ç­¾èŠ‚ç‚¹å…ƒç´  (æ¯ä¸€ä¸ªæ ‡ç­¾éƒ½æ˜¯æ ‡ç­¾èŠ‚ç‚¹)\n- TextèŠ‚ç‚¹ (åŒ…å«åœ¨XMLå…ƒç´ å†…çš„ï¼Œéƒ½ç®—TextèŠ‚ç‚¹) \n- AttrèŠ‚ç‚¹(æ¯ä¸ªå±æ€§èŠ‚ç‚¹) \n#### è¯»å–ï¼š\n##### 1. è‡ªä¸Šè€Œä¸‹éå†ï¼ˆDFSï¼‰ï¼š\n```java\n//DOMè§£æxmlæ–‡ä»¶\nDocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();\nDocumentBuilder db = dbf.newDocumentBuilder();\nDocument document = db.parse(\"pom.xml\");\n//è·å–æ‰€æœ‰ä¸€çº§å­èŠ‚ç‚¹\nNodeList usersList = document.getChildNodes();\nSystem.out.println(usersList.getLength());\n\nfor (int i = 0; i < usersList.getLength(); i++) {\n    Node users = usersList.item(i);\n    //è·å–äºŒçº§å­èŠ‚ç‚¹åˆ—è¡¨\n    NodeList userList = users.getChildNodes();\n    System.out.println(\"==\" + userList.getLength());\n\n    for (int j = 0; j < userList.getLength(); j++) {\n        Node user = userList.item(j);\n        //æ’é™¤whitespace\n        if (user.getNodeType() == Node.ELEMENT_NODE) {\n            //è·å–ä¸‰çº§å­èŠ‚ç‚¹åˆ—è¡¨\n            NodeList metaList = user.getChildNodes();\n            System.out.println(\"====\" + metaList.getLength());\n            //......\n        }\n    }\n}\n```\n##### 2. æ ¹æ®åç§°è¿›è¡Œæœç´¢\n```java\n//DOMè§£æxmlæ–‡ä»¶\nDocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();\nDocumentBuilder db = dbf.newDocumentBuilder();\nDocument document = db.parse(\"pom.xml\");\n\nElement rootElement =document.getDocumentElement();\n//è·å–æ‰€æœ‰æ ‡ç­¾åä¸ºnameçš„èŠ‚ç‚¹\nNodeList nodeList=rootElement.getElementsByTagName(\"name\");\nif(nodeList!=null) {\n    for(int i=0;i<nodeList.getLength();i++) {\n        Element element = (Element)nodeList.item(i);\n        System.out.println(element.getNodeName()+\"=\"+element.getTextContent());\n    }\n}\n```\n#### å†™å…¥ï¼š\n```java\nDocumentBuilderFactory dbFactory = DocumentBuilderFactory.newInstance();\nDocumentBuilder dbBuilder = dbFactory.newDocumentBuilder();\n//æ–°å»ºDocumnetæ ¹èŠ‚ç‚¹\nDocument document = dbBuilder.newDocument();\nif (document != null) {\n    Element docx = document.createElement(\"document\");    //å‡é‡‡ç”¨Doucumentåˆ›å»ºå…ƒç´ \n    Element element = document.createElement(\"element\");\n    element.setAttribute(\"type\", \"paragraph\");    \n    element.setAttribute(\"alignment\", \"left\"); //elementæ–°å¢ä¸¤ä¸ªå±æ€§\n\n    Element object = document.createElement(\"object\");\n    object.setAttribute(\"type\", \"text\");\n\n    Element text = document.createElement(\"text\");\n    text.appendChild(document.createTextNode(\"abcdefg\")); //textèŠ‚ç‚¹èµ‹å€¼\n    Element bold = document.createElement(\"bold\");\n    bold.appendChild(document.createTextNode(\"true\")); //boldèŠ‚ç‚¹èµ‹å€¼\n\n    object.appendChild(text);\n    object.appendChild(bold);\n    element.appendChild(object);\n    docx.appendChild(element);\n    document.appendChild(docx);    //åˆ›å»ºæ ‘çŠ¶ç»“æ„\n\n    TransformerFactory transformerFactory = TransformerFactory.newInstance();\n    Transformer transformer = transformerFactory.newTransformer();\n    DOMSource source = new DOMSource(document);\n    //å®šä¹‰ç›®æ ‡æ–‡ä»¶\n    File file = new File(\"dom_result.xml\");\n    StreamResult result = new StreamResult(file);\n    //å°†xmlå†…å®¹å†™å…¥åˆ°æ–‡ä»¶ä¸­\n    transformer.transform(source, result);\n}\n```\n\n## **3.XMLè§£æï¼ˆåŸºäºSAXï¼‰**\nSimple API for XML\n- é‡‡ç”¨äº‹ä»¶/æµæ¨¡å‹æ¥è§£æ XML æ–‡æ¡£ï¼Œ**æ›´å¿«é€Ÿã€æ›´è½»é‡**\n- æœ‰é€‰æ‹©çš„è§£æå’Œè®¿é—®ï¼Œä¸åƒ DOM åŠ è½½æ•´ä¸ªæ–‡æ¡£ï¼Œ*å†…å­˜è¦æ±‚è¾ƒä½*\n- SAX å¯¹ XML æ–‡æ¡£çš„è§£æä¸ºä¸€æ¬¡æ€§è¯»å–ï¼Œä¸åˆ›å»º/ä¸å­˜å‚¨æ–‡æ¡£å¯¹è±¡ï¼Œ**å¾ˆéš¾åŒæ—¶è®¿é—®æ–‡æ¡£ä¸­çš„å¤šå¤„æ•°æ®**\n- æ¨æ¨¡å‹ã€‚å½“å®ƒæ¯å‘ç°ä¸€ä¸ªèŠ‚ç‚¹å°±å¼•å‘ä¸€ä¸ªäº‹ä»¶ï¼Œè€Œæˆ‘ä»¬éœ€è¦ç¼–å†™è¿™äº›äº‹ä»¶çš„å¤„ç†ç¨‹åº\n- å…³é”®ç±»ï¼šDefaultHandler\n```java\npublic class SAXReader {\n    public static void main(String[] args) throws SAXException, IOException {\n        XMLReader parser = XMLReaderFactory.createXMLReader();\n        BookHandler bookHandler = new BookHandler();\n        parser.setContentHandler(bookHandler);\n        parser.parse(\"books.xml\");\n        System.out.println(bookHandler.getNameList());\n    }\n}\n\nclass BookHandler extends DefaultHandler {\n    private List<String> nameList;\n    private boolean title = false;\n\n    public List<String> getNameList() {\n        return nameList;\n    }\n\n    // xmlæ–‡æ¡£åŠ è½½æ—¶\n    public void startDocument() throws SAXException {\n        System.out.println(\"Start parsing document...\");\n        nameList = new ArrayList<String>();\n    }\n\n    // æ–‡æ¡£è§£æç»“æŸ\n    public void endDocument() throws SAXException {\n        System.out.println(\"End\");\n    }\n\n    // è®¿é—®æŸä¸€ä¸ªå…ƒç´ \n    public void startElement(String uri, String localName, String qName, Attributes atts) throws SAXException {\n        if (qName.equals(\"title\")) {\n            title = true;\n        }\n    }\n\n    // ç»“æŸè®¿é—®å…ƒç´ \n    public void endElement(String namespaceURI, String localName, String qName) throws SAXException {\n        // End of processing current element\n        if (title) {\n            title = false;\n        }\n    }\n\n    // è®¿é—®å…ƒç´ æ­£æ–‡\n    public void characters(char[] ch, int start, int length) {\n        if (title) {\n            String bookTitle = new String(ch, start, length);\n            System.out.println(\"Book title: \" + bookTitle);\n            nameList.add(bookTitle);\n        }\n    }\n}\n```\n\n## **4.XMLè§£æï¼ˆåŸºäºStaxï¼‰**\nStreaming API for XML\n- æµæ¨¡å‹ä¸­çš„æ‹‰æ¨¡å‹\n- åœ¨éå†æ–‡æ¡£æ—¶ï¼Œä¼šæŠŠæ„Ÿå…´è¶£çš„éƒ¨åˆ†ä»è¯»å–å™¨ä¸­æ‹‰å‡ºï¼Œä¸éœ€è¦å¼•å‘äº‹ä»¶ï¼Œå…è®¸æˆ‘ä»¬**é€‰æ‹©æ€§åœ°å¤„ç†èŠ‚ç‚¹**ã€‚è¿™å¤§å¤§æé«˜äº†çµæ´»æ€§ï¼Œä»¥åŠæ•´ä½“æ•ˆç‡\n- ä¸¤å¥—å¤„ç†API\n    - åŸºäºæŒ‡é’ˆçš„APIï¼Œ XMLStreamReader\n    - åŸºäºè¿­ä»£å™¨çš„APIï¼ŒXMLEventReader\n\n```java\npublic class StaxReader {\n\n    public static void main(String[] args) {\n        StaxReader.readByStream();    //åŸºäºæŒ‡é’ˆéå†\n        StaxReader.readByEvent();    //åŸºäºè¿­ä»£å™¨éå†\n    }\n\n    // æµæ¨¡å¼\n    public static void readByStream() {\n        //å›ºå®šå†™æ³•\n        String xmlFile = \"books.xml\";\n        XMLInputFactory factory = XMLInputFactory.newFactory();\n        XMLStreamReader streamReader = null;\n        try {\n            streamReader = factory.createXMLStreamReader(new FileReader(xmlFile));\n        } catch (FileNotFoundException e) {\n            e.printStackTrace();\n        } catch (XMLStreamException e) {\n            e.printStackTrace();\n        }\n\n        //åŸºäºæŒ‡é’ˆéå†\n        try {\n            while (streamReader.hasNext()) {\n                int event = streamReader.next();\n                // å¦‚æœæ˜¯å…ƒç´ çš„å¼€å§‹\n                if (event == XMLStreamConstants.START_ELEMENT) {\n                    // åˆ—å‡ºæ‰€æœ‰ä¹¦ç±åç§°\n                    if (\"title\".equalsIgnoreCase(streamReader.getLocalName())) {\n                        System.out.println(\"title:\" + streamReader.getElementText());\n                    }\n                }\n            }\n            streamReader.close();\n        } catch (XMLStreamException e) {\n            e.printStackTrace();\n        }\n    }\n\n    // äº‹ä»¶æ¨¡å¼\n    public static void readByEvent() {\n        String xmlFile = \"books.xml\";\n        XMLInputFactory factory = XMLInputFactory.newInstance();\n        boolean titleFlag = false;\n        try {\n            // åˆ›å»ºåŸºäºè¿­ä»£å™¨çš„äº‹ä»¶è¯»å–å™¨å¯¹è±¡\n            XMLEventReader eventReader = factory.createXMLEventReader(new FileReader(xmlFile));\n            // éå†Eventè¿­ä»£å™¨\n            while (eventReader.hasNext()) {\n                XMLEvent event = eventReader.nextEvent();\n                // å¦‚æœäº‹ä»¶å¯¹è±¡æ˜¯å…ƒç´ çš„å¼€å§‹\n                if (event.isStartElement()) {\n                    // è½¬æ¢æˆå¼€å§‹å…ƒç´ äº‹ä»¶å¯¹è±¡\n                    StartElement start = event.asStartElement();\n                    // æ‰“å°å…ƒç´ æ ‡ç­¾çš„æœ¬åœ°åç§°\n\n                    String name = start.getName().getLocalPart();\n                    // System.out.print(start.getName().getLocalPart());\n                    if (name.equals(\"title\")) {\n                        titleFlag = true;\n                        System.out.print(\"title:\");\n                    }\n\n                    // å–å¾—æ‰€æœ‰å±æ€§\n                    Iterator attrs = start.getAttributes();\n                    while (attrs.hasNext()) {\n                        // æ‰“å°æ‰€æœ‰å±æ€§ä¿¡æ¯\n                        Attribute attr = (Attribute) attrs.next();\n                        // System.out.print(\":\" + attr.getName().getLocalPart() + \"=\" +\n                        // attr.getValue());\n                    }\n                    // System.out.println();\n                }\n                // å¦‚æœæ˜¯æ­£æ–‡\n                if (event.isCharacters()) {\n                    String s = event.asCharacters().getData();\n                    if (null != s && s.trim().length() > 0 && titleFlag) {\n                        System.out.println(s.trim());\n                    }\n                }\n                // å¦‚æœäº‹ä»¶å¯¹è±¡æ˜¯å…ƒç´ çš„ç»“æŸ\n                if (event.isEndElement()) {\n                    EndElement end = event.asEndElement();\n                    String name = end.getName().getLocalPart();\n                    if (name.equals(\"title\")) {\n                        titleFlag = false;\n                    }\n                }\n            }\n            eventReader.close();\n        } catch (FileNotFoundException e) {\n            e.printStackTrace();\n        } catch (XMLStreamException e) {\n            e.printStackTrace();\n        }\n    }\n}\n```\n\n## **5.JSONç®€ä»‹**\n- JavaScript Object Notation, JS å¯¹è±¡è¡¨ç¤ºæ³•\n- æ˜¯ä¸€ç§è½»é‡çº§çš„æ•°æ®äº¤æ¢æ ¼å¼\n- ç±»ä¼¼XMLï¼Œæ›´å°ã€æ›´å¿«ã€æ›´æ˜“è§£æ\n- æœ€æ—©ç”¨äºJavascriptä¸­ï¼Œå®¹æ˜“è§£æï¼Œæœ€åæ¨å¹¿åˆ°å…¨è¯­è¨€\n- å°½ç®¡ä½¿ç”¨Javascriptè¯­æ³•ï¼Œä½†æ˜¯**ç‹¬ç«‹äºç¼–ç¨‹è¯­è¨€**\n\n### **JSONObjectå’ŒJSONArray**\n- åç§°/å€¼å¯¹ã€‚å¦‚\"firstName\":\"John\"\n    - JSONå¯¹è±¡ï¼š{â€œname\":\"Jo\",\"email\":\"a@b.com\"}\n    - æ•°æ®åœ¨é”®å€¼å¯¹ä¸­\n    - æ•°æ®ç”±é€—å·åˆ†éš”\n    - èŠ±æ‹¬å·ä¿å­˜å¯¹è±¡\n- JSONæ•°ç»„\n    - æ–¹æ‹¬å·ä¿å­˜æ•°ç»„\n        [{â€œname\":\"Jo\",\"email\":\"a@b.com\"}, {â€œname\":\"Jo\",\"email\":\"a@b.com\"}]\n\n### **Javaçš„JSONå¤„ç†**\n- org.jsonï¼šJSONå®˜æ–¹æ¨èçš„è§£æç±»\n    - ç®€å•æ˜“ç”¨ï¼Œé€šç”¨æ€§å¼º\n    -  å¤æ‚åŠŸèƒ½æ¬ ç¼º\n- GSONï¼šGoogleå‡ºå“\n    - åŸºäºåå°„ï¼Œå¯ä»¥å®ç°JSONå¯¹è±¡ã€JSONå­—ç¬¦ä¸²å’ŒJavaå¯¹è±¡äº’è½¬\n- Jacksonï¼šå·ç§°æœ€å¿«çš„JSONå¤„ç†å™¨\n    - ç®€å•æ˜“ç”¨ï¼Œç¤¾åŒºæ›´æ–°å’Œå‘å¸ƒé€Ÿåº¦æ¯”è¾ƒå¿«\n\n### **Jsonä¸»è¦ç”¨é€”**\n- JSONç”Ÿæˆ\n- JSONè§£æ\n- JSONæ ¡éªŒ\n- å’Œ**Java Bean**å¯¹è±¡è¿›è¡Œäº’è§£æ\n    - å…·æœ‰ä¸€ä¸ªæ— å‚çš„æ„é€ å‡½æ•°\n    - å¯ä»¥åŒ…æ‹¬å¤šä¸ªå±æ€§ï¼Œæ‰€æœ‰å±æ€§éƒ½æ˜¯private\n    - æ¯ä¸ªå±æ€§éƒ½æœ‰ç›¸åº”çš„Getter/Setteræ–¹æ³•\n    - Java Beanç”¨äºå°è£…æ•°æ®ï¼Œåˆå¯ç§°ä¸ºPOJO(Plain Old Java Object)\n\n### **org.json**\n```java\npublic static void main(String[] args) {\n        testJsonObject();\n        testJsonFile();\n    }\n\n    public static void testJsonObject() {\n        // æ„é€ å¯¹è±¡\n        Person p = new Person();\n        p.setName(\"Tom\");\n        p.setAge(20);\n\n        // æ„é€ JSONObjectå¯¹è±¡\n        JSONObject obj = new JSONObject();\n        obj.put(\"name\", p.getName());\n        obj.put(\"age\", p.getAge());\n        System.out.println(\"name: \" + obj.getString(\"name\"));\n        System.out.println(\"age: \" + obj.getInt(\"age\"));\n    }\n\n    public static void testJsonFile() {\n        File file = new File(\"books.json\");\n        try (FileReader reader = new FileReader(file)) {\n            // è¯»å–æ–‡ä»¶å†…å®¹åˆ°JsonObjectå¯¹è±¡ä¸­\n            int fileLen = (int) file.length();\n            char[] chars = new char[fileLen];\n            reader.read(chars);\n            String s = String.valueOf(chars);\n            JSONObject jsonObject = new JSONObject(s);\n\n            // å¼€å§‹è§£æJSONObjectå¯¹è±¡\n            JSONArray books = jsonObject.getJSONArray(\"books\");\n            List<Book> bookList = new ArrayList<>();\n            for (Object book : books) {\n                // è·å–å•ä¸ªJSONObjectå¯¹è±¡\n                JSONObject bookObject = (JSONObject) book;\n                Book book1 = new Book();\n                book1.setAuthor(bookObject.getString(\"author\"));\n                book1.setYear(bookObject.getString(\"year\"));\n                book1.setTitle(bookObject.getString(\"title\"));\n                book1.setPrice(bookObject.getInt(\"price\"));\n                book1.setCategory(bookObject.getString(\"category\"));\n                bookList.add(book1);\n            }\n\n            for (Book book : bookList) {\n                System.out.println(book.getAuthor() + \",  \" + book.getTitle());\n            }\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n```\n### **GSON**\n```java\npublic static void main(String[] args) {\n        testJsonObject();\n        testJsonFile();\n    }\n\n    public static void testJsonObject() {\n        // æ„é€ å¯¹è±¡\n        Person p = new Person();\n        p.setName(\"Tom\");\n        p.setAge(20);\n\n        // ä»Javaå¯¹è±¡åˆ°JSONå­—ç¬¦ä¸²\n        Gson gson = new Gson();\n        String s = gson.toJson(p);\n        System.out.println(s); // {\"name\":\"Tom\",\"age\":20}\n\n        // ä»JSONå­—ç¬¦ä¸²åˆ°Javaå¯¹è±¡\n        Person p2 = gson.fromJson(s, Person.class);\n        System.out.println(p2.getName()); // Tom\n        System.out.println(p2.getAge()); // 20\n\n        // è°ƒç”¨GSONçš„JsonObject\n        JsonObject json = gson.toJsonTree(p).getAsJsonObject(); // å°†æ•´ä¸ªjsonè§£æä¸ºä¸€é¢—æ ‘\n        System.out.println(json.get(\"name\")); // \"Tom\"\n        System.out.println(json.get(\"age\")); // 20\n    }\n\n    public static void testJsonFile() {\n        Gson gson = new Gson();\n        File file = new File(\"books2.json\");\n\n        try (FileReader reader = new FileReader(file)) {\n            List<Book> books = gson.fromJson(reader, new TypeToken<List<Book>>() {\n            }.getType());\n\n            for (Book book : books) {\n                System.out.println(book.getAuthor() + \",  \" + book.getTitle());\n            }\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n```\n### **Jackson**\n```java\npublic static void main(String[] args) throws Exception {\n        testJsonObject();\n        testJsonFile();\n    }\n    \n    static void testJsonObject() throws IOException {\n        ObjectMapper om = new ObjectMapper();\n        \n        //æ„é€ å¯¹è±¡\n        Person p = new Person();\n        p.setName(\"Tom\");\n        p.setAge(20);\n        \n        //å°†å¯¹è±¡è§£æä¸ºjsonå­—ç¬¦ä¸²\n        String jsonStr = om.writeValueAsString(p);\n        System.out.println(jsonStr);\n        \n        //ä»jsonå­—ç¬¦ä¸²é‡æ„å¯¹è±¡\n        Person p2 = om.readValue(jsonStr, Person.class);\n        System.out.println(p2.getName());\n        System.out.println(p2.getAge());\n        \n        //ä»jsonå­—ç¬¦ä¸²é‡æ„ä¸ºJsonNodeå¯¹è±¡\n        JsonNode node = om.readTree(jsonStr);\n        System.out.println(node.get(\"name\").asText());\n        System.out.println(node.get(\"age\").asText());\n    }\n    \n    static void testJsonFile() throws IOException {\n        ObjectMapper om = new ObjectMapper();\n        \n        //ä»jsonæ–‡ä»¶ä¸­åŠ è½½ï¼Œå¹¶é‡æ„ä¸ºjavaå¯¹è±¡\n        File json2 = new File(\"books2.json\");\n        List<Book> books = om.readValue(json2, new TypeReference<List<Book>>(){});\n        for (Book book : books) {\n            System.out.println(book.getAuthor());\n            System.out.println(book.getTitle());\n        }\n    }    \n```\n\n### **JSON vs XML**\n- éƒ½æ˜¯æ•°æ®äº¤æ¢æ ¼å¼ï¼Œå¯è¯»æ€§å¼ºï¼Œå¯æ‰©å±•æ€§é«˜\n- å¤§éƒ¨åˆ†çš„æƒ…å†µä¸‹ï¼ŒJSONæ›´å…·ä¼˜åŠ¿ï¼ˆç¼–ç ç®€å•ï¼Œè½¬æ¢æ–¹ä¾¿ï¼‰\n- JSONå­—ç¬¦é•¿åº¦ä¸€èˆ¬å°äºXMLï¼Œä¼ è¾“æ•ˆç‡æ›´é«˜\n- **XMLæ›´åŠ æ³¨é‡æ ‡ç­¾å’Œé¡ºåº**\n- **JSONä¼šä¸¢å¤±ä¿¡æ¯**","tags":["Java"],"categories":["Java","Javaè¿›é˜¶"]},{"title":"Java é«˜çº§æ–‡ä»¶å¤„ç†ï¼ˆç»­ï¼‰","url":"/20210921/java-advanced-file-processing2/","content":"## **1. å›¾åƒå¤„ç†**\n### **å…³é”®ç±»**\n- å›¾å½¢ï¼šGraph\n    - java.awt åŒ… \n    -  Java 2Dåº“: Graphics2D, Line2D, Rectangle2D, Ellipse2D,Arc2D\n    - Color, Stroke\n- **å›¾åƒï¼šImage**\n    - javax.imageioåŒ… \n    - ImageIO, BufferedImage, ImageReader, ImageWriter\n\n### **å…³é”®ç±»æè¿°**\nJavaåŸç”Ÿæ”¯æŒ**jpg, png**, bmp, wbmp, gif\n- javax.imageio.ImageIO\n    - è‡ªåŠ¨å°è£…å¤šç§ImageReaderå’ŒImageWriterï¼Œè¯»å†™å›¾åƒæ–‡ä»¶\n    - read è¯»å–å›¾ç‰‡ write å†™å›¾ç‰‡\n- java.awt.image.BufferedImage,å›¾åƒåœ¨å†…å­˜ä¸­çš„è¡¨ç¤ºç±»\n    - getHeight è·å–é«˜åº¦\n    - getWidth è·å–å®½åº¦\n- å›¾åƒæ–‡ä»¶è¯»å†™/æˆªå–/åˆå¹¶\n\n### å›¾ç‰‡è¯»å†™\n```java\n// ImageIOéœ€è¦æµ‹è¯•å›¾ç‰‡çš„ç±»å‹ï¼ŒåŠ è½½åˆé€‚çš„ImageReaderæ¥è¯»å–å›¾ç‰‡ï¼Œè€—æ—¶æ›´é•¿\nBufferedImage image = ImageIO.read(new File(\"c:/temp/ecnu.jpg\"));\n\n// æŒ‡å®šç”¨jpg Readeræ¥åŠ è½½ï¼Œé€Ÿåº¦ä¼šåŠ å¿«\nIterator<ImageReader> readers = ImageIO.getImageReadersByFormatName(\"jpg\");\nImageReader reader = (ImageReader) readers.next();\nImageInputStream iis = ImageIO.createImageInputStream(new File(\"c:/temp/ecnu.jpg\"));\nreader.setInput(iis, true);\n\n//å¤åˆ¶ï¼ˆå†™ï¼‰å›¾ç‰‡\nImageIO.write(image, \"png\", new File(\"c:/temp/ecnu.png\"));\n```\n### è·å–åŸºç¡€å±æ€§\n```java\nSystem.out.println(\"Height: \" + image.getHeight()); // é«˜åº¦åƒç´ \nSystem.out.println(\"Width: \" + image.getWidth()); // å®½åº¦åƒç´ \n```\n### å›¾åƒåˆ‡å‰²\n```java\n// å®šä¹‰ä¸€ä¸ªçŸ©å½¢ å¹¶æ”¾å…¥åˆ‡å‰²å‚æ•°ä¸­\nImageReadParam param = reader.getDefaultReadParam();            \nRectangle rect = new Rectangle(x, y, width, height);            \nparam.setSourceRegion(rect);\n\n//ä»æºæ–‡ä»¶è¯»å–ä¸€ä¸ªçŸ©å½¢å¤§å°çš„å›¾åƒ\nBufferedImage bi = reader.read(0, param);\n```\n### RGB\n```java\n//ä»ç¬¬ä¸€å¼ å›¾ç‰‡ä¸­è¯»å–RGB\nint[] firstRGB = new int[width1*height1];    \nfirstRGB = imageOne.getRGB(0,0,width1,height1,firstRGB,0,width1);\n\n//è®¾ç½®å·¦åŠéƒ¨åˆ†çš„RGB ä»(0,0) å¼€å§‹ \nimageNew.setRGB(0,0,width1,height1,firstRGB,0,width1); \n```\n\n### **ç»Ÿè®¡å›¾ç”Ÿæˆ**\n- ç»Ÿè®¡å›¾\n    - æŸ±çŠ¶å›¾/é¥¼å›¾/æŠ˜çº¿å›¾\n    - JavaåŸç”Ÿçš„Graphics 2Då¯ä»¥ç”»ï¼Œæ¯”è¾ƒç¹ç\n    - åŸºäºjFreeChart(www.jfree.org/jfreechart)å¯ä»¥å¿«é€Ÿå®ç°ç»Ÿè®¡å›¾ç”Ÿæˆ\n        - è®¾å®šæ•°æ®é›†\n        - è°ƒç”¨ChartFactoryç”Ÿæˆå›¾å½¢","tags":["Java"],"categories":["Java","Javaè¿›é˜¶"]},{"title":"Java é«˜çº§æ–‡æœ¬å¤„ç†","url":"/20210921/java-advanced-text-processing/","content":"## **1. å›½é™…åŒ–ç¼–ç¨‹**\n* Javaæ˜¯ç¬¬ä¸€ä¸ªè®¾è®¡æˆæ”¯æŒå›½é™…åŒ–çš„ç¼–ç¨‹è¯­è¨€\n    - java.util.ResourceBundle ç”¨äºåŠ è½½ä¸€ä¸ªè¯­è¨€_å›½å®¶è¯­è¨€åŒ…\n    - java.util.Locale å®šä¹‰ä¸€ä¸ªè¯­è¨€_å›½å®¶\n    - java.text.MessageFormat ç”¨äºæ ¼å¼åŒ–å¸¦å ä½ç¬¦çš„å­—ç¬¦ä¸²\n    - java.text.NumberFormat ç”¨äºæ ¼å¼åŒ–æ•°å­—/é‡‘é¢\n    - java.text.DateFormat ç”¨äºæ ¼å¼åŒ–æ—¥æœŸæ—¶é—´\n    - java.time.format.DateTimeFormatter ç”¨äºæ ¼å¼åŒ–æ—¥æœŸæ—¶é—´\n\n### **Localeç±»**\n- Locale(zh_CN, en_US,â€¦)\n    - è¯­è¨€ï¼Œzhï¼Œenç­‰ \n    - å›½å®¶/åœ°åŒºï¼ŒCNï¼ŒUSç­‰ \n    - å…¶ä»–å˜é‡(variant)(å‡ ä¹ä¸ç”¨)\n- Localeæ–¹æ³•\n    - getAvailableLocales()è¿”å›æ‰€æœ‰çš„å¯ç”¨Locale\n    - getDefault()è¿”å›é»˜è®¤çš„Locale\n\n### **è¯­è¨€æ–‡ä»¶**\n-  ä¸€ä¸ªPropertiesæ–‡ä»¶ \n    - åŒ…å«K-Vå¯¹ï¼Œæ¯è¡Œä¸€ä¸ªK-Vï¼Œä¾‹å¦‚ï¼šage=20\n- å‘½åè§„åˆ™\n    - åŒ…å_è¯­è¨€_å›½å®¶åœ°åŒº.properties, (è¯­è¨€å’Œå›½å®¶åœ°åŒºå¯é€‰) \n        e.g. message_zh_CN.properties\n    - å­˜å‚¨æ–‡ä»¶å¿…é¡»æ˜¯ASCIIç æ–‡ä»¶\n    - å¦‚æœæ˜¯ASCIIä»¥å¤–çš„æ–‡å­—ï¼Œå¿…é¡»ç”¨Unicodeçš„è¡¨ç¤º\\uxxxx\n    - å¯ä»¥é‡‡ç”¨native2ascii.exe (%JAVA_HOME%\\binç›®å½•ä¸‹)è¿›è¡Œè½¬ç \n\n### **ResourceBundleç±»**\n1. **ResourceBundle**\n*  æ ¹æ®Localeè¦æ±‚ï¼ŒåŠ è½½è¯­è¨€æ–‡ä»¶(Propertiesæ–‡ä»¶)ï¼Œå­˜å‚¨K-Vå¯¹\n    ```java\n    Locale myLocale = new Locale(\"zh\", \"CN\");\n    ResourceBundle.getBundle(\"msg\", myLocale); //åŠ è½½msg_zh_CN.properties\n    ```\n* getString(String key) è¿”å›æ‰€å¯¹åº”çš„value\n    * å¦‚æœæ‰¾ä¸åˆ°keyï¼Œåˆ™æŠ¥å¼‚å¸¸\n2. **è¯­è¨€æ–‡ä»¶å±‚çº§ç»“æ„**\n* æ–‡ä»¶: åŒ…å_å½“å‰Localeè¯­è¨€_å½“å‰Localeå›½å®¶åœ°åŒº_å½“å‰Localeå˜é‡(variant)\n    * msg_zh_CN.properties (æ³¨æ„å¤§å°å†™) \n    *  msg_zh.properties\n    *  msg.properties\n* æ–‡ä»¶å½¢æˆæ ‘ç»“æ„\n3. **ResourceBundle åŠ è½½æ–‡ä»¶**\n* é¦–å…ˆï¼ŒæŒ‰å¦‚ä¸‹é¡ºåºæ‰¾åˆ°ç¬¬ä¸€ä¸ªPropertiesæ–‡ä»¶\n    - åŒ…å_å½“å‰Localeè¯­è¨€_å½“å‰Localeå›½å®¶åœ°åŒº_å½“å‰Localeå˜é‡(variant)\n    - åŒ…å_å½“å‰Localeè¯­è¨€_å½“å‰Localeå›½å®¶åœ°åŒº\n    - åŒ…å_å½“å‰Localeè¯­è¨€\n    - åŒ…å_é»˜è®¤Localeè¯­è¨€_é»˜è®¤Localeå›½å®¶åœ°åŒº_é»˜è®¤Localeå˜é‡(variant)\n    - åŒ…å_é»˜è®¤Localeè¯­è¨€_é»˜è®¤Localeå›½å®¶åœ°åŒº\n    - åŒ…å_é»˜è®¤Localeè¯­è¨€\n    - åŒ…å\n* æ ¹æ®Propertiesæ ‘ç»“æ„ï¼ŒæŠŠç¬¬ä¸€æ­¥çš„Propertiesæ–‡ä»¶åŠçˆ¶çº§æ–‡ä»¶å…¨éƒ¨åŠ è½½ï¼Œä½œä¸ºåç»­çš„K-Vé›†åˆ\n\n## **2. é«˜çº§å­—ç¬¦ä¸²å¤„ç†**\n### **æ­£åˆ™è¡¨è¾¾å¼**\n- ç”¨äº‹å…ˆå®šä¹‰å¥½çš„ä¸€äº›ç‰¹å®šå­—ç¬¦ã€åŠè¿™äº›ç‰¹å®šå­—ç¬¦çš„ç»„åˆï¼Œç»„æˆä¸€ä¸ªâ€œè§„åˆ™å­—ç¬¦ä¸²â€ \n- ä½œç”¨\n    - æµ‹è¯•å­—ç¬¦ä¸²å†…çš„æ¨¡å¼\n    - è¯†åˆ«/æ›¿æ¢æ–‡æœ¬\n    - æå–æ–‡æœ¬\n\n### **java.util.regexåŒ…**\n* Patternç±» æ­£åˆ™è¡¨è¾¾å¼çš„ç¼–è¯‘è¡¨ç¤º\n    - compile ç¼–è¯‘ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ä¸ºPatternå¯¹è±¡\n    - matcher ç”¨Patternå¯¹è±¡åŒ¹é…ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¿”å›åŒ¹é…ç»“æœ\n    ```java\n    private static final String REGEX = \"\\\\bdog\\\\b\";  //\\bè¡¨ç¤ºè¾¹ç•Œ\n    private static final String INPUT = \"dog dog dog doggie dogg\";\n    Pattern p = Pattern.compile(REGEX);\n    Matcher m = p.matcher(INPUT);\n    ```\n* Matcherç±»\n    - Index Methods(ä½ç½®æ–¹æ³•) \n    - start(), start(int group), end(), end(int group)\n    ```java\n    while (m.find()) {\n        System.out.println(\"start(): \" + m.start()); //å¼€å§‹ä½ç½®\n        System.out.println(\"end(): \" + m.end()); //ç»“æŸä½ç½®\n    }\n    ```\n    - Study Methods(æŸ¥æ‰¾æ–¹æ³•)\n    - lookingAt(), find(), find(int start), matches()\n    ```java\n    private static final String REGEX = \"foo\";\n    private static final String INPUT = \"foooooooo\";\n    private static Pattern pattern;\n    private static Matcher matcher;\n\n    public static void main(String[] args) {\n        // Initialize\n        pattern = Pattern.compile(REGEX);\n        matcher = pattern.matcher(INPUT);\n\n        System.out.println(\"Current REGEX is: \" + REGEX);\n        System.out.println(\"Current INPUT is: \" + INPUT);\n\n        System.out.println(\"lookingAt(): \" + matcher.lookingAt());  //éƒ¨åˆ†åŒ¹é…\n        System.out.println(\"matches(): \" + matcher.matches());    //å®Œå…¨åŒ¹é…\n    }\n    ```\n    - Replacement Methods(æ›¿æ¢æ–¹æ³•) \n    - replaceAll(String replacement)\n      - appendReplacementæ–¹æ³•ï¼š\n        ```java\n        private static String REGEX = \"a*b\"; //*è¡¨ç¤ºé™å®šå‰é¢çš„aå¯ä»¥æœ‰0æˆ–è€…å¤šä¸ªã€‚\n        private static String INPUT = \"aabfooaabfooabfoobcdd\";\n        private static String REPLACE = \"-\";\n\n        public static void main(String[] args) {\n            Pattern p = Pattern.compile(REGEX);\n            Matcher m = p.matcher(INPUT); // get a matcher object\n            StringBuffer sb = new StringBuffer();\n            //å…¨éƒ¨æ›¿æ¢\n            while(m.find()){\n                m.appendReplacement(sb,REPLACE);\n            }\n            //å°†æœ€åçš„å°¾å·´å­—ç¬¦ä¸²é™„åŠ ä¸Š\n            m.appendTail(sb); \n            System.out.println(sb.toString());\n        }\n        ```\n        replaceAllæ–¹æ³•ï¼š\n        ```java\n        private static String REGEX = \"a*b\"; //*è¡¨ç¤ºé™å®šå‰é¢çš„aå¯ä»¥æœ‰0æˆ–è€…å¤šä¸ªã€‚\n        private static String INPUT = \"aabfooaabfooabfoobcdd\";\n            private static String REPLACE = \"-\";\n            public static void main(String[] args) {\n                Pattern p = Pattern.compile(REGEX);\n                Matcher m = p.matcher(INPUT); // get a matcher object\n                StringBuffer sb = new StringBuffer();\n                //å…¨éƒ¨æ›¿æ¢\n                while(m.find()){\n                    m.appendReplacement(sb,REPLACE);\n                }\n                //å°†æœ€åçš„å°¾å·´å­—ç¬¦ä¸²é™„åŠ ä¸Š\n                m.appendTail(sb); \n                System.out.println(sb.toString());\n            }\n        ```\n\n### **å…¶ä»–å­—ç¬¦ä¸²æ“ä½œ**\n- å­—ç¬¦ä¸²å’Œé›†åˆäº’è½¬\n    - [1,2,3], â€œ1,2,3â€\n    ```java\n    import org.apache.commons.lang3.StringUtils;\n\n    List<String> names = new LinkedList<String>();\n    names.add(\"Xiaohong\");\n    names.add(\"Xiaoming\");\n    names.add(\"Daming\");\n    names.add(\"Xiaohei\");\n\n    //ä»ArrayListå˜åˆ°å­—ç¬¦ä¸²\n    String str1 = String.join(\",\", names);  //String.joinï¼Œ JDK 8 å¼•å…¥\n    System.out.println(str1);\n    \n    String str2 = StringUtils.join(names, \",\");  //Apache Commons Lang\n    System.out.println(str2);\n        \n    //ä»å­—ç¬¦ä¸²å˜å›ArrayList\n    List<String> names2 = Arrays.asList(str2.split(\",\")); \n    for(String name:names2) {\n            System.out.println(name);\n    }\n\n    //StringUtils å¯ä»¥æ”¯æŒæ›´å¤šæ•°æ®ç±»å‹\n    List<Integer> ids = new ArrayList<Integer>();\n    ids.add(1);\n    ids.add(3);\n    ids.add(5);\n    String str3 = StringUtils.join(ids, \",\");  \n    System.out.println(str3);\n    ```\n- å­—ç¬¦ä¸²è½¬ä¹‰\n    - å¯¹å…³é”®å­—ç¬¦è½¬ä¹‰\n    ```java\n    import org.apache.commons.text.StringEscapeUtils;\n    String str = \"He didn't say, \\\"Stop!\\\"\";\n\n    //è½¬ä¹‰\n    String escapedStr = StringEscapeUtils.escapeJava(str);\n    System.out.println(\"escape\" + \":\" + escapedStr);\n\n    //ä»è½¬ä¹‰å­—ç¬¦ä¸²è½¬å›æ¥\n    String str2 = StringEscapeUtils.unescapeJava(escapedStr);\n    System.out.println(\"unescape\" + \":\" + str2);\n    ```\n- å˜é‡åå­—æ ¼å¼åŒ–\n    - åå­—é©¼å³°å‘½å\n    ```java\n    import com.google.common.base.CaseFormat;\n    String s1 = \"CONSTANT_NAME\";\n    String s2 = CaseFormat.UPPER_UNDERSCORE.to(CaseFormat.LOWER_CAMEL, s1);\n    System.out.println(s2); //constantName;\n    ```\n- å­—ç¬¦ä¸²è¾“å…¥æµ\n    - å°†å­—ç¬¦ä¸²è½¬ä¸ºä¸€ä¸ªè¾“å…¥æµ\n    - è¾“å…¥æµå¯ä»¥å®šä¹‰ä¸ºScannerï¼ˆOJå®ç°åŸç†ï¼‰\n    ```java\n    import org.apache.commons.io.Charsets;\n    import org.apache.commons.io.IOUtils;\n    //æ„é€ å­—ç¬¦ä¸²åˆ—è¡¨\n    List<String> names = new LinkedList<String>();\n    names.add(\"Xiaohong\");\n    names.add(\"Xiaoming\");\n    names.add(\"Daming\");\n    names.add(\"Xiaohei\");\n\n    //åˆå¹¶ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä»¥é€—å·ç›¸è¿\n    String nameStr = String.join(\",\",names);\n\n    //å°†å­—ç¬¦ä¸²ä½œä¸ºé»˜è®¤çš„è¾“å…¥æµ\n    InputStream in = IOUtils.toInputStream(nameStr, Charsets.toCharset(\"UTF-8\"));\n    //é‡ç½®ç³»ç»Ÿçš„è¾“å…¥æµ\n    System.setIn(in);\n\n    //æ¨¡æ‹Ÿé”®ç›˜è¾“å…¥  è¿™ä¹Ÿæ˜¯OJå¹³å°æµ‹è¯•ç”¨ä¾‹è¾“å…¥çš„åŸç†\n    //æ­¤å¤„ä¹Ÿå¯ä»¥æ¢æˆä¸€ä¸ªæ–‡ä»¶è¾“å…¥æµ\n    Scanner sc=new Scanner(System.in);\n    sc.useDelimiter(\",\");\n    while(sc.hasNext())\n    {\n        System.out.println(sc.next());\n    }\n    ```","tags":["Java"],"categories":["Java","Javaè¿›é˜¶"]}]