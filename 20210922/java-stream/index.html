<!DOCTYPE html><html lang="zh-CN"><head><link rel="stylesheet" href="/reimu-lighthouse/source/midijs.css"><script src="https://www.midijs.net/lib/midi.js"></script><meta charset="utf-8"><script>!function(t,e,n,c,s,a){t[n]=t[n]||function(){(t[n].q=t[n].q||[]).push(arguments)},(s=e.createElement(c)).async=1,s.src="https://www.clarity.ms/tag/l21x0dspxn",(a=e.getElementsByTagName(c)[0]).parentNode.insertBefore(s,a)}(window,document,"clarity","script")</script><title>Java Stream流 | 拔剑Sketon</title><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel="preload" href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7CNoto%20Serif%20SC:400,400italic,700,700italic%7CUbuntu%20Mono:400,400italic,700,700italic&display=swap&subset=latin,latin-ext" as="style" onload="this.onload&#x3D;null;this.rel&#x3D;&#39;stylesheet&#39;"><link rel="stylesheet" href="https://npm.webcache.cn/@fortawesome/fontawesome-free@6.5.1/css/regular.min.css"><link rel="stylesheet" href="https://npm.webcache.cn/@fortawesome/fontawesome-free@6.5.1/css/solid.min.css"><link rel="preload" href="https://npm.webcache.cn/@fortawesome/fontawesome-free@6.5.1/css/brands.min.css" as="style" onload="this.onload&#x3D;null;this.rel&#x3D;&#39;stylesheet&#39;"><link rel="preload" href="https://npm.webcache.cn/@fortawesome/fontawesome-free@6.5.1/css/v5-font-face.min.css" as="style" onload="this.onload&#x3D;null;this.rel&#x3D;&#39;stylesheet&#39;"><link rel="preload" href="https://npm.webcache.cn/@fortawesome/fontawesome-free@6.5.1/css/v4-font-face.min.css" as="style" onload="this.onload&#x3D;null;this.rel&#x3D;&#39;stylesheet&#39;"><link rel="stylesheet" href="/reimu-lighthouse/css/loader.css"><meta name="description" content="MOOC个人学习笔记JavaStream流，包含流的概述，流的创建和流的应用"><meta property="og:type" content="article"><meta property="og:title" content="Java Stream流"><meta property="og:url" content="https://d-sketon.github.io/reimu-lighthouse/20210922/java-stream/index.html"><meta property="og:site_name" content="拔剑Sketon"><meta property="og:description" content="MOOC个人学习笔记JavaStream流，包含流的概述，流的创建和流的应用"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2021-09-22T14:24:38.000Z"><meta property="article:modified_time" content="2023-01-17T04:43:19.918Z"><meta property="article:author" content="D-Sketon"><meta property="article:tag" content="Java"><meta name="twitter:card" content="summary"><link rel="alternate" href="/reimu-lighthouse/atom.xml" title="拔剑Sketon" type="application/atom+xml"><link rel="shortcut icon" href="/reimu-lighthouse/images/favicon.ico"><link rel="stylesheet" href="https://npm.webcache.cn/typeface-source-code-pro@1.1.13/index.css"><link rel="stylesheet" href="/reimu-lighthouse/css/style.css"><link rel="stylesheet" href="https://npm.webcache.cn/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://npm.webcache.cn/katex@0.16.9/dist/katex.min.css"><link rel="stylesheet" href="https://npm.webcache.cn/@waline/client@v2/dist/waline.css"><script src="https://npm.webcache.cn/pace-js@1.2.4/pace.min.js"></script><link rel="stylesheet" href="https://npm.webcache.cn/wowjs@1.1.3/css/libs/animate.css"><script src="https://npm.webcache.cn/wowjs@1.1.3/dist/wow.min.js"></script><script>new WOW({offset:0,mobile:!0,live:!1}).init()</script><meta name="generator" content="Hexo 7.2.0"></head><body><div id="loader"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="loading-taichi"><svg width="150" height="150" viewBox="0 0 1024 1024" class="icon" version="1.1" xmlns="http://www.w3.org/2000/svg" shape-rendering="geometricPrecision"><path d="M303.5 432A80 80 0 0 1 291.5 592A80 80 0 0 1 303.5 432z" fill="#ff6e6b"/><path d="M512 65A447 447 0 0 1 512 959L512 929A417 417 0 0 0 512 95A417 417 0 0 0 512 929L512 959A447 447 0 0 1 512 65z" fill="#fd0d00"/><path d="M512 95A417 417 0 0 1 929 512A208.5 208.5 0 0 1 720.5 720.5L720.5 592A80 80 0 0 0 720.5 432A80 80 0 0 0 720.5 592L720.5 720.5A208.5 208.5 0 0 1 512 512A208.5 208.5 0 0 0 303.5 303.5A208.5 208.5 0 0 0 95 512A417 417 0 0 1 512 95" fill="#fd0d00"/></svg></div><div class="loading-word">少女祈祷中...</div></div></div><script>var time=null;const startLoading=()=>{time=Date.now(),document.getElementById("loader").classList.remove("loading")},endLoading=()=>{time?500<Date.now()-time?(time=null,document.body.style.overflow="auto",document.getElementById("loader").classList.add("loading")):(setTimeout(endLoading,500-(Date.now()-time)),time=null):(document.body.style.overflow="auto",document.getElementById("loader").classList.add("loading"))};window.addEventListener("load",endLoading),document.getElementById("loader").addEventListener("click",endLoading)</script><div id="container"><div id="wrap"><div id="header-nav"><nav id="main-nav"><span class="main-nav-link-wrap"><span class="main-nav-icon"></span> <a class="main-nav-link" href="/reimu-lighthouse/">首页</a> </span><span class="main-nav-link-wrap"><span class="main-nav-icon"></span> <a class="main-nav-link" href="/reimu-lighthouse/archives">归档</a> </span><span class="main-nav-link-wrap"><span class="main-nav-icon"></span> <a class="main-nav-link" href="/reimu-lighthouse/about">关于</a> </span><span class="main-nav-link-wrap"><span class="main-nav-icon"></span> <a class="main-nav-link" href="/reimu-lighthouse/friend">友链</a> </span><a id="main-nav-toggle" class="nav-icon"></a></nav><nav id="sub-nav"><a id="nav-rss-link" class="nav-icon" href="/reimu-lighthouse/atom.xml" title="RSS 订阅"></a> <a id="nav-search-btn" class="nav-icon popup-trigger" title="搜索"></a></nav></div><header id="header"><img fetchpriority="high" src="/images/banner.webp" alt="Java Stream流"><div id="header-outer" class="outer"><div id="header-title" class="inner"><div id="logo-wrap"><a href="/reimu-lighthouse/" id="logo"><h1>Java Stream流</h1></a></div><h2 id="subtitle-wrap"></h2></div></div></header><div id="content" class="outer"><aside id="sidebar"><div class="sidebar-wrap wow fadeInRight wrap-sticky"><div class="sidebar-toc-sidebar"><div class="sidebar-toc"><h3 class="toc-title">文章目录</h3><div class="sidebar-toc-wrapper toc-div-class"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E6%B5%81%E7%9A%84%E6%A6%82%E8%BF%B0"><span class="toc-number">1.</span> <span class="toc-text">1.流的概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#stream%E8%AF%AD%E6%B3%95"><span class="toc-number">1.1.</span> <span class="toc-text">Stream语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%81%E7%9A%84%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B"><span class="toc-number">1.2.</span> <span class="toc-text">流的工作流程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E6%B5%81%E7%9A%84%E5%88%9B%E5%BB%BA"><span class="toc-number">2.</span> <span class="toc-text">2.流的创建</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E7%B1%BB%E5%9E%8B%E6%B5%81"><span class="toc-number">2.1.</span> <span class="toc-text">基本类型流</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B9%B6%E8%A1%8C%E6%B5%81"><span class="toc-number">2.2.</span> <span class="toc-text">并行流</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3stream%E7%9A%84%E8%BD%AC%E6%8D%A2"><span class="toc-number">3.</span> <span class="toc-text">3.Stream的转换</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4filter"><span class="toc-number">3.1.</span> <span class="toc-text">过滤filter</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%BB%E9%87%8Ddistinct"><span class="toc-number">3.2.</span> <span class="toc-text">去重distinct</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%92%E5%BA%8Fsorted"><span class="toc-number">3.3.</span> <span class="toc-text">排序sorted</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BD%AC%E5%8C%96map"><span class="toc-number">3.4.</span> <span class="toc-text">转化map</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%BD%E5%8F%96limit"><span class="toc-number">3.5.</span> <span class="toc-text">抽取limit</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%B3%E8%BF%87skip"><span class="toc-number">3.6.</span> <span class="toc-text">跳过skip</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5concat"><span class="toc-number">3.7.</span> <span class="toc-text">连接concat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%9D%E5%A4%96%E8%B0%83%E8%AF%95peek"><span class="toc-number">3.8.</span> <span class="toc-text">额外调试peek</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4optional%E7%B1%BB%E5%9E%8B"><span class="toc-number">4.</span> <span class="toc-text">4.Optional类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#optionalt%E5%88%9B%E5%BB%BA"><span class="toc-number">4.1.</span> <span class="toc-text">Optional&lt;T&gt;创建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#optionalt%E4%BD%BF%E7%94%A8"><span class="toc-number">4.2.</span> <span class="toc-text">Optional&lt;T&gt;使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#optionalt%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">4.3.</span> <span class="toc-text">Optional&lt;T&gt;注意事项</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5%E6%B5%81%E7%9A%84%E8%AE%A1%E7%AE%97%E7%BB%93%E6%9E%9C"><span class="toc-number">5.</span> <span class="toc-text">5.流的计算结果</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E7%BA%A6%E7%AE%80%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0"><span class="toc-number">5.1.</span> <span class="toc-text">简单约简(聚合函数)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BA%A6%E7%AE%80"><span class="toc-number">5.2.</span> <span class="toc-text">自定义约简</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E9%81%8D%E5%8E%86%E5%85%83%E7%B4%A0"><span class="toc-number">5.3.</span> <span class="toc-text">查看&#x2F;遍历元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E6%94%BE%E5%88%B0%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%AD"><span class="toc-number">5.4.</span> <span class="toc-text">存放到数据结构中</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%81%E7%9A%84%E9%AB%98%E9%98%B6%E8%AE%A1%E7%AE%97"><span class="toc-number">5.5.</span> <span class="toc-text">流的高阶计算</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6%E6%B5%81%E7%9A%84%E5%BA%94%E7%94%A8"><span class="toc-number">6.</span> <span class="toc-text">6.流的应用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#java-stream%E7%9A%84%E4%BC%98%E7%82%B9"><span class="toc-number">6.1.</span> <span class="toc-text">Java Stream的优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#java-stream-vs-%E5%BE%AA%E7%8E%AF%E8%BF%AD%E4%BB%A3%E4%BB%A3%E7%A0%81"><span class="toc-number">6.2.</span> <span class="toc-text">Java Stream vs 循环迭代代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#stream%E5%BA%94%E7%94%A8%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">6.3.</span> <span class="toc-text">Stream应用注意事项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#stream-vs-collection"><span class="toc-number">6.4.</span> <span class="toc-text">Stream vs Collection</span></a></li></ol></li></ol></div></div></div><div class="sidebar-common-sidebar hidden"><div class="sidebar-author"><img data-src="/avatar/avatar.webp" data-sizes="auto" alt="D-Sketon" class="lazyload"><div class="sidebar-author-name">D-Sketon</div><div class="sidebar-description">D-Sketon&#39;s blog</div></div><div class="sidebar-state"><div class="sidebar-state-article"><div>文章</div><div class="sidebar-state-number">53</div></div><div class="sidebar-state-category"><div>分类</div><div class="sidebar-state-number">10</div></div><div class="sidebar-state-tag"><div>标签</div><div class="sidebar-state-number">19</div></div></div><div class="sidebar-social"><div class="icon-github"><a href="https://github.com/D-Sketon" itemprop="url" target="_blank" aria-label="github"></a></div><div class="icon-bilibili"><a href="https://space.bilibili.com/20339857" itemprop="url" target="_blank" aria-label="bilibili"></a></div></div><div class="sidebar-menu"><div class="sidebar-menu-link-wrap"><a class="sidebar-menu-link-dummy" href="/reimu-lighthouse/" aria-label="首页"></a> <span class="sidebar-menu-icon"></span><div class="sidebar-menu-link">首页</div></div><div class="sidebar-menu-link-wrap"><a class="sidebar-menu-link-dummy" href="/reimu-lighthouse/archives" aria-label="归档"></a> <span class="sidebar-menu-icon"></span><div class="sidebar-menu-link">归档</div></div><div class="sidebar-menu-link-wrap"><a class="sidebar-menu-link-dummy" href="/reimu-lighthouse/about" aria-label="关于"></a> <span class="sidebar-menu-icon"></span><div class="sidebar-menu-link">关于</div></div><div class="sidebar-menu-link-wrap"><a class="sidebar-menu-link-dummy" href="/reimu-lighthouse/friend" aria-label="友链"></a> <span class="sidebar-menu-icon"></span><div class="sidebar-menu-link">友链</div></div></div></div><div class="sidebar-btn-wrapper" style="position:static"><div class="sidebar-toc-btn current"></div><div class="sidebar-common-btn"></div></div></div></aside><section id="main"><article id="post-Stream流" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting"><div class="article-inner"><div class="article-meta"><div class="article-date wow slideInLeft"><a href="/reimu-lighthouse/20210922/java-stream/" class="article-date-link"><time datetime="2021-09-22T14:24:38.000Z" itemprop="datePublished">2021-09-22</time></a></div><div class="article-category wow slideInLeft"><a class="article-category-link" href="/reimu-lighthouse/categories/Java/">Java</a><a class="article-category-link" href="/reimu-lighthouse/categories/Java/Java%E9%AB%98%E9%98%B6/">Java高阶</a></div></div><div class="hr-line"></div><div class="e-content article-entry" itemprop="articleBody"><h2 id="1流的概述"><a class="markdownIt-Anchor" href="#1流的概述"></a> <strong>1.流的概述</strong></h2><p>a sequence of elements from source that supports aggregate operations</p><ul><li>sequence of elements: 一个流对外提供一个接口，可以访问到一串特定的数据。<strong>流不存储元素</strong>，但是可以根据需要进行计算转化</li><li>source：数据来源，如数据结构，数组，文件等</li><li>aggregate operation：聚合操作，流支持像SQL操作或者其他函数式语言的操作，如filter/map/reduce/find/match/sorted等</li><li>pipelining: 很多流操作也是返回一个流</li><li>Internal Iteration: 流操作进行迭代，用户感知不到循环遍历</li></ul><h3 id="stream语法"><a class="markdownIt-Anchor" href="#stream语法"></a> <strong>Stream语法</strong></h3><ul><li>类似SQL语句，遵循“做什么而非怎么做”原则</li></ul><h3 id="流的工作流程"><a class="markdownIt-Anchor" href="#流的工作流程"></a> <strong>流的工作流程</strong></h3><ul><li>流的创建</li><li>流的转换，将流转换为其他流的中间操作，可包括多个步骤(惰性操作)</li><li>流的计算结果。这个操作会强制执行之前的惰性操作。这个步骤以后，流就再也不用了</li></ul><h2 id="2流的创建"><a class="markdownIt-Anchor" href="#2流的创建"></a> <strong>2.流的创建</strong></h2><ul><li>Collection接口的stream方法<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Stream&lt;String&gt; a1 = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;String&gt;().stream();</span><br><span class="line">Stream&lt;String&gt; a2 = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;String&gt;().stream();</span><br></pre></td></tr></table></figure><ul><li>还有其他的子类，如LinkedList, LinkedSet, TreeSet, Vector等</li></ul></li><li>Arrays.stream可以将数组转为Stream<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Stream&lt;String&gt; b1 = Arrays.stream(<span class="string">&quot;a,b,c,d,e&quot;</span>.split(<span class="string">&quot;,&quot;</span>), <span class="number">3</span>, <span class="number">5</span>);</span><br></pre></td></tr></table></figure></li><li>利用Stream类进行转化<ul><li>of 方法，直接将数组转化</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Stream&lt;Integer&gt; c1 = Stream.of(<span class="keyword">new</span> <span class="title class_">Integer</span>[<span class="number">5</span>]);</span><br><span class="line">Stream&lt;String&gt; c2 = Stream.of(<span class="string">&quot;a,b,c&quot;</span>.split(<span class="string">&quot;,&quot;</span>));</span><br><span class="line">Stream&lt;String&gt; c3 = Stream.of(<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>);</span><br></pre></td></tr></table></figure><ul><li>empty方法，产生一个空流</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Stream&lt;String&gt; d1 = Stream.empty();</span><br></pre></td></tr></table></figure></li><li>利用Stream类进行转化<ul><li>generate 方法，接收一个Lambda表达式</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Stream&lt;String&gt; e1 = Stream.generate(()-&gt;<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">Stream&lt;Double&gt; e2 = Stream.generate(Math::random);</span><br></pre></td></tr></table></figure><ul><li>iterate方法，接收一个种子，和一个Lambda表达式</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Stream&lt;BigInteger&gt; e3 = Stream.iterate(BigInteger.ZERO, n -&gt; n.add(BigInteger.ONE));</span><br></pre></td></tr></table></figure></li><li>其他类/方法产生Stream流<ul><li>Files.lines方法</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Stream&lt;String&gt; contents = Files.lines(Paths.get(<span class="string">&quot;C:/abc.txt&quot;</span>)); </span><br></pre></td></tr></table></figure><ul><li>Pattern的splitAsStream方法</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Stream&lt;String&gt; words = Pattern.compile(<span class="string">&quot;,&quot;</span>).splitAsStream(<span class="string">&quot;a,b,c&quot;</span>);</span><br></pre></td></tr></table></figure></li></ul><h3 id="基本类型流"><a class="markdownIt-Anchor" href="#基本类型流"></a> <strong>基本类型流</strong></h3><ul><li>IntStream，LongStream，DoubleStream</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">IntStream</span> <span class="variable">s1</span> <span class="operator">=</span> IntStream.of(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">s1 = Arrays.stream(<span class="keyword">new</span> <span class="title class_">int</span>[] &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>&#125;);        </span><br><span class="line">s1 = IntStream.generate(()-&gt;(<span class="type">int</span>)(Math.random() * <span class="number">100</span>));        </span><br><span class="line">s1 = IntStream.range(<span class="number">1</span>,<span class="number">5</span>); <span class="comment">//1,2,3,4  step 1        </span></span><br><span class="line">s1 = IntStream.rangeClosed(<span class="number">1</span>,<span class="number">5</span>); <span class="comment">//1,2,3,4,5</span></span><br><span class="line"></span><br><span class="line"><span class="type">IntStream</span> <span class="variable">s2</span> <span class="operator">=</span> IntStream.of(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>);</span><br><span class="line">Stream&lt;Integer&gt; s3 = s2.boxed();</span><br><span class="line"><span class="type">IntStream</span> <span class="variable">s5</span> <span class="operator">=</span> s3.mapToInt(Integer::intValue);</span><br></pre></td></tr></table></figure><h3 id="并行流"><a class="markdownIt-Anchor" href="#并行流"></a> <strong>并行流</strong></h3><ul><li>使得所有的中间转换操作都将被并行化</li><li>Collections.parallelStream()将任何集合转为并行流</li><li>Stream.parallel()方法，产生一个并行流</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">IntStream</span> <span class="variable">s1</span> <span class="operator">=</span> IntStream.range(<span class="number">1</span>,<span class="number">10000000</span>);</span><br><span class="line"><span class="type">long</span> <span class="variable">evenNum</span> <span class="operator">=</span> s1.parallel().filter(n-&gt;n%<span class="number">2</span>==<span class="number">0</span>).count();</span><br><span class="line">System.out.println(evenNum);</span><br></pre></td></tr></table></figure><ul><li><strong>注意：需要保证传给并行流的操作不存在竞争</strong></li></ul><h2 id="3stream的转换"><a class="markdownIt-Anchor" href="#3stream的转换"></a> <strong>3.Stream的转换</strong></h2><h3 id="过滤filter"><a class="markdownIt-Anchor" href="#过滤filter"></a> <strong>过滤filter</strong></h3><ul><li>filter(Predicate&lt;? super T&gt; predicate)</li><li>接收一个Lambda表达式，对每个元素进行判定，符合条件留下</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Stream&lt;Integer&gt; s1 = Stream.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line">Stream&lt;Integer&gt; s2 = s1.filter(n -&gt; n&gt;<span class="number">2</span>);</span><br><span class="line">s2.forEach(System.out::println);</span><br><span class="line"><span class="comment">//3, 4, 5</span></span><br></pre></td></tr></table></figure><h3 id="去重distinct"><a class="markdownIt-Anchor" href="#去重distinct"></a> <strong>去重distinct</strong></h3><ul><li>distinct()</li><li>对流的元素进行过滤，去除重复，只留下不重复的元素</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//基本类型包装类对象去重</span></span><br><span class="line">Stream&lt;Integer&gt; s1 = Stream.of(<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>);</span><br><span class="line">Stream&lt;Integer&gt; s2 = s1.distinct();</span><br><span class="line">s2.forEach(System.out::println);</span><br><span class="line"><span class="comment">// 1, 2, 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//自定义对象的去重</span></span><br><span class="line">ArrayList&lt;Student&gt; students = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Student&gt;();</span><br><span class="line">students.add(<span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;Tom&quot;</span>, <span class="number">20</span>));</span><br><span class="line">students.add(<span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;Tom&quot;</span>, <span class="number">20</span>));</span><br><span class="line">students.add(<span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;Jerry&quot;</span>, <span class="number">20</span>));</span><br><span class="line">students.add(<span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&quot;Jerry&quot;</span>, <span class="number">18</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 先对象的hashCode再调用equals方法进行判重</span></span><br><span class="line">Stream&lt;Student&gt; s3 = students.stream().distinct();</span><br><span class="line">s3.forEach(System.out::println);</span><br></pre></td></tr></table></figure><h3 id="排序sorted"><a class="markdownIt-Anchor" href="#排序sorted"></a> <strong>排序sorted</strong></h3><ul><li>sorted()</li><li>对流的基本类型包装类元素进行排序</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Stream&lt;Integer&gt; s1 = Stream.of(<span class="number">3</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">5</span>);</span><br><span class="line">Stream&lt;Integer&gt; s2 = s1.sorted();</span><br><span class="line">s2.forEach(System.out::println);</span><br><span class="line"><span class="comment">//1, 2, 3, 4, 5</span></span><br></pre></td></tr></table></figure><ul><li>提供Comparator，对流的元素进行排序</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">String[] planets = <span class="keyword">new</span> <span class="title class_">String</span>[] &#123; </span><br><span class="line">        <span class="string">&quot;Mercury&quot;</span>, <span class="string">&quot;Venus&quot;</span>, <span class="string">&quot;Earth&quot;</span>, </span><br><span class="line">        <span class="string">&quot;Mars&quot;</span>, <span class="string">&quot;Jupiter&quot;</span>, <span class="string">&quot;Saturn&quot;</span>, </span><br><span class="line">        <span class="string">&quot;Uranus&quot;</span>, <span class="string">&quot;Neptune&quot;</span> &#125;;</span><br><span class="line"></span><br><span class="line">Stream&lt;String&gt; s3 = Stream.of(planets).sorted(</span><br><span class="line">        Comparator.comparing(String::length));</span><br><span class="line">s3.forEach(System.out::println);</span><br></pre></td></tr></table></figure><ul><li>对流的自定义对象元素进行排序，调用对象的compareTo方法</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ArrayList&lt;Cat&gt; cats = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">cats.add(<span class="keyword">new</span> <span class="title class_">Cat</span>(<span class="number">3</span>));</span><br><span class="line">cats.add(<span class="keyword">new</span> <span class="title class_">Cat</span>(<span class="number">2</span>));</span><br><span class="line">cats.add(<span class="keyword">new</span> <span class="title class_">Cat</span>(<span class="number">5</span>));</span><br><span class="line">cats.add(<span class="keyword">new</span> <span class="title class_">Cat</span>(<span class="number">1</span>));</span><br><span class="line">cats.add(<span class="keyword">new</span> <span class="title class_">Cat</span>(<span class="number">4</span>));</span><br><span class="line">Stream&lt;Cat&gt; s4 = cats.stream().sorted();</span><br><span class="line">s4.forEach(System.out::println);</span><br></pre></td></tr></table></figure><h3 id="转化map"><a class="markdownIt-Anchor" href="#转化map"></a> <strong>转化map</strong></h3><ul><li>利用方法引用对流每个元素进行函数计算</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Stream&lt;Double&gt; s1 = Stream.of(-<span class="number">1.5</span>, <span class="number">2.5</span>, -<span class="number">3.5</span>);</span><br><span class="line">Stream&lt;Double&gt; s2 = s1.map(Math::abs);</span><br><span class="line">s2.forEach(System.out::println);</span><br></pre></td></tr></table></figure><ul><li>利用Lambda表达式对流每个元素进行函数计算</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Stream&lt;Integer&gt; s3 = Stream.of(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>);</span><br><span class="line">Stream&lt;Integer&gt; s4 = s3.map(n-&gt;n*n);</span><br><span class="line">s4.forEach(System.out::println);</span><br></pre></td></tr></table></figure><ul><li>利用方法引用，对流每个元素进行函数计算返回Stream</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">String[] planets = <span class="keyword">new</span> <span class="title class_">String</span>[] &#123; </span><br><span class="line">        <span class="string">&quot;Mercury&quot;</span>, <span class="string">&quot;Venus&quot;</span>, <span class="string">&quot;Earth&quot;</span>&#125;;</span><br><span class="line"></span><br><span class="line">Stream&lt;String&gt; allLetters2 = </span><br><span class="line">        Stream.of(planets).flatMap(word -&gt; letters(word));</span><br><span class="line">allLetters2.forEach(System.out::print);</span><br><span class="line"><span class="comment">//flatMap 执行一对多的转换，然后将所有的Map都展开</span></span><br><span class="line"><span class="comment">//[&#x27;M&#x27;,&#x27;e&#x27;,&#x27;r&#x27;,&#x27;c&#x27;,&#x27;u&#x27;,&#x27;r&#x27;,&#x27;y&#x27;,</span></span><br><span class="line"><span class="comment">// &#x27;V&#x27;,&#x27;e&#x27;,&#x27;n&#x27;,&#x27;u&#x27;,&#x27;s&#x27;,</span></span><br><span class="line"><span class="comment">// &#x27;E&#x27;,&#x27;a&#x27;,&#x27;r&#x27;,&#x27;t&#x27;,&#x27;h&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> Stream&lt;String&gt; <span class="title function_">letters</span><span class="params">(String word)</span></span><br><span class="line">&#123;</span><br><span class="line">    List&lt;String&gt; result = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;word.length();i++)</span><br><span class="line">    &#123;</span><br><span class="line">        result.add(word.substring(i, i+<span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result.stream();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>利用方法引用，对流每个元素进行函数计算返回Stream，并合并</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Stream&lt;Stream&lt;String&gt;&gt; allLetters = </span><br><span class="line">        Stream.of(planets).map(word -&gt; letters(word));</span><br><span class="line">allLetters.forEach(System.out::print);</span><br><span class="line"><span class="comment">//[[&#x27;M&#x27;,&#x27;e&#x27;,&#x27;r&#x27;,&#x27;c&#x27;,&#x27;u&#x27;,&#x27;r&#x27;,&#x27;y&#x27;],</span></span><br><span class="line"><span class="comment">// [&#x27;V&#x27;,&#x27;e&#x27;,&#x27;n&#x27;,&#x27;u&#x27;,&#x27;s&#x27;],</span></span><br><span class="line"><span class="comment">// [&#x27;E&#x27;,&#x27;a&#x27;,&#x27;r&#x27;,&#x27;t&#x27;,&#x27;h&#x27;]]</span></span><br></pre></td></tr></table></figure><h3 id="抽取limit"><a class="markdownIt-Anchor" href="#抽取limit"></a> <strong>抽取limit</strong></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取前n个元素</span></span><br><span class="line">Stream&lt;Integer&gt; s1 = Stream.of(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>);</span><br><span class="line">Stream&lt;Integer&gt; s2 = s1.limit(<span class="number">3</span>);</span><br><span class="line">s2.forEach(System.out::println);</span><br></pre></td></tr></table></figure><h3 id="跳过skip"><a class="markdownIt-Anchor" href="#跳过skip"></a> <strong>跳过skip</strong></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//跳过前n个元素</span></span><br><span class="line">Stream&lt;Integer&gt; s3 = Stream.of(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>);</span><br><span class="line">Stream&lt;Integer&gt; s4 = s3.skip(<span class="number">8</span>);</span><br><span class="line">s4.forEach(System.out::println);</span><br></pre></td></tr></table></figure><h3 id="连接concat"><a class="markdownIt-Anchor" href="#连接concat"></a> <strong>连接concat</strong></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//连接两个流</span></span><br><span class="line">Stream&lt;String&gt; s5 = Stream.concat(letters(<span class="string">&quot;hello&quot;</span>), letters(<span class="string">&quot;world&quot;</span>));</span><br><span class="line">s5.forEach(System.out::println);</span><br></pre></td></tr></table></figure><h3 id="额外调试peek"><a class="markdownIt-Anchor" href="#额外调试peek"></a> <strong>额外调试peek</strong></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Stream&lt;Double&gt; s1 = Stream.iterate(<span class="number">1.0</span>, n -&gt; n*<span class="number">2</span>)</span><br><span class="line">        .peek(n -&gt; System.out.println(<span class="string">&quot;number:&quot;</span> + n)).limit(<span class="number">5</span>);</span><br><span class="line">s1.forEach(System.out::println);</span><br></pre></td></tr></table></figure><h2 id="4optional类型"><a class="markdownIt-Anchor" href="#4optional类型"></a> <strong>4.Optional类型</strong></h2><ul><li>一个包装器对象</li><li>要么包装了类型T的对象，要么没有包装任何对象(<strong>还是null</strong>)</li><li><strong>如果T有值，那么直接返回T的对象</strong></li><li><strong>如果T是null，那么可以返回一个替代物</strong></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Optional&lt;String&gt; s1 = Optional.of(<span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&quot;abc&quot;</span>));</span><br><span class="line"><span class="type">String</span> <span class="variable">s2</span> <span class="operator">=</span> s1.get();</span><br><span class="line">System.out.println(<span class="string">&quot;s2: &quot;</span> + s2); <span class="comment">//abc</span></span><br><span class="line"></span><br><span class="line">Optional&lt;String&gt; s3 = Optional.empty();</span><br><span class="line"><span class="type">String</span> <span class="variable">s4</span> <span class="operator">=</span> s3.orElse(<span class="string">&quot;def&quot;</span>); </span><br><span class="line">System.out.println(<span class="string">&quot;s4: &quot;</span> + s4); <span class="comment">//def</span></span><br></pre></td></tr></table></figure><h3 id="optionalt创建"><a class="markdownIt-Anchor" href="#optionalt创建"></a> <strong>Optional&lt;T&gt;创建</strong></h3><ul><li>of方法</li><li>empty方法</li><li><strong>ofNullable方法，对于对象有可能为null情况下，安全创建</strong></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Optional&lt;String&gt; s5 = Optional.of(<span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&quot;abc&quot;</span>));</span><br><span class="line">Optional&lt;String&gt; s6 = Optional.empty();</span><br><span class="line"><span class="type">String</span> <span class="variable">s7</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">Optional&lt;String&gt; s8 = Optional.ofNullable(s7); </span><br><span class="line"><span class="comment">//s7不为Null，s8就是s7, 否则s8就为Optional.empty()</span></span><br></pre></td></tr></table></figure><h3 id="optionalt使用"><a class="markdownIt-Anchor" href="#optionalt使用"></a> <strong>Optional&lt;T&gt;使用</strong></h3><ul><li>get方法，获取值，不安全的用法<br>-orElse方法，获取值，如果为null，采用替代物的值</li><li>orElseGet方法，获取值，如果为null，采用Lambda表达式值返回</li><li>orElseThrow方法，获取值，如果为null，抛出异常</li><li>ifPresent方法，判断是否为空，不为空返回true</li><li>isPresent(Consumer), 判断是否为空，如果不为空，则进行后续Consumer操作,如果为空，则不做任何事情</li><li>map(Function), 将值传递给Function函数进行计算。如果为空，则不计算</li></ul><h3 id="optionalt注意事项"><a class="markdownIt-Anchor" href="#optionalt注意事项"></a> <strong>Optional&lt;T&gt;注意事项</strong></h3><ul><li>直接使用get，很容易引发NoSuchElementException异常</li><li>使用isPresent判断值是否存在，这和判断null是一样的低效</li></ul><h2 id="5流的计算结果"><a class="markdownIt-Anchor" href="#5流的计算结果"></a> <strong>5.流的计算结果</strong></h2><h3 id="简单约简聚合函数"><a class="markdownIt-Anchor" href="#简单约简聚合函数"></a> <strong>简单约简(聚合函数)</strong></h3><ul><li>count(), 计数</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Stream&lt;Integer&gt; s1 = Stream.of(a);</span><br><span class="line"><span class="type">long</span> <span class="variable">countResult</span> <span class="operator">=</span> s1.filter(n-&gt; n&gt;<span class="number">0</span>).count();</span><br></pre></td></tr></table></figure><ul><li>max(Comparator)，最大值，需要比较器</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Stream&lt;Integer&gt; s2 = Stream.of(a);</span><br><span class="line">Optional&lt;Integer&gt; maxResult = s2.max((n1,n2)-&gt;n1-n2);</span><br></pre></td></tr></table></figure><ul><li>min(Comparator)，最小值，需要比较器</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Stream&lt;Integer&gt; s3 = Stream.of(a);</span><br><span class="line">Optional&lt;Integer&gt; minResult = s3.min((n1,n2)-&gt;n1-n2);</span><br></pre></td></tr></table></figure><ul><li>findFirst(), 找到第一个元素</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Stream&lt;Integer&gt; s4 = Stream.of(a);</span><br><span class="line">Optional&lt;Integer&gt; first = s4.findFirst();</span><br></pre></td></tr></table></figure><ul><li>findAny(), 找到任意一个元素</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Stream&lt;Integer&gt; s5 = Stream.of(a);</span><br><span class="line">Optional&lt;Integer&gt; random = s5.findAny();</span><br></pre></td></tr></table></figure><ul><li>anyMatch(Predicate)，如有任意一个元素满足Predicate，返回true</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Stream&lt;Integer&gt; s6 = Stream.of(a);</span><br><span class="line">System.out.println(s6.anyMatch(n -&gt; n&gt;<span class="number">6</span>));</span><br></pre></td></tr></table></figure><ul><li>allMatch(Predicate)，如所有元素满足Predicate，返回true</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Stream&lt;Integer&gt; s7 = Stream.of(a);</span><br><span class="line">System.out.println(s7.allMatch(n -&gt; n&gt;<span class="number">6</span>));</span><br></pre></td></tr></table></figure><ul><li>noneMatch(Predicate)，如没有任何元素满足Predicate，返回true</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Stream&lt;Integer&gt; s8 = Stream.of(a);</span><br><span class="line">System.out.println(s8.noneMatch(n-&gt;n&gt;<span class="number">100</span>));</span><br></pre></td></tr></table></figure><h3 id="自定义约简"><a class="markdownIt-Anchor" href="#自定义约简"></a> <strong>自定义约简</strong></h3><ul><li>reduce，传递一个二元函数BinaryOperator，对流元素进行计算</li><li>如求和、求积、字符串连接等</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Integer[] a = <span class="keyword">new</span> <span class="title class_">Integer</span>[] &#123;<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">8</span>&#125;;</span><br><span class="line">        </span><br><span class="line">Stream&lt;Integer&gt; s1 = Stream.of(a);</span><br><span class="line">Optional&lt;Integer&gt; sum = s1.reduce(Integer::sum);</span><br><span class="line">System.out.println(sum.get());</span><br><span class="line"></span><br><span class="line">Stream&lt;Integer&gt; s2 = Stream.of(a);</span><br><span class="line">Optional&lt;Integer&gt; product = s2.reduce((x,y)-&gt;x*y);</span><br><span class="line">System.out.println(product.get());</span><br><span class="line"></span><br><span class="line">Stream&lt;Integer&gt; s3 = Stream.of(a);</span><br><span class="line"><span class="type">Integer</span> <span class="variable">product3</span> <span class="operator">=</span> s3.reduce(<span class="number">1</span>,(x,y)-&gt;x*y);</span><br><span class="line">System.out.println(product3);</span><br><span class="line"></span><br><span class="line">String[] b = <span class="keyword">new</span> <span class="title class_">String</span>[] &#123;<span class="string">&quot;abc&quot;</span>,<span class="string">&quot;def&quot;</span>,<span class="string">&quot;ghi&quot;</span>&#125;;</span><br><span class="line">Stream&lt;String&gt; s4 = Stream.of(b);</span><br><span class="line"><span class="type">String</span> <span class="variable">bigStr</span> <span class="operator">=</span> s4.reduce(<span class="string">&quot;&quot;</span>,(x,y)-&gt;x+y);</span><br><span class="line">System.out.println(bigStr);</span><br></pre></td></tr></table></figure><h3 id="查看遍历元素"><a class="markdownIt-Anchor" href="#查看遍历元素"></a> <strong>查看/遍历元素</strong></h3><ul><li>iterator()，遍历元素</li><li>forEach(Consumer)，应用一个函数到每个元素上</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Integer[] a = <span class="keyword">new</span> <span class="title class_">Integer</span>[] &#123;<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">8</span>&#125;;</span><br><span class="line">        </span><br><span class="line">Stream&lt;Integer&gt; s1 = Stream.of(a);</span><br><span class="line">Iterator&lt;Integer&gt; it1 = s1.filter(n-&gt;n&gt;<span class="number">2</span>).iterator();</span><br><span class="line"><span class="keyword">while</span>(it1.hasNext()) &#123;</span><br><span class="line">    System.out.println(it1.next());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Stream&lt;Integer&gt; s2 = Stream.of(a);</span><br><span class="line">s2.filter(n-&gt;n&gt;<span class="number">2</span>).forEach(System.out::println);</span><br></pre></td></tr></table></figure><h3 id="存放到数据结构中"><a class="markdownIt-Anchor" href="#存放到数据结构中"></a> <strong>存放到数据结构中</strong></h3><ul><li>toArray()，将结果转为数组</li><li>collect(Collectors.toList()),将结果转为List</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//List</span></span><br><span class="line">Stream&lt;Integer&gt; s1 = Stream.of(a);</span><br><span class="line">List&lt;Integer&gt; list1 = s1.collect(Collectors.toList());</span><br><span class="line"></span><br><span class="line"><span class="comment">//Linkedlist</span></span><br><span class="line">Stream&lt;Integer&gt; s2 = Stream.of(a);</span><br><span class="line">List&lt;Integer&gt; list2 = s2.collect(Collectors.toCollection(LinkedList::<span class="keyword">new</span>));</span><br></pre></td></tr></table></figure><ul><li>collect(Collectors.toSet()),将结果转为Set</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Stream&lt;Integer&gt; s3 = Stream.of(a);</span><br><span class="line">Set&lt;Integer&gt; set1 = s3.collect(Collectors.toSet());</span><br></pre></td></tr></table></figure><ul><li>collect(Collectors.toMap()), 将结果转为Map</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Person&gt; persons = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Person&gt;();</span><br><span class="line">persons.add(<span class="keyword">new</span> <span class="title class_">Person</span>(<span class="number">1</span>, <span class="string">&quot;Jerry&quot;</span>));</span><br><span class="line">persons.add(<span class="keyword">new</span> <span class="title class_">Person</span>(<span class="number">2</span>, <span class="string">&quot;Tom&quot;</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">//将流存储为Map</span></span><br><span class="line">Stream&lt;Person&gt; s6 = persons.stream();</span><br><span class="line">Map&lt;Integer, String&gt; map1 = s6.collect(Collectors.toMap(Person::getId, Person::getName));</span><br></pre></td></tr></table></figure><ul><li>collect(Collectors.joining()), 将结果连接起来</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//将流变换为字符流，并连接起来</span></span><br><span class="line">Stream&lt;Integer&gt; s4 = Stream.of(a);</span><br><span class="line"><span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> s4.map(String::valueOf).collect(Collectors.joining());</span><br><span class="line">System.out.println(result); <span class="comment">//2468</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//将流变换为字符流，并连接起来</span></span><br><span class="line">Stream&lt;Integer&gt; s5 = Stream.of(a);</span><br><span class="line"><span class="type">String</span> <span class="variable">result2</span> <span class="operator">=</span> s5.map(String::valueOf).collect(Collectors.joining(<span class="string">&quot;,&quot;</span>));</span><br><span class="line">System.out.println(result2); <span class="comment">//2,4,6,8</span></span><br></pre></td></tr></table></figure><h3 id="流的高阶计算"><a class="markdownIt-Anchor" href="#流的高阶计算"></a> <strong>流的高阶计算</strong></h3><ul><li>分组groupingBy和分区partitionBy</li><li>分组后的约简<ul><li>counting</li><li>summing</li><li>maxBy</li><li>minBy</li></ul></li><li>以上方法均在java.util.stream.Collectors中</li></ul><h2 id="6流的应用"><a class="markdownIt-Anchor" href="#6流的应用"></a> <strong>6.流的应用</strong></h2><h3 id="java-stream的优点"><a class="markdownIt-Anchor" href="#java-stream的优点"></a> <strong>Java Stream的优点</strong></h3><ul><li>统一转换元素</li><li>过滤元素</li><li>利用单个操作合并元素</li><li>将元素序列存放到某一个集合中</li><li>搜索满足某些条件的元素的序列</li><li><strong>类似SQL操作，遵循“做什么而非怎么做”原则</strong></li><li><strong>简化了串行/并行的大批量操作</strong></li></ul><h3 id="java-stream-vs-循环迭代代码"><a class="markdownIt-Anchor" href="#java-stream-vs-循环迭代代码"></a> <strong>Java Stream vs 循环迭代代码</strong></h3><ul><li>Stream广泛使用Lambda表达式，只能读取外围的final或者effectively final变量，循环迭代代码可以读取/修改任意的局部变量。</li><li>在循环迭代代码块中，可以随意break/continue/return，或者抛出异常，而Lambda表达式无法完成这些事情。</li><li><strong>Stream流不是淘汰循环迭代代码，应该是两者相互搭配使用</strong></li></ul><h3 id="stream应用注意事项"><a class="markdownIt-Anchor" href="#stream应用注意事项"></a> <strong>Stream应用注意事项</strong></h3><ul><li>一个流，一次只能一个用途，不能多个用途，用了不能再用</li><li>避免创建无限流</li><li>注意操作顺序</li><li>谨慎使用并行流<ul><li>底层使用Fork-Join Pool，处理计算密集型任务</li><li>数据量过小不用</li><li>数据结构不容易分解的时候不用，如LinkedList等 –数据频繁拆箱装箱不用</li><li>涉及findFirst或者limit的时候不用</li></ul></li></ul><h3 id="stream-vs-collection"><a class="markdownIt-Anchor" href="#stream-vs-collection"></a> <strong>Stream vs Collection</strong></h3><ul><li>Stream和Collection两者可以互相转化</li><li>如果数据可能无限，用Stream</li><li>如果数据很大很大，用Stream</li><li>如果调用者将使用查找/过滤/聚合等操作，用Stream</li><li>当调用者使用过程中，发生数据改变，而调用者需要对数据一致性有较高要求，用Collection</li></ul></div><footer class="article-footer"><a data-url="https://d-sketon.github.io/reimu-lighthouse/20210922/java-stream/" data-id="clx5mff68000qz8q37t17act3" data-title="Java Stream流" class="article-share-link">分享</a> <a href="/reimu-lighthouse/20210922/java-stream/#comments" class="article-comment-link"><span class="post-comments-count waline-comment-count" data-path="/reimu-lighthouse/20210922/java-stream/" itemprop="commentCount"></span> 留言 </a><span class="article-visitor-link"><span class="waline-pageview-count" data-path="/reimu-lighthouse/20210922/java-stream/">0</span> <em class="post-meta-item-text">阅读量</em></span><ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/reimu-lighthouse/tags/Java/" rel="tag">Java</a></li></ul></footer></div><nav id="article-nav" class="wow fadeInUp"><div class="article-nav-link-wrap article-nav-link-left"><img data-src="https://d-sketon.top/img/_backwebp/bg21.webp" data-sizes="auto" alt="Java 模块化" class="lazyload"> <a href="/reimu-lighthouse/20210922/java-modularization/"></a><div class="article-nav-caption">前一篇</div><h3 class="article-nav-title">Java 模块化</h3></div><div class="article-nav-link-wrap article-nav-link-right"><img data-src="https://d-sketon.top/img/_backwebp/bg11.webp" data-sizes="auto" alt="Java Lambda表达式" class="lazyload"> <a href="/reimu-lighthouse/20210922/java-lambda/"></a><div class="article-nav-caption">后一篇</div><h3 class="article-nav-title">Java Lambda表达式</h3></div></nav></article><div id="comments" class="wcomment"></div></section></div><footer id="footer" class="wow fadeInUp"><div style="width:100%;overflow:hidden"><div class="footer-line"></div></div><div class="outer"><div id="footer-info" class="inner"><div><span class="icon-copyright"></span> 2020-2024 <span class="footer-info-sep"></span> D-Sketon</div><div>基于&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>&nbsp; Theme.<a href="https://github.com/D-Sketon/hexo-theme-reimu" target="_blank">Reimu</a></div><div><span class="icon-brush"></span> 170.6k &nbsp;|&nbsp; <span class="icon-coffee"></span> 11:54</div><div><span class="icon-eye"></span> <span id="busuanzi_container_site_pv">总访问量&nbsp;<span id="busuanzi_value_site_pv"></span></span> &nbsp;|&nbsp; <span class="icon-user"></span> <span id="busuanzi_container_site_uv">总访客量&nbsp;<span id="busuanzi_value_site_uv"></span></span></div></div></div></footer><div class="sidebar-top"><img src="/images/taichi.png" height="50" width="50"><div class="arrow-up"></div></div><div id="mask"></div></div><nav id="mobile-nav"><div class="sidebar-wrap"><div class="sidebar-toc-sidebar"><div class="sidebar-toc"><h3 class="toc-title">文章目录</h3><div class="sidebar-toc-wrapper toc-div-class"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E6%B5%81%E7%9A%84%E6%A6%82%E8%BF%B0"><span class="toc-number">1.</span> <span class="toc-text">1.流的概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#stream%E8%AF%AD%E6%B3%95"><span class="toc-number">1.1.</span> <span class="toc-text">Stream语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%81%E7%9A%84%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B"><span class="toc-number">1.2.</span> <span class="toc-text">流的工作流程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E6%B5%81%E7%9A%84%E5%88%9B%E5%BB%BA"><span class="toc-number">2.</span> <span class="toc-text">2.流的创建</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E7%B1%BB%E5%9E%8B%E6%B5%81"><span class="toc-number">2.1.</span> <span class="toc-text">基本类型流</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B9%B6%E8%A1%8C%E6%B5%81"><span class="toc-number">2.2.</span> <span class="toc-text">并行流</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3stream%E7%9A%84%E8%BD%AC%E6%8D%A2"><span class="toc-number">3.</span> <span class="toc-text">3.Stream的转换</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4filter"><span class="toc-number">3.1.</span> <span class="toc-text">过滤filter</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%BB%E9%87%8Ddistinct"><span class="toc-number">3.2.</span> <span class="toc-text">去重distinct</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%92%E5%BA%8Fsorted"><span class="toc-number">3.3.</span> <span class="toc-text">排序sorted</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BD%AC%E5%8C%96map"><span class="toc-number">3.4.</span> <span class="toc-text">转化map</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%BD%E5%8F%96limit"><span class="toc-number">3.5.</span> <span class="toc-text">抽取limit</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%B3%E8%BF%87skip"><span class="toc-number">3.6.</span> <span class="toc-text">跳过skip</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5concat"><span class="toc-number">3.7.</span> <span class="toc-text">连接concat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%9D%E5%A4%96%E8%B0%83%E8%AF%95peek"><span class="toc-number">3.8.</span> <span class="toc-text">额外调试peek</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4optional%E7%B1%BB%E5%9E%8B"><span class="toc-number">4.</span> <span class="toc-text">4.Optional类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#optionalt%E5%88%9B%E5%BB%BA"><span class="toc-number">4.1.</span> <span class="toc-text">Optional&lt;T&gt;创建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#optionalt%E4%BD%BF%E7%94%A8"><span class="toc-number">4.2.</span> <span class="toc-text">Optional&lt;T&gt;使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#optionalt%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">4.3.</span> <span class="toc-text">Optional&lt;T&gt;注意事项</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5%E6%B5%81%E7%9A%84%E8%AE%A1%E7%AE%97%E7%BB%93%E6%9E%9C"><span class="toc-number">5.</span> <span class="toc-text">5.流的计算结果</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E7%BA%A6%E7%AE%80%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0"><span class="toc-number">5.1.</span> <span class="toc-text">简单约简(聚合函数)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BA%A6%E7%AE%80"><span class="toc-number">5.2.</span> <span class="toc-text">自定义约简</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E9%81%8D%E5%8E%86%E5%85%83%E7%B4%A0"><span class="toc-number">5.3.</span> <span class="toc-text">查看&#x2F;遍历元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E6%94%BE%E5%88%B0%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%AD"><span class="toc-number">5.4.</span> <span class="toc-text">存放到数据结构中</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%81%E7%9A%84%E9%AB%98%E9%98%B6%E8%AE%A1%E7%AE%97"><span class="toc-number">5.5.</span> <span class="toc-text">流的高阶计算</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6%E6%B5%81%E7%9A%84%E5%BA%94%E7%94%A8"><span class="toc-number">6.</span> <span class="toc-text">6.流的应用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#java-stream%E7%9A%84%E4%BC%98%E7%82%B9"><span class="toc-number">6.1.</span> <span class="toc-text">Java Stream的优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#java-stream-vs-%E5%BE%AA%E7%8E%AF%E8%BF%AD%E4%BB%A3%E4%BB%A3%E7%A0%81"><span class="toc-number">6.2.</span> <span class="toc-text">Java Stream vs 循环迭代代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#stream%E5%BA%94%E7%94%A8%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">6.3.</span> <span class="toc-text">Stream应用注意事项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#stream-vs-collection"><span class="toc-number">6.4.</span> <span class="toc-text">Stream vs Collection</span></a></li></ol></li></ol></div></div></div><div class="sidebar-common-sidebar hidden"><div class="sidebar-author"><img data-src="/avatar/avatar.webp" data-sizes="auto" alt="D-Sketon" class="lazyload"><div class="sidebar-author-name">D-Sketon</div><div class="sidebar-description">D-Sketon&#39;s blog</div></div><div class="sidebar-state"><div class="sidebar-state-article"><div>文章</div><div class="sidebar-state-number">53</div></div><div class="sidebar-state-category"><div>分类</div><div class="sidebar-state-number">10</div></div><div class="sidebar-state-tag"><div>标签</div><div class="sidebar-state-number">19</div></div></div><div class="sidebar-social"><div class="icon-github"><a href="https://github.com/D-Sketon" itemprop="url" target="_blank" aria-label="github"></a></div><div class="icon-bilibili"><a href="https://space.bilibili.com/20339857" itemprop="url" target="_blank" aria-label="bilibili"></a></div></div><div class="sidebar-menu"><div class="sidebar-menu-link-wrap"><a class="sidebar-menu-link-dummy" href="/reimu-lighthouse/" aria-label="首页"></a> <span class="sidebar-menu-icon"></span><div class="sidebar-menu-link">首页</div></div><div class="sidebar-menu-link-wrap"><a class="sidebar-menu-link-dummy" href="/reimu-lighthouse/archives" aria-label="归档"></a> <span class="sidebar-menu-icon"></span><div class="sidebar-menu-link">归档</div></div><div class="sidebar-menu-link-wrap"><a class="sidebar-menu-link-dummy" href="/reimu-lighthouse/about" aria-label="关于"></a> <span class="sidebar-menu-icon"></span><div class="sidebar-menu-link">关于</div></div><div class="sidebar-menu-link-wrap"><a class="sidebar-menu-link-dummy" href="/reimu-lighthouse/friend" aria-label="友链"></a> <span class="sidebar-menu-icon"></span><div class="sidebar-menu-link">友链</div></div></div></div></div><div class="sidebar-btn-wrapper"><div class="sidebar-toc-btn current"></div><div class="sidebar-common-btn"></div></div></nav></div><div class="site-search"><div class="reimu-popup popup"><div class="reimu-search"><span class="reimu-search-input-icon"></span><div class="reimu-search-input" id="reimu-search-input"></div></div><div class="reimu-results"><div id="reimu-stats"></div><div id="reimu-hits"></div><div id="reimu-pagination" class="reimu-pagination"></div></div><span class="popup-btn-close"></span></div></div><script src="https://npm.webcache.cn/jquery@3.7.1/dist/jquery.min.js"></script><script src="https://npm.webcache.cn/lazysizes@5.3.2/lazysizes.min.js"></script><script src="https://npm.webcache.cn/clipboard@2.0.11/dist/clipboard.min.js"></script><script src="https://npm.webcache.cn/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" defer></script><script src="https://npm.webcache.cn/busuanzi@2.3.0/bsz.pure.mini.js" async></script><script src="https://npm.webcache.cn/mermaid@9.4.3/dist/mermaid.min.js"></script><script>if(window.mermaid){const a=".mermaid",b=()=>new Promise((t,r)=>{try{var e=document.querySelectorAll(a),n=e.length;e.forEach(e=>{null==e.getAttribute("data-original-code")&&e.setAttribute("data-original-code",e.innerHTML),0==--n&&t()})}catch(e){r(e)}}),c=()=>new Promise((t,r)=>{try{var e=document.querySelectorAll(a),n=e.length;e.forEach(e=>{null!=e.getAttribute("data-original-code")&&(e.removeAttribute("data-processed"),e.innerHTML=e.getAttribute("data-original-code")),0==--n&&t()})}catch(e){r(e)}}),d=e=>{window.mermaid.initialize({theme:e}),window.mermaid.init({theme:e},document.querySelectorAll(a))};document.body.addEventListener("dark-theme-set",()=>{b().then(c()).then(d("dark")).catch(console.error)}),document.body.addEventListener("light-theme-set",()=>{b().then(c()).then(d("default")).catch(console.error)})}</script><script src="/reimu-lighthouse/js/pjax_script.js" data-pjax></script><script data-pjax type="module">import { init } from "https://npm.webcache.cn/@waline/client@v2/dist/waline.mjs";
    if(document.querySelector('.wcomment')) {
      init({
        el: '.wcomment',
        serverURL: 'https://reimu.d-sketon.top',
        lang: 'zh-CN',
        locale: {},
        emoji: ["https://unpkg.com/@waline/emojis@1.2.0/weibo","https://unpkg.com/@waline/emojis@1.2.0/alus","https://unpkg.com/@waline/emojis@1.2.0/bilibili","https://unpkg.com/@waline/emojis@1.2.0/qq","https://unpkg.com/@waline/emojis@1.2.0/tieba","https://unpkg.com/@waline/emojis@1.2.0/tw-emoji"],
        meta: ["nick","mail","link"],
        requiredMeta: ["nick","mail"],
        wordLimit: JSON.parse('0'),
        comment: true,
        pageSize: JSON.parse('10'),
        dark: 'html[data-theme="dark"]',
        pageview: JSON.parse('true'),
    });
    }</script><script src="https://npm.webcache.cn/algoliasearch@4.17.1/dist/algoliasearch-lite.umd.js"></script><script src="https://npm.webcache.cn/instantsearch.js@4.56.1/dist/instantsearch.production.min.js"></script><script src="/reimu-lighthouse/js/algolia_search.js"></script><script>var CONFIG={root:"/",algolia:{applicationID:"AIE5T9AKYQ",apiKey:"2b855b06a058dd80bc84972874e020aa",indexName:"reimu_new_algoliasearch",hits:{per_page:parseInt("10")},labels:{input_placeholder:"搜索.....",hits_empty:"未发现与 「${query}」相关内容",hits_stats:"找到${hits}条结果（用时 ${time} ms）"}}}</script><script src="https://npm.webcache.cn/mouse-firework@0.0.4/dist/index.umd.js"></script><script>firework(JSON.parse('{"excludeElements":["a","button"],"particles":[{"shape":"circle","move":["emit"],"easing":"easeOutExpo","colors":["#ff5252","#ff7c7c","#ffafaf","#ffd0d0"],"number":20,"duration":[1200,1800],"shapeOptions":{"radius":[16,32],"alpha":[0.3,0.5]}},{"shape":"circle","move":["diffuse"],"easing":"easeOutExpo","colors":["#ff0000"],"number":1,"duration":[1200,1800],"shapeOptions":{"radius":20,"alpha":[0.2,0.5],"lineWidth":6}}]}'))</script><script src="https://npm.webcache.cn/theme-shokax-pjax@0.0.3/dist/index.umd.js"></script><script>new Pjax({selectors:["#header-title","#subtitle-wrap","#content","#mobile-nav"],switches:{"#header-title":Pjax.switches.outerHTML,"#subtitle-wrap":Pjax.switches.outerHTML,"#content":function(oldEl,newEl,options){function loadScripts(scripts,index){var script;index<scripts.length&&(script=scripts[index],$(script).attr("src")?$.ajax({url:$(script).attr("src"),dataType:"script",success:()=>{loadScripts(scripts,index+1)},error:(t,s,r)=>{console.error("Failed to load script:",$(script).attr("src"),r)}}):(eval($(script).text()),loadScripts(scripts,index+1)))}const scripts=$(newEl.outerHTML).find("script").toArray();loadScripts(scripts,0),oldEl.outerHTML=newEl.outerHTML,this.onSwitch()},"#mobile-nav":Pjax.switches.outerHTML},cacheBust:!1})</script><script src="/reimu-lighthouse/js/pjax.js"></script><script src="/reimu-lighthouse/js/script.js"></script><script>console.log(String.raw`%c 
 ______     ______     __     __    __     __  __    
/\  == \   /\  ___\   /\ \   /\ "-./  \   /\ \/\ \   
\ \  __<   \ \  __\   \ \ \  \ \ \-./\ \  \ \ \_\ \  
 \ \_\ \_\  \ \_____\  \ \_\  \ \_\ \ \_\  \ \_____\ 
  \/_/ /_/   \/_____/   \/_/   \/_/  \/_/   \/_____/ 
                                                  
`,"color: #ff5252;"),console.log("%c Theme.Reimu v0.1.2 %c https://github.com/D-Sketon/hexo-theme-reimu ","color: white; background: #ff5252; padding:5px 0;","padding:4px;border:1px solid #ff5252;")</script><script src="/reimu-lighthouse/js/insert_highlight.js" data-pjax></script></body></html>